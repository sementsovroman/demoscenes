var b4w="object"===typeof b4w?b4w:function(a){var r={};a.module=r;var d={};a.cleanup=function(a,b){var c=r[a];c&&(c.Zl=null);d[b||"__b4w_default"]=null};a.register=function(a,b){r[a]||(r[a]=b)};a.require=function(a,b){if(!r[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";d[b]||(d[b]=function(a){return function(b){var c=r[b];if(!c)throw Error('Module "'+b+'" not found');c.Zl||(c.Zl={});c.Zl[a]||(c.Zl[a]={},c(c.Zl[a],d[a]));return c.Zl[a]}}(b));return d[b](a)};a.module_check=function(a){return r[a]?
!0:!1};a.get_namespace=function(a){for(var b in d)if(d[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.__version=function(a){var r=new Date(2017,1,27,18,16,26),d=[17,2];a.version=function(){return d};a.version_str=function(){for(var a="",b=0;b<d.length;b++)a=1==b?a+(10>d[b]?"0"+d[b]:d[b]):a+d[b],b!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return r};a.date_str=function(){var a=r.getDate(),a=10>a?"0"+String(a):String(a),b=r.getMonth()+1,b=10>b?"0"+String(b):String(b),d=String(r.getFullYear()),n=r.getHours(),n=10>n?"0"+String(n):String(n),x=r.getMinutes(),
x=10>x?"0"+String(x):String(x),e=r.getSeconds(),e=10>e?"0"+String(e):String(e);return a+"."+b+"."+d+" "+n+":"+x+":"+e};a.timestamp=function(){return"?v=_b4w_ver_17_02_"}};b4w.module.__config=function(a,r){function d(){return b4w.module_check(a.ge.pr)}function c(){for(var c=a.ge,d=null,g=document.getElementsByTagName("script"),u=0;u<g.length;u++){for(var w=g[u].src,h=0;h<c.OC.length;h++)if(0<=w.indexOf(c.OC[h])){d=w;break}if(null!==d)break}d||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),d=document.location.href);c=d.indexOf("?");0<=c&&(d=d.substring(0,c));return d.substring(0,d.lastIndexOf("/"))}var b=r("__print"),
g=r("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.P_AUTO=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.fB=g.S(a.context);a.H={alpha_sort:!0,alpha_sort_threshold:.1,jl:[6,2],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,LB:1,uM:5,background_color:[0,0,0,0],canvas_resolution_factor:1,El:3,allow_cors:!1,KB:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,HT:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,
motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,$F:!1,sm:!0,qt:!0,yc:!0,water_dynamic:!0,shore_smoothing:!0,an:!0,GF:!0,precision:"highp",quality:a.P_HIGH,br:!0,QO:!1,oy:!1,Yv:!1,TF:!1,is_mobile_device:!1,Pw:!1,yv:!1,YU:!1,bq:!1,allow_hidpi:!1,AE:!1,rx:!1,enable_selectable:!0,enable_outlining:!0,ii:!0,Uk:!1,IB:!1,fx:[0,0],KD:!0,Mt:!1,url_params:null,Yb:!0,uc:4,Go:!1,$D:!1,aE:!1,ay:!1,UA:!1,yC:!1,media_auto_activation:!0,eD:4,Ts:!1,gl_debug:!1,OA:!1,aA:!1,Yu:!1,Ho:"dds",shadow_blur_samples:"",
reflection_quality:"",srgb_type:"SRGB_SIMPLE",Ds:!1,xB:!1};a.vB=g.S(a.H);a.nk={as:-1,MB:!1,Pk:1};a.controls={LO:1/120};a.rd={path:"",bP:"B4W_ASSETS_PATH=__JS__/../../assets/",rP:"B4W_PROJ_ASSETS_PATH=__JS__/../../../projects/__NAME__/assets/",FO:15,prevent_caching:!0,qx:!1,Tv:!1,At:!1};a.gA=g.S(a.rd);a.ge={shaders_path:"",IQ:"../shaders/",yE:"include/",VU:"postprocessing/",pr:"built_in_data",OC:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js B4W_MAIN_MODULE".split(" "),
smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};a.wC={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{AB:.8,Kf:.064,Yg:.035,Zp:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],hk:.11,rh:.062,Zg:.004}};a.J={enabled:!0,max_fps:60,xq:"",eS:"B4W_URANIUM_PATH=uranium.js",pv:!1,ping:!1,yn:!0};a.BD=g.S(a.J);a.$m={mp:1024,Fr:256,oB:32,BL:128,AL:256,DD:.25,jP:.5,iP:1};a.dE=g.S(a.$m);a.Y={mz:!0,
$s:!1,lA:!1,VA:!1,zB:!1};a.wE=g.S(a.Y);a.Ic={outlining_overview_mode:!1,wi:[1,.4,.05],Gj:.2,Hj:3.8,Ij:1};a.Jk={enabled:!1,oq:0,iR:0,LQ:"COLOR"};a.tB=g.S(a.Jk);a.pg={EO:8,jx:64,nx:8,Vs:8,ox:15,gD:0,Ws:128,ri:1024,kx:4096,tc:4096,px:[4096,4096],hh:24};a.eB=g.S(a.pg);a.apply_quality=function(){var b=a.H,c=a.J,d=a.$m;switch(b.quality){case a.P_ULTRA:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.sm=!0;b.qt=!0;b.yc=!0;d.mp=2048;d.Fr=512;
b.El=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.an=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.ii=!0;b.uc=16;b.srgb_type="SRGB_PROPER";c.max_fps=120;break;case a.P_HIGH:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.sm=!0;b.qt=!0;b.yc=!0;d.mp=1024;d.Fr=256;b.El=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=
!0;b.an=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.ii=!0;b.srgb_type="SRGB_SIMPLE";b.uc=4;c.max_fps=60;break;case a.P_LOW:b.shadows=!1;b.shore_smoothing=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.sm=!1;b.qt=!1;b.yc=!1;d.mp=512;d.Fr=256;b.El=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.an=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=
!1;b.enable_outlining=!1;b.ii=!1;b.srgb_type="SRGB_SIMPLE";b.uc=1;c.max_fps=60;break;case a.P_AUTO:g.D("Direct AUTO quality profile setting is forbidden")}};a.set=function(c,d){switch(c){case "allow_cors":a.H.allow_cors=d;break;case "allow_hidpi":a.H.allow_hidpi=d;break;case "alpha":a.context.alpha=d;break;case "alpha_sort":a.H.alpha_sort=d;break;case "alpha_sort_threshold":a.H.alpha_sort_threshold=d;break;case "anaglyph_use":b.ZL();a.H.stereo=d?"ANAGLYPH":a.H.stereo;break;case "animation_framerate":a.nk.as=
d;break;case "anisotropic_filtering":a.H.anisotropic_filtering=d;break;case "antialiasing":a.H.antialiasing=d;break;case "assets_dir":case "assets_path":a.rd.path=d;break;case "assets_dds_available":a.rd.Tv=d;break;case "assets_pvr_available":a.rd.At=d;break;case "assets_min50_available":a.rd.qx=d;break;case "audio":a.Y.mz=d;break;case "background_color":a.H.background_color=d;break;case "bloom":a.H.bloom=d;break;case "built_in_module_name":a.ge.pr=d;break;case "canvas_resolution_factor":a.H.canvas_resolution_factor=
d;break;case "console_verbose":a.H.console_verbose=d;break;case "compositing":a.H.compositing=d;break;case "dof":a.H.dof=d;break;case "do_not_load_resources":a.H.do_not_load_resources=d;break;case "god_rays":a.H.god_rays=d;break;case "stereo":a.H.stereo=d;break;case "max_fps":a.H.max_fps=d;break;case "max_fps_physics":a.J.max_fps=d;break;case "media_auto_activation":a.H.media_auto_activation=d;break;case "motion_blur":a.H.motion_blur=d;break;case "physics_enabled":a.J.enabled=d;break;case "physics_uranium_path":a.J.xq=
d;break;case "physics_calc_fps":a.J.pv=d;break;case "physics_use_workers":a.J.yn=d;break;case "precision":a.H.precision=d;break;case "prevent_caching":a.rd.prevent_caching=d;break;case "quality":a.H.quality=d;break;case "reflections":a.H.reflections=d;break;case "refractions":a.H.refractions=d;break;case "sfx_mix_mode":a.Y.$s=d;break;case "shaders_dir":case "shaders_path":a.ge.shaders_path=d;break;case "shadows":a.H.shadows=d;break;case "show_hud_debug_info":a.H.show_hud_debug_info=d;break;case "smaa":a.H.smaa=
d;break;case "smaa_search_texture_path":a.ge.smaa_search_texture_path=d;break;case "smaa_area_texture_path":a.ge.smaa_area_texture_path=d;break;case "ssao":a.H.ssao=d;break;case "debug_view":a.H.debug_view=d;break;case "enable_selectable":a.H.enable_selectable=d;break;case "enable_outlining":a.H.enable_outlining=d;break;case "outlining_overview_mode":a.Ic.outlining_overview_mode=d;break;case "glow_materials":a.H.ii=d;break;case "url_params":a.H.url_params=d;break;case "use_min50":a.H.use_min50=d;
break;case "gl_debug":a.H.gl_debug=d;break;case "srgb_type":a.H.srgb_type=d;break;case "shadow_blur_samples":a.H.shadow_blur_samples=d;break;case "reflection_quality":a.H.reflection_quality=d;break;default:b.error("Unknown config property: "+c)}};a.get=function(d){switch(d){case "allow_cors":return a.H.allow_cors;case "allow_hidpi":return a.H.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.H.alpha_sort;case "alpha_sort_threshold":return a.H.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==
a.H.stereo;case "animation_framerate":return a.nk.as;case "anisotropic_filtering":return a.H.anisotropic_filtering;case "antialiasing":return a.H.antialiasing;case "assets_dir":case "assets_path":return a.rd.path;case "assets_dds_available":return a.rd.Tv;case "assets_pvr_available":return a.rd.At;case "assets_min50_available":return a.rd.qx;case "audio":return a.Y.mz;case "background_color":return a.H.background_color;case "bloom":return a.H.bloom;case "built_in_module_name":return a.ge.pr;case "canvas_resolution_factor":return a.H.canvas_resolution_factor;
case "console_verbose":return a.H.console_verbose;case "compositing":return a.H.compositing;case "dof":return a.H.dof;case "do_not_load_resources":return a.H.do_not_load_resources;case "is_mobile_device":return a.H.is_mobile_device;case "god_rays":return a.H.god_rays;case "stereo":return a.H.stereo;case "max_fps":return a.H.max_fps;case "max_fps_physics":return a.J.max_fps;case "media_auto_activation":return a.H.media_auto_activation;case "motion_blur":return a.H.motion_blur;case "physics_enabled":return a.J.enabled;
case "physics_uranium_path":return a.J.xq;case "physics_calc_fps":return a.J.pv;case "physics_use_workers":return a.J.yn;case "precision":return a.H.precision;case "prevent_caching":return a.rd.prevent_caching;case "quality":return a.H.quality;case "reflections":return a.H.reflections;case "refractions":return a.H.refractions;case "sfx_mix_mode":return a.Y.$s;case "shaders_dir":case "shaders_path":return a.ge.shaders_path;case "shadows":return a.H.shadows;case "show_hud_debug_info":return a.H.show_hud_debug_info;
case "smaa":return a.H.smaa;case "smaa_search_texture_path":return a.ge.smaa_search_texture_path;case "smaa_area_texture_path":return a.ge.smaa_area_texture_path;case "ssao":return a.H.ssao;case "debug_view":return a.H.debug_view;case "enable_selectable":return a.H.enable_selectable;case "enable_outlining":return a.H.enable_outlining;case "outlining_overview_mode":return a.Ic.outlining_overview_mode;case "glow_materials":return a.H.ii;case "url_params":return a.H.url_params;case "use_min50":return a.H.use_min50;
case "gl_debug":return a.H.gl_debug;case "srgb_type":return a.H.srgb_type;case "shadow_blur_samples":return a.H.shadow_blur_samples;case "reflection_quality":return a.H.reflection_quality;default:b.error("Unknown config property: "+d)}};a.reset=function(){for(var b in a.fB)a.context[b]=a.fB[b];for(b in a.vB)a.H[b]=a.vB[b];for(b in a.gA)a.rd[b]=a.gA[b];for(b in a.BD)a.J[b]=a.BD[b];for(b in a.dE)a.$m[b]=a.dE[b];for(b in a.wE)a.Y[b]=a.wE[b];for(b in a.tB)a.Jk[b]=a.tB[b]};a.reset_limits=function(){var b=
a.pg.hh,d;for(d in a.eB)a.pg[d]=a.eB[d];a.pg.hh=b};a.EC=d;a.tQ=function(){var b=a.ge,g=a.J;d()||""!=b.shaders_path||(b.shaders_path=c()+"/"+b.IQ);g.enabled&&""==g.xq&&(g.xq=c()+"/"+g.eS.replace("B4W_URANIUM_PATH=",""))};a.get_assets_path=function(b){var d=a.rd;if(d.path)return d.path;var g=d.bP,n="B4W_ASSETS_PATH=";b&&(g=d.rP,n="B4W_PROJ_ASSETS_PATH=",g=g.replace("__NAME__",b));g=g.replace(n,"");return g=g.replace("__JS__",c())}};b4w.module.__anchors=function(a,r){function d(){if(!y&&!H){var a=p;if(a)if("visible"==a.lastElementChild.style.visibility)c(),p=null;else if(1==a.style.opacity){var b=a.lastElementChild,a=a.firstElementChild,d=b.firstElementChild,f=Math.ceil(b.getBoundingClientRect().width),D=Math.ceil(b.getBoundingClientRect().height),l=Math.ceil(a.getBoundingClientRect().width),h=Math.ceil(a.getBoundingClientRect().height);b.style.position="absolute";b.style.visibility="visible";var k=!0,v=!0;a.style.display="none";
y=!0;l!=f?A.animate(l,f,200,function(a){a==f&&(k=!1,v||(y=!1,d.style.visibility="visible"));b.style.width=a+"px"}):(k=!1,v||(y=!1));h!=D?A.animate(h,D,200,function(a){a==D&&(v=!1,k||(y=!1,d.style.visibility="visible"));b.style.height=a+"px"}):(v=!1,k||(y=!1))}}}function c(){var a=p.lastElementChild;p.firstElementChild.style.display="";a.style.visibility="hidden";a.style.position="relative";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 1.25;"}
function g(a,d,f){var L=document.createElement("div"),D=document.createElement("span");f&&(L.style.maxWidth=f+"px");L.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);left:               0;box-sizing:         border-box;opacity:            1.0;padding:            6px 12px 6px 12px;position:           relative;z-index:            2;";b(D);D.innerHTML=
a;L.style.visibility="hidden";D.style.visibility="hidden";L.appendChild(D);d.appendChild(L);k.add_click_listener(d,function(){y||d==p||1!=d.style.opacity||H||(p&&"visible"==p.lastElementChild.style.visibility&&c(),p=d)})}function n(){for(var a=0,b=0;b<z.length;b++)z[b].im&&a++;Z=new Float32Array(3*a)}function x(a,b){return b.depth-a.depth}function e(a,b,p){a=a.element;l.yC&&(b=Math.floor(b),p=Math.floor(p));"transform"in a.style?a.style.transform="translate3d("+b+"px, "+p+"px, 0px)":"webkitTransform"in
a.style?a.style.webkitTransform="translate3d("+b+"px, "+p+"px, 0px)":(a.style.left=b+"px",a.style.top=p+"px")}function u(a){for(var b=0;b<z.length;b++)if(z[b].obj==a)return!0;return!1}var w=r("__batch"),h=r("__camera"),m=r("__config"),B=r("__container"),k=r("__input"),f=r("__objects"),F=r("__obj_util"),t=r("__print"),q=r("__renderer"),E=r("__scenes"),J=r("__subscene"),A=r("__time"),I=r("__transform"),C=r("__tsr"),v=r("__vec3"),l=m.H,z=[],H=!1,p=null,Q=!1,y=!1,Z=new Float32Array(0),S=new Uint8Array(16),
G=new Float32Array(2),D=new Float32Array(3),X=new Float32Array(3);a.append=function(a){if(!u(a)){var p=a.anchor.im&&!!E.Aa(E.oh(),J.Rl),p={type:a.anchor.type,obj:a,x:0,y:0,depth:0,pk:"out",im:p,element:null,Lm:null,BI:a.anchor.GO,gj:a.anchor.gj};switch(p.type){case "ANNOTATION":var y=p.obj;a=B.get_container();var c=f.get_meta_tags(y),y=y.name,D="",l=document.createElement("div"),h=l.cloneNode(!1),k=document.createElement("span");l.style.cssText+="position:        absolute;height:          0;transform-style: preserve-3d;";
h.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);opacity:            1.0;box-sizing:         border-box;bottom:             0;left:               0;padding:            6px 12px 6px 12px;position:           absolute;";l.style.visibility="hidden";c&&(D=c.description||D,y=c.title||y);k.innerHTML=y;k.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(k);k.style.whiteSpace="nowrap";h.appendChild(k);l.appendChild(h);D&&g(D,l,p.BI);a.appendChild(l);p.element=l;break;case "ELEMENT":if(p.element=document.getElementById(a.anchor.gj),p.element)for(c=0;c<z.length;c++)"ELEMENT"==z[c].type&&z[c].gj==a.anchor.gj&&(t.warn("Anchor with the id '"+a.anchor.gj+"' already exists, making the new anchor generic."),p.type="GENERIC");else t.warn("Anchor HTML element with the id '"+a.anchor.gj+"' was not found, making it generic."),p.type="GENERIC"}z.push(p);n();
Q||(Q=!0,B.get_container().addEventListener("mouseup",d))}};a.remove=function(a){for(var b=0;b<z.length;b++){var p=z[b];if(p.obj==a){"ANNOTATION"==p.type&&(a=p,B.get_container().removeChild(a.element));z.splice(b,1);n();break}}};a.update=function(a){for(var b=0,d=z.length;d--;){var y=z[d];if(y.im){var c=C.get_trans_view(y.obj.o.v);Z.set(c,3*b++)}var f;f=y;var c=D,l=E.mj(E.oh());f=C.get_trans_view(f.obj.o.v);h.project_point(l,f,c);f=c;c=f[0];l=f[1];f=f[2];if(a||c!=y.x||l!=y.y||f!=y.depth){switch(y.type){case "ANNOTATION":var k=
c,v=l;e(y,k,v);break;case "ELEMENT":v=y.element.getBoundingClientRect(),k=c-v.width/2,v=l-v.height/2,e(y,k,v)}y.x=c;y.y=l;y.depth=f;y.Lm&&y.Lm(c,l,y.pk,y.obj,y.element)}}z.sort(x);for(d=0;d<z.length;d++)y=z[d],"GENERIC"!=y.type&&(y.element.style.zIndex=p==y.element?z.length:d);0<b&&(a=E.Aa(E.oh(),J.Rl),b=a.Qa[0].ra[0],w.xR(b.qa,Z),J.Ec(a,b))};a.EF=function(){for(var a=B.get_container(),b=E.get_active(),b=E.Aa(b,J.uf),b=!(!b||!b.enable_hmd_stereo),d=z.length;d--;){var y=z[d],f=y.obj,l=f.o,h=y.x,k=
y.y,g=y.depth,Q=E.mj(E.oh()),e=I.get_translation(f,D),Q=I.get_translation(Q,X),e=v.dist(e,Q);(g=0>h||0>k||0>g||1<g||E.is_hidden(f)||h>=a.clientWidth||k>=a.clientHeight)||(g=l.De,g=!(e<l.Dg?0:g==F.Mn||e<g));l=g?"out":"visible";y.im&&"out"!=l&&(l=y,g=E.Aa(E.oh(),J.Rl).B,e=B.po(l.x,l.y,G,g),q.Dt(g.ee,e[0],g.height-e[1],2,2,S),l=1020==S[5]+S[6]+S[9]+S[10]?"visible":"out"!=l.pk&&S[5]+S[6]+S[9]+S[10]?l.pk:"covered");b&&(l="out");if(l!=y.pk){switch(y.type){case "ANNOTATION":case "ELEMENT":var m=y.element;
m&&("out"==l?(m.style.visibility="hidden",m.children.length&&(m.children[0].style.visibility="hidden")):"visible"==l?(m.style.visibility="visible",m.children.length&&(m.children[0].style.visibility="visible"),m.style.opacity=1):(m.style.visibility="visible",m.style.opacity=.1,m.children.length&&(m.children[0].style.visibility="visible"),"ANNOTATION"==y.type&&1<m.children.length&&"visible"==m.lastElementChild.style.visibility&&(c(),m==p&&(p=null))))}y.pk=l;y.Lm&&y.Lm(h,k,y.pk,f,m)}}};a.attach_move_cb=
function(a,b){for(var p=0;p<z.length;p++)z[p].obj==a&&(z[p].Lm=b)};a.detach_move_cb=function(a){for(var b=0;b<z.length;b++)z[b].obj==a&&(z[b].Lm=null)};a.cleanup=function(){for(var a=0;a<z.length;a++){var b=z[a];"ANNOTATION"==b.type&&B.get_container().removeChild(b.element)}z.length=0};a.is_anchor=u;a.get_element_id=function(a){for(var b=0;b<z.length;b++)if(z[b].obj==a)return z[b].gj;return!1};a.pause=function(){H=!0};a.resume=function(){H=!1};a.cP=function(a,b){for(var p=-1,d=0;d<z.length;d++){var y;
if(y="visible"==z[d].pk){var c=z[d];if(c.element){y=Math.round(c.element.offsetWidth)||0;var f=Math.round(c.element.offsetHeight)||0}else f=y=0;var D=c.x,c=c.y;y=a>=D&&a<=D+y&&b<c&&b>=c-f?!0:!1}if(y)if(0>p)var l=z[d].depth,p=d;else z[d].depth<l&&(p=d,l=z[d].depth)}return 0>p?null:z[p].obj}};b4w.module.__armature=function(a,r){function d(a){a=a.o;for(var b=a.dn,d=a.Xs,c=0;c<b.length;c++){for(var h=b[c],k=d[c],g=0;g<k.length;g+=2)for(var e=k[g],m=k[g+1],n=0;4>n;n++)h.Pd[e+n]=a.Pd[m+n],h.he[e+n]=a.he[m+n],h.Td[e+n]=a.Td[m+n],h.ke[e+n]=a.ke[m+n];h.Be=a.Be}}function c(a,b,d,h){var f=a.Xy,k=a.Ni,e=a.rq,m=a.Ip;m?(m=m.rq,b?g.multiply(m,f,e):(b=w,g.invert(m,b),g.multiply(b,e,f))):b?g.copy(f,e):g.copy(e,f);f=u;g.invert(k,f);g.multiply(e,f,f);k=a.Vh;d[4*k]=f[0];d[4*k+1]=f[1];d[4*k+2]=f[2];d[4*
k+3]=f[3];h[4*k]=f[4];h[4*k+1]=f[5];h[4*k+2]=f[6];h[4*k+3]=f[7];a=a.Wv;for(k=0;k<a.length;k++)e=a[k],e.cc||c(e,!0,d,h)}var b=r("__util"),g=r("__tsr"),n=r("__quat"),x=r("__mat4"),e=r("__vec3"),u=g.create(),w=g.create(),h=new Float32Array(4),m=new Float32Array(4),B=new Float32Array(4);a.bk=function(a,d){for(var c=a.data.bones,f=a.pose.bones,h={},k=0;k<f.length;k++){var m=f[k],n=m.bone,w=n.name,B=h[w]={Vh:0,UF:-1,Ip:null,Wv:[],rr:[],cc:null,sn:g.create(),Xy:g.create(),Ni:g.create(),Zy:g.create(),rq:g.create(),
tF:g.create(),sF:g.create(),qq:g.create(),Yy:g.create(),gu:!1,cF:new Float32Array(3)},w=new Float32Array(n.matrix_local),v=new Float32Array(16);x.invert(w,v);var m=new Float32Array(m.matrix_basis),l=B.cF;e.subtract(b.f32(n.tail_local),b.f32(n.head_local),l);b.nS(l,v,l);g.from_mat4(w,B.Ni);g.from_mat4(m,B.qq);g.copy(B.Ni,B.rq);g.invert(B.Ni,B.Zy)}for(k=0;k<c.length;k++){w=c[k].name;m=b.keysearch("name",w,f);B=h[w];n=m.parent_recursive;B.rr.push(B);for(v=0;v<n.length;v++)m=n[v],m=m.name,m=h[m],B.rr.push(m);
n.length?(m=n[0],m=m.name,m=h[m],B.Ip=m,g.invert(m.Ni,u),g.multiply(u,B.Ni,B.sn),m.Wv.push(B)):g.copy(B.Ni,B.sn);B.Vh=k;B.name=w;g.multiply(B.sn,B.qq,B.Xy)}d.o.zf=h};a.get_bone_tsr=function(a,b,d,c,q){var f=a.o,k=f.Be;b=f.zf[b];var e=b.Vh;a=b.Ni;var t=f.Td,C=f.ke,v=f.Pd,f=f.he,l=t[4*e+1],z=t[4*e+2],F=t[4*e+3],p=C[4*e+1],Q=C[4*e+2],y=C[4*e+3];h[0]=(1-k)*t[4*e]+k*C[4*e];h[1]=(1-k)*l+k*p;h[2]=(1-k)*z+k*Q;h[3]=(1-k)*F+k*y;m[0]=v[4*e];m[1]=v[4*e+1];m[2]=v[4*e+2];m[3]=v[4*e+3];B[0]=f[4*e];B[1]=f[4*e+1];
B[2]=f[4*e+2];B[3]=f[4*e+3];n.slerp(m,B,k,m);k=u;g.set_transcale(h,k);g.set_quat(m,k);d?(d=w,g.translate(a,b.cF,d),g.multiply(k,d,k)):g.multiply(k,a,k);if(c){if(c=b.Ip)d=w,g.invert(c.rq,d),g.multiply(d,k,k);c=w;g.invert(b.sn,c);g.multiply(c,k,k)}g.copy(k,q)};a.set_bone_tsr=function(a,b,h,e){var f=a.o;b=f.zf[b];var k=f.Td,m=f.Pd;e?g.multiply(b.sn,h,b.Xy):g.copy(h,b.rq);c(b,e,k,m);f.Be=0;d(a)};a.WR=d;a.ER=c;a.ur=function(a,b){return b in a.o.zf}};b4w.module.__boundings=function(a,r){function d(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function c(){return{M:new Float32Array(3),Ea:new Float32Array(3),Fa:new Float32Array(3),Ga:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function g(a,b){for(var d=a[0],p=a[1],c=a[2],f=a[0],D=a[1],l=a[2],h=3;h<a.length;h+=3)var L=a[h],k=a[h+1],v=a[h+2],d=Math.max(d,L),p=Math.max(p,k),c=Math.max(c,v),
f=Math.min(f,L),D=Math.min(D,k),l=Math.min(l,v);b.max_x=d;b.max_y=p;b.max_z=c;b.min_x=f;b.min_y=D;b.min_z=l;return b}function n(a,b){b||(b=new Float32Array(24));var d=a.max_x,p=a.max_y,c=a.max_z,f=a.min_x,D=a.min_y,l=a.min_z;b[0]=f;b[1]=D;b[2]=l;b[3]=d;b[4]=D;b[5]=l;b[6]=d;b[7]=p;b[8]=l;b[9]=f;b[10]=p;b[11]=l;b[12]=f;b[13]=D;b[14]=c;b[15]=d;b[16]=D;b[17]=c;b[18]=d;b[19]=p;b[20]=c;b[21]=f;b[22]=p;b[23]=c;return b}function x(){return{M:new Float32Array(3),Wa:0}}function e(a,b){b.M[0]=a.M[0];b.M[1]=
a.M[1];b.M[2]=a.M[2];b.Wa=a.Wa}function u(){return{Ea:new Float32Array(3),Fa:new Float32Array(3),Ga:new Float32Array(3),M:new Float32Array(3)}}function w(a,b){t.copy(a.Ea,b.Ea);t.copy(a.Fa,b.Fa);t.copy(a.Ga,b.Ga);t.copy(a.M,b.M);return b}function h(a){var b=u();w(a,b);return b}function m(a,b,d,c){return{Ea:new Float32Array(a),Fa:new Float32Array(b),Ga:new Float32Array(d),M:new Float32Array([c[0],c[1],c[2]])}}function B(a,b){var d=q.IJ(a,v),d=b?q.DJ(a,d,z):E.identity(z),d=q.mM(d,l);t.copy(a,A);t.transformMat3(A,
d,A);for(var c=A[0],p=c,f=A[1],D=f,h=A[2],k=h,L,g,e,Q,n=3;n<a.length;n+=3)A[0]=a[n],A[1]=a[n+1],A[2]=a[n+2],t.transformMat3(A,d,A),L=A[0],g=A[1],e=A[2],L>c&&(c=L),L<p&&(p=L),g>f&&(f=g),g<D&&(D=g),e>h&&(h=e),e<k&&(k=e);c=Math.max(c-p,1E-9);f=Math.max(f-D,1E-9);h=Math.max(h-k,1E-9);k=E.identity(z);k[0]=c?1/c:1E8;k[4]=f?1/f:1E8;k[8]=h?1/h:1E8;E.transpose(d,H);A[0]=a[0];A[1]=a[1];A[2]=a[2];t.transformMat3(A,d,A);t.transformMat3(A,k,A);t.transformMat3(A,H,A);D=A[0];p=A[0];L=A[1];g=A[1];e=A[2];Q=A[2];for(n=
3;n<a.length;n+=3)A[0]=a[n],A[1]=a[n+1],A[2]=a[n+2],t.transformMat3(A,d,A),t.transformMat3(A,k,A),t.transformMat3(A,H,A),D=Math.max(D,A[0]),p=Math.min(p,A[0]),L=Math.max(L,A[1]),g=Math.min(g,A[1]),e=Math.max(e,A[2]),Q=Math.min(Q,A[2]);n=Math.sqrt((D-p)*(D-p)+(L-g)*(L-g)+(e-Q)*(e-Q))/2;n=Math.min(n,1);C[0]=(D+p)/2;C[1]=(L+g)/2;C[2]=(e+Q)/2;D=C;k=E.identity(z);k[0]=c;k[4]=f;k[8]=h;t.transformMat3(D,d,D);t.transformMat3(D,k,D);t.transformMat3(D,H,D);k=[d[0],d[3],d[6]];p=[d[1],d[4],d[7]];d=[d[2],d[5],
d[8]];t.scale(k,c*n,k);t.scale(p,f*n,p);t.scale(d,h*n,d);return m(k,p,d,D)}function k(a,b,d){t.add(b,d,a.M);t.scale(a.M,.5,a.M);a.Wa=t.distance(a.M,b);return a}var f=r("__tsr"),F=r("__util"),t=r("__vec3"),q=r("__math"),E=r("__mat3"),J=new Float32Array(24),A=new Float32Array(3),I=new Float32Array(3),C=new Float32Array(3),v=new Float32Array(3),l=new Float32Array(9),z=new Float32Array(9),H=new Float32Array(9);a.sd=d;a.Cr=c;a.cm=b;a.nT=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,
min_z:-1E12}};a.BS=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.yk=function(a){var c=d();b(a,c);return c};a.EJ=function(a){var b=a.max_x-a.min_x,d=a.max_y-a.min_y;d<b&&(b=d);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.fw=function(a,b){var d=a.max_y,c=a.max_z,p=a.min_x,f=a.min_y,D=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,d);a.max_z=Math.max(b.max_z,c);a.min_x=Math.min(b.min_x,p);a.min_y=Math.min(b.min_y,f);a.min_z=Math.min(b.min_z,D)};a.oA=g;a.wk=
function(a,b,c){c||(c=d());a=n(a,J);f.transform_vectors(a,b,a);return g(a,c)};a.GB=n;a.XU=function(a,b,c){c||(c=d());var p=b.min_x,y=b.max_x,f=b.min_y,D=b.max_y,l=b.min_z;b=b.max_z;if(p>=a.max_x||y<=a.min_x||f>=a.max_y||D<=a.min_y||l>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,p);c.max_x=Math.min(a.max_x,y);c.min_y=Math.max(a.min_y,f);c.max_y=Math.min(a.max_y,D);c.min_z=Math.max(a.min_z,l);c.max_z=Math.min(a.max_z,b);
return c};a.bV=function(a,b,c){c||(c=d());var p=a.max_x-a.min_x,y=a.max_y-a.min_y,f=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*p;c.max_x=a.max_x+.5*(b-1)*p;c.min_y=a.min_y-.5*(b-1)*y;c.max_y=a.max_y+.5*(b-1)*y;c.min_z=a.min_z-.5*(b-1)*f;c.max_z=a.max_z+.5*(b-1)*f;return c};a.lo=function(a,b,d){d||(d=x());f.transform_vec3(a.M,b,d.M);b=f.get_scale(b);d.Wa=a.Wa*(0>b?-b:b);return d};a.ko=function(a,b,d){d||(d=u());f.transform_vec3(a.M,b,d.M);t.copy(a.Ea,d.Ea);t.copy(a.Fa,d.Fa);t.copy(a.Ga,d.Ga);f.transform_dir_vec3(d.Ea,
b,d.Ea);f.transform_dir_vec3(d.Fa,b,d.Fa);f.transform_dir_vec3(d.Ga,b,d.Ga);return d};a.lv=function(a,b,d){d||(d=c());f.transform_vec3(a.M,b,d.M);t.copy(a.Ea,d.Ea);t.copy(a.Fa,d.Fa);t.copy(a.Ga,d.Ga);f.transform_dir_vec3(d.Ea,b,d.Ea);f.transform_dir_vec3(d.Fa,b,d.Fa);f.transform_dir_vec3(d.Ga,b,d.Ga);return d};a.ov=function(a,b){var d=x();t.copy(b,d.M);d.Wa=a;return d};a.OP=function(a,b,d,f,l){var p=c();t.copy(a,p.M);t.copy(b,p.Ea);t.copy(d,p.Fa);t.copy(f,p.Ga);t.scale(p.Ea,l[0],p.Ea);t.scale(p.Fa,
l[1],p.Fa);t.scale(p.Ga,l[2],p.Ga);return p};a.fh=x;a.Gv=e;a.qg=u;a.Fv=w;a.yo=h;a.zk=function(a){var b=x();e(a,b);return b};a.fo=m;a.oJ=function(){var a;a||(a=x());t.set(0,0,0,a.M);a.Wa=1E12;return a};a.aM=function(a,b){var d=t.subtract(b.M,a.M,t.create());0==t.length(d)&&t.set(1,0,0,d);var c=t.normalize(d,t.create()),d=t.scale(c,a.Wa,t.create());t.add(d,a.M,d);var f=t.scale(c,-a.Wa,t.create());t.add(f,a.M,f);var p=t.scale(c,b.Wa,t.create());t.add(p,b.M,p);var l=t.scale(c,-b.Wa,t.create());t.add(l,
b.M,l);d=[d,f,p,l];c=t.normalize(c,t.create());f=d[0];p=d[0];for(l=1;l<d.length;l++){var h=t.dot(d[l],c);h<t.dot(f,c)&&(f=d[l]);h>t.dot(p,c)&&(p=d[l])}c=[f,p];d=c[0];c=c[1];a.M=t.scale(t.add(d,c,t.create()),.5,t.create());a.Wa=t.length(t.subtract(c,d,t.create()))/2};a.iw=function(a,b){t.add(a.M,a.Fa,A);t.add(A,a.Ea,A);t.add(A,a.Ga,A);b.push(A[0],A[1],A[2]);t.add(a.M,a.Fa,A);t.add(A,a.Ea,A);t.subtract(A,a.Ga,A);b.push(A[0],A[1],A[2]);t.add(a.M,a.Fa,A);t.subtract(A,a.Ea,A);t.add(A,a.Ga,A);b.push(A[0],
A[1],A[2]);t.add(a.M,a.Fa,A);t.subtract(A,a.Ea,A);t.subtract(A,a.Ga,A);b.push(A[0],A[1],A[2]);t.subtract(a.M,a.Fa,A);t.add(A,a.Ea,A);t.add(A,a.Ga,A);b.push(A[0],A[1],A[2]);t.subtract(a.M,a.Fa,A);t.add(A,a.Ea,A);t.subtract(A,a.Ga,A);b.push(A[0],A[1],A[2]);t.subtract(a.M,a.Fa,A);t.subtract(A,a.Ea,A);t.add(A,a.Ga,A);b.push(A[0],A[1],A[2]);t.subtract(a.M,a.Fa,A);t.subtract(A,a.Ea,A);t.subtract(A,a.Ga,A);b.push(A[0],A[1],A[2])};a.Ar=B;a.yK=function(a){var b=c();t.copy(a.Ea,b.Ea);t.copy(a.Fa,b.Fa);t.copy(a.Ga,
b.Ga);t.copy(a.M,b.M);return b};a.Lo=function(a){var b=x(),d;d=t.length(a.Ea);var c=t.length(a.Fa),f=t.length(a.Ga);d=d>c?d:c;b.M=a.M;b.Wa=f>d?f:d;return b};a.BJ=function(a,b){var d=h(a),c=f.ec(b,v);t.subtract(d.M,c,d.M);return d};a.Fs=function(a,b){var d=t.length(a.Ea),c=t.length(a.Fa),f=t.length(a.Ga);return.75*b.Wa*b.Wa*b.Wa>d*c*f};a.qA=function(a,b){var d=b.max_z,c=b.min_z;return{Wa:a,height:Math.max(0,d-c-2*a),M:new Float32Array([0,0,(d+c)/2])}};a.sA=function(a,b){var d=b.max_z,c=b.min_z;return{Wa:a,
height:Math.max(0,d-c),M:new Float32Array([0,0,(d+c)/2])}};a.rA=function(a,b){var d=b.max_z,c=b.min_z;return{Wa:a,height:Math.max(0,d-c),M:new Float32Array([0,0,(d+c)/2])}};a.rT=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.tP=function(a){for(var b=0,d=0,c=0,f=0,l=0,h=0,k,p,L,v,g,e,q=0,z=0,m=0;m<a.submeshes.length;m++){var n=a.submeshes[m];if(n.position.length){b=f=n.position[0];d=l=n.position[1];c=h=n.position[2];
break}}for(m=0;m<a.submeshes.length;m++){var n=a.submeshes[m],M=n.position;k=v=n.position[0];p=g=n.position[1];L=e=n.position[2];for(var t=0;t<M.length/3;t++){var w=M[3*t],u=M[3*t+1],I=M[3*t+2],b=Math.max(w,b),d=Math.max(u,d),c=Math.max(I,c),f=Math.min(w,f),l=Math.min(u,l),h=Math.min(I,h);k=Math.max(w,k);p=Math.max(u,p);L=Math.max(I,L);v=Math.min(w,v);g=Math.min(u,g);e=Math.min(I,e);q=Math.max(Math.sqrt(w*w+u*u+I*I),q);z=Math.max(Math.sqrt(w*w+u*u),z)}M=n.boundings.bb;M.max_x=k;M.min_x=v;M.max_y=
p;M.min_y=g;M.max_z=L;M.min_z=e;M=J;M[0]=v;M[1]=g;M[2]=e;M[3]=k;M[4]=g;M[5]=e;M[6]=k;M[7]=p;M[8]=e;M[9]=v;M[10]=p;M[11]=e;M[12]=v;M[13]=g;M[14]=L;M[15]=k;M[16]=g;M[17]=L;M[18]=k;M[19]=p;M[20]=L;M[21]=v;M[22]=p;M[23]=L;k=B(M,!1);n.boundings.be_cen=k.M;n.boundings.be_ax=[k.Ea[0],k.Fa[1],k.Ga[2]]}m=a.b4w_boundings.bb;m.max_x=b;m.min_x=f;m.max_y=d;m.min_y=l;m.max_z=c;m.min_z=h;m=a.b4w_boundings.bb_src;m.max_x=b;m.min_x=f;m.max_y=d;m.min_y=l;m.max_z=c;m.min_z=h;a.b4w_boundings.bs_rad=q;a.b4w_boundings.bc_rad=
z;M=J;M[0]=f;M[1]=l;M[2]=h;M[3]=b;M[4]=l;M[5]=h;M[6]=b;M[7]=d;M[8]=h;M[9]=f;M[10]=d;M[11]=h;M[12]=f;M[13]=l;M[14]=c;M[15]=b;M[16]=l;M[17]=c;M[18]=b;M[19]=d;M[20]=c;M[21]=f;M[22]=d;M[23]=c;k=B(M,!1);a.b4w_boundings.be_cen=k.M;a.b4w_boundings.be_ax=[k.Ea[0],k.Fa[1],k.Ga[2]]};a.hN=function(a){var b=a.subarray(0,3),d=a.subarray(6,9),c=a.subarray(12,15),f=a.subarray(18,21);a=t.subtract(d,b,A);t.normalize(a,a);var l=F.rN(b,d,c,I),l=t.cross(l,a,l);t.normalize(l,l);var h=t.create(),p=t.create();t.subtract(d,
b,C);p[0]=t.dot(C,a);p[1]=t.dot(C,l);d=t.create();t.subtract(c,b,C);d[0]=t.dot(C,a);d[1]=t.dot(C,l);c=t.create();t.subtract(f,b,C);c[0]=t.dot(C,a);c[1]=t.dot(C,l);f=x();c=[h,p,d,c];h=k(f,c[0],c[1]);for(f=2;f<c.length;f++)if(t.distance(h.M,c[f])>h.Wa){for(var v=h,h=c,p=c[f],d=f-1,v=k(v,p,h[0]),L=1;L<=d;L++)if(t.distance(v.M,h[L])>v.Wa){for(var g=v,v=h,e=p,m=h[L],q=L-1,g=k(g,e,m),z=0;z<=q;z++)if(t.distance(g.M,v[z])>g.Wa){var n=e,w=m,M=v[z],u=t.subtract(w,M,C),u=t.squaredLength(u),aa=t.subtract(n,M,
C),B=t.squaredLength(aa),aa=t.subtract(n,w,C),E=t.squaredLength(aa),aa=u*(B+E-u),H=B*(E+u-B),u=E*(u+B-E),B=aa+H+u;t.copy(n,g.M);t.scale(g.M,aa/B,g.M);t.scaleAndAdd(g.M,w,H/B,g.M);t.scaleAndAdd(g.M,M,u/B,g.M);g.Wa=t.distance(g.M,n)}v=g}h=v}f=h;a=t.scale(a,f.M[0],C);t.scaleAndAdd(a,l,f.M[1],a);t.add(a,b,f.M);return f}};b4w.module.__compat=function(a,r){function d(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var g=r("__config"),n=r("__debug"),x=r("__extensions"),
e=r("__print"),u=r("__renderer"),w="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.Nz=256;var h=g.nk,m=g.H,B=g.Jk,k=g.context,f=g.pg,F=g.Y,t=g.J,q=g.rd;a.IL=function(a){a.getError()==a.INVALID_ENUM&&e.warn("Possible Tegra invalid enum issue detected, ignoring")};a.lE=function(E,J){function A(a){J&&e.warn(a)}f.EO=E.getParameter(E.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
f.jx=E.getParameter(E.MAX_FRAGMENT_UNIFORM_VECTORS);f.nx=E.getParameter(E.MAX_TEXTURE_IMAGE_UNITS);f.Vs=E.getParameter(E.MAX_VARYING_VECTORS);f.ox=E.getParameter(E.MAX_VERTEX_ATTRIBS);f.gD=E.getParameter(E.MAX_VERTEX_TEXTURE_IMAGE_UNITS);f.Ws=E.getParameter(E.MAX_VERTEX_UNIFORM_VECTORS);f.ri=E.getParameter(E.MAX_CUBE_MAP_TEXTURE_SIZE);f.kx=E.getParameter(E.MAX_RENDERBUFFER_SIZE);f.tc=E.getParameter(E.MAX_TEXTURE_SIZE);f.px=E.getParameter(E.MAX_VIEWPORT_DIMS);f.hh=24;m.Yb&&!B.enabled&&(m.Go=!0);m.Yb?
(m.uc=Math.min(m.uc,E.getParameter(E.MAX_SAMPLES)),d("Firefox")&&(A("Firefox and WebGL 2 detected, applying framebuffer hack."),m.OA=!0),d("Windows")&&d("Chrome")&&(A("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),m.uc=1)):m.uc=1;d("Firefox")&&"NONE"!==m.stereo&&(A("Firefox and Stereo rendering detected, disable texture reusage"),m.IB=!0);if(m.Yb&&n.aK()||d("Firefox"))A("Firefox detected, disabling multisample"),m.uc=1;b()&&(A("IE11 detected, use 16 bit depth."),
f.hh=16);u.gQ();var I=!!x.ZM();d("Firefox/28.0")&&(d("Linux")||d("Macintosh"))&&(A("Firefox 28 detected, applying depth hack"),I=!1);d("Windows Phone")||(d("iPad")||d("iPhone")?(A("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),k.alpha||(m.background_color[3]=1),m.aE=!0,m.Ds=!0,m.TF=!0,m.smaa=!1,m.ssao=!1,m.precision="highp",m.Pw=!0,x.iC()&&q.At&&(m.Ho="pvr")):
d("Mac OS X")&&d("Safari")&&!d("Chrome")&&(A("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),m.$D=!0,F.lA=!0,F.VA=!0));d("Windows")&&(d("Chrome/40")||d("Firefox/33")||d("Firefox/34")||d("Firefox/35")||d("Firefox/36"))&&(A("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),m.yv=!0);d("Chrome")&&!c()&&g.EC()&&(A('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
m.UA=!0);d("Mac OS X")&&(m.Ts=!0,A("OS X detected, applying shadows hack."));c()&&(A("Mobile detected, applying various hacks for video textures."),m.is_mobile_device=!0,d("iPad")||d("iPhone")||d("Windows Phone")||(A("Mobile (not iOS) detected, disable playback rate for video textures."),F.zB=!0));(d("Firefox/35.0")||d("Firefox/36.0"))&&d("Windows")&&(A("Windows/Firefox 35/36 detected, applying shadows slink hack"),m.AE=!0);if(d("iPhone")||b()||d("Edge"))A("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
m.bq=!0;10>f.Vs&&(A("Not enough varyings, disable shadows on blend objects"),m.Yv=!0);d("Windows Phone")&&(A("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),m.debug_view=!1,m.precision="highp",m.ii=!1,m.ssao=!1,m.smaa=!1,m.shadows=!1,m.reflections=!1,m.refractions=!1,m.KD=!1);if(d("UCBrowser")||d("Chrome")&&d("Nexus")&&m.is_mobile_device)A("Mobile Nexus Chrome or UCBrowser detected, disable workers."),t.yn=!1;d("Firefox")&&d("Linux")&&
(A("Firefox and Linux detected, disable workers."),t.yn=!1);var C=x.get_renderer_info();if(C){var v=E.getParameter(C.UNMASKED_VENDOR_WEBGL),C=E.getParameter(C.UNMASKED_RENDERER_WEBGL),l=/\b4\d{2}\b/;-1<C.indexOf("AMD")&&d("Windows")&&d("Chrome")&&!b()&&!d("Edge")&&(A("AMD, Windows and Chrome detected, use 16 bit depth."),f.hh=16);-1<v.indexOf("ARM")&&l.test(C)&&(A("ARM Mali-400 series detected, applying depth and frames blending hacks"),I=!1,h.MB=!0);-1<v.indexOf("ARM")&&-1<C.indexOf("Mali-T604")&&
(A('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),m.precision="highp",m.shadows=!1);-1<v.indexOf("ARM")&&-1<C.indexOf("Mali-T760")&&(A('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),m.precision="highp",m.ssao=!1,m.Mt=!0,m.Yb&&(m.uc=1,A("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<v.indexOf("Qualcomm")&&-1<C.indexOf("Adreno")&&(A("Qualcomm Adreno detected, applying shader constants hack."),m.oy=!0,-1<C.indexOf("305")&&(A('Qualcomm Adreno305 detected, set "highp" precision.'),
m.precision="highp"),-1<C.indexOf("330")&&(A('Qualcomm Adreno330 detected, set "highp" precision.'),m.precision="highp"),-1<C.indexOf("420")&&(A("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),f.tc=4096,f.ri=4096));-1<v.indexOf("NVIDIA")&&-1<C.indexOf("Tegra 3")&&(A("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),m.KB=!0);d("Windows")&&d("Chrome")&&!d("Edge")&&(C.match(/NVIDIA GeForce 8..0/)||C.match(/NVIDIA GeForce 9..0/)||
C.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(A("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),f.ri=a.Nz,m.ay=!0);-1<C.indexOf("PowerVR")&&(A("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),m.ay=!0,m.Mt=!0,m.shadows=!1);v="";for(l=0;l<w.length;l++)if(-1<C.indexOf(w[l])){v=w[l];break}v&&(A("Architecture "+v+" detected. Blending between frames and shadows on blend objects will be disabled."),
m.Mt=!0,m.Yv=!0)}0==f.gD&&(A("Vertex textures are not allowed. Disabling vertex textures"),m.br=!1);I||(m.sm=!1,m.yc=!1,m.water_dynamic=!1,m.shore_smoothing=!1,m.an=!1,m.smaa=!1);m.GF=!!x.jC()||"pvr"==m.Ho;m.Lr=I;if(E.getShaderPrecisionFormat)var z=E.getShaderPrecisionFormat(E.FRAGMENT_SHADER,E.HIGH_FLOAT);E.getShaderPrecisionFormat&&0!==z.precision||(m.precision="mediump");if(b()&&d("Touch")||d("Edge"))A("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),
m.Uk=!0;if(b()||d("Edge"))m.yC=!0;c()&&d("Firefox")&&(e.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),m.rx=!0,f.tc=4096,f.ri=4096);16==f.hh&&(m.xB=!0)};a.wv=d;a.detect_mobile=c;a.ZI=function(){d("Firefox/35.0")&&d("Windows")&&(e.warn("Windows/Firefox 35 detected, forcing context's alpha"),g.context.alpha=!0)};a.is_ie11=b};b4w.module.__constraints=function(a,r){function d(a){var b={};b.type=a;return b}function c(a,d){a.cc&&a.cc.Ca&&b(a.cc.Ca,a);if(d.Ca){var c=d.Ca;-1==c.ve.indexOf(a)?c.ve.push(a):f.D("Descendant object override is forbidden")}a.cc=d}function b(a,b){var d=a.ve.indexOf(b);-1!=d?a.ve.splice(d,1):f.D("No descendant object")}function g(a,b,d){switch(b.type){case 1:var c=k.get_quat_view(a.o.v),p=b.Ca.o.v;d=k.get_quat_view(b.Ca.o.v);b.Fd?(B.copy(b.Fd,c),B.multiply(d,c,c)):B.copy(d,c);var g=k.transform_vec3(b.offset,
p,E);k.set_trans(g,a.o.v);g=k.get_scale(b.Ca.o.v);k.set_scale(b.Yp*g,a.o.v);break;case 9:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);p=b.Ca.o.v;d=k.get_quat_view(b.Ca.o.v);B.multiply(B.invert(b.sl,b.sl),c,c);B.multiply(d,c,c);k.transform_vec3(b.offset,p,g);B.copy(d,b.sl);break;case 10:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);p=b.Ca.o.v;d=k.get_quat_view(b.Ca.o.v);B.multiply(B.invert(b.sl,b.sl),c,c);B.multiply(d,c,c);k.transform_vec3(b.offset,p,g);B.copy(d,b.sl);g=k.get_quat_view(a.o.v);
c=k.get_quat_view(b.Ca.o.v);c=B.multiply(c,b.Fd,C);c=w.qw(c,t);g=w.qw(g,q);w.dy(a,f.xk(g[0],c[0]+b.fK,c[0]+b.eK),f.xk(g[1],c[1]+b.dK,c[1]+b.gK));break;case 13:var g=k.get_trans_view(a.o.v),c=k.get_quat_view(a.o.v),p=b.Ca.o.v,D=k.get_trans_view(p),y=b.PQ,m=E,L=C;k.transform_vec3(b.offset,p,m);f.smooth_v(m,g,d,y,g);p=E;F.sub(D,g,p);F.normalize(p,p);var n=c,g=v,D=g.subarray(0,3),m=g.subarray(3,6),I=g.subarray(6,9);F.copy(p,I);F.negate(I,I);F.normalize(I,I);.999999<Math.abs(F.dot(p,f.AXIS_Z))?(p=h.fromQuat(B.normalize(n,
L),l),F.copy(p.subarray(0,3),D)):F.cross(f.AXIS_Z,I,D);F.normalize(D,D);F.cross(I,D,m);F.normalize(m,m);B.fromMat3(g,L);B.normalize(L,L);f.JE(L,c,d,.16*y,c);break;case 2:c=k.get_quat_view(a.o.v);d=z;u.get_bone_tsr(b.Ca,b.vk,!0,!1,d);k.multiply(b.Ca.o.v,d,d);c[0]=d[4];c[1]=d[5];c[2]=d[6];c[3]=d[7];b.Fd&&(B.copy(b.Fd,c),B.multiply(c,b.Fd,c));k.set_scale(b.Yp*d[3],a.o.v);g=k.get_trans_view(a.o.v);k.transform_vec3(b.offset,d,g);break;case 3:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);d=k.get_trans_view(b.Ca.o.v);
x(g,c,d);break;case 4:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);d=b.target;x(g,c,d);break;case 5:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);d=k.get_trans_view(b.Ca.o.v);x(g,c,d);c=F.dist(g,d);if(c=c>b.dist_max?c-b.dist_max:c<b.Uo?c-b.Uo:0)F.sub(d,g,E),F.normalize(E,E),F.scale(E,c,E),F.add(g,E,g);break;case 6:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);d=b.target;x(g,c,d);c=F.dist(g,d);if(c=c>b.dist_max?c-b.dist_max:c<b.Uo?c-b.Uo:0)F.sub(d,g,E),F.normalize(E,E),F.scale(E,c,
E),F.add(g,E,g);break;case 7:p=b.Ca.o.v;g=k.get_trans_view(a.o.v);k.transform_vec3(b.offset,p,g);break;case 8:D=k.get_trans_view(b.Ca.o.v);g=k.get_trans_view(a.o.v);F.add(D,b.offset,g);break;case 14:c=k.get_quat_view(a.o.v);p=b.Ca.o.v;d=k.get_quat_view(b.Ca.o.v);b.Fd?(B.copy(b.Fd,c),B.multiply(d,c,c)):B.copy(d,c);g=k.get_trans_view(a.o.v);k.transform_vec3(b.offset,p,g);break;case 11:k.multiply(b.Ca.o.v,b.hu,a.o.v);break;case 12:g=b.hu;d=z;u.get_bone_tsr(b.Ca,b.vk,!0,!1,d);k.multiply(b.Ca.o.v,d,d);
k.multiply(d,g,a.o.v);break;case 15:c=b.Ca,d=w.bN(c),g=k.get_trans_view(a.o.v),p=w.gs(d,"LEFT"),D=w.gs(d,"RIGHT"),y=w.gs(d,"TOP"),L=w.gs(d,"BOTTOM"),m="heights"==b.hor_units?y-L:D-p,g[0]=b.WC?p+m*b.ax:D-m*b.ax,p="heights"==b.vert_units?y-L:D-p,g[1]=b.lF?y-p*b.Ny:L+p*b.Ny,w.TN(d)?g[2]=-b.distance:(g[2]=-1,F.normalize(g,g),F.scale(g,b.distance/Math.abs(g[2]),g)),k.transform_dir_vec3(g,c.o.v,g),d=k.get_trans_view(c.o.v),F.add(d,g,g),g=k.get_quat_view(a.o.v),c=k.get_quat_view(c.o.v),b.Fd?(B.copy(b.Fd,
g),B.multiply(c,g,g)):B.copy(c,g)}"CAMERA"==a.o.type&&a.o.kb!=w.MS_STATIC&&(g=a.o.sf,10==b.type&&(d=k.get_quat_view(b.Ca.o.v),g=F.transformQuat(g,d,H)),w.az(a),e(a,g))}function n(a,b){switch(b.type){case 1:var d=b.target.o.v,c=z;k.invert(a.o.v,c);k.multiply(c,d,c);u.set_bone_tsr(a,b.vk,c,!1)}a.Ax=!0}function x(a,b,d){var c=E;f.quat_to_dir(b,f.AXIS_MZ,c);F.normalize(c,c);var l=J;F.subtract(d,a,l);F.normalize(l,l);a=f.hy(c,l,I);B.multiply(a,b,b);B.normalize(b,b)}function e(a,b,d){var c=a.o,l=k.get_quat_view(c.v),
h=f.quat_to_dir(l,f.AXIS_Z,E);F.normalize(h,h);if(.999999<Math.abs(F.dot(b,h)))h=B.identity(C);else{var g=F.cross(b,h,J);F.normalize(g,g);c.kb==w.MS_TARGET_CONTROLS?c.Yj&&F.negate(g,g):(c=f.quat_to_dir(l,f.AXIS_MY,A),0<F.dot(c,b)&&F.negate(g,g));c=f.quat_to_dir(l,f.AXIS_X,A);F.normalize(c,c);var v=f.clamp(F.dot(c,g),-1,1),h=-.999999>=v?B.setAxisAngle(h,Math.acos(v),C):B.rotationTo(c,g,C);B.normalize(h,h)}B.multiply(h,l,l);d&&(d=f.quat_to_dir(l,f.AXIS_Y,E),0>F.dot(b,d)&&B.rotateZ(l,Math.PI,l));w.az(a)}
var u=r("__armature"),w=r("__camera"),h=r("__mat3"),m=r("__print"),B=r("__quat"),k=r("__tsr"),f=r("__util"),F=r("__vec3");a.MS=1;a.LS=2;a.QS=3;a.RS=4;a.GS=5;a.HS=6;a.NS=7;a.FS=8;a.KS=9;a.JS=10;a.DS=11;a.ES=12;a.IS=13;a.OS=14;a.PS=15;a.CS=1;var t=new Float32Array(2),q=new Float32Array(2),E=new Float32Array(3),J=new Float32Array(3),A=new Float32Array(3),I=new Float32Array(4),C=new Float32Array(4),v=new Float32Array(9),l=new Float32Array(9),z=k.create(),H=new Float32Array(3);a.eA=function(a,b,f,l,h){var k=
d(1);k.Ca=b;k.offset=new Float32Array(f);k.Fd=l?new Float32Array(l):null;k.Yp=h;c(a,k);g(a,k,0)};a.RI=function(a,b,f,l,h,k){var D=d(2);D.Ca=b;D.vk=f;D.offset=new Float32Array(l);D.Fd=h?new Float32Array(h):null;D.Yp=k;c(a,D);g(a,D,0)};a.OI=function(a,b,f,l){var h=d(9),v=k.get_quat_view(a.o.v),D=k.get_quat_view(b.o.v);h.Ca=b;h.offset=new Float32Array(f);h.sl=new Float32Array(D);l&&(B.copy(l,v),B.multiply(D,v,v));c(a,h);g(a,h,0)};a.NI=function(a,b,l,h,v,e,D,m){var p=d(10),L=k.get_quat_view(a.o.v),y=
k.get_quat_view(b.o.v);p.Ca=b;p.offset=new Float32Array(l);p.sl=new Float32Array(y);p.eK=f.angle_wrap_0_2pi(v);p.fK=f.angle_wrap_0_2pi(e);p.gK=f.angle_wrap_periodic(D,-Math.PI,Math.PI);p.dK=f.angle_wrap_periodic(m,-Math.PI,Math.PI);h?(p.Fd=new Float32Array(h),B.copy(h,L),B.multiply(y,L,L)):p.Fd=B.create();c(a,p);g(a,p,0)};a.MI=function(a,b,f,l){var h=d(13);h.Ca=b;h.offset=new Float32Array(f);h.PQ=l;c(a,h);g(a,h,0)};a.UI=function(a,b,f,l){var h=d(14);h.Ca=b;h.offset=new Float32Array(f);h.Yp=1;h.Fd=
l?new Float32Array(l):null;c(a,h);g(a,h,0)};a.MU=b;a.VI=function(a,b){var f=d(3);f.Ca=b;c(a,f);g(a,f,0)};a.WI=function(a,b){var f=d(4);f.target=new Float32Array(b);c(a,f);g(a,f,0)};a.II=function(a,b,f,l){var h=d(5);h.Ca=b;h.Uo=f;h.dist_max=l;c(a,h);g(a,h,0)};a.JI=function(a,b,f,l){var h=d(6);h.target=new Float32Array(b);h.Uo=f;h.dist_max=l;c(a,h);g(a,h,0)};a.TI=function(a,b,f){var h=d(7);h.Ca=b;h.offset=new Float32Array(f);c(a,h);g(a,h,0)};a.FI=function(a,b,f){var h=d(8);h.Ca=b;h.offset=new Float32Array(f);
c(a,h);g(a,h,0)};a.DI=function(a,b,f){var h=d(11);h.Ca=b;h.hu=new Float32Array(f);c(a,h);g(a,h,0)};a.EI=function(a,b,f,h){var l=d(12);l.Ca=b;l.vk=f;l.hu=new Float32Array(h);c(a,l);g(a,l,0)};a.append_stiff_viewport=function(a,b,h){var l=d(15);l.Ca=b;if(f.Lf(h.left))l.WC=!0,l.ax=h.left;else if(f.Lf(h.right))l.WC=!1,l.ax=h.right;else{m.error("append_stiff_viewport: Wrong positioning params");return}if(f.Lf(h.top))l.lF=!0,l.Ny=h.top;else if(f.Lf(h.bottom))l.lF=!1,l.Ny=h.bottom;else{m.error("append_stiff_viewport: Wrong positioning params");
return}f.Lf(h.distance)?(l.distance=h.distance,f.Lf(h.rotation)?l.Fd=new Float32Array(h.rotation):l.Fd=null,f.Lf(h.hor_units)?l.hor_units=h.hor_units:l.hor_units="widths",f.Lf(h.vert_units)?l.vert_units=h.vert_units:l.vert_units="heights",c(a,l),g(a,l,0)):m.error("append_stiff_viewport: Wrong positioning params")};a.IR=function(a,b){a.cc&&g(a,a.cc,b)};a.SI=function(a,b,c,f,h){var l=d(1);l.vk=c;l.target=b;l.offset=new Float32Array(f);l.Fd=h?new Float32Array(h):null;l.Yp=1;b=l.target;c=l.vk;f=a.o.zf[c];
h=b.Ev;for(var k=0;k<h;k++){var g=h[k];if(g[0]==a&&g[1]==c){h.splice(k,1);break}}b.Ev.push([a,c]);f.cc=l;n(a,l)};a.DR=function(a,b){var d=a.o.zf[b];d.cc&&n(a,d.cc)};a.QP=x;a.correct_up=e;a.VJ=function(a){return a.cc?!0:!1};a.remove=function(a){a.cc.Ca&&b(a.cc.Ca,a);a.cc=null};a.hU=function(a){return a.cc?a.cc.type:null};a.Hf=function(a){a=a.cc;return!a||11!=a.type&&12!=a.type?!1:!0};a.fs=function(a){if((a=a.cc)&&11==a.type)return a.Ca.o.v;if(a&&12==a.type){var b=z;u.get_bone_tsr(a.Ca,a.vk,!0,!1,b);
k.multiply(a.Ca.o.v,b,b);return b}return null};a.Gf=function(a){a=a.cc;return!a||11!=a.type&&12!=a.type?null:a.hu}};b4w.module.__container=function(a,r){var d,c,b;function g(){C.getBoundingClientRect()}function n(a,b,d,c){J.Uk?(c[0]=a,c[1]=b):(z.clientX=a,z.clientY=b,a=new MouseEvent("b4w_convert",z),d.dispatchEvent(a),c[0]=a.offsetX,c[1]=a.offsetY);return c}function x(){return J.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function e(a,b,d,c){a.style.width=d+"px";a.style.height=c+"px";b&&(b.style.width=d+"px",b.style.height=c+"px")}function u(b,d,c){if(!b||!d){b=a.Hu;d=a.Gu;var h=l;h.style.width=a.Hu+"px";h.style.height=
a.Gu+"px"}var h=C,g=v;c&&e(h,g,b,d);g&&(g.width=b,g.height=d,B.tq());c=Math.floor(b*J.canvas_resolution_factor);d=Math.floor(d*J.canvas_resolution_factor);x()&&(c*=window.devicePixelRatio,d*=window.devicePixelRatio);if(g=f.oh())g=g.F,c=Math.floor(c*g.Xm),d=Math.floor(d*g.Xm);h.width=c;h.height=d;var g=Math.min(I.drawingBufferWidth,A.kx,A.px[0]),z=Math.min(I.drawingBufferHeight,A.kx,A.px[1]);if(c>g||d>z)k.warn("Canvas size exceeds platform limits, downscaling"),g=Math.min(g/c,z/d),c*=g,d*=g,h.width=
c,h.height=d;f.sE(c,d,c/b);f.xa()&&q.L(f.get_active().Vi);m.MR(h.width,h.height);m.is_primary_loaded()&&(w.update(),f.update(t.get_timeline(),0),w.EF())}var w=r("__anchors"),h=r("__config"),m=r("__data"),B=r("__hud"),k=r("__print"),f=r("__scenes"),F=r("__subscene"),t=r("__time"),q=r("__transform"),E=r("__util"),J=h.H,A=h.pg,I=null,C=null,v=null,l=null,z={clientX:0,clientY:0};c=d=0;b=1;a.Hu=320;a.Gu=240;a.mf=function(a){I=a};a.get_canvas=function(){return C};a.get_canvas_hud=function(){return v};a.get_container=
function(){return l};a.init=function(a,b){a&&a.parentNode?(C=a,v=b,l=a.parentNode):E.D("canvas container is not available")};a.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":l.insertBefore(a,l.firstElementChild);break;case "JUST_BEFORE_CANVAS":l.insertBefore(a,C);break;case "JUST_AFTER_CANVAS":C.nextElementSibling?l.insertBefore(a,C.nextElementSibling):l.appendChild(a,C);break;case "LAST":l.appendChild(a,C);break;default:k.error(b+" invalid stack order")}};a.oC=function(){return d};
a.nC=function(){return c};a.set_canvas_offsets=function(){};a.update_canvas_offsets=g;a.GQ=function(a,f,h){d=a;c=f;b=h;g()};a.force_offsets_updating=function(){};a.client_to_canvas_coords=function(a,b,d){return n(a,b,C,d)};a.client_to_element_coords=n;a.po=function(a,c,f,h){f||(f=new Float32Array(2));f[0]=a*b;f[1]=c*b;h&&(a=h.width/d,f[0]*=a,f[1]*=a);return f};a.rS=function(a,c,f,h){f||(f=new Float32Array(2));f[0]=a/b;f[1]=c/b;h&&(a=h.width/d,f[0]/=a,f[1]/=a)};a.FC=function(b){return b&&b.parentNode?
b.parentNode==l?!0:a.FC(b.parentNode):!1};a.PN=x;a.pM=function(a){var b=document.getElementsByTagName("script");a=E.zh(a);for(var d=0;d<b.length;d++)if(b[d].src==a)return b[d];return null};a.resize=u;a.resize_to_container=function(a){var b=l,d=C,c=b.clientWidth,b=b.clientHeight;if(a||c!=d.clientWidth||b!=d.clientHeight){a=d.width;d=d.height;e(C,v,c,b);if(f.xa()){var h=f.get_active();if((h=f.Aa(h,F.uf))&&h.enable_hmd_stereo){u(a,d,!1);return}}u(c,b,!1)}};a.reset=function(){l=v=C=I=null}};b4w.module.__controls=function(a,r){function d(a,b){b||(b=B.get_container());return{type:a,value:0,$:null,element:b,Ia:!1,key:0,Tb:"",ah:!1,Cv:null,Bv:function(){},Av:null,ZA:function(){},Fh:null,from:new Float32Array(3),to:new Float32Array(3),CC:!1,As:!1,Tp:0,OD:function(){},axis:"",rf:0,rn:new Float32Array(3),Bt:new Float32Array(4),threshold:0,LD:new Float32Array(4),gr:0,fr:0,ZD:0,hr:0,kf:0,repeat:!1,DB:!1,gamepad_id:0,callback:function(){}}}function c(a){function b(){return{dj:new Float32Array(2),
cl:!0,obj:null,identifier:-1,Ks:!0}}a||(a=B.get_container());for(var d=0;d<Q.length;d++){var c=Q[d];if(a==c.element)return c}c={element:a,tp:!0,fe:0,Ls:!0,at:0,bt:0,ll:0,ml:0,Np:0,Op:0,Rg:new Float32Array(2),Sd:new Float32Array(2),Sg:new Float32Array(2),je:new Float32Array(2),fu:0,Vy:0,mF:0,ze:new Uint8Array(256),zu:0,Fw:null,xh:b(),Fl:Array(10),Vw:!1,rC:q.create(),rs:0,qs:0,ps:0,Iw:0,Hw:0,os:Infinity,Gx:null,Fx:null,wx:null,sx:null,ux:null,Ty:null,Sy:null,vx:null,tx:null,Ox:null,AU:null,Uy:null,
Ry:null,Qy:null,yi:{}};for(d=0;10>d;++d)c.Fl[d]=b();c.Gx=function(a){c.Vw||(k.AN(a,c.rC),c.Vw=!0)};c.Fx=function(a){a=I.copy(a,S);c.ps=a[0];c.qs=a[1];c.rs=a[2];Infinity==c.os&&(c.os=a[0],c.Hw=a[1],c.Iw=a[2])};c.wx=function(a){c.zu+=a*C.LO};c.sx=function(a){var b=k.get_device_by_type_element(k.DEVICE_MOUSE,c.element),b=k.get_vector_param(b,k.MOUSE_LOCATION,y);c.at=b[0];c.bt=b[1];c.ll=b[0];c.ml=b[1];if(3==c.fe||0==c.fe)c.fe=1;c.which=a};c.ux=function(){var a=k.get_device_by_type_element(k.DEVICE_MOUSE,
c.element),a=k.get_vector_param(a,k.MOUSE_LOCATION,y),a=B.client_to_canvas_coords(a[0],a[1],y);c.xh.cl=!1;c.xh.dj[0]=a[0];c.xh.dj[1]=a[1]};c.Ty=function(a){for(var b=0;b<a.length;++b){for(var d=a[b],f=null,h=null,l=0;l<c.Fl.length;l++){var g=c.Fl[l];if(g.identifier==d.identifier){g.Ks&&(h=g);break}else!f&&g.Ks&&(f=g,f.identifier=d.identifier)}if(d=h||f)f=B.client_to_canvas_coords(a[b].clientX,a[b].clientY,y),d.cl=!1,d.Ks=!1,d.dj[0]=f[0],d.dj[1]=f[1]}};c.Sy=function(a){for(var b=0;b<c.Fl.length;++b){for(var d=
c.Fl[b],f=!1,h=0;h<a.length;++h)if(a[h].identifier==d.identifier){f=!0;break}f||(d.cl=!0,d.Ks=!0,d.obj=null)}};c.vx=function(a){var b=k.get_device_by_type_element(k.DEVICE_MOUSE,c.element),b=k.get_vector_param(b,k.MOUSE_LOCATION,y);c.at=b[0];c.bt=b[1];c.ll=b[0];c.ml=b[1];0<c.fe&&(c.fe=3);c.which=a};c.tx=function(a){if(!v.Uk||c.fe)c.ll=a[0],c.ml=a[1]};c.Ox=function(a){if(!v.Uk||c.fe)c.Np+=a[0],c.Op+=a[1]};c.PC=function(a){2!=c.ze[a]&&(c.ze[a]=1,c.tp=!1)};c.RC=function(){for(var a=0;a<c.ze.length;a++)0!=
c.ze[a]&&(c.ze[a]=3,c.tp=!1)};c.SC=function(a){c.tp=!1;c.ze[a]=3};c.Uy=function(a){c.Ls=!1;if(1==a.length)c.Rg[0]=a[0].clientX,c.Rg[1]=-1,c.Sg[0]=a[0].clientY,c.Sg[1]=-1;else if(1<a.length){c.fu=c.Vy=w(a);c.Rg[0]=a[0].clientX;c.Rg[1]=a[1].clientX;c.Sg[0]=a[0].clientY;c.Sg[1]=a[1].clientY;var b=a[0];a=a[1];c.mF=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}c.Sd.set(c.Rg);c.je.set(c.Sg)};c.Ry=function(a){1===a.length?(c.Sd[0]=a[0].clientX,c.Sd[1]=-1,c.je[0]=a[0].clientY,c.je[1]=-1):1<a.length&&
(c.Sd[0]=a[0].clientX,c.Sd[1]=a[1].clientX,c.je[0]=a[0].clientY,c.je[1]=a[1].clientY,c.fu=w(a))};c.Qy=function(a){0==a.length&&(c.Ls=!0)};Q.push(c);return c}function b(a,b){if(b in a.yi&&0<a.yi[b])a.yi[b]+=1;else switch(a.yi[b]=1,b){case "orientation_quat":var c=k.get_device_by_type_element(k.DEVICE_GYRO);c&&k.attach_param_cb(c,k.GYRO_ORIENTATION_ANGLES,a.Gx);break;case "orientation_angles":(c=k.get_device_by_type_element(k.DEVICE_GYRO))&&k.attach_param_cb(c,k.GYRO_ORIENTATION_ANGLES,a.Fx);break;
case "mouse_wheel":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_WHEEL,a.wx);break;case "mouse_down_which":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_DOWN_WHICH,a.sx);break;case "mouse_select":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_DOWN_WHICH,a.ux);break;case "touch_select":if(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))k.attach_param_cb(c,k.TOUCH_START,
a.Ty),k.attach_param_cb(c,k.TOUCH_END,a.Sy);break;case "mouse_up_which":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_UP_WHICH,a.vx);break;case "mouse_location":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_LOCATION,a.tx);break;case "mouse_pointerlock":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.Gz,a.Ox);break;case "keyboard_downed_keys":if(c=k.get_device_by_type_element(k.DEVICE_KEYBOARD,
a.element))k.attach_param_cb(c,k.KEYBOARD_DOWN,a.PC),k.attach_param_cb(c,k.Fz,a.RC),k.attach_param_cb(c,k.KEYBOARD_UP,a.SC);break;case "touch_start":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.attach_param_cb(c,k.TOUCH_START,a.Uy);break;case "touch_move":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.attach_param_cb(c,k.TOUCH_MOVE,a.Ry);break;case "touch_end":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.attach_param_cb(c,k.TOUCH_END,a.Qy)}}function g(a,
b){if(b in a.yi&&0<a.yi[b]&&(--a.yi[b],!a.yi[b]))switch(b){case "orientation_quat":var c=k.get_device_by_type_element(k.DEVICE_GYRO);c&&k.detach_param_cb(c,k.GYRO_ORIENTATION_QUAT,a.Gx);break;case "orientation_angles":(c=k.get_device_by_type_element(k.DEVICE_GYRO))&&k.detach_param_cb(c,k.GYRO_ORIENTATION_ANGLES,a.Fx);break;case "mouse_wheel":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.MOUSE_WHEEL,a.wx);break;case "mouse_down_which":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,
a.element))&&k.detach_param_cb(c,k.MOUSE_DOWN_WHICH,a.sx);break;case "mouse_select":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.MOUSE_DOWN_WHICH,a.ux);break;case "touch_select":if(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))k.detach_param_cb(c,k.TOUCH_START,a.Ty),k.detach_param_cb(c,k.TOUCH_END,a.Sy);break;case "mouse_up_which":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.MOUSE_UP_WHICH,a.vx);break;case "mouse_location":(c=
k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.MOUSE_LOCATION,a.tx);break;case "mouse_pointerlock":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.Gz,a.Ox);break;case "keyboard_downed_keys":if(c=k.get_device_by_type_element(k.DEVICE_KEYBOARD,a.element))k.detach_param_cb(c,k.KEYBOARD_DOWN,a.PC),k.detach_param_cb(c,k.Fz,a.RC),k.detach_param_cb(c,k.KEYBOARD_UP,a.SC);break;case "touch_start":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,
a.element))&&k.detach_param_cb(c,k.TOUCH_START,a.Uy);break;case "touch_move":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.detach_param_cb(c,k.TOUCH_MOVE,a.Ry);break;case "touch_end":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.detach_param_cb(c,k.TOUCH_END,a.Qy)}}function n(a,b){a.value=Number(b)}function x(a){for(var b=a.Ai,c=a.YP,d=0;d<b.length;d++)c[d]=b[d].value;return a.yO(c)}function e(a,b){a=a||z;var c=a.Og;if(c){var d=a.zl;if(b){var f=c[b];if(f){for(var h=
f.Ai,g=0;g<h.length;g++){var k=h[g],v;v=H.indexOf(k);v=-1<v?p[v]:[];1==v.length?(u(k),k=H.indexOf(k),-1<k?(H.splice(k,1),p.splice(k,1)):A.D("Sensors cache is corrupted")):1<v.length&&v.splice(v.indexOf(f),1)}delete c[b];g=d.indexOf(f);-1<g?d.splice(g,1):A.D("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=l.indexOf(a),-1<c?l.splice(c,1):F.error("Wrong object"))}}else{d=[];for(g in c)d.push(g);for(g=0;g<d.length;g++)e(a,d[g])}D=!0}}function u(a){switch(a.type){case 90:t.remove_collision_test(a.Cv,
a.Tb,a.Bv);a.Ia=!0;break;case 100:t.clear_collision_impulse_test(a.Av);a.Ia=!0;break;case 110:t.remove_ray_test(a.Tp);a.Ia=!0;break;case 140:a.Ia=!0;break;case 20:var b=c(a.element);g(b,"keyboard_downed_keys");a.Ia=!0;break;case 30:b=c(a.element);g(b,"mouse_wheel");a.Ia=!0;break;case 40:b=c(a.element);g(b,"mouse_down_which");g(b,"mouse_up_which");g(b,"mouse_location");a.Ia=!0;break;case 260:b=c(a.element);g(b,"mouse_pointerlock");a.Ia=!0;break;case 50:b=c(a.element);g(b,"mouse_down_which");g(b,"mouse_up_which");
a.Ia=!0;break;case 60:b=c(a.element);g(b,"touch_start");g(b,"touch_move");g(b,"touch_end");a.Ia=!0;break;case 70:b=c(a.element);g(b,"touch_start");g(b,"touch_move");a.Ia=!0;break;case 75:b=c(a.element);g(b,"touch_start");g(b,"touch_move");a.Ia=!0;break;case 80:b=c(a.element);g(b,"touch_start");g(b,"touch_end");a.Ia=!0;break;case 170:b=c(a.element);g(b,"mouse_select");g(b,"touch_select");g(b,"touch_start");g(b,"touch_end");g(b,"mouse_down_which");g(b,"mouse_up_which");a.Ia=!0;break;case 180:case 190:b=
c(a.element);g(b,"orientation_angles");a.Ia=!0;break;case 200:b=c(a.element);g(b,"orientation_quat");a.Ia=!0;break;case 210:case 220:a.Ia=!0}}function w(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function h(a){return 0==a?k.get_device_by_type_element(k.Mq):1==a?k.get_device_by_type_element(k.Iu):2==a?k.get_device_by_type_element(k.Ju):k.get_device_by_type_element(k.Ku)}var m=r("__config"),B=r("__container"),k=r("__input"),f=r("__objects"),F=r("__print"),
t=r("__physics"),q=r("__quat"),E=r("__time"),J=r("__tsr"),A=r("__util"),I=r("__vec3"),C=m.controls,v=m.H,l=[],z={},H=[],p=[],Q=[],y=new Float32Array(2),Z=new Float32Array(2),S=I.create(),G=q.create(),D=!1,X=0;a.CT_POSITIVE=10;a.CT_CONTINUOUS=20;a.CT_TRIGGER=30;a.CT_SHOT=40;a.CT_LEVEL=50;a.CT_CHANGE=60;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.PL_MULTITOUCH_MOVE_ROTATE=3;var V=1;a.update=function(b,d){for(var g=0;g<Q.length;g++){var e=Q[g];e.xh.cl||(e.xh.obj=
f.pick_object(e.xh.dj[0],e.xh.dj[1]),e.xh.cl=!0,e.Fw=e.xh.obj);for(var m=0;10>m;++m){var L=e.Fl[m];L.cl||(L.obj=f.pick_object(L.dj[0],L.dj[1]),L.cl=!0,e.Fw=L.obj)}}for(g=0;g<H.length;g++)if(e=H[g],L=b,m=d)switch(e.type){case 120:var p=e.Fh,t=J.ec(p.o.v,S),p=J.Qc(p.o.v,G),M=I.dist(e.rn,t),w=e.LD;q.invert(e.Bt,w);q.multiply(p,w,w);q.normalize(w,w);w=Math.abs(2*Math.acos(w[3]));M/=m;e.gr=A.smooth(M,e.gr,m,.3);e.$[0]=M;M=w/m;e.fr=A.smooth(M,e.fr,m,.3);e.$[1]=M;e.gr>=e.threshold||e.fr>=e.ZD?n(e,1):n(e,
0);I.copy(t,e.rn);q.copy(p,e.Bt);e.rf=L;break;case 130:p=e.Fh;t=J.ec(p.o.v,S);p=Math.abs(t[1]-e.rn[1])/m;e.hr=A.smooth(p,e.hr,m,.3);e.$=p;e.hr>=e.threshold?n(e,1):n(e,0);I.copy(t,e.rn);e.rf=L;break;case 140:!e.Ia&&0<=e.kf&&L-e.rf>=e.kf&&(n(e,1),e.repeat?e.rf=L:e.kf=-e.kf);break;case 150:e.rf||(e.rf=L);n(e,L-e.rf);e.rf=L;break;case 160:n(e,L);break;case 180:L=c(e.element);e.$[0]=L.rs-L.Iw;e.$[1]=L.qs-L.Hw;e.$[2]=L.ps-L.os;break;case 190:L=c(e.element);e.$[0]=L.rs;e.$[1]=L.qs;e.$[2]=L.ps;break;case 200:L=
c(e.element);q.copy(L.rC,e.$);break;case 210:m=k.get_device_by_type_element(k.DEVICE_HMD);k.get_vector_param(m,k.HMD_ORIENTATION_QUAT,e.$);break;case 220:m=k.get_device_by_type_element(k.DEVICE_HMD);k.get_vector_param(m,k.HMD_POSITION,e.$);break;case 240:m=h(e.gamepad_id);e.value=k.jN(m,e.key);break;case 250:m=h(e.gamepad_id);e.value=k.iN(m,e.key);break;case 230:n(e,e.callback());break;case 30:L=c(e.element);n(e,L.zu);break;case 40:L=c(e.element);if(!v.Uk||1==L.fe||2==L.fe)switch(t=L.ll-L.at,p=L.ml-
L.bt,e.$.coords[0]=L.ll,e.$.coords[1]=L.ml,e.axis){case "X":n(e,t);break;case "Y":n(e,p);break;case "XY":m=Math.sqrt(t*t+p*p),n(e,m)}break;case 260:L=c(e.element);v.Uk||(t=L.Np,p=L.Op,M=A.smooth(t,0,m,.1*V),m=A.smooth(p,0,m,.1*V),.01<Math.abs(t)||.01<Math.abs(p)?(L.Np-=M,L.Op-=m,e.$.coords[0]=M,e.$.coords[1]=m):(e.$.coords[0]=0,e.$.coords[1]=0),n(e,Math.sqrt(t*t+p*p)));break;case 50:L=c(e.element);n(e,0<L.fe|0);e.$.which=L.which;e.$.coords[0]=L.ll;e.$.coords[1]=L.ml;break;case 170:L=c(e.element);
n(e,0);if(e.DB)L.Fw==e.Fh&&n(e,1);else if(L.fe&&L.xh.obj==e.Fh)n(e,1);else if(!L.Ls)for(m=0;10>m;++m)if(L.Fl[m].obj==e.Fh){n(e,1);break}break;case 20:L=c(e.element);e.$=L.ze[e.key];1==e.$||L.ze[0]&&16==e.key?n(e,1):e.$||n(e,0);break;case 60:L=c(e.element);if(-1==L.Sd[1]&&-1==L.je[1]){t=L.Sd[0]-L.Rg[0];p=L.je[0]-L.Sg[0];m=Math.sqrt(t*t+p*p);if(-1!=L.Rg[1]&&-1!=L.Sg[1]){var M=L.Sd[0]-L.Rg[1],w=L.je[0]-L.Sg[1],u=Math.sqrt(M*M+w*w);u<m&&(t=M,p=w,m=u)}e.$.es=a.PL_SINGLE_TOUCH_MOVE}else m=y,m[0]=(L.Sd[0]+
L.Sd[1])/2,m[1]=(L.je[0]+L.je[1])/2,p=Z,p[0]=(L.Rg[0]+L.Rg[1])/2,p[1]=(L.Sg[0]+L.Sg[1])/2,t=m[0]-p[0],p=m[1]-p[1],m=Math.sqrt(t*t+p*p),e.$.es=a.PL_MULTITOUCH_MOVE_PAN;e.$.coords[0]=L.Sd[0];e.$.coords[1]=L.je[0];switch(e.axis){case "X":n(e,t);break;case "Y":n(e,p);break;case "XY":n(e,m)}break;case 70:L=c(e.element);m=L.fu-L.Vy;e.$=a.PL_MULTITOUCH_MOVE_ZOOM;n(e,m);break;case 75:L=c(e.element);-1!=L.Sd[1]&&(m=Math.atan2(L.je[0]-L.je[1],L.Sd[0]-L.Sd[1]),e.$=a.PL_MULTITOUCH_MOVE_ROTATE,n(e,m-L.mF));break;
case 80:L=c(e.element),e.$.coords[0]=L.Sd[0],e.$.coords[1]=L.je[0],L.Ls?n(e,0):n(e,1)}for(g=0;g<l.length;g++)for(L=l[g],e=L.zl,m=0;m<e.length;m++)if(t=e[m],t.ak!=X){t.ak=X;w=t;p=0;switch(w.type){case a.CT_POSITIVE:p=(M=x(w))?1:0;break;case a.CT_CONTINUOUS:p=w.oi;(M=x(w))?(p=1,w.oi=1):1==p?(p=-1,w.oi=-1):p=0;break;case a.CT_TRIGGER:p=w.oi;(M=x(w))&&-1==p?(p=1,w.oi=1):M||1!=p?p=0:(p=-1,w.oi=-1);break;case a.CT_SHOT:p=w.oi;(M=x(w))&&-1==p?(p=1,w.oi=1):M||1!=p?p=0:(p=0,w.oi=-1);break;case a.CT_LEVEL:M=
x(w);w.UC!=M?(p=1,w.UC=M):p=0;break;case a.CT_CHANGE:M=w.Ai;w=w.bO;for(u=0;u<M.length;u++){var B=M[u].value;p||B==w[u]||(p=1);w[u]=B}break;default:A.D("Wrong sensor manifold type: "+w.type)}if(p&&(M=L==z?null:L,D=!1,t.callback(M,t.id,p,t.JJ),D)){g=-1;break}}for(g=0;g<l.length;g++)for(L=l[g],e=L.zl,m=0;m<e.length;m++)for(t=e[m],L=t.Ai,t=0;t<L.length;t++)switch(p=L[t],p.type){case 30:n(p,0);break;case 40:n(p,0);break;case 60:n(p,0);break;case 70:n(p,0);break;case 75:n(p,0);break;case 80:n(p,0);break;
case 140:n(p,0)}for(g=0;g<Q.length;g++){e=Q[g];if(!e.tp){for(m=0;m<e.ze.length;m++)1==e.ze[m]?e.ze[m]=2:3==e.ze[m]&&(e.ze[m]=0);e.tp=!0}1==e.fe?e.fe=2:3==e.fe&&(e.fe=0);e.zu=0;e.at=e.ll;e.bt=e.ml;e.ze[0]=0;e.Rg.set(e.Sd);e.Sg.set(e.je);e.Vy=e.fu;e.Iw=e.rs;e.Hw=e.qs;e.os=e.ps;e.Vw=!1}X++};a.create_custom_sensor=function(a){var b=d(10);n(b,a);return b};a.create_keyboard_sensor=function(a){var b=d(20,document);b.key=a;b.Ia=!0;return b};a.create_gamepad_btn_sensor=function(a,b){var c=d(240,document);
b=b||k.dC();c.gamepad_id=b;c.key=a;c.Ia=!0;return c};a.create_gamepad_axis_sensor=function(a,b){var c=d(250,document);b=void 0==b?k.dC():b;c.gamepad_id=b;c.key=a;c.Ia=!0;return c};a.create_collision_sensor=function(a,b,c){if(!a||!t.ka(a))return F.error("Wrong collision object"),null;var f=d(90);f.Cv=a;f.Tb=b;f.ah=c;f.$={pK:null,qK:c?new Float32Array(3):null,dh:c?new Float32Array(3):null,bm:0};f.Bv=function(a,b,c,d,h){n(f,a);a=f.$;a.pK=b;f.ah&&(a.qK.set(c),a.dh.set(d),a.bm=h)};f.Ia=!0;return f};a.create_collision_impulse_sensor=
function(a){if(!a||!a.J)return F.error("Wrong collision impulse object"),null;var b=d(100);b.Av=a;b.ZA=function(a){n(b,a)};b.Ia=!0;return b};a.create_ray_sensor=function(a,b,c,f,h,l,g){var e=d(110);e.Fh=a;e.from=b;e.to=c;e.Tb=f;e.CC=h;e.ah=l;e.As=g;e.$={If:0,UO:null,li:0,sh:new Float32Array(3),ki:new Float32Array(3),Tp:0};e.OD=function(a,b,c,d,f,h){e.CC?n(e,-1==b?0:1):n(e,b);e.$.If=b;e.$.UO=c;e.$.li=d;e.ah&&(e.$.sh.set(f),e.$.ki.set(h))};e.Ia=!0;return e};a.create_mouse_click_sensor=function(a){a=
d(50,a);a.Ia=!0;a.$={coords:new Float32Array(2),which:null};return a};a.create_mouse_wheel_sensor=function(a){a=d(30,a);a.Ia=!0;return a};a.create_mouse_move_sensor=function(a,b){var c=d(40,b);c.axis=a||"XY";c.$={coords:new Float32Array(2)};c.Ia=!0;return c};a.create_touch_move_sensor=function(a,b){var c=d(60,b);c.axis=a||"XY";c.$={coords:new Float32Array(2),es:0};c.Ia=!0;return c};a.create_touch_zoom_sensor=function(a){a=d(70,a);a.$=0;a.Ia=!0;return a};a.create_touch_rotate_sensor=function(a){a=
d(75,a);a.$=0;a.Ia=!0;return a};a.create_touch_click_sensor=function(a){a=d(80,a);a.$={coords:new Float32Array(2)};a.Ia=!0;return a};a.create_motion_sensor=function(a,b,c){if(!a)return F.error("Wrong collision object"),null;var f=d(120);f.Fh=a;var h=J.get_trans_view(a.o.v);a=J.get_quat_view(a.o.v);f.LD=new Float32Array(4);f.rn=new Float32Array(h);f.Bt=new Float32Array(a);f.gr=0;f.fr=0;f.threshold=b||.1;f.ZD=c||.1;f.rf=0;f.$=new Float32Array([0,0]);return f};a.create_vertical_velocity_sensor=function(a,
b){if(!a)return F.error("Wrong collision object"),null;var c=d(130);c.Fh=a;var f=J.get_trans_view(a.o.v),h=J.get_quat_view(a.o.v);c.rn=new Float32Array(f);c.Bt=new Float32Array(h);c.hr=0;c.threshold=b||1;c.rf=0;c.$=0;return c};a.create_timer_sensor=function(a,b){var c=d(140);c.kf=a;c.repeat=b;c.Ia=!0;return c};a.reset_timer_sensor=function(a,b,c,d){a=a||z;a=a.Og;if(!a||!a[b])return F.error("reset_timer_sensor(): wrong object"),null;b=a[b].Ai[c];if(!b)return F.error("reset_timer_sensor(): sensor not found"),
null;b.rf=E.get_timeline();b.kf=d};a.create_elapsed_sensor=function(){var a=d(150);a.rf=0;return a};a.create_gyro_delta_sensor=function(){var a=d(180,window);a.$=new Float32Array(3);k.get_device_by_type_element(k.DEVICE_GYRO)?n(a,1):n(a,0);a.Ia=!0;return a};a.create_gyro_angles_sensor=function(){var a=d(190,window);a.$=new Float32Array(3);k.get_device_by_type_element(k.DEVICE_GYRO)?n(a,1):n(a,0);a.Ia=!0;return a};a.create_gyro_quat_sensor=function(){var a=d(200,window);a.$=q.create();k.get_device_by_type_element(k.DEVICE_GYRO)?
n(a,1):n(a,0);a.Ia=!0;return a};a.create_hmd_quat_sensor=function(){var a=d(210,window);a.$=q.create();k.get_device_by_type_element(k.DEVICE_HMD)?n(a,1):n(a,0);a.Ia=!0;return a};a.create_hmd_position_sensor=function(){var a=d(220,window);a.$=I.create();k.get_device_by_type_element(k.DEVICE_HMD)?n(a,1):n(a,0);a.Ia=!0;return a};a.create_timeline_sensor=function(){return d(160)};a.create_selection_sensor=function(a,b){var c=d(170);c.Fh=a;c.DB=b;c.Ia=!0;return c};a.create_callback_sensor=function(a,b){var c=
d(230);c.callback=a;n(c,b);return c};a.create_plock_mouse_sensor=function(a){a=d(260,a);a.$={coords:new Float32Array(2)};a.Ia=!0;return a};a.create_plock_sensor=function(a){a=d(270,a);a.Ia=!0;return a};a.XP=n;a.get_sensor_value=function(a,b,c){a=a||z;a=a.Og;if(!a||!a[b])return F.error("get_sensor_value(): wrong object"),null;b=a[b].Ai[c];return b?b.value:(F.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,c){a=a||z;a=a.Og;if(!a||!a[b])return F.error("get_sensor_payload(): wrong object"),
null;b=a[b].Ai[c];return b?b.$:(F.error("get_sensor_payload(): sensor not found"),null)};a.cleanup=function(){l=[];z={};for(var a=0;a<H.length;a++)u(H[a]);H.length=0;p.length=0};a.check_sensor_manifold=function(a,b){a=a||z;if(!a.Og)return!1;if(b&&a.Og[b])return!0;if(!b)for(var c in a.Og)return!0;return!1};a.create_sensor_manifold=function(a,d,f,h,g,v,m){a=a||z;a.zl=a.zl||[];a.Og=a.Og||{};var q=a.Og,M=a.zl;q[d]&&e(a,d);f={id:d,type:f,Ai:h.slice(0),yO:g,YP:Array(h.length),callback:v,JJ:m,oi:-1,UC:0,
bO:Array(h.length),ak:-1};q[d]=f;M.push(f);-1==l.indexOf(a)&&l.push(a);for(a=0;a<f.Ai.length;a++){q=d=f.Ai[a];if(q.Ia){switch(q.type){case 90:t.append_collision_test(q.Cv,q.Tb,q.Bv,q.ah);break;case 100:t.apply_collision_impulse_test(q.Av,q.ZA);break;case 110:q.Tp=t.append_ray_test(q.Fh,q.from,q.to,q.Tb,q.OD,!1,!1,q.ah,q.As);q.$.Tp=q.Tp;break;case 140:q.rf=E.get_timeline();0>q.kf&&(q.kf=-q.kf);break;case 20:M=c(q.element);b(M,"keyboard_downed_keys");break;case 30:M=c(q.element);b(M,"mouse_wheel");
break;case 40:M=c(q.element);b(M,"mouse_down_which");b(M,"mouse_up_which");b(M,"mouse_location");break;case 260:M=c(q.element);b(M,"mouse_pointerlock");break;case 270:k.xI(q);break;case 50:M=c(q.element);b(M,"mouse_down_which");b(M,"mouse_up_which");break;case 60:M=c(q.element);b(M,"touch_start");b(M,"touch_move");b(M,"touch_end");break;case 70:M=c(q.element);b(M,"touch_start");b(M,"touch_move");break;case 75:M=c(q.element);b(M,"touch_start");b(M,"touch_move");break;case 80:M=c(q.element);b(M,"touch_start");
b(M,"touch_end");break;case 170:M=c(q.element);b(M,"mouse_select");b(M,"touch_select");b(M,"touch_start");b(M,"touch_end");b(M,"mouse_down_which");b(M,"mouse_up_which");break;case 180:case 190:M=c(q.element);b(M,"orientation_angles");break;case 200:M=c(q.element);b(M,"orientation_quat");break;case 240:0==q.gamepad_id?k.get_device_by_type_element(k.Mq):1==q.gamepad_id?k.get_device_by_type_element(k.Iu):2==q.gamepad_id?k.get_device_by_type_element(k.Ju):k.get_device_by_type_element(k.Ku)}q.Ia=!1}q=
H.indexOf(d);-1==q?(H.push(d),p.push([f])):p[q].push(f)}D=!0};a.default_AND_logic_fun=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.default_OR_logic_fun=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.remove_sensor_manifold=e;a.reset=function(){for(var a=0;a<l.length;a++){var b=l[a],c=b.Og,b=b.zl,d;for(d in c)delete c[d];b.length=0}for(a=0;a<H.length;a++)u(H[a]);l.length=0;H.length=0;p.length=0};a.debug=function(){F.log(String(l.length)+
" objects with manifolds",l);F.log(String(H.length)+" sensors",H);for(var a=[],b=[],c=0;c<H.length;c++){var d=H[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}F.log(String(a.length)+" collision sensors",a);F.log(String(b.length)+" ray sensors",b)};a.set_plock_smooth_factor=function(a){V=a}};b4w.module.__curve=function(a,r){function d(a,b,c,d,e){var h=d.length;e||(e=new Float32Array(h));for(var f=h+a,g=new Float32Array(f),m=1;m<=f-1;m++)g[m-1]=b>=c[m-1]&&b<c[m+1-1]?1:0;for(var q=2;q<=a;q++)for(m=1;m<=f-q;m++)g[m-1]=(g[m-1]?(b-c[m-1])*g[m-1]/(c[m+q-1-1]-c[m-1]):0)+(g[m+1-1]?(c[m+q-1]-b)*g[m+1-1]/(c[m+q-1]-c[m+1-1]):0);b==c[f-1]&&(g[h-1]=1);a=0;for(m=1;m<=h;m++)a+=g[m-1]*d[m-1];for(m=1;m<=h;m++)e[m-1]=a?g[m-1]*d[m-1]/a:0;return e}function c(a){a=a.Os;return a[a.length-1]}function b(a){a=
a.pB;return a[a.length-1]}function g(a,b,c,d,e,k,f,F){var h=a+(b-a)/2,m=n(h,d,e,k,f)-c;F=F?F:.01;return Math.abs(m)<F?h:0<m?g(a,h,c,d,e,k,f,F):g(h,b,c,d,e,k,f,F)}function n(a,b,c,d,e){var h=1-a;return b*h*h*h+3*c*h*h*a+3*d*h*a*a+e*a*a*a}var x=r("__util"),e=r("__vec3");a.WK=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var e=a.order_u;b.order=e;a=a.points;var g=a.length/5,k=[],f=g+e,g=g+2;k[0]=0;for(var n=2;n<=f;n++)k[n-1]=n>e&&n<g?k[n-2]+1:k[n-
2];b.Os=k;"2D"==c.dimensions?b.uj=!1:"3D"==c.dimensions?b.uj=!0:x.D("Wrong curve dimensions");e=[];k=[];for(c=0;c<a.length;c+=5)e.push(a[c]),e.push(a[c+1]),e.push(a[c+2]),b.uj&&e.push(a[c+3]),k.push(a[c+4]);b.Hv=e;b.nz=k;a=[];for(var c=b.Hv,e=b.uj?4:3,k=b.nz,f=b.Os,g=b.order,n=c.length/e,t=n+g,q=0,u=f[t-1]/999,J=0;1E3>J;J++){5E-6>f[t-1]-q&&(q=f[t-1]);for(var A=d(g,q,f,k),I=0;I<e;I++)for(var C=a[e*J+I]=0;C<n;C++)a[e*J+I]+=A[C]*c[e*C+I];q+=u}e=b.uj?4:3;k=new Float32Array(1E3);k[0]=0;for(c=1;1E3>c;c+=
1)f=a[(c-1)*e],g=a[(c-1)*e+1],n=a[(c-1)*e+2],t=a[c*e],q=a[c*e+1],u=a[c*e+2],k[c]=k[c-1]+Math.sqrt((t-f)*(t-f)+(q-g)*(q-g)+(u-n)*(u-n));b.pB=k;return b};a.aR=function(a,b,h){h||(h=[]);b=Math.min(b,c(a));var e=a.Hv,g=a.uj?4:3,k=a.nz,f=a.Os,n=a.order;a=e.length/g;var t=a+n;5E-6>f[t-1]-b&&(b=f[t-1]);t=new Float32Array(a);d(n,b,f,k,t);for(b=0;b<g;b++)for(k=h[b]=0;k<a;k++)h[b]+=t[k]*e[g*k+b]};a.YQ=function(a,b,c){c||(c=[]);var d=a.Hv,h=a.uj?4:3,e=a.nz,f=a.Os,g=a.order;a=d.length/h;var n=a+g;5E-6>f[n-1]-
b&&(b=f[n-1]);var n=new Float32Array(a),q=b;b=n;var w=e.length;b||(b=new Float32Array(w));var u=new Float32Array(w),x=new Float32Array(w),I=u,C=x;I||(I=new Float32Array(w));C||(C=new Float32Array(w));for(var v=w+g,l=new Float32Array(v),z=new Float32Array(v),H=1;H<=v-1;H++)l[H-1]=q>=f[H-1]&&q<f[H+1-1]?1:0;q==f[v-1]&&(l[w-1]=1);for(var p=2;p<=g;p++)for(H=1;H<=v-p;H++){var Q=l[H-1]?l[H-1]/(f[H+p-1-1]-f[H-1]):0,y=l[H+1-1]?-l[H+1-1]/(f[H+p-1]-f[H+1-1]):0,r=z[H-1]?(q-f[H-1])*z[H-1]/(f[H+p-1-1]-f[H-1]):
0,S=z[H+1-1]?(f[H+p-1]-q)*z[H+1-1]/(f[H+p-1]-f[H+1-1]):0;l[H-1]=(l[H-1]?(q-f[H-1])*l[H-1]/(f[H+p-1-1]-f[H-1]):0)+(l[H+1-1]?(f[H+p-1]-q)*l[H+1-1]/(f[H+p-1]-f[H+1-1]):0);z[H-1]=Q+y+r+S}for(H=1;H<=w;H++)I[H-1]=l[H-1],C[H-1]=z[H-1];f=0;for(g=1;g<=w;g++)f+=u[g-1]*e[g-1];q=0;for(g=1;g<=w;g++)q+=x[g-1]*e[g-1];for(g=1;g<=w;g++)b[g-1]=f?x[g-1]*e[g-1]/f+u[g-1]*e[g-1]*q/(f*f):0;for(e=0;e<h;e++)for(f=c[e]=0;f<a;f++)c[e]+=n[f]*d[h*f+e]};a.ZU=c;a.$Q=b;a.ZQ=function(a,d){if(0>=d)return 0;var h=c(a);if(d>=b(a))return h;
var e=a.pB,g=x.kr(e,d,0,e.length-1);return h*(g+(d-e[g])/(e[g+1]-e[g]))/1E3};a.Ps=function(a,b,c,d,e){return c+(e-d)*(a-c)/(b-d)};a.YC=function(a,b,c){var d=b[0];b=b[1];c=(c[1]-b)/(c[0]-d);return c*a+(b-c*d)};a.tA=function(a,b,c,d,e,k){return n(g(0,1,a,b[0],c[0],d[0],e[0],k),b[1],c[1],d[1],e[1])};a.rv=function(a,b,c,d,g){var h=new Float32Array(3),f=new Float32Array(3),m=new Float32Array(3),n=new Float32Array(3),q=new Float32Array(3),w=new Float32Array(3);e.copy(a[1],f);null==b?(e.copy(c[1],m),h[0]=
2*f[0]-m[0],h[1]=2*f[1]-m[1]):e.copy(b[1],h);null==c?(e.copy(b[1],h),m[0]=2*f[0]-h[0],m[1]=2*f[1]-h[1]):e.copy(c[1],m);e.subtract(f,h,n);e.subtract(m,f,q);b=e.length(n);c=e.length(q);0==b&&(b=1);0==c&&(c=1);if("AUTO"==d||"AUTO"==g)if(w[0]=q[0]/c+n[0]/b,w[1]=q[1]/c+n[1]/b,h=2.5614*e.length(w))"AUTO"==d&&e.scaleAndAdd(f,w,-(b/h),a[0]),"AUTO"==g&&e.scaleAndAdd(f,w,c/h,a[2]);"VECTOR"==d&&e.scaleAndAdd(f,n,-1/3,a[0]);"VECTOR"==g&&e.scaleAndAdd(f,q,1/3,a[2])};a.tK=function(a,b,c,d){var e=[],g=[],f,h,m;
e[0]=a[0]-b[0];e[1]=a[1]-b[1];g[0]=d[0]-c[0];g[1]=d[1]-c[1];m=d[0]-a[0];f=Math.abs(e[0]);h=Math.abs(g[0]);f+h&&f+h>m&&(f=m/(f+h),b[0]=a[0]-f*e[0],b[1]=a[1]-f*e[1],c[0]=d[0]-f*g[0],c[1]=d[1]-f*g[1])}};b4w.module.__debug=function(a,r){function d(a,b,d){var f=[],e;for(e in a)1<A.hi(a[e])&&f.push([e,a[e]]);f.sort(function(a,b){var c=A.hi(a[1]),d=A.hi(b[1]);return d!=c?d-c:a<b?-1:b<a?1:0});if(f.length){F.groupCollapsed(b+" "+d);F.dd("Property different variants (>1) | Property name");for(a=0;a<f.length;a++)F.groupCollapsed(A.hi(f[a][1]),f[a][0]),c(f[a][1]);F.groupEnd()}}function c(a){F.dd("Batches count for this property value | Property value");var b=[],c;for(c in a)b.push([c,a[c]]);b.sort(function(a,
b){return b[1]!=a[1]?b[1]-a[1]:a[0]<b[0]?-1:b[0]<a[0]?1:0});for(a=0;a<b.length;a++)F.dd(b[a][1],b[a][0]);F.groupEnd()}function b(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function g(){var a=B.tw();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function n(){var b=Q;return b&&b.debug_view_mode==a.DV_RENDER_TIME}function x(a,b,c){var d=B.tw(),f=0;if(d)for(c&&d.endQuery(),c=0;c<a.length;c++){var e=a[c],g=d.XB(e),h=v.getParameter(d.WB());
g&&!h&&(f=d.YB(e)/1E6,b&&(f=A.smooth(f,b,1,10)),a.splice(c,1),c--)}else f=performance.now()-a.pop(),b&&(f=A.smooth(f,b,1,10));return f}function e(a,b){u(a)||A.D("Structure assertion failed: invalid first object value");u(b)||A.D("Structure assertion failed: invalid second object value");w(a,b)||A.D("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||A.Uw(a)||a instanceof Array)){for(var c in a)u(a[c])||A.D("Structure assertion failed: invalid value for key in the first object: "+
c),c in b||A.D("Structure assertion failed: missing key in the first object: "+c);for(c in b)u(b[c])||A.D("Structure assertion failed: invalid value for key in the second object: "+c),c in a||A.D("Structure assertion failed: missing key in the second object: "+c),w(a[c],b[c])||A.D("Structure assertion failed: incompatible types for key "+c)}}function u(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function w(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==
typeof a){var c=a instanceof Array,d=b instanceof Array;if(c&&!d||!c&&d)return!1;c=A.Uw(a);d=A.Uw(b);if(c&&!d||!c&&d)return!1}return!0}var h=r("__compat"),m=r("__config"),B=r("__extensions"),k=r("__graph"),f=r("__objects"),F=r("__print"),t=r("__scenes"),q=r("__subscene"),E=r("__textures"),J=r("__time"),A=r("__util"),I=m.H,C={},v=null,l={},z=[],H=-1,p=-1,Q=null,y=null,Z=!1,S={};a.DV_NONE=0;a.DV_OPAQUE_WIREFRAME=1;a.DV_TRANSPARENT_WIREFRAME=2;a.DV_FRONT_BACK_VIEW=3;a.DV_BOUNDINGS=4;a.DV_CLUSTERS_VIEW=
5;a.DV_BATCHES_VIEW=6;a.DV_RENDER_TIME=7;a.mf=function(a){for(var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c=0;c<b.length;c++){var d=b[c];d in a&&(C[a[d]]=d)}v=a};a.dQ=function(a){Q=a};a.$T=function(){return Q};a.lM=function(a,b,c,d,f){S[a]||(S[a]={HQ:b,se:{}});c in S[a].se||(S[a].se[c]=d);f&&(S[a].se[c]=0)};a.calc_vbo_garbage_byte_size=function(){var a=0,b;for(b in S)for(var c in S[b].se)a+=S[b].se[c];return a};a.show_vbo_garbage_info=
function(){var a={},b;for(b in S)for(var c in S[b].se){var d=S[b].se[c];if(d){var f=S[b].HQ;f in a||(a[f]={Py:0,se:{}});c in a[f].se||(a[f].se[c]=0);a[f].se[c]+=d;a[f].Py+=d}}for(f in a){F.groupCollapsed(f,a[f].Py);for(c in a[f].se)F.dd(c,a[f].se[c]);F.groupEnd()}};a.print_batches_stat=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),c=0,e=0,g=f.Ib(t.oh(),"MESH",
f.DATA_ID_ALL),h=0;h<g.length;h++)for(var l=0;l<g[h].K.length;l++)for(var k=0;k<g[h].K[l].R.length;k++){var v=A.bh(g[h].K[l].R[k]),m=v.ab.bg+"/"+v.ab.Ae;v["shaders_info.directives"]=v.ab.ei;v["shaders_info.node_elements"]=v.ab.Rf;delete v.ab;for(var q=0;q<b.length;q++)delete v[b[q]];if(g[h].is_dynamic)e++;else{c++;v.type in a||(a[v.type]={});m in a[v.type]||(a[v.type][m]={});for(var p in v)p in a[v.type][m]||(a[v.type][m][p]={}),q=JSON.stringify(v[p]),q in a[v.type][m][p]||(a[v.type][m][p][q]=0),
a[v.type][m][p][q]++}}F.group("Batches statistics:");F.dd("STATIC/DYNAMIC count:",c+"/"+e);F.group("STATIC batches diversity:");for(var n in a)for(m in a[n])d(a[n][m],n,m);F.groupEnd();F.groupEnd()};a.vv=function(a){if(I.gl_debug){var b=v.getError();b!=v.NO_ERROR&&(b in C?A.D("GL Error: "+b+", gl."+C[b]+" ("+a+")"):A.D("Unknown GL error: "+b+" ("+a+")"))}};a.SJ=function(){if(I.gl_debug||I.OA)switch(v.checkFramebufferStatus(v.FRAMEBUFFER)){case v.FRAMEBUFFER_COMPLETE:break;case v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:F.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:F.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:F.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case v.FRAMEBUFFER_UNSUPPORTED:F.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case v.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:F.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:F.error("FRAMEBUFFER CHECK FAILED")}};
a.WJ=function(){if(-1!=H)return H;v.bindFramebuffer(v.FRAMEBUFFER,v.createFramebuffer());var a=E.Gk(E.ik,!1);E.resize(a,1,1);v.framebufferTexture2D(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,a.qb,a.Cb,0);v.checkFramebufferStatus(v.FRAMEBUFFER)!=v.FRAMEBUFFER_COMPLETE?(H=!0,F.warn("depth-only issue was found")):H=!1;v.bindFramebuffer(v.FRAMEBUFFER,null);return H};a.aK=function(){if(1==I.uc)return!1;if(-1!=p)return p;v.bindRenderbuffer(v.RENDERBUFFER,v.createRenderbuffer());v.renderbufferStorageMultisample(v.RENDERBUFFER,
I.uc,v.RGBA8,1,1);var a=v.getRenderbufferParameter(v.RENDERBUFFER,v.RENDERBUFFER_SAMPLES);a!=I.uc?(p=!0,F.warn("multisample issue was found: requested "+I.uc+", got "+a),v.getError()==v.INVALID_OPERATION&&F.warn("the error from multisample issue detected, ignoring")):p=!1;v.bindRenderbuffer(v.RENDERBUFFER,null);return p};a.YJ=function(){return h.wv("Firefox")&&v.getError()==v.OUT_OF_MEMORY?(F.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.UD=function(a,c,d){I.gl_debug&&(d=b(d),F.error("shader compilation failed:\n"+
d+"\n"+v.getShaderInfoLog(a)+" ("+c+")"))};a.HP=function(a,c,d,f){I.gl_debug&&(d=b(d),f=b(f),F.error("shader linking failed:\n"+d+"\n\n\n"+f+"\n"+v.getProgramInfoLog(a)+" ("+c+")"))};a.Xx=function(a){if(I.show_hud_debug_info||a.type==q.On)a.$v||a.Ik.push(g())};a.CP=function(a){"MAIN"==a.type&&n()&&a.Ik.push(g())};a.Yx=function(a){if((I.show_hud_debug_info||a.type==q.On)&&!a.$v){var b=x(a.Ik,a.Xe,!0);b&&(a.Xe=b)}};a.DP=function(a){if("MAIN"==a.type&&n()){var b=x(a.Ik,a.Xe,!0);b&&(a.Xe=b)}};a.IC=n;
a.qP=function(a){var b=x(a.Ik,a.Xe,!1);b&&(a.Xe=b)};a.JT=function(a){l[a]=a in l?l[a]+1:1};a.update=function(){for(var a in l)F.log(a,l[a]),l[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(A.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}z.push(a)};a.msg=function(){for(var a=1,b=0;b<z.length;b++){var c=z[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],A.is_vector(a))for(var d=
0;d<a.length;d++)c.push(a[d]);else c.push(arguments[b]);z.push(c)};var G=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),f=0;f<z.length;f++){var e=z[f];a=e[0];if(!(a<d)){var g=String(e[1]);c[g]||(c[g]=G[b++%G.length]);a=["%c"+(a/1E3).toFixed(6),c[g],g];for(g=2;g<e.length;g++)a.push(e[g]);F.log.apply(this,a)}}z.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b=
{},c=Math.max(0,performance.now()-1E3*a),d=0;d<z.length;d++){var f=z[d];a=f[0];if(!(a<c))for(var e=2;e<f.length;e++){var g=String(f[1]);3<f.length&&(g+="_"+String(e-2));b[g]||(b[g]=g+"\n");b[g]+=String(a)+" "+f[e]+"\n"}}a="";for(g in b)a+=b[g]+"\n\n";F.log(a);z.splice(0)};a.sT=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&
b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(A.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return!!a.length}return isFinite(a)?!0:!1};a.iT=function(a,b){a.constructor!=b&&A.D("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.jT=e;a.kT=function(a){Z?
e(a,y):Z=!0;y=null!=a&&"object"==typeof a?A.zo(a):a};a.fake_load=function(a,b,c,d,f){(a=a||null)||A.D("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&A.D("Max percentage must be less than 100");0>c&&A.D("Min percentage must be greater than 0");c>d&&A.D("Max percentage must be greater than min percentage");var e=J.animate(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(J.clear_animation(e),f&&f())})};a.TO=function(a){return k.DL(a,function(a,b){var c=b.type+"("+b.name+")",d=b.inputs,
c=c+"\n\nINPUTS:";if(d.length)for(var f=0;f<d.length;f++)c+="\n"+d[f].identifier+": ",c=d[f].Ka?c+"linked":c+d[f].ya;else c+="\n---";d=b.outputs;c+="\n\nOUTPUTS:";if(d.length)for(f=0;f<d.length;f++)c+="\n"+d[f].identifier+": ",c=d[f].Ka?c+("linked(default "+d[f].ya+")"):c+"not used";else c+="\n---";f="";switch(b.type){case "GEOMETRY_UV":f="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":f="\ntexture: "+b.data.value.name+"\n("+b.data.value.ym+")"}""==f&&(f="\n---");return c+
"\n\nDATA:"+f},function(b,c,d){b=k.Ra(a,b);c=k.Ra(a,c);return b.outputs[d[0]].identifier+"\n==>\n"+c.inputs[d[1]].identifier})};a.hs=function(){return v};a.cleanup=function(){Q=null;S={}};a.reset=function(){v=null}};b4w.module.__extensions=function(a,r){function d(a){if(a in e)return e[a];var b=x.getExtension(a)||null;e[a]=b;g.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function c(a){if(a in e)return e[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=x;break;case "EXT_disjoint_timer_query":(b=x.getExtension("EXT_disjoint_timer_query")||null)||(b=x.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}e[a]=b;g.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=r("__config"),g=r("__print"),n=b.H,x=null,e={};a.mf=function(a){x=a};a.jC=function(){return d("WEBGL_compressed_texture_s3tc")||d("WEBKIT_WEBGL_compressed_texture_s3tc")};a.iC=function(){return d("WEBKIT_WEBGL_compressed_texture_pvrtc")||d("WEBGL_compressed_texture_pvrtc")};a.ZM=function(){return n.Yb?c("WEBGL_depth_texture"):d("WEBGL_depth_texture")||d("WEBKIT_WEBGL_depth_texture")};a.pw=function(){return d("EXT_texture_filter_anisotropic")||
d("WEBKIT_EXT_texture_filter_anisotropic")};a.YM=function(){return d("WEBGL_debug_shaders")};a.get_renderer_info=function(){return d("WEBGL_debug_renderer_info")};a.cC=function(){return n.Yb?c("OES_element_index_uint"):d("OES_element_index_uint")};a.Aw=function(){return n.Yb?c("OES_standard_derivatives"):d("OES_standard_derivatives")};a.tw=function(){var a=n.Yb?c("EXT_disjoint_timer_query"):d("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},
beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},XB:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},YB:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},WB:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return x.createQuery()},beginQuery:function(b){x.beginQuery(a.TIME_ELAPSED_EXT,b)},endQuery:function(){x.endQuery(a.TIME_ELAPSED_EXT)},XB:function(a){return x.getQueryParameter(a,
x.QUERY_RESULT_AVAILABLE)},YB:function(a){return x.getQueryParameter(a,x.QUERY_RESULT)},WB:function(){return a.GPU_DISJOINT_EXT}}};a.nN=function(){if(n.Yb)return c("ANGLE_instanced_arrays");var a=d("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,c,d,e,g){a.drawElementsInstancedANGLE(b,c,d,e,g)},vertexAttribDivisor:function(b,c){a.vertexAttribDivisorANGLE(b,c)},drawArraysInstanced:function(b,c,d,e){a.drawArraysInstancedANGLE(b,c,d,e)}}};a.Dw=function(){if(n.Yb)return c("OES_vertex_array_object");
var a=d("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.cleanup=function(){e={}};a.reset=function(){x=null}};b4w.module.__graph=function(a,r){function d(a,b,d){d||(d=null);c(a,b)?Q.D("Graph already has node with given ID"):a.V.push(b,d)}function c(a,b){for(var c=a.V,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,d,f){f||(f=null);c(a,b)&&c(a,d)?a.za.push(b,d,f):Q.D("Wrong node IDs")}function g(a,b){c(a,b)||Q.D("Node not found");for(var d=a.V,f=0;f<d.length;f+=2)d[f]==b&&(d.splice(f,2),f-=2)}function n(a,b,c,d){l(a,b,c)||Q.D("Edge not found");a=a.za;for(var f=0,e=0;e<a.length;e+=3)if(a[e]==
b&&a[e+1]==c){if(-1==d)a.splice(e,3);else{if(d==f){a.splice(e,3);break}f++}e-=3}}function x(a){a=a.V;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function e(a,b){for(var c=a.V,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function u(a){var b=[],c={};w(a,c);for(var d=a.V,f=0;f<d.length;f+=2)0==I(a,d[f])&&h(a,d[f],c,b);return{V:b,za:a.za.slice(0)}}function w(a,b){for(var c=a.V,d=0;d<c.length;d+=2)b[c[d]]=!1}function h(a,b,c,d){if(!c[b]){c[b]=!0;for(var f=0;f<A(a,b);f++)h(a,
C(a,b,f),c,d);d.unshift(b,J(a,b))}}function m(a,b,c,d){if(!c[b]){c[b]=!0;if(10==d||30==d)for(var f=0;f<A(a,b);f++){var e=C(a,b,f);m(a,e,c,d)}if(20==d||30==d)for(f=0;f<I(a,b);f++)e=v(a,b,f),m(a,e,c,d)}}function B(a){for(var b=a.za,d=0;d<b.length;d+=3){var f=b[d+1];c(a,b[d])&&c(a,f)||(b.splice(d,3),d-=3)}}function k(a){for(var b=[],c=a.V,d=0;d<c.length;d+=2){var f=c[d];A(a,f)||b.push(f)}return b}function f(a){var b=a.V;a=a.za;for(var c=[],d=[],f=[],e=0;e<b.length;e++)f[b[2*e]]=e,c.push(e,b[2*e+1]);
for(e=0;e<a.length;e+=3)d.push(f[a[e]],f[a[e+1]],a[e+2]);return{V:c,za:d}}function F(a,b,c){if(c.eh==c.Bj){for(var d=0,f=0;d<c.Bj;d++)-1!=c.ai[d]&&(a[f]=d,b[f]=c.ai[d],f++);return!0}if(c.Bj>c.Mm||c.Wj>c.Xj||c.on>c.qn||c.nn>c.pn)return!1;for(var f=d=-1,e=!1;!e&&t(c,y,d,f);)if(d=y[0],f=y[1],q(c,d,f)){var g;g=c;e={};e.hp=g.hp;e.ip=g.ip;e.Bx=g.Bx;e.Pr=g.Pr;e.Bj=g.Bj;e.Mm=g.Mm;e.order=g.order;e.eh=e.lt=g.eh;e.nn=g.nn;e.on=g.on;e.Wj=g.Wj;e.pn=g.pn;e.qn=g.qn;e.Xj=g.Xj;e.Tn=-1;e.ai=g.ai;e.Dk=g.Dk;e.Wk=g.Wk;
e.Xk=g.Xk;e.pl=g.pl;e.ql=g.ql;e.Kt=g.Kt;g.Kt[0]+=1;var e=g=e,h=d,l=f,k=e.hp,m=e.ip,p=e.Bj,n=e.Mm,z=e.ai,M=e.Dk,w=e.Wk,aa=e.Xk,B=e.pl,u=e.ql;E(h<p);E(l<n);E(e.eh<p);E(e.eh<n);p=++e.eh;e.Tn=h;w[h]||(w[h]=p,e.nn++,B[h]&&e.Wj++);B[h]||(B[h]=p,e.on++,w[h]&&e.Wj++);aa[l]||(aa[l]=p,e.pn++,u[l]&&e.Xj++);u[l]||(u[l]=p,e.qn++,aa[l]&&e.Xj++);z[h]=l;M[l]=h;for(z=0;z<I(k,h);z++)M=v(k,h,z),w[M]||(w[M]=p,e.nn++,B[M]&&e.Wj++);for(z=0;z<A(k,h);z++)M=C(k,h,z),B[M]||(B[M]=p,e.on++,w[M]&&e.Wj++);for(z=0;z<I(m,l);z++)M=
v(m,l,z),aa[M]||(aa[M]=p,e.pn++,u[M]&&e.Xj++);for(z=0;z<A(m,l);z++)M=C(m,l,z),u[M]||(u[M]=p,e.qn++,aa[M]&&e.Xj++);e=F(a,b,g);E(1>=g.eh-g.lt);E(-1!=g.Tn);M=g.hp;h=g.ip;l=g.eh;k=g.Tn;m=g.ai;w=g.Dk;p=g.Wk;aa=g.Xk;n=g.pl;B=g.ql;if(g.lt<l){p[k]==l&&(p[k]=0);for(u=0;u<I(M,k);u++)z=v(M,k,u),p[z]==l&&(p[z]=0);n[k]==l&&(n[k]=0);for(u=0;u<A(M,k);u++)z=C(M,k,u),n[z]==l&&(n[z]=0);M=m[k];aa[M]==l&&(aa[M]=0);for(u=0;u<I(h,M);u++)z=v(h,M,u),aa[z]==l&&(aa[z]=0);B[M]==l&&(B[M]=0);for(u=0;u<A(h,M);u++)z=C(h,M,u),B[z]==
l&&(B[z]=0);m[k]=-1;w[M]=-1;g.eh=g.lt;g.Tn=-1}}return e}function t(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var f=a.Wj,e=a.Xj,g=a.on,h=a.qn,l=a.nn,k=a.pn,v=a.eh,m=a.Bj,p=a.Mm,q=a.ai,z=a.Dk,n=a.Wk,y=a.Xk,t=a.pl,D=a.ql;if(f>v&&e>v)for(;c<m&&(-1!=q[c]||0==t[c]||0==n[c]);)c++,d=0;else if(g>v&&h>v)for(;c<m&&(-1!=q[c]||0==t[c]);)c++,d=0;else if(l>v&&k>v)for(;c<m&&(-1!=q[c]||0==n[c]);)c++,d=0;else if(0==c&&0!=a.order){for(n=0;n<m&&-1!=q[c=a.order[n]];)n++;n==m&&(c=m)}else for(;c<m&&-1!=q[c];)c++,d=0;if(f>v&&
e>v)for(;d<p&&(-1!=z[d]||0==D[d]||0==y[d]);)d++;else if(g>v&&h>v)for(;d<p&&(-1!=z[d]||0==D[d]);)d++;else if(l>v&&k>v)for(;d<p&&(-1!=z[d]||0==y[d]);)d++;else for(;d<p&&-1!=z[d];)d++;return c<m&&d<p?(b[0]=c,b[1]=d,!0):!1}function q(a,b,c){var d=a.hp,f=a.ip,e=a.Mm,g=a.ai,h=a.Dk,k=a.Wk,m=a.Xk,p=a.pl,q=a.ql;E(b<a.Bj);E(c<e);E(-1==g[b]);E(-1==h[c]);if(!(0,a.Bx)(J(d,b),J(f,c)))return!1;for(var n=e=0,y=0,M=0,t=0,w=0,B=0;B<A(d,b);B++){var u=C(d,b,B);if(-1!=g[u]){var x=g[u];if(!l(f,c,x)||!z(a.Pr,d,b,u,f,c,
x))return!1}else k[u]&&y++,p[u]&&e++,k[u]||p[u]||t++}for(B=0;B<I(d,b);B++)if(u=v(d,b,B),-1!=g[u]){if(x=g[u],!l(f,x,c)||!z(a.Pr,d,u,b,f,x,c))return!1}else k[u]&&y++,p[u]&&e++,k[u]||p[u]||t++;for(B=0;B<A(f,c);B++)if(x=C(f,c,B),-1!=h[x]){if(u=h[x],!l(d,b,u))return!1}else m[x]&&M++,q[x]&&n++,m[x]||q[x]||w++;for(B=0;B<I(f,c);B++)if(x=v(f,c,B),-1!=h[x]){if(u=h[x],!l(d,u,b))return!1}else m[x]&&M++,q[x]&&n++,m[x]||q[x]||w++;return y<=M&&e<=n&&t<=w}function E(a){a||Q.D("Assertion failed")}function J(a,b){for(var c=
a.V,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function A(a,b){for(var c=a.za,d=0,f=0;f<c.length;f+=3)c[f]==b&&d++;return d}function I(a,b){for(var c=a.za,d=0,f=0;f<c.length;f+=3)c[f+1]==b&&d++;return d}function C(a,b,c){a=a.za;for(var d=0,f=0;f<a.length;f+=3)if(a[f]==b){if(d==c)return a[f+1];d++}return-1}function v(a,b,c){a=a.za;for(var d=0,f=0;f<a.length;f+=3)if(a[f+1]==b){if(d==c)return a[f];d++}return-1}function l(a,b,c){a=a.za;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;
return!1}function z(a,b,c,d,f,e,g){for(var h=H(b,c,d),l=H(f,e,g),k=0;k<h;k++){for(var v=!1,m=0;m<l;m++)if(a(p(b,c,d,k),p(f,e,g,m))){v=!0;break}if(!v)return!1}return!0}function H(a,b,c){var d=0;a=a.za;for(var f=0;f<a.length;f+=3)a[f]==b&&a[f+1]==c&&d++;return d}function p(a,b,c,d){a=a.za;for(var f=0,e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c){if(f==d)return a[e+2];f++}return null}var Q=r("__util"),y=[-1,-1];a.Ou=-1;a.SS=10;a.Sl=20;a.$S=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var f=
a[d];switch(f.length){case 2:b.push(f[0],f[1]);break;case 3:c.push(f[0],f[1],f[2]);break;default:Q.D("Wrong graph constructor params")}}return{V:b,za:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.V.length),f=0;f<a.V.length;f+=2)d[f]=a.V[f],d[f+1]=b(a.V[f+1]);else d=Q.S(a.V);if(c)for(b=Array(a.za.length),f=0;f<a.za.length;f+=3)b[f]=a.za[f],b[f+1]=a.za[f+1],b[f+2]=c(a.za[f+2]);else b=Q.S(a.za);return a={V:d,za:b}};a.BT=function(a,b){for(var c=[],d=[],f=0;f<a.length;f++)c.push(a[f][0],a[f][1]);
for(f=0;f<b.length;f++)d.push(b[f][0],b[f][1],b[f][2]);return{V:c,za:d}};a.Xg=d;a.mU=c;a.Nc=b;a.Vf=g;a.Pj=n;a.Wm=function(a,b,c,d){l(a,b,c)||Q.D("Edge not found");a=a.za;for(var f=0;f<a.length;f+=3)if(a[f]==b&&a[f+1]==c&&a[f+2][0]==d[0]&&a[f+2][1]==d[1]){a.splice(f,3);break}};a.O=function(a,b){if(-1==e(a,b)){var c=x(a);d(a,c,b);return c}Q.D("Non-unique attribute")};a.FP=function(a,b,c,d,f){a=a.za;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&a[e+2]==d&&(a[e+2]=f)};a.fA=function(a,c,f,e){f=f||[];
e=e||[];for(var g={},h=0;h<a.V.length;h+=2){var l=a.V[h],k=x(c);d(c,k,a.V[h+1]);g[l]=k}for(h=0;h<a.za.length;h+=3){var k=g[a.za[h]],v=g[a.za[h+1]],l=a.za[h+2];b(c,k,v,l)}for(h=0;h<f.length;h+=3)k=g[f[h]],a=f[h+1],l=f[h+2],b(c,k,a,l);for(h=0;h<e.length;h+=3)f=e[h],v=g[e[h+1]],l=e[h+2],b(c,f,v,l)};a.lj=x;a.yh=e;a.C=function(a,c,d,f){c=e(a,c);d=e(a,d);-1!=c&&-1!=d?b(a,c,d,f):Q.D("Attributes not found")};a.ha=function(a,b){for(var c=a.V,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.ag=function(a,b){for(var c=
a.za,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.Ih=function(a,b,c){for(var d=a.za,f=0;f<d.length;f+=3)if(d[f+1]==b){var e=d[f];if(c(e,J(a,e),d[f+2]))break}};a.Zj=function(a,b,c){for(var d=a.za,f=0;f<d.length;f+=3)if(d[f]==b){var e=d[f+1];if(c(e,J(a,e),d[f+2]))break}};a.Oy=u;a.mR=function(a){a=u(a).V;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.uU=function(){};a.mn=function(a,b,d){c(a,b)||Q.D("No such node");var f={};w(a,f);m(a,b,f,d);b=[];for(var e in f)f[e]&&(e=Number(e),b.push(e,
J(a,e)));a={V:b,za:a.za.slice(0)};B(a);return a};a.xv=B;a.sN=function(a){for(var b=[],c=a.V,d=0;d<c.length;d+=2){var f=c[d];I(a,f)||b.push(f)}return b};a.kp=k;a.match=function(a,b,c,d){var e={};e.hp=f(a);e.ip=f(b);e.Bx=c||function(a,b){return a==b};e.Pr=d||function(a,b){return a==b};d=a.V.length/2;var g=b.V.length/2;e.Bj=d;e.Mm=g;e.order=0;e.eh=e.lt=0;e.Wj=e.nn=e.on=0;e.Xj=e.pn=e.qn=0;e.Tn=-1;e.ai=Array(d);e.Dk=Array(g);e.Wk=Array(d);e.Xk=Array(g);e.pl=Array(d);e.ql=Array(g);e.Kt=[1];for(c=0;c<d;c++)e.ai[c]=
-1,e.Wk[c]=0,e.pl[c]=0;for(c=0;c<g;c++)e.Dk[c]=-1,e.Xk[c]=0,e.ql[c]=0;g=Array(d);d=Array(d);if(F(g,d,e)){for(c=0;c<g.length;c++)g[c]=a.V[2*g[c]],d[c]=b.V[2*d[c]];return[g,d]}return null};a.pN=function(a,b){for(var c=a.V,d=1;d<c.length;d+=2)if(c[d]==b)return c[d-1];return null};a.Ra=J;a.Ig=A;a.Yk=I;a.qh=C;a.nh=v;a.aU=H;a.yd=p;a.replace=function(a,b,c){for(var f=a.za,e=x(a),h=0;h<b.length;h++){var l=b[h];g(a,l);for(var k=0;k<f.length;k+=3)f[k]==l&&(f[k]=e),f[k+1]==l&&(f[k+1]=e),f[k]==f[k+1]&&(f.splice(k,
3),k-=3)}d(a,e,c)};a.uP=function(a,b,c,d,f){l(a,b,c)||Q.D("Edge not found");a=a.za;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&(a[e]=d,a[e+1]=f)};a.YL=function(a,b){function c(a,b){if(-1!=h.indexOf(a)){var d=h.slice(h.indexOf(a));if(-1!=f[d[d.length-1]].indexOf(d[0])){l.push([a,d[d.length-1]]);return}}h.push(a);for(d=0;d<b.length;d++)b[d]in f&&c(b[d],f[b[d]])}b||(b=k(a)[0]);var d=a.za;if(d.length&&-1!=d.indexOf(b)){for(var f={},e=0,g=0;g<d.length;g+=3)d[g+1]in f?f[d[g+1]].push(d[g]):f[d[g+1]]=
[d[g]],e++;var h=[],l=[];c(b,f[b]);for(g=0;g<l.length;g++)for(var v=e=0;v<d.length;v+=3)l[g][1]==d[v+1]&&l[g][0]==d[v]&&n(a,d[v],d[v+1],e),e++}};a.DL=function(a,b,c){var d=a.V;a=a.za;var f;f="digraph debug {\n    node [shape=box];\n";for(var e=0;e<d.length;e+=2){var g=d[e],h=d[e+1],h=b?b(g,h):String(g);f+="    ";f+=String(g)+' [label="'+h.replace(/\"/g,'\\"')+'"];\n'}for(e=0;e<a.length;e+=3)b=a[e],d=a[e+1],h=a[e+2],f+="    ",f+=String(b)+" -> "+String(d),c&&(f+=' [label="'+c(b,d,h)+'"]'),f+=";\n";
return f+"}"}};b4w.module.__ipc=function(a,r){function d(a,b,c){for(var d=0;d<B.length;d+=2)B[d+1]==a&&(m[d+Number(!b)]=c)}function c(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,f;for(f in c){var e=c[f];switch(e.constructor){case Float32Array:d+=e.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.xG=0;a.Az=1;a.Bz=2;a.rG=3;a.tG=4;a.uG=5;a.vG=6;a.yG=7;a.Cz=8;a.Nu=9;a.Dz=10;a.AG=11;a.Ez=12;a.BG=13;a.zG=14;a.wG=15;a.sG=16;var g=a.Az,n=a.Bz,x=a.Cz,e=a.Nu,u=a.Dz,w=a.Ez;a.NH=100;a.oH=101;a.pH=102;a.qH=103;a.rH=
104;a.tH=105;a.sH=106;a.uH=107;a.vH=108;a.wH=109;a.xH=110;a.yH=111;a.zH=112;a.BH=113;a.CH=114;a.QH=115;a.DH=116;a.EH=117;a.FH=118;a.HH=119;a.IH=120;a.JH=121;a.LH=122;a.MH=123;a.OH=124;a.AH=125;a.SH=126;a.GH=127;a.Pz=128;a.RH=129;a.TH=130;a.UH=131;a.VH=132;a.WH=133;a.XH=134;a.YH=135;a.ZH=136;a.$H=137;a.aI=138;a.bI=139;a.Qz=140;a.Nn=141;a.cI=142;a.Oz=143;a.dI=144;a.eI=145;a.PH=146;a.KH=147;a.fI=148;var h=a.Nn,m=b4w.worker_listeners,B=b4w.worker_namespaces,k={gf:w,ba:0,time:0,trans:new Float32Array(3),
quat:new Float32Array(4),uh:new Float32Array(3),Wg:new Float32Array(3),len:0},f={gf:x,uv:0,Rx:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},F={gf:e,id:0,am:0,If:0,li:0,len:0},t={gf:u,id:0,am:0,If:0,li:0,sh:new Float32Array(3),ki:new Float32Array(3),len:0},q={gf:g,tk:0,uk:0,result:0,len:0},E={gf:n,tk:0,uk:0,result:0,Bk:new Float32Array(3),dh:new Float32Array(3),bm:0,len:0},J={gf:h,ba:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},A=[k,f,F,t,q,E,J];a.xL=function(a,c){var f=
{Js:a?!0:!1,Ti:null,$g:[],Cf:""};if(c){var e=r("__util"),g=r("__container");f.Ti={addEventListener:function(a,b){"message"!=a&&e.D("Wrong web worker event");d(f.Cf,f.Js,b)},removeEventListener:function(a){"message"!=a&&e.D("Wrong web worker event");d(f.Cf,f.Js,null)},postMessage:function(a){var b;a:{for(b=0;b<B.length;b+=2)if(B[b+1]==f.Cf){b=m[b+Number(!!f.Js)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<B.length;a+=2)if(B[a+1]==f.Cf){m.splice(a,2);B.splice(a,2);break}}};if(f.Js){var h=
b4w.get_namespace(r),k=e.sq(h+"_worker");B.push(h);B.push(k);m.push(null);m.push(null);f.Cf=k;(g=g.pM(a))?b?g.addEventListener("load",function(){b4w.require("__bindings",f.Cf)},!1):(b4w.cleanup("__bindings",f.Cf),b4w.cleanup("__ipc",f.Cf),b4w.require("__bindings",f.Cf)):(g=document.createElement("script"),g.src=a,g.defer="defer",g.async="async",g.addEventListener("load",function(){b=!1;b4w.require("__bindings",f.Cf)},!1),document.head.appendChild(g))}else f.Cf=b4w.get_namespace(r)}else a?f.Ti=new Worker(a):
f.Ti=self;return f};a.hJ=function(a,b){function d(c){if(c.constructor==ArrayBuffer)c=new Float32Array(c);else if(c[0].constructor==ArrayBuffer){for(var l=0;l<c.length;l++)d(c[l]);return}l=c[0]|0;switch(l){case w:var v=k;v.ba=c[1]|0;v.time=c[2];v.trans[0]=c[3];v.trans[1]=c[4];v.trans[2]=c[5];v.quat[0]=c[6];v.quat[1]=c[7];v.quat[2]=c[8];v.quat[3]=c[9];v.uh[0]=c[10];v.uh[1]=c[11];v.uh[2]=c[12];v.Wg[0]=c[13];v.Wg[1]=c[14];v.Wg[2]=c[15];break;case x:v=f;v.uv=c[1]|0;v.Rx=c[2]|0;v.trans[0]=c[3];v.trans[1]=
c[4];v.trans[2]=c[5];v.quat[0]=c[6];v.quat[1]=c[7];v.quat[2]=c[8];v.quat[3]=c[9];break;case e:v=F;v.id=c[1]|0;v.am=c[2]|0;v.If=c[3];v.li=c[4];break;case u:v=t;v.id=c[1]|0;v.am=c[2]|0;v.If=c[3];v.li=c[4];v.sh[0]=c[5];v.sh[1]=c[6];v.sh[2]=c[7];v.ki[0]=c[8];v.ki[1]=c[9];v.ki[2]=c[10];break;case g:v=q;v.tk=c[1]|0;v.uk=c[2]|0;v.result=!!c[3];break;case n:v=E;v.tk=c[1]|0;v.uk=c[2]|0;v.result=!!c[3];v.Bk[0]=c[4];v.Bk[1]=c[5];v.Bk[2]=c[6];v.dh[0]=c[7];v.dh[1]=c[8];v.dh[2]=c[9];v.bm=c[10];break;case h:v=J;
v.ba=c[1]|0;v.trans[0]=c[2];v.trans[1]=c[3];v.trans[2]=c[4];v.quat[0]=c[5];v.quat[1]=c[6];v.quat[2]=c[7];v.quat[3]=c[8];break;default:v=c}b(a,l,v)}c(A);a.Ti.addEventListener("message",function(a){d(a.data)},!1)};a.cleanup=function(){};a.ga=function(a,b){if(a)switch(b){case w:var c=k,d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.ba;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.uh[0];d[11]=c.uh[1];d[12]=c.uh[2];d[13]=c.Wg[0];
d[14]=c.Wg[1];d[15]=c.Wg[2];a.$g.push(d.buffer);break;case x:c=f;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.uv;d[2]=c.Rx;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.$g.push(d.buffer);break;case e:c=F;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.id;d[2]=c.am;d[3]=c.If;d[4]=c.li;a.$g.push(d.buffer);break;case u:c=t;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.id;d[2]=c.am;d[3]=c.If;d[4]=c.li;d[5]=c.sh[0];d[6]=c.sh[1];d[7]=c.sh[2];d[8]=c.ki[0];
d[9]=c.ki[1];d[10]=c.ki[2];a.$g.push(d.buffer);break;case g:c=q;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.tk;d[2]=c.uk;d[3]=c.result;a.$g.push(d.buffer);break;case n:c=E;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.tk;d[2]=c.uk;d[3]=c.result;d[4]=c.Bk[0];d[5]=c.Bk[1];d[6]=c.Bk[2];d[7]=c.dh[0];d[8]=c.dh[1];d[9]=c.dh[2];d[10]=c.bm;a.$g.push(d.buffer);break;case h:c=J;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.ba;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];
d[8]=c.quat[3];a.$g.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.Ti.postMessage(d)}};a.mP=function(a){a&&a.$g.length&&(a.Ti.postMessage(a.$g),a.$g.length=0)};a.gC=function(a){switch(a){case w:return k;case x:return f;case e:return F;case u:return t;case g:return q;case n:return E;case h:return J;default:return null}};a.terminate=function(a){a.Ti.terminate();a.Ti=null};a.Es=function(a){return!!a.Ti};a.JC=function(a){return!!a.Cf}};b4w.module.__hud=function(a,r){function d(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.F){var c=0,d=0,g=0;e.ha(a.F.Ja,function(a,f){if(f.type!=u.Xl){for(var e=Math.round(f.B.width)+"x"+Math.round(f.B.height),h=0,k=0;k<f.Qa.length;k++)h+=f.Qa[k].ra.length;k=f.Ro;if(f.type==u.Wc||f.type==u.qe)h*=6;var m=f.Ub&&!f.Zr,q=m?f.Xe:0;f.enqueue||
(f.Xe=0);var v=m?" (\u2713)":" (\u2715)",l=u.Cy(f);b(v,l,f.jt,e,k,"of",h,"  ",q.toFixed(3));f.Ro=0;m&&(c+=h,d+=k,g+=q)}});return[c,d,g]}b("No INFO")}function b(){for(var a=80+20*m[0],b=arguments[0],c=1;c<arguments.length;c++){for(var d="",e=0;e<w[c]-String(arguments[c]).length;e++)d+=" ";b+=d+arguments[c]}m[0]++;h.fillText(b,30,a)}function g(a,b,c){b=a.ic*b;c.x=a.x+b;c.y=a.y;c.ic=a.ic-2*b;c.Ab=a.Ab}function n(a){return a.x+a.ic/2}function x(a){var b=h,c={x:0,y:0,ic:0,Ab:0},d=b.canvas.width,b=b.canvas.height;
c.x=0;c.y=0;c.ic=d;c.Ab=b;g(c,.01,c);d=.02*c.Ab;c.x=c.x;c.y+=d;c.ic=c.ic;c.Ab=c.Ab-2*d;d=c.ic/8;c.x+=d*a;c.y=c.y;c.ic=d;c.Ab=c.Ab;g(c,.02,c);return c}var e=r("__graph"),u=r("__subscene"),w=[5,30,4,10,5,3,5],h=null,m=[0,0];a.init=function(a){a=a.getContext("2d");d(a);return h=a};a.tq=function(){h&&d(h)};a.reset=function(){var a=h;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),m[0]=0,m[1]=0)};a.KQ=function(a,d){var f=
h;if(f){f.textAlign="left";f.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/d).toFixed(2));m[0]++;for(var e=f=0,g=0,k=0;k<a.length;k++){var n=c(a[k]),f=f+n[0],e=e+n[1],g=g+n[2];m[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",e,"of",f,"  ",g.toFixed(3))}};a.print=function(){var a=h;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.plot_array=function(a,b,c,d,e,g,m){var f=h;if(f){b=x(b);var k=b.Ab/5;b.x=b.x;b.y+=
4*k;b.ic=b.ic;b.Ab=k;f.textAlign="center";f.fillStyle="#00FF00";h.fillText(a,n(b),b.y-10);f.strokeStyle="#00FF00";f.lineWidth=.5;f.beginPath();f.moveTo(b.x,b.y);f.lineTo(b.x+b.ic,b.y);f.lineTo(b.x+b.ic,b.y+b.Ab);f.lineTo(b.x,b.y+b.Ab);f.closePath();f.stroke();if(!g&&!m)for(g=1E6,m=-1E6,a=0;a<c.length;a++)g=Math.min(g,c[a]),m=Math.max(m,c[a]);f.textAlign="right";h.fillText(String(g),b.x-10,b.y+b.Ab);h.fillText(String(m),b.x-10,b.y);f.textAlign="center";h.fillText(String(d),b.x,b.y+b.Ab+15);h.fillText(String(e),
b.x+b.ic,b.y+b.Ab+15);f.strokeStyle="#FF0000";f.lineWidth=1.5;f.beginPath();d=b.ic/(c.length-1);m=b.Ab/(m-g);for(a=0;a<c.length;a++)e=b.x+d*a,k=b.y+b.Ab-(c[a]-g)*m,a?f.lineTo(e,k):f.moveTo(e,k);f.stroke()}};a.draw_mixer_strip=function(a,b,c,d,e,g,m){var f=h;if(f)for(f.textAlign="center",f.fillStyle="#00FF00",f.font="bold 12px Courier",c=x(c),h.fillText(b?"["+a+"]":a,n(c),c.y),0<=g&&h.fillText(g?"[M]":"[ ]",n(c)-15,c.y+30),0<=m&&h.fillText(m?"[S]":"[ ]",n(c)+15,c.y+30),a={x:0,y:0,ic:0,Ab:0},b=0;b<
d.length;b++){g=d[b];var k="VOLUME"==g[0];if(k){m=c.y+350;var q=c.ic,t=a;t.x=c.x;t.y=m;t.ic=q;t.Ab=250}else{m=c.y+50+50*b;var q=c.ic,t=c.Ab,v=a;v.x=c.x;v.y=m;v.ic=q;v.Ab=t}m=f;var q=a,v=b==e,l=g[0],t=g[1],z=g[2],w=g[3],p=(w-z)/g[4],p=1>p?Math.floor(1/p-1E-5).toFixed(0).length:0;g=g[5]?Math.log(t/z)/Math.log(w/z):(t-z)/(w-z);m.textAlign="center";v?m.fillText("["+l+"]",n(q),q.y):m.fillText(l,n(q),q.y);m.strokeStyle="#00FF00";m.lineWidth=k?3:1;k?(m.textAlign="right",m.fillText(w.toFixed(p),n(q)-10,q.y+
15),m.textAlign="right",m.fillText(z.toFixed(p),n(q)-10,q.y+q.Ab-15)):(m.textAlign="right",m.fillText(z.toFixed(p),q.x+28,q.y+15),m.textAlign="left",m.fillText(w.toFixed(p),q.x+q.ic-28,q.y+15));m.beginPath();if(k){var u=q.y+15+(q.Ab-30)*(1-g);m.moveTo(n(q),q.y+15);m.lineTo(n(q),q.y+q.Ab-15);m.moveTo(n(q)-5,q.y+15);m.lineTo(n(q)+5,q.y+15);m.moveTo(n(q)-5,q.y+q.Ab-15);m.lineTo(n(q)+5,q.y+q.Ab-15);m.moveTo(n(q)-5,u);m.lineTo(n(q)+5,u)}else{var y=q.x+30+(q.ic-60)*g;m.moveTo(q.x+30,q.y+15);m.lineTo(q.x+
q.ic-30,q.y+15);m.moveTo(q.x+30,q.y+15-5);m.lineTo(q.x+30,q.y+15+5);m.moveTo(q.x+q.ic-30,q.y+15-5);m.lineTo(q.x+q.ic-30,q.y+15+5);m.moveTo(y,q.y+15-5);m.lineTo(y,q.y+15+5)}m.stroke();"EQ_Q"==l?(g=Math.log(1+1/(2*t*t)+Math.sqrt((2+1/(t*t))*(2+1/(t*t))/4-1))/Math.log(2),k?(m.textAlign="left",m.fillText(t.toFixed(p),n(q)+10,u),m.textAlign="left",m.fillText("("+g.toFixed(p+1)+")",n(q)+10,u+10)):(m.textAlign="right",m.fillText(t.toFixed(p),y,q.y+30),m.textAlign="left",m.fillText("("+g.toFixed(p+1)+")",
y,q.y+30))):k?(m.textAlign="left",m.fillText(t.toFixed(p),n(q)+10,u)):(m.textAlign="center",m.fillText(t.toFixed(p),y,q.y+30))}}};b4w.module.__renderer=function(a,r){function d(a){for(var c=a.B,d=a.Qa,f=null,e=F.ec(c.v,Z),g=0;g<d.length;g++){var h=d[g];if(h.Ub){var q=h.ib,h=h.ra;if(q.Dh!=f){l.useProgram(q.Dh);for(var f=a,p=c,z=q,M=z.qF,u=M.length;u--;){var aa=M[u];aa.vm(l,aa.Nd,f,p)}if(z.Om&&!z.it)for(z.Lx.length||n(z),z=z.Lx,M=z.length;M--;)aa=z[M],aa.vm(l,aa.Nd,f,p);f=q.Dh}for(p=0;p<h.length;p++)if(u=h[p],u.Ub){M=u.Ee;aa=u.qa;w.CP(aa);w.IC()&&"DEBUG_VIEW"==aa.type&&(aa.Qo=t.smooth(x.kJ(aa.gm),aa.Qo,1,15));if(D.alpha_sort&&
aa.Pe){var z=M,u=u.Bs,B=e,I=aa.da;if(E.dist(B,u.gG)>D.alpha_sort_threshold*Math.min(u.nJ,1)||z.ep)m.FR(I,u,z.v,B),E.copy(B,u.gG),z.ep=!1}for(var z=a,B=aa,u=q,C=u.rF,A=C.length;A--;)I=C[A],I.vm(l,I.Nd,M,B);if(u.Om&&!u.it){u.Kp.length||n(u);C=u.Kp;for(A=C.length;A--;)I=C[A],I.vm(l,I.Nd,M,B);u.Om=!1}l.depthMask(B.Va);B.Qb?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE);I=B.Sa;C=l;for(A=0;A<I.length;A++){var Q=I[A];C.activeTexture(C.TEXTURE0+A);C.bindTexture(Q.qb,Q.Cb)}if(z.type==k.gg){M=z;u=u.Gl;I=M.B.lc.Cb;
C=M.Hk;for(A=0;6>A;A++)if(Q=b(A),D.yv?(l.bindTexture(l.TEXTURE_CUBE_MAP,I),l.texImage2D(Q,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,v)):(l.uniformMatrix4fv(u.u_cube_view_matrix,!1,C[A]),l.uniform4fv(u.u_sky_tex_fac,M.Rt),l.uniform3fv(u.u_sky_tex_color,M.Pt),l.uniform1f(u.u_sky_tex_dvar,M.Qt),l.uniform3fv(u.u_horizon_color,M.Md),l.uniform3fv(u.u_zenith_color,M.Vd),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,Q,I,0),y(B,0)),M.ft&&3!=A){var Q=M,J=A,wa=G;D.yv?wa.set(v):(l.readPixels(191,191,1,
1,l.RGBA,l.UNSIGNED_BYTE,wa),255!=wa[0]&&255!=wa[1]&&255!=wa[2]||l.readPixels(191,220,1,1,l.RGBA,l.UNSIGNED_BYTE,wa));var H=wa[0],X=wa[1],wa=wa[2],H=H/255,X=X/255,wa=wa/255;2===J?(Q.$d[3]=H,Q.$d[7]=X,Q.$d[11]=wa):2>J?(Q.$d[4*J]=H,Q.$d[4*J+1]=X,Q.$d[4*J+2]=wa):(Q.$d[4*(J-2)]=H,Q.$d[4*(J-2)+1]=X,Q.$d[4*(J-2)+2]=wa)}z.Ro+=6}else y(B,M.lu),z.Ro++;w.DP(aa);w.IC()&&"MAIN"==aa.type&&x.lJ(aa.id,aa.Xe)}}}}function c(a){if(a){var b=(a.rb?l.COLOR_BUFFER_BIT:0)|(a.tb?l.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case k.Id:a=
C;break;case k.Xc:a=J;break;case k.Re:a=A;break;case k.Wd:case k.dg:case k.Rl:a=I;break;case k.fg:case k.Qn:case k.Rq:a=C;break;default:a=D.background_color}}else b=l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT,a=D.background_color;l.colorMask(!0,!0,!0,!0);l.depthMask(!0);l.clearColor(a[0],a[1],a[2],a[3]);l.clear(b)}function b(a){switch(a){case 0:return l.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return l.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return l.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return l.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return l.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return l.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function g(a){var b=h.Dw(),c=a.ao,d=a.da,f=d.Fb;a.ne.length=0;var e=1,g;for(g in f)e=Math.max(e,f[g].frames);for(f=0;f<e;f++){g=b.createVertexArray();Q(g);d.Jf&&l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,d.Jf);for(var m=0;m<d.Sc.length;m++){l.bindBuffer(l.ARRAY_BUFFER,d.Sc[m].Ri);for(var k=0;k<c.length;k++){var v=c[k];v.nu==d.Sc[m].type&&(l.enableVertexAttribArray(v.Nd),l.vertexAttribPointer(v.Nd,v.Vb,v.xm,v.xm==l.FLOAT?
!1:!0,v.Gi,v.ir+v.$r*f),H(v.Nd,v.Lk))}}Q(null);a.ne.push(g)}}function n(a){var b=a.Gl,c=a.rF,d=a.Kp,f=a.qF,e=a.Lx;c.length=0;d.length=0;f.length=0;e.length=0;for(var g in b){var h=!1,m=null,l=null;switch(g){case "u_proj_matrix":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.lb)};h=!0;break;case "u_view_refl_matrix":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ru)};h=!0;break;case "u_view_tsr":case "u_view_tsr_frag":m=function(a,b,c,d){d.hc?a.uniformMatrix3fv(b,!1,d.Up):a.uniformMatrix3fv(b,!1,d.Me)};
h=!0;break;case "u_view_tsr_inverse":m=function(a,b,c,d){d.hc?a.uniformMatrix3fv(b,!1,d.Et):a.uniformMatrix3fv(b,!1,d.su)};h=!0;break;case "u_shadow_cast_billboard_view_tsr":m=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.fq)};h=!0;break;case "u_view_proj_prev":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Qx)};h=!0;break;case "u_view_proj_matrix":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Tc)};h=!0;break;case "u_view_proj_inverse":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.qu)};h=!0;break;case "u_sky_vp_inverse":m=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Wf)};h=!0;break;case "u_camera_eye":case "u_camera_eye_frag":m=function(a,b,c,d){a.uniform3fv(b,F.ec(d.v,Z))};h=!0;break;case "u_camera_quat":m=function(a,b,c,d){a.uniform4fv(b,F.Qc(d.v,S))};h=!0;break;case "u_view_max_depth":m=function(a,b,c,d){a.uniform1f(b,d.far)};h=!0;break;case "u_camera_range":m=function(a,b,c,d){a.uniform2f(b,d.near,d.far)};break;case "u_csm_center_dists":m=function(a,b,c,d){a.uniform4fv(b,d.Er)};break;case "u_height":m=function(a,
b,c,d){a.uniform1f(b,d.height)};h=!0;break;case "u_pcf_blur_radii":m=function(a,b,c,d){a.uniform4fv(b,d.Sm)};break;case "u_dof_dist":m=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};h=!0;break;case "u_dof_front_start":m=function(a,b,c,d){a.uniform1f(b,d.dof_front_start)};h=!0;break;case "u_dof_front_end":m=function(a,b,c,d){a.uniform1f(b,d.dof_front_end)};h=!0;break;case "u_dof_rear_start":m=function(a,b,c,d){a.uniform1f(b,d.dof_rear_start)};h=!0;break;case "u_dof_rear_end":m=
function(a,b,c,d){a.uniform1f(b,d.dof_rear_end)};h=!0;break;case "u_dof_bokeh_intensity":m=function(a,b,c,d){a.uniform1f(b,d.dof_bokeh_intensity)};h=!0;break;case "u_camera_direction":m=function(a,b,c,d){a.uniform3fv(b,d.direction)};h=!0;break;case "u_cam_water_depth":m=function(a,b,c){a.uniform1f(b,c.tv)};h=!0;break;case "u_waves_height":m=function(a,b,c){a.uniform1f(b,c.kz)};break;case "u_waves_length":m=function(a,b,c){a.uniform1f(b,c.lz)};break;case "u_fog_color_density":m=function(a,b,c){a.uniform4fv(b,
c.ce)};break;case "u_fog_params":m=function(a,b,c){a.uniform4fv(b,c.Ef)};break;case "u_underwater_fog_color_density":m=function(a,b,c){a.uniform4fv(b,c.Mh)};break;case "u_bloom_key":m=function(a,b,c){a.uniform1f(b,c.mr)};break;case "u_bloom_edge_lum":m=function(a,b,c){a.uniform1f(b,c.lr)};break;case "u_time":m=function(a,b,c){a.uniform1f(b,c.time)};h=!0;break;case "u_wind":m=function(a,b,c){a.uniform3fv(b,c.Ui)};h=!0;break;case "u_sky_tex_dvar":m=function(a,b,c){a.uniform1f(b,c.Qt)};break;case "u_sky_tex_fac":m=
function(a,b,c){a.uniform4fv(b,c.Rt)};break;case "u_sky_tex_color":m=function(a,b,c){a.uniform3fv(b,c.Pt)};break;case "u_horizon_color":m=function(a,b,c){a.uniform3fv(b,c.Md)};break;case "u_zenith_color":m=function(a,b,c){a.uniform3fv(b,c.Vd)};break;case "u_environment_energy":m=function(a,b,c){a.uniform1f(b,c.wg)};break;case "u_sky_color":m=function(a,b,c){a.uniform3fv(b,c.en)};break;case "u_rayleigh_brightness":m=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":m=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":m=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":m=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":m=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":m=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":m=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":m=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":m=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":m=function(a,b,c){a.uniform4fv(b,c.Bp)};break;case "u_light_directions":m=function(a,b,c){a.uniform3fv(b,c.cx)};break;case "u_light_color_intensities":m=function(a,b,c){a.uniform4fv(b,c.zp)};break;case "u_sun_quaternion":m=function(a,b,c){a.uniform4fv(b,c.ZE)};break;case "u_sun_intensity":m=function(a,b,c){a.uniform3fv(b,c.YE)};
break;case "u_sun_direction":m=function(a,b,c){a.uniform3fv(b,c.Dy)};break;case "u_debug_view_mode":m=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":m=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":m=function(a,b,c){a.uniform1f(b,c.sB)};break;case "u_subpixel_jitter":m=function(a,b,c){a.uniform2fv(b,c.VN)};h=!0;break;case "u_subsample_indices":m=function(a,b,c){a.uniform4fv(b,c.WN)};h=!0;break;case "u_radial_blur_step":m=
function(a,b,c){a.uniform1f(b,c.Ct)};break;case "u_god_rays_intensity":m=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":m=function(a,b,c){a.uniform1f(b,c.Zt)};break;case "u_ssao_blur_discard_value":m=function(a,b,c){a.uniform1f(b,c.Vt)};h=!0;break;case "u_ssao_influence":m=function(a,b,c){a.uniform1f(b,c.Yt)};break;case "u_ssao_dist_factor":m=function(a,b,c){a.uniform1f(b,c.Wt)};break;case "u_texel_size":m=function(a,b,c){a.uniform2fv(b,c.Ly)};h=!0;break;
case "u_normal_offset":m=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":m=function(a,b,c){a.uniform4fv(b,c.ku)};h=!0;break;case "u_v_light_r":m=function(a,b,c){a.uniform4fv(b,c.ju)};h=!0;break;case "u_v_light_tsr":m=function(a,b,c){a.uniformMatrix3fv(b,!1,c.gz)};h=!0;break;case "u_p_light_matrix0":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.rl[0])};h=!0;break;case "u_p_light_matrix1":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.rl[1])};h=!0;break;case "u_p_light_matrix2":m=
function(a,b,c){a.uniformMatrix4fv(b,!1,c.rl[2])};h=!0;break;case "u_p_light_matrix3":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.rl[3])};h=!0;break;case "u_outline_color":m=function(a,b,c){a.uniform3fv(b,c.wi)};break;case "u_draw_outline":m=function(a,b,c){a.uniform1f(b,c.cw)};h=!0;break;case "u_glow_mask_small_coeff":m=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};h=!0;break;case "u_glow_mask_large_coeff":m=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};h=!0;break;case "u_brightness":m=
function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":m=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":m=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":m=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":m=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":m=function(a,b,c){a.uniform4fv(b,c.Kk)};break;case "u_chromatic_aberration_coefs":m=function(a,b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};
break;case "u_motion_blur_exp":m=function(a,b,c){a.uniform1f(b,c.iD)};h=!0;break;case "u_motion_blur_decay_threshold":m=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};h=!0;break;case "u_model_tsr":l=function(a,b,c){a.uniformMatrix3fv(b,!1,c.v)};h=!0;break;case "u_model_tsr_inverse":l=function(a,b,c){a.uniformMatrix3fv(b,!1,c.Au)};h=!0;break;case "u_transb":l=function(a,b,c){a.uniform4fv(b,c.Td)};h=!0;break;case "u_transa":l=function(a,b,c){a.uniform4fv(b,c.ke)};h=!0;break;case "u_arm_rel_trans":l=
function(a,b,c){a.uniform4fv(b,c.Zn)};h=!0;break;case "u_arm_rel_quat":l=function(a,b,c){a.uniform4fv(b,c.Yn)};h=!0;break;case "u_quat":l=function(a,b,c){a.uniform4fv(b,F.Qc(c.v,S))};h=!0;break;case "u_quatsb":l=function(a,b,c){a.uniform4fv(b,c.Pd)};h=!0;break;case "u_quatsa":l=function(a,b,c){a.uniform4fv(b,c.he)};h=!0;break;case "u_frame_factor":l=function(a,b,c){a.uniform1f(b,c.Be)};h=!0;break;case "au_center_pos":l=function(a,b,c){a.uniform3fv(b,c.so)};h=!0;break;case "au_wind_bending_amp":l=
function(a,b,c){a.uniform1f(b,c.Ne)};h=!0;break;case "au_wind_bending_freq":l=function(a,b,c){a.uniform1f(b,c.Oe)};h=!0;break;case "au_detail_bending_freq":l=function(a,b,c){a.uniform1f(b,c.ye)};h=!0;break;case "au_detail_bending_amp":l=function(a,b,c){a.uniform1f(b,c.xe)};h=!0;break;case "au_branch_bending_amp":l=function(a,b,c){a.uniform1f(b,c.te)};h=!0;break;case "u_node_values":l=function(a,b,c,d){a.uniform1fv(b,d.Gg)};h=!0;break;case "u_node_rgbs":l=function(a,b,c,d){a.uniform3fv(b,d.Bd)};h=
!0;break;case "u_diffuse_color":l=function(a,b,c,d){a.uniform4fv(b,d.xd)};h=!0;break;case "u_diffuse_intensity":l=function(a,b,c,d){a.uniform1f(b,d.jh)};h=!0;break;case "u_diffuse_params":l=function(a,b,c,d){a.uniform2fv(b,d.$c)};h=!0;break;case "u_emit":l=function(a,b,c,d){a.uniform1f(b,d.ug)};h=!0;break;case "u_ambient":l=function(a,b,c,d){a.uniform1f(b,d.lg)};h=!0;break;case "u_specular_color":l=function(a,b,c,d){a.uniform3fv(b,d.Yf)};h=!0;break;case "u_specular_alpha":l=function(a,b,c,d){a.uniform1f(b,
d.Cl)};h=!0;break;case "u_specular_params":l=function(a,b,c,d){a.uniform3fv(b,d.Rd)};h=!0;break;case "u_reflect_factor":l=function(a,b,c,d){a.uniform1f(b,d.reflect_factor)};h=!0;break;case "u_mirror_factor":l=function(a,b,c,d){a.uniform1f(b,d.kl)};h=!0;break;case "u_grass_map_dim":l=function(a,b,c,d){a.uniform3fv(b,d.hd)};h=!0;break;case "u_grass_size":l=function(a,b,c,d){a.uniform1f(b,d.ji)};h=!0;break;case "u_scale_threshold":l=function(a,b,c,d){a.uniform1f(b,d.ns)};h=!0;break;case "u_cube_fog":l=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.$d)};break;case "u_jitter_amp":l=function(a,b,c,d){a.uniform1f(b,d.Ms)};h=!0;break;case "u_jitter_freq":l=function(a,b,c,d){a.uniform1f(b,d.Ns)};h=!0;break;case "u_wireframe_edge_color":l=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":l=function(a,b,c,d){a.uniform1f(b,d.Ao)};h=!0;break;case "u_batch_debug_id_color":l=function(a,b,c,d){a.uniform1f(b,d.Ir)};h=!0;break;case "u_batch_debug_main_render_time":l=function(a,
b,c,d){a.uniform1f(b,d.Qo)};h=!0;break;case "u_refr_bump":l=function(a,b,c,d){a.uniform1f(b,d.Vm)};h=!0;break;case "u_line_width":l=function(a,b,c,d){a.uniform1f(b,d.Hm)};h=!0;break;case "u_lamp_light_positions":l=function(a,b,c,d){a.uniform3fv(b,d.Fm)};break;case "u_lamp_light_directions":l=function(a,b,c,d){a.uniform3fv(b,d.xp)};break;case "u_lamp_light_color_intensities":l=function(a,b,c,d){a.uniform3fv(b,d.wp)};break;case "u_halo_size":l=function(a,b,c,d){a.uniform1f(b,d.ws)};h=!0;break;case "u_halo_hardness":l=
function(a,b,c,d){a.uniform1f(b,d.ts)};h=!0;break;case "u_halo_rings_color":l=function(a,b,c,d){a.uniform3fv(b,d.vs)};h=!0;break;case "u_halo_lines_color":l=function(a,b,c,d){a.uniform3fv(b,d.us)};h=!0;break;case "u_halo_stars_blend":l=function(a,b,c,d){a.uniform1f(b,d.xs)};h=!0;break;case "u_halo_stars_height":l=function(a,b,c,d){a.uniform1f(b,d.ys)};h=!0;break;case "u_fresnel_params":l=function(a,b,c,d){a.uniform4fv(b,d.bf)};h=!0;break;case "u_texture_scale":l=function(a,b,c,d){a.uniform3fv(b,d.$f)};
h=!0;break;case "u_parallax_scale":l=function(a,b,c,d){a.uniform1f(b,d.parallax_scale)};h=!0;break;case "u_color_id":l=function(a,b,c){a.uniform3fv(b,c.bj)};h=!0;break;case "u_diffuse_color_factor":l=function(a,b,c,d){a.uniform1f(b,d.ih)};h=!0;break;case "u_alpha_factor":l=function(a,b,c,d){a.uniform1f(b,d.xf)};h=!0;break;case "u_specular_color_factor":l=function(a,b,c,d){a.uniform1f(b,d.Ei)};h=!0;break;case "u_normal_factor":l=function(a,b,c,d){a.uniform1f(b,d.Pm)};h=!0;break;case "u_normalmap0_scale":l=
function(a,b,c,d){a.uniform2fv(b,d.vi[0])};h=!0;break;case "u_normalmap1_scale":l=function(a,b,c,d){a.uniform2fv(b,d.vi[1])};h=!0;break;case "u_normalmap2_scale":l=function(a,b,c,d){a.uniform2fv(b,d.vi[2])};h=!0;break;case "u_normalmap3_scale":l=function(a,b,c,d){a.uniform2fv(b,d.vi[3])};h=!0;break;case "u_foam_factor":l=function(a,b,c,d){a.uniform1f(b,d.foam_factor)};h=!0;break;case "u_foam_uv_freq":l=function(a,b,c,d){a.uniform2fv(b,d.Yr)};h=!0;break;case "u_foam_mag":l=function(a,b,c,d){a.uniform2fv(b,
d.Xr)};h=!0;break;case "u_foam_scale":l=function(a,b,c,d){a.uniform2fv(b,d.ap)};h=!0;break;case "u_water_norm_uv_velocity":l=function(a,b,c,d){a.uniform1f(b,d.gk)};h=!0;break;case "u_shallow_water_col":l=function(a,b,c,d){a.uniform3fv(b,d.shallow_water_col)};h=!0;break;case "u_shore_water_col":l=function(a,b,c,d){a.uniform3fv(b,d.shore_water_col)};h=!0;break;case "u_water_shallow_col_fac":l=function(a,b,c,d){a.uniform1f(b,d.shallow_water_col_fac)};h=!0;break;case "u_water_shore_col_fac":l=function(a,
b,c,d){a.uniform1f(b,d.shore_water_col_fac)};h=!0;break;case "u_p_length":l=function(a,b,c,d){a.uniform1f(b,d.wa.jF)};h=!0;break;case "u_p_cyclic":l=function(a,b,c,d){a.uniform1i(b,d.wa.cyclic)};h=!0;break;case "u_p_max_lifetime":l=function(a,b,c,d){a.uniform1f(b,d.wa.XC)};h=!0;break;case "u_p_fade_in":l=function(a,b,c,d){a.uniform1f(b,d.wa.Nk)};h=!0;break;case "u_p_fade_out":l=function(a,b,c,d){a.uniform1f(b,d.wa.$e)};h=!0;break;case "u_p_size":l=function(a,b,c,d){a.uniform1f(b,d.wa.size)};h=!0;
break;case "u_p_alpha_start":l=function(a,b,c,d){a.uniform1f(b,d.wa.cA)};h=!0;break;case "u_p_alpha_end":l=function(a,b,c,d){a.uniform1f(b,d.wa.bA)};h=!0;break;case "u_p_nfactor":l=function(a,b,c,d){a.uniform1f(b,d.wa.ht)};h=!0;break;case "u_p_gravity":l=function(a,b,c,d){a.uniform1f(b,d.wa.qC)};h=!0;break;case "u_p_mass":l=function(a,b,c,d){a.uniform1f(b,d.wa.wh)};h=!0;break;case "u_p_color_ramp":l=function(a,b,c,d){a.uniform4fv(b,d.wa.$A)};h=!0;break;case "u_p_wind_fac":l=function(a,b,c,d){a.uniform1f(b,
d.wa.bG)};h=!0;break;case "u_p_time":l=function(a,b,c,d){a.uniform1f(b,d.wa.time)};h=!0;break;case "u_p_tilt":l=function(a,b,c,d){a.uniform1f(b,d.wa.hF)};h=!0;break;case "u_p_tilt_rand":l=function(a,b,c,d){a.uniform1f(b,d.wa.iF)};h=!0;break;case "u_position":l=function(a,b,c,d){a.uniform3fv(b,d.lk)};h=!0;break;case "u_va_frame_factor":l=function(a,b,c){a.uniform1f(b,c.mu)};h=!0;break;case "u_refl_plane":l=function(a,b,c){a.uniform4fv(b,c.hc)};h=!0;break;case "u_outline_intensity":l=function(a,b,c){a.uniform1f(b,
c.Jg)};h=!0;break;case "u_obj_info":l=function(a,b,c,d){a.uniform3fv(b,d.Qm)},h=!0}l&&(l={name:g,vm:l,Nd:b[g]},h?c.push(l):d.push(l));m&&(l={name:g,vm:m,Nd:b[g]},h?f.push(l):e.push(l))}if(d.length||e.length){a=a.Mx;for(var k in a)delete a[k];for(k=0;k<d.length;k++)l=d[k],a[l.name]=l;for(k=0;k<e.length;k++)l=e[k],a[l.name]=l}else a.it=!0}var x=r("__batch"),e=r("__camera"),u=r("__config"),w=r("__debug"),h=r("__extensions"),m=r("__geometry"),B=r("__quat"),k=r("__subscene"),f=r("__textures"),F=r("__tsr"),
t=r("__util"),q=r("__version"),E=r("__vec3"),J=[1,1,1,1],A=[1,1,1,1],I=[0,0,0,1],C=[0,0,0,0],v=new Uint8Array([91.8,142.8,.96*255,255]),l=null,z=null,H=null,p=null,Q=null,y=null,Z=new Float32Array(3),S=B.create(),G=new Uint8Array(4),D=u.H;a.mf=function(a){var b=D.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);l=a};a.lm=
function(a){if(a.Ub&&!a.Zr)if(a.type==k.Qq){w.Xx(a);var f=a.B;l.bindFramebuffer(l.READ_FRAMEBUFFER,f.fp);l.bindFramebuffer(l.DRAW_FRAMEBUFFER,f.ee);var h=0;f.lc&&(h|=l.COLOR_BUFFER_BIT);f.we&&(h|=l.DEPTH_BUFFER_BIT);l.blitFramebuffer(0,0,f.width,f.height,0,0,f.width,f.height,h,l.NEAREST);w.Yx(a);w.vv("draw resolve")}else if(a.type==k.Fu)w.Xx(a),f=a.B,l.bindFramebuffer(l.FRAMEBUFFER,f.fp),l.bindTexture(l.TEXTURE_2D,f.lc.Cb),l.copyTexSubImage2D(l.TEXTURE_2D,0,0,0,0,0,f.width,f.height,0),w.Yx(a),w.vv("draw copy");
else{w.Xx(a);f=a.B;l.bindFramebuffer(l.FRAMEBUFFER,f.ee);a.cv&&(h=f.lc,l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,h.qb,h.Cb,0));l.viewport(0,0,f.width,f.height);a.type!=k.Wc&&a.type!=k.qe&&c(a);a.yb?l.enable(l.BLEND):l.disable(l.BLEND);a.wd?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST);switch(a.type){case k.Xc:l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);l.cullFace(l.BACK);break;case k.qd:case k.Qe:l.disable(l.POLYGON_OFFSET_FILL);
l.cullFace(l.FRONT);break;case k.eg:l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(-4,-4);l.cullFace(l.BACK);break;case k.Id:if(1<D.uc||D.aE){l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(-2,-2);break}default:l.disable(l.POLYGON_OFFSET_FILL),l.cullFace(l.BACK)}if(a.type==k.Wc||a.type==k.qe)for(var f=a.B,h=f.lc.Cb,g=0;6>g;g++){var m=b(g);f.Hb=a.Hk[g];F.from_mat4(f.Hb,f.Me);e.qv(f);l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,m,h,0);c(a);for(var m=a.Qa,v=0;v<m.length;v++)for(var q=0;q<
m[v].ra.length;q++){var p=m[v].ra[q];p.Ub=p.aw[g]}d(a)}else d(a);w.Yx(a);w.vv("draw subscene: "+k.Cy(a))}};a.clear=function(a){l.bindFramebuffer(l.FRAMEBUFFER,a.B.ee);c(a)};a.bv=function(a){var b=a.ao;b.length=0;var c=a.da,d=c.Fb,f=a.ib.attributes,e;for(e in f){var h=d[e],l=m.nj(e),k=m.kN(e),v=m.mC(e);b.push({nu:l,xm:k,Nd:f[e],ir:h.offset*v,$r:1<h.frames?h.length*v:0,Vb:h.Vb,Gi:h.Gi*v,Lk:h.Lk})}if("DEBUG"==q.type())for(e in d)l=m.nj(e),b=m.WP(c.Sc,l),b=c.Sc[b],h=a.ab.bg+" | "+a.ab.Ae,l=d[e].length*
d[e].frames*m.mC(e),w.lM(b.EL,h,e,l,e in f);D.Yu&&g(a)};a.gJ=g;a.kK=function(a){for(var b=h.Dw(),c=0;c<a.ne.length;c++)b.deleteVertexArray(a.ne[c]);a.ne.length=0};a.mK=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({nu:d.nu,xm:d.xm,Nd:d.Nd,ir:d.ir,$r:d.$r,Vb:d.Vb,Gi:d.Gi,Lk:d.Lk})}return b};a.fJ=n;a.jA=function(a){var b=a.ib,c=a.Sa;a=a.Ie;l.useProgram(b.Dh);for(var d=0;d<c.length;d++)l.uniform1i(b.Gl[a[d]],d)};a.Dt=function(a,b,c,d,f,e){d||(d=1);f||(f=1);e||(e=new Uint8Array(4*d*f));
e.length!=4*d*f&&t.D("read_pixels(): Wrong storage");l.bindFramebuffer(l.FRAMEBUFFER,a);l.readPixels(b,c,d,f,l.RGBA,l.UNSIGNED_BYTE,e);l.bindFramebuffer(l.FRAMEBUFFER,null);return e};a.CR=function(a){var b=a.ib;b.it||(l.useProgram(b.Dh),b.Kp.length||n(b),b=b.Mx.u_cube_fog,b.vm(l,b.Nd,null,a))};a.BP=function(a,b){var c=l.createFramebuffer();l.bindFramebuffer(l.FRAMEBUFFER,c);if(f.Dm(a)){var d=a.pe;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.RENDERBUFFER,d)}else if(f.Em(a)){var e=
a,d=e.Cb,e=e.qb==l.TEXTURE_CUBE_MAP?l.TEXTURE_CUBE_MAP_NEGATIVE_Z:e.qb;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,e,d,0)}f.Dm(b)?(d=b.pe,l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,d)):f.Em(b)&&(e=b,d=e.Cb,e=e.qb,l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,e,d,0));w.SJ();l.bindFramebuffer(l.FRAMEBUFFER,null);return c};a.AP=function(a,b,c,d,e){null==a?(l.bindFramebuffer(l.FRAMEBUFFER,a),l.viewport(0,0,d,e),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT)):
(f.Dm(b)?l.deleteRenderbuffer(b.pe):f.Em(b)&&l.deleteTexture(b.Cb),f.Dm(c)?l.deleteRenderbuffer(c.pe):f.Em(c)&&l.deleteTexture(c.Cb),l.deleteFramebuffer(a))};a.qU=function(){};a.OL=function(a,b,c,d,f,e){a=a.Cb;l.viewport(0,0,c,c);l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,b,a,0);b=x.Jv("FLIP_CUBEMAP_COORDS");a=b.ib;l.activeTexture(l.TEXTURE0);l.bindTexture(l.TEXTURE_2D,f);var h=f=0;c!=d&&(f=1/(6*d),h=1/(4*d));l.uniform1i(a.Gl.u_tex_number,e);l.uniform2fv(a.Gl.u_delta,[f,h]);l.useProgram(a.Dh);
y(b,0);l.bindTexture(l.TEXTURE_2D,null)};a.PL=function(a,b,c,d,f){l.bindFramebuffer(l.FRAMEBUFFER,d);d=a.Cb;a=a.qb;l.bindTexture(a,d);l.viewport(0,0,b,c);l.texImage2D(a,0,l.RGBA,b,c,0,l.RGBA,l.UNSIGNED_BYTE,null);l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,a,d,0);b=x.Jv("NONE");c=b.ib;l.activeTexture(l.TEXTURE0);l.bindTexture(a,f);l.useProgram(c.Dh);y(b,0);l.bindFramebuffer(l.FRAMEBUFFER,null);l.bindTexture(a,null)};a.cleanup=function(){};a.gQ=function(){var a=h.nN(),b=h.Dw();D.aA=a?
!0:!1;D.Yu=b?!0:!1;a?(z=function(b,c,d,f){a.drawElementsInstanced(l.TRIANGLES,b,c,d,f)},H=function(b,c){a.vertexAttribDivisor(b,c)},p=function(b,c,d){a.drawArraysInstanced(l.TRIANGLES,b,c,d)}):(z=function(a,b,c){l.drawElements(l.TRIANGLES,a,b,c)},H=function(){},p=function(a,b){l.drawArrays(l.TRIANGLES,a,b)});b?(Q=function(a){b.bindVertexArray(a)},y=function(a,b){var c=a.da;Q(a.ne[b]);c.Jf?z(c.count,c.Tk,0,c.Zk):p(0,c.count,c.Zk);Q(null)}):y=function(a,b){for(var c=a.da,d=a.ao,f=0;f<c.Sc.length;f++){l.bindBuffer(l.ARRAY_BUFFER,
c.Sc[f].Ri);for(var e=0;e<d.length;e++){var h=d[e];h.nu==c.Sc[f].type&&(l.enableVertexAttribArray(h.Nd),l.vertexAttribPointer(h.Nd,h.Vb,h.xm,h.xm==l.FLOAT?!1:!0,h.Gi,h.ir+h.$r*b),H(h.Nd,h.Lk))}}c.Jf?(l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,c.Jf),z(c.count,c.Tk,0,c.Zk)):p(0,c.count,c.Zk);for(f=0;f<d.length;f++)h=d[f],l.disableVertexAttribArray(h.Nd)}};a.reset=function(){Q=p=H=z=l=null}};b4w.module.__shaders=function(a,r){function d(a,b,d){var f=a.ei;"string"==typeof d?(a=c(a,d))&&(d=a[1]):d=String(d);for(a=0;a<f.length;a++)if(f[a][0]==b){f[a][1]=d;break}}function c(a,b){for(var c=a.ei,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var c=a+b;if(!(c in D)){var d=k(y.shaders_path,a),f=k(y.shaders_path,b),d=F(d),f=F(f),e;for(e in f)d[e]=f[e];f=[];for(e in d)f.push([e,d[e]]);D[c]=f}return D[c]}function g(a,b){return a+b}function n(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3],10):1)}).filter(function(a){return a})||[]).reduce(g,0)}function x(a,b){var c=B(a.type),d=B(b.type),f=a.qk,e=b.qk;return c>d?-1:c<d?1:f>e?-1:f<e?1:0}function e(a){if(p.Yb){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ba}else b=pa;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],qk:a[4]?parseInt(a[4],10):1}}).filter(function(a){return a});return w(a,ha,Q.Vs)}function u(a,b,c){a=a.split(";");for(var d=[],f=0;f<a.length;f++){var e=a[f].match(L);e&&
d.push({type:e[2],qk:e[4]?parseInt(e[4],10):1})}return w(d,b,c)}function w(a,b,c){function d(){for(var c=0;v<a.length;){var d=a[v];if(3!=B(d.type))break;c+=m(d.type)*d.qk;v++}l=k+c;if(l>M)return!1;h(b,k,c,0,3);return!0}function f(){for(var c=M-l,d=c,f=c;v<a.length;){var e=a[v];if(2!=B(e.type))break;e=m(e.type)*e.qk;if(e<=d)d-=e;else if(e<=f)f-=e;else return!1;v++}f=c-f;h(b,l,c-d,0,2);h(b,M-f,f,2,2);return!0}function e(){for(;v<a.length;){for(var d=a[v],d=m(d.type)*d.qk,f=-1,e=c+1,g=-1,K=0;4>K;K++){var l=
Y;l[0]=0;l[1]=1;var k;k=b;for(var q=K,p=d,z=l;ca<k.length&&15===k[ca];)ca++;for(;0<M&&15===k[M];)M--;if(M-ca<p)k=!1;else{for(var q=1<<q,n=0,y=-1,t=k.length+1,N=!1,qa=ca;qa<=M;qa++)qa<M&&!(k[qa]&q)?N||(n=qa,N=!0):(N&&(N=qa-n,N>=p&&N<t&&(t=N,y=n)),N=!1);0>y?k=!1:(z[0]=y,z[1]=t,k=!0)}k&&l[1]<e&&(g=l[0],e=l[1],f=K)}if(0>f)return!1;h(b,g,d,f,1);v++}return!0}if(!a.length)return!0;for(var g=0;g<c;g++)b[g]=0;M=c;a.sort(x);var l=0,k=0,v=0;return function(){for(;v<a.length;){var c=a[v];if(4!=B(c.type))break;
k+=m(c.type)*c.qk;v++}if(k>M)return!1;ca=k;h(b,0,k,0,4);return!0}()&&d()&&f()&&e()}function h(a,b,c,d,f){for(var e=0,h=0;h<f;h++)e|=1<<d+h;for(h=0;h<c;h++)a[b+h]|=e}function m(a){switch(a){case "mat4":a=4;break;case "mat3":a=3;break;case "mat2":a=2;break;default:a=1}return a}function B(a){switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":a=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":a=3;break;case "vec2":case "ivec2":case "bvec2":a=2;break;default:a=1}return a}
function k(a,b){var c=a+b;if(S[c])return S[c];if(G){var d=G[b];if(!d)return null;d=r("__gpp_parser").JU.parse(d)}else if(d=r("shader_texts")[b],!d)return null;return S[c]=d}function f(a,b){for(var c={},d=b.ei||[],f=0;f<d.length;f++)c[d[f][0]]=[d[f][1]];for(f=0;f<b.Rf.length;f++)c["USE_NODE_"+b.Rf[f].id]=["1"];p.Yb?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],
c.GLSL_TEXTURE_PROJ=["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=p.Go?["sampler2DShadow"]:["sampler2D"];for(var e in c)c[e][0].constructor!=String&&z.warn("Warning! The value of a directive '"+e+"' is not of type string.");return c}
function F(a){function b(a){"var"==a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=k(y.shaders_path,y.yE+a.A),c(a,b))}function c(a,b,d){if(a instanceof Array)for(var f=0;f<a.length;f++)c(a[f],b,d);else if(a instanceof Object&&a){b&&b(a);for(f in a)c(a[f],b,d);d&&d(a)}}var d={};c(a,b);return d}function t(a,b,c){function d(b){b=b.f;for(var c=0;c<b.length;c++){var f=b[c];switch(f.a){case "cond":a:for(var f=f.f,v=0;v<f.length;v++){var p=f[v];switch(p.a){case "if":case "elif":if(e(p.i)){d(p.j);break a}break;
case "else":d(p.j);break a;case "ifdef":p.c in M&&d(p.j);break;case "ifndef":p.c in M||d(p.j)}}break;case "include":f=f.A;v=k(y.shaders_path,y.yE+f);K.push("include/"+f);d(v);K.pop();break;case "var":break;case "define":M[f.c]=f.b;break;case "error":H.D("Shader error: #error "+f.b.join(" "));break;case "line":break;case "pragma":n.push("#pragma "+f.c+" "+f.b.join(" "));break;case "undef":delete M[f.c];break;case "warning":z.warn("Shader warning: #warning "+f.b.join(" "));break;case "extension":f=
m(f.b,M,t,!1);n.push("#extension "+f.join(" "));break;case "version":f=m(f.b,M,t,!1),n.push("#version "+f.join(" "));case "#":break;case "node":u[f.c]=f;break;case "nodes_global":f=q;for(v=0;v<f.length;v++){var p=f[v],O=u[p.id];if(O)for(var qa=0,w=0;w<O.s.length;w++){var ia=O.s[w];if("node_param"==ia.a){var na;if("PARTICLE_INFO"==p.id&&ia.g)if(1==M.PARTICLE_BATCH)switch(na=!1,qa){case 0:na=I(p.hb,"PART_INFO_IND")||I(p.hb,"PART_INFO_AGE")||I(p.hb,"PART_INFO_LT")||I(p.hb,"PART_INFO_SIZE");break;case 1:na=
I(p.hb,"PART_INFO_LOC");break;case 2:na=I(p.hb,"PART_INFO_VEL");break;case 3:na=I(p.hb,"PART_INFO_A_VEL");break;case 4:na=I(p.hb,"PART_INFO_IND")}else na=!1;else na=!0;na&&(ia=ia.h.join(" ")+" ","vert"==a?ia+=p.oe[qa]:"frag"==a&&(ia+=p.X[qa],null!==p.rt[qa]&&(ia+="="+p.rt[qa])),ia+=";",l(g(ia)));qa++}}}break;case "nodes_main":f=q;for(v=0;v<f.length;v++)if(p=f[v],O=u[p.id]){qa={};N=E=D=0;w=O;ia=p;na=w;for(var C={},x=0;x<na.u.length;x++){var R=na.u[x];C[R.c]=[R.b.join("")]}na=C;for(C=0;C<ia.hb.length;C++)x=
ia.hb[C][0],x in na&&(na[x]=[ia.hb[C][1]]);for(C=x=0;C<w.s.length;C++)R=w.s[C],"node_out"==R.a&&(na["USE_OUT_"+R.c]=[-1<B.indexOf(ia.outputs[x])|0],x++);w=na;ia=p;na=O.s;C=qa;x=w;for(R=0;R<na.length;R++){var L=na[R];switch(L.a){case "node_in":var A=ia.inputs[D];if(null!==ia.Qw[D]){if(("MATERIAL_BEGIN"==ia.id&&3===D||!x.MATERIAL_EXT&&("MATERIAL_BEGIN"==ia.id&&4===D||"MATERIAL_END"==ia.id&&3===D||"MATERIAL_END"==ia.id&&4===D||"MATERIAL_END"==ia.id&&5===D)||"TEXTURE_COLOR"==ia.id||"TEXTURE_NORMAL"==
ia.id)&&L.g){C[L.c]=ia.Qw[D];D++;continue}var Q=L.h.join(" ")+" ",Q=Q+(A+"="+ia.Qw[D]+";");l(g(Q))}C[L.c]=A;D++;break;case "node_out":A=ia.outputs[E];if(!L.g||-1<B.indexOf(A))Q=L.h.join(" ")+" ",Q+=A+";",l(g(Q)),C[L.c]=A;E++;break;case "node_param":"vert"==a?A=ia.oe[N]:"frag"==a&&(A=ia.X[N]),C[L.c]=A,N++}}n.push("{");h(p,O.m,qa,w);n.push("}")}break;case "txt":l(f.b);break;default:H.D("Unknown element type: "+f.a)}}}function e(a,b){var c;c=m(a,M,t,!0,b);for(var d=[],f=0;f<c.length;f++)if(c[f]instanceof
Object)switch(c[f].a){case "conditional_expr":var e=d.pop(),h=d.pop();d.pop()?d.push(h):d.push(e);break;case "logical_or_expr":for(var h=d.pop(),g=0;g<c[f].l-1;g++)e=d.pop(),h=h||e;d.push(h);break;case "logical_and_expr":h=d.pop();for(g=0;g<c[f].l-1;g++)e=d.pop(),h=h&&e;d.push(h);break;case "logical_bitor_expr":h=d.pop();for(g=0;g<c[f].l-1;g++)h|=d.pop();d.push(h);break;case "logical_bitxor_expr":h=d.pop();for(g=0;g<c[f].l-1;g++)h^=d.pop();d.push(h);break;case "logical_bitand_expr":h=d.pop();for(g=
0;g<c[f].l-1;g++)h&=d.pop();d.push(h);break;case "equal_expr":e=d.pop();h=d.pop();d.push(h==e);break;case "non_equal_expr":e=d.pop();h=d.pop();d.push(h!=e);break;case "le_expr":e=d.pop();h=d.pop();d.push(h<=e);break;case "ge_expr":e=d.pop();h=d.pop();d.push(h>=e);break;case "l_expr":e=d.pop();h=d.pop();d.push(h<e);break;case "g_expr":e=d.pop();h=d.pop();d.push(h>e);break;case "left_shift_expr":h=d.pop();e=d.pop();d.push(h<<e);break;case "right_shift_expr":h=d.pop();e=d.pop();d.push(h>>e);break;case "add_expr":h=
d.pop();e=d.pop();d.push(h+e);break;case "sub_expr":h=d.pop();e=d.pop();d.push(h-e);break;case "mul_expr":h=d.pop();e=d.pop();d.push(h*e);break;case "div_expr":h=d.pop();e=d.pop();d.push(h/e);break;case "mod_expr":h=d.pop();e=d.pop();d.push(h%e);break;case "pre_inc_expr":case "post_inc_expr":e=d.pop();d.push(++e);break;case "pre_dec_expr":case "post_dec_expr":e=d.pop();d.push(--e);break;case "positive_expr":e=d.pop();d.push(+e);break;case "negative_expr":e=d.pop();d.push(-e);break;case "one_compl_expr":e=
d.pop();d.push(~e);break;case "logic_negative_expr":e=d.pop();d.push(!e);break;default:H.D("Unknown operation type: "+c[f].a)}else e=c[f],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(e)?(d.push(0),0!=e.indexOf("USE_NODE_")&&(h=K[K.length-1],h in w||(w[h]=[]),-1==w[h].indexOf(e)&&(w[h].push(e),z.error("Undefined directive '"+e+"' in shader '"+h+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[f]));1==d.length?c=d[0]:(H.D("Incorrect expression: "+c.join(" ")),c=void 0);return c}
function h(a,b,c,d){for(var f=0;f<b.length;f++){var g=b[f];switch(g.a){case "node_cond":a:for(var N=a,g=g.f,K=c,m=d,k=0;k<g.length;k++){var v=g[k];switch(v.a){case "node_if":case "node_elif":if(e(v.i,m)){h(N,v.m,K,m);break a}break;case "node_else":h(N,v.m,K,m);break a;case "node_ifdef":(v.c in M||v.c in m)&&h(N,v.m,K,m);break;case "node_ifndef":v.c in M||v.c in m||h(N,v.m,K,m)}}break;case "txt":N=[];for(K=0;K<g.b.length;K++)m=g.b[K],m in c?N.push(c[m]):N.push(m);l(N,d)}}}function g(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}
function l(b,c){var d=b;if(!p.Yb&&"frag"==a){var f=d.join(" ");L&&(f.match(/[^;]*;/)?(f=f.replace(/[^;]*;/,""),L=!1):f="");f=f.replace(/GLSL_OUT [^;]*;/g,"");f.match(/GLSL_OUT(?:$| [^;]*)/)&&(f=f.replace(/GLSL_OUT(?:$| [^;]*)/,""),L=!0);f=f.replace(/ {2,}/g," ");(f=f.trim())?d=f.split(" "):d=[]}b=d;b.length&&(d=m(b,M,t,!1,c),n.push(d.join(" ")))}function m(a,b,c,d,f){var e=[];v(a,b,c,d,e,f);return e}function v(a,b,c,d,f,e){for(var h=0;h<a.length;h++){var g=a[h];if(e&&g in e)g=e[g];else if(g in b)g=
b[g];else{f.push(g);continue}0==g.length&&d?f.push(0):v(g,b,c,d,f,e)}}var q=c.Rf,n=[],M=f(a,c),t={},K=[c[a]],w={},u={},B=[],C;for(C in q)for(var x in q[C].inputs)B.push(q[C].inputs[x]);var L=!1;d(b);var D=0,E=0,N=0;return n.join("\n")}function q(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function E(a){aa.deleteProgram(a.Dh);aa.deleteShader(a.uu);aa.deleteShader(a.bs);delete Z[a.py]}function J(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return A(a);case 2:return"vec2("+
A(a[0])+","+A(a[1])+")";case 3:return"vec3("+A(a[0])+","+A(a[1])+","+A(a[2])+")";case 4:return"vec4("+A(a[0])+","+A(a[1])+","+A(a[2])+","+A(a[3])+")";case 9:return"mat3("+A(a[0])+","+A(a[1])+","+A(a[2])+","+A(a[3])+","+A(a[4])+","+A(a[5])+","+A(a[6])+","+A(a[7])+","+A(a[8])+")";case 16:return"mat4("+A(a[0])+","+A(a[1])+","+A(a[2])+","+A(a[3])+","+A(a[4])+","+A(a[5])+","+A(a[6])+","+A(a[7])+","+A(a[8])+","+A(a[9])+","+A(a[10])+","+A(a[11])+","+A(a[12])+","+A(a[13])+","+A(a[14])+","+A(a[15])+")";default:H.D("Wrong glsl value dimension")}}
function A(a){return a%1?String(a):String(a)+".0"}function I(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var C=r("__assets"),v=r("__config"),l=r("__debug"),z=r("__print"),H=r("__util"),p=v.H,Q=v.pg,y=v.ge,Z={},S={},G=null,D={},X="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.Su=0;a.mG=1;a.lG=2;a.pG=4;a.oG=8;a.nG=16;a.jG=32;var V=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,L=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ba=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,pa=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
Y=new Int16Array(2),ha=null,U=null,ga=null,ca=0,M=0,la=[],aa=null,P=!1;a.mf=function(a){aa=a};a.ia=d;a.$M=c;a.eQ=function(a){a.ei=H.bh(b(a.bg,a.Ae));d(a,"PRECISION",v.H.precision);"highp"==v.H.precision?d(a,"EPSILON",J(1E-6)):d(a,"EPSILON",J(1E-4));d(a,"CONSTANTS_HACK",p.oy|0);d(a,"SRGB",p.srgb_type);d(a,"COMPARED_MODE",p.Go|0)};a.jU=function(a){return a.bg};a.cU=function(a){return a.Ae};a.VM=function(a){var b=JSON.stringify(a.bg)+JSON.stringify(a.Ae)+JSON.stringify(a.ei)+JSON.stringify(a.Rf),c=Z[b];
if(c)return c;var d=a.Ae,f=k(y.shaders_path,a.bg),d=k(y.shaders_path,d);if(!f||!d)return null;var f=t("vert",f,a),d=t("frag",d,a),c=0,h=n(d,V);a.fF=h;h>Q.nx&&(c|=1);ha||(ha=new Uint32Array(Q.Vs));U||(U=new Uint32Array(Q.jx));ga||(ga=new Uint32Array(Q.Ws));u(d,U,Q.jx)||(c|=2);u(f,ga,Q.Ws)||(c|=4);h=p.Yb?(f.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(f.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.kA=h;h>Q.ox&&(c|=8);e(d)||(c|=16);a.status=c;if(0===
a.status){var c=aa,g=q(c,f,c.VERTEX_SHADER),m=q(c,d,c.FRAGMENT_SHADER),h=c.createProgram();c.attachShader(h,g);c.attachShader(h,m);c.linkProgram(h);for(var g={uu:g,bs:m,Dh:h,attributes:{},Gl:{},Kp:H.ej(),Lx:H.ej(),Mx:{},Om:!0,it:!1,rF:H.ej(),qF:H.ej(),ab:H.bh(a),py:b,Bf:!0},v=c.getProgramParameter(h,c.ACTIVE_ATTRIBUTES),m=0;m<v;m++){var z=c.getActiveAttrib(h,m).name;g.attributes[z]=c.getAttribLocation(h,z)}v=c.getProgramParameter(h,c.ACTIVE_UNIFORMS);for(m=0;m<v;m++)z=c.getActiveUniform(h,m).name.split("[0]").join(""),
g.Gl[z]=c.getUniformLocation(h,z);Z[b]=c=g;h=!aa.getShaderParameter(c.bs,aa.COMPILE_STATUS);g=!aa.getShaderParameter(c.uu,aa.COMPILE_STATUS);m=!aa.getProgramParameter(c.Dh,aa.LINK_STATUS);h?l.UD(c.bs,b,d):g?l.UD(c.uu,b,f):m&&l.HP(c.Dh,b,f,d);if(h||g||m)a.status|=32,c=null}else c=null;return c};a.rO=function(){P=!1;if(b4w.module_check("shader_texts"))P=!0;else{for(var a=[],b=C.AT_TEXT,c=0;c<X.length;c++){var d=H.zh(y.shaders_path+X[c]);a.push({id:X[c],type:b,url:d})}b=function(a,b){G||(G={});G[b]=
a};a.length?C.enqueue(a,b,function(){P=!0}):z.error("Shaders have not been found.")}};a.SA=function(){return P};a.FT=function(){return la};a.aC=function(){return Z};a.cleanup=function(){for(var a in Z)E(Z[a]);for(var b in S)delete S[b];for(var c in la)delete la[c];ga=U=ha=null;D={}};a.jK=E;a.GT=function(a){var b=a.ei;z.log("Shader: "+a.bg+" "+a.Ae+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)z.log("  "+b[a][0],b[a][1])};a.N=J;a.TA=function(a,b){return b in a.Gl?!0:!1};a.reset=function(){aa=
null}};b4w.module.__geometry=function(a,r){function d(){return{length:0,frames:1,Vb:0,Gi:0,offset:0,Lk:0}}function c(a,b){for(var c=b.a_tbn_quat,d=b.a_position,f=c.length,e=d.length,h=1;h<a.eb.length;h++)for(var g=a.eb[h].cf,m=a.eb[h].op,g=g.a_position,l=0;l<e;l++)d[l]+=m*g[l];d=aa;for(h=0;h<f;h+=4){e=c.subarray(h,h+4);d.set(U.Wl);for(l=1;l<a.eb.length;l++)g=a.eb[l].cf,m=a.eb[l].op,m=Y.slerp(U.Wl,g.a_tbn_quat,m,P),Y.normalize(m,m),Y.multiply(m,d,d);Y.multiply(d,e,e)}}function b(a){return 65536<a.Ha?ba.cC()?
!1:!0:!1}function g(a){return 0<a.ma.length?!0:!1}function n(a,b,c){if(!g(a))return a;c||pa.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ha*(b||1)+", will use drawArrays","color: #aa0");b=a.ma;c=a.Ha;var d=a.pa,f=a.aa,e;for(e in d){var h=d[e],m=A(h,c);d[e]=x(b,h,m)}for(d=0;d<f.length;d++){var l=f[d];for(e in l)h=l[e],m=A(h,c),l[e]=x(b,h,m)}for(d=0;d<a.eb.length;d++){e=a.eb[d].cf;for(var v in e)h=e[v],m=A(h,c),e[v]=x(b,h,m)}a.Ha=b.length;a.ma=new Uint16Array(0);return a}
function x(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),f=0;f<a.length;f++)for(var e=a[f],h=0;h<c;h++)d[c*f+h]=b[c*e+h];return d}function e(){return{zd:null,Kb:Q(),Tk:0,count:0,Fb:{},usage:0,fm:0,hm:0,Sc:[],Jf:null,eb:null,Zk:1,Bf:!0}}function u(a,b){var c=a.Fb[b];if(c){var d=X(b);return G(a.Kb,d).subarray(c.offset,c.offset+c.length)}U.D("extract_array() failed; invalid name: "+b)}function w(b,c){var d;switch(c){case a.Tl:case a.Jn:d=W.STATIC_DRAW;break;
case a.Nq:d=W.DYNAMIC_DRAW;break;default:U.D("Wrong draw_mode")}b.usage=d}function h(a,b,c){function d(a,b){f[a]||(f[a]=0);f[a]+=b}var f={},e;for(e in a[0]){var h=a[0][e],g=X(e);d(g,h.length*a.length)}for(e in b)h=b[e],g=X(e),d(g,h.length);if(c){a=c.pq.length;g=X("a_part_ts");d(g,4*a);g=X("a_part_r");d(g,4*a);b=c.Rm;for(e in b)g=X(e),d(g,b[e].Vb*a);c=c.cu;for(e in c)g=X(e),d(g,a)}return f}function m(a){a.zd?(a.Jf||(a.Jf=W.createBuffer()),W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,a.Jf),W.bufferData(W.ELEMENT_ARRAY_BUFFER,
a.zd,a.usage),a.fm=a.zd.byteLength):a.fm=0;for(var b=a.hm=0;b<a.Kb.length;b++){var c=a.Kb[b].type,d=Z(a.Sc,c);-1==d&&(a.Sc.push({Ri:null,type:c,EL:U.uF()}),d=a.Sc.length-1);c=a.Sc[d];c.Ri||(c.Ri=W.createBuffer());W.bindBuffer(W.ARRAY_BUFFER,c.Ri);W.bufferData(W.ARRAY_BUFFER,a.Kb[b].Kh,a.usage);a.hm+=a.Kb[b].Kh.byteLength}}function B(a,b){a.U=L.wk(a.U,b);a.Z=L.ko(a.Z,b);a.va=L.lo(a.va,b);a.fd=L.lv(a.fd,b)}function k(a){for(var b=a[0],c=a[0],d=p("JOIN_"+a.length+"_SUBMESHES"),f=0,e=0;e<a.length;e++)f+=
a[e].ma.length;d.ma=new Uint32Array(f);var h=f=0;if(0<a[0].eb.length)for(var g=0;g<a[0].eb.length;g++){for(e=0;e<a.length;e++)f+=a[e].eb[g].cf.a_position.length,h+=a[e].eb[g].cf.a_tbn_quat.length;e={a_position:new Float32Array(f),a_tbn_quat:new Float32Array(h)};d.eb.push({op:a[0].eb[g].op,cf:e})}for(e=f=0;e<a.length;e++)f+=a[e].Ha;d.Ha=f;for(var m in c.pa){for(e=f=0;e<a.length;e++)f+=a[e].pa[m].length;d.pa[m]=new Float32Array(f)}for(m in c.aa[0]){for(e=f=0;e<a.length;e++)f+=a[e].aa[0][m].length;for(e=
0;e<c.aa.length;e++)d.aa[e]=d.aa[e]||{},d.aa[e][m]=new Float32Array(f)}e=d.pf;e.U=L.yk(b.pf.U);h=f=0;g=[];for(c=0;c<a.length;c++){var l=a[c],v=l.ma,k=l.Ha,K=l.pa;m=l.pf.va;L.fw(e.U,l.pf.U);L.aM(e.va,m);L.iw(l.pf.fd,g);for(m=0;m<v.length;m++)d.ma[f+m]=v[m]+h;var f=f+v.length,q;for(q in K){var v=K[q],z=h*A(v,k);d.pa[q].set(v,z)}for(m=0;m<l.aa.length;m++){var K=l.aa[m],n=d.aa[m];for(q in K)v=K[q],z=h*A(v,k),n[q].set(v,z)}h+=k}e.Z=L.Ar(U.f32(g),!0);if(0<d.eb.length)for(c=0;c<d.eb.length;c++)for(q=d.eb[c].cf,
m=f=e=0;m<a.length;m++)h=a[m].eb[c].cf,q.a_position.set(h.a_position,e),q.a_tbn_quat.set(h.a_tbn_quat,f),e+=h.a_position.length,f+=h.a_tbn_quat.length;a[0].ff&&(d.ff={pq:b.ff.pq,zy:b.ff.zy,PE:!0,cu:b.ff.cu,Rm:b.ff.Rm,Or:b.ff.Or});return d}function f(a,b,c){b=b.pf;for(var d=L.sd(),f=L.Cr(),e=[],h=0;h<c.length;h++)L.wk(a.pf.U,c[h],d),L.fw(b.U,d),L.lv(a.pf.fd,c[h],f),L.iw(f,e);b.Z=L.Ar(U.f32(e),!0);b.fd=L.yK(b.Z);b.va=L.Lo(b.Z)}function F(a,b,c,d,f,e){var h=a.submeshes[b],g=h.base_length,m=p("SUBMESH_"+
a.name+"_"+a.materials[b].name);m.Ha=g;var v=!1;if(E(c,"a_texcoord")){var k=null,z=a.materials[b];b=a.submeshes[b];if(z.texture_slots.length)switch(z=z.texture_slots[0],z.texture_coords){case "UV":k=q(b,z.uv_layer,a.name);break;case "ORCO":for(var K=a.b4w_boundings.bb_src,k=new Float32Array(2*b.base_length),z=(K.max_x+K.min_x)/2,M=(K.max_y+K.min_y)/2,y=K.max_x-K.min_x,K=K.max_y-K.min_y,w=0,u=0;u<b.position.length;u+=3)k[w++]=(b.position[u]-z)/y+.5,k[w++]=(b.position[u+1]-M)/K+.5}null===k&&(k=new Float32Array(2*
b.base_length));b=k}else b=new Float32Array(0);if(E(c,"a_orco_tex_coord")){for(var k=a.b4w_boundings.bb_src,z=new Float32Array(3*h.base_length),M=h.position,y=k.max_x-k.min_x,K=k.max_y-k.min_y,w=k.max_z-k.min_z,B=u=0;B<M.length;B+=3)y?z[u++]=U.clamp(parseFloat(((M[B]-k.min_x)/y).toFixed(5)),0,1):z[u++]=.5,K?z[u++]=U.clamp(parseFloat(((M[B+1]-k.min_y)/K).toFixed(5)),0,1):z[u++]=.5,w?z[u++]=U.clamp(parseFloat(((M[B+2]-k.min_z)/w).toFixed(5)),0,1):z[u++]=.5;k=z}else k=new Float32Array(0);z=h.group;if(E(c,
"a_influence")&&d){M=new Float32Array(4*g);y=z.length/g;K=new Float32Array(y);for(w=0;w<y;w++){K[w]=-1;for(var C in d)if(u=d[C],u.UF===w){K[w]=u.Uv;break}}B=3<y?y:4;d=new Float32Array(B);C=new Uint32Array(B);for(var w=new Float32Array(4),u=new Float32Array(B),B=new Uint32Array(B),x=new Float32Array(4),I=0;I<g;I++)d.set(u),C.set(B),w.set(x),M.set(J(z,y,I,g,K,d,C,w),4*I)}else M=new Float32Array(0);d=M;f=f?U.S(f):{};f.a_color={Sk:!0};f.a_color.src=E(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,
Mf:7}]:[];m.pa.a_texcoord=b;m.pa.a_influence=d;m.pa.a_orco_tex_coord=k;d=m.pa;C=h.vertex_colors;b=h.color;k=a.name;z=[];for(M=0;M<C.length;M++)z.push(C[M].name);for(var N in f)if(M=f[N].src,M.length){for(K=y=0;K<M.length;K++)y+=U.xl(M[K].Mf);d[N]=new Float32Array(y*g);for(K=w=0;K<M.length;K++){var qa=M[K].name,u=M[K].Mf,B=U.WD(u),x=z.indexOf(qa);if(-1==x)pa.warn('vertex color "'+qa+'" for mesh "'+k+'" not found'),I=7;else{for(var I=C[x].mask,D,A=D=0;A<x;A++)D+=U.xl(C[A].mask);D*=g}A=U.xl(I);(u&I)!==
u&&pa.error("Wrong color extraction from "+qa+" to "+N+' for the mesh "'+k+'".');for(qa=0;qa<g;qa++)for(var Q=0;3>Q;Q++)if(B[Q]){var F=U.Ym(I,Q);d[N][qa*y+(w+U.Ym(u,Q))]=-1==x?0:b[D+qa*A+F]}w+=A}}else d[N]=new Float32Array(0);N=a.name;D=m.pa;if(e)for(var H in e)D[e[H]]=q(h,H,N);m.ma=new Uint32Array(h.indices);H=h.position.length/g/3;N=E(c,"a_tbn_quat")&&h.tbn_quat.length?!0:!1;D=E(c,"a_shade_tangs")&&h.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(v=!0);for(f=0;f<H;f++){e=t(h,g,N,D,f);if(v)if(d=
{},d.name=a.b4w_shape_keys[f].name,m.eb.push(d),f){d.cf=e;d.op=a.b4w_shape_keys[f].value;continue}else d.cf=t(h,g,N,D,f),d.op=1;m.aa.push(e)}if(1<H&&!v){a=m.aa[0];e={};for(var r in a)e[r]=new Float32Array(a[r]);m.aa.push(e)}E(c,"a_polyindex")&&(n(m,1,!0),m.pa.a_polyindex=l(m));h=h.boundings;c=m.pf;c.U=L.sd();c.U.max_x=h.bb.max_x;c.U.max_y=h.bb.max_y;c.U.max_z=h.bb.max_z;c.U.min_x=h.bb.min_x;c.U.min_y=h.bb.min_y;c.U.min_z=h.bb.min_z;r=h.rbb;a=h.caxis_x;g=h.caxis_y;v=h.caxis_z;e=h.be_ax;c.Z=L.fo(a,
g,v,h.be_cen);ga.scale(c.Z.Ea,e[0],c.Z.Ea);ga.scale(c.Z.Fa,e[1],c.Z.Fa);ga.scale(c.Z.Ga,e[2],c.Z.Ga);c.va=L.Lo(c.Z);ga.copy(r.rbb_c,c.fd.M);ga.copy(a,c.fd.Ea);ga.copy(g,c.fd.Fa);ga.copy(v,c.fd.Ga);h=r.rbb_s;ga.scale(c.fd.Ea,h[0],c.fd.Ea);ga.scale(c.fd.Fa,h[1],c.fd.Fa);ga.scale(c.fd.Ga,h[2],c.fd.Ga);return m}function t(a,b,c,d,f){var e={},h=new Float32Array(3*b),g=new Float32Array(c?4*b:0),m=f*b*3;h.set(a.position.subarray(m,m+3*b),0);c&&(m=f*b*4,g.set(a.tbn_quat.subarray(m,m+4*b),0));d&&(c=new Float32Array(3*
b),c.set(a.shade_tangs.subarray(0,3*b),0),e.a_shade_tangs=c);e.a_position=h;e.a_tbn_quat=g;return e}function q(a,b,c){var d=2*a.base_length,f=a.uv_layers.indexOf(b);if(-1==f)return pa.warn('uv layer "'+b+'" for mesh "'+c+'" not found'),new Float32Array(d);b=f*d;return a.texcoord.subarray(b,b+d)}function E(a,b){return-1<a.indexOf(b)?!0:!1}function J(b,c,d,f,e,h,g,m){for(var l=!0,k=0;k<c;k++){var v=b[k*f+d];if(-1!==v){var p=e[k];-1!==p&&(h[k]=v,g[k]=p,l=!1)}}if(l)return m;I(h,g,a.Qu,!1);for(k=b=0;4>
k;k++)b+=h[k];if(.01>b)return m;for(k=0;4>k;k++)h[k]/=b;if(.01>Math.abs(h[0]-1))m[0]=g[0]+1;else for(k=0;4>k;k++)m[k]=g[k]+h[k];return m}function A(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&U.D("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return d}function I(b,c,d,f){for(var e=b.length,h=e,g=!1,m=f?-1:1;1<h||g;){1<h&&(h=Math.floor(h/1.247330950103979));for(var g=!1,l=0;h+l<e;l++)if(d==a.Qu?0>m*(b[l]-b[l+h]):b[l]<b[l+h]&&f)g=b[l],b[l]=b[l+
h],b[l+h]=g,g=c[l],c[l]=c[l+h],c[l+h]=g,g=!0}}function C(a,b,c){var d=[],f=[];ga.subtract(b,a,d);ga.subtract(c,a,f);ga.normalize(d,d);ga.normalize(f,f);a=U.clamp(ga.dot(d,f),-1,1);return Math.acos(a)}function v(a,b){var c=[];if(g(b))for(var d=b.ma,f=d.length/3,e=0;e<f;e++){var h=new Float32Array(9),m=d[3*e];h[0]=a[3*m];h[1]=a[3*m+1];h[2]=a[3*m+2];m=d[3*e+1];h[3]=a[3*m];h[4]=a[3*m+1];h[5]=a[3*m+2];m=d[3*e+2];h[6]=a[3*m];h[7]=a[3*m+1];h[8]=a[3*m+2];c[e]=h}else for(e=0;e<a.length;e++)h=new Float32Array(9),
h[0]=a[9*e],h[1]=a[9*e+1],h[2]=a[9*e+2],h[3]=a[9*e+3],h[4]=a[9*e+4],h[5]=a[9*e+5],h[6]=a[9*e+6],h[7]=a[9*e+7],h[8]=a[9*e+8],c[e]=h;return c}function l(a){for(var b=new Float32Array(a.Ha),c=0;c<a.Ha;c++)b[c]=c%3/2;return b}function z(a,b,c){var d=ga.dist(a,b);a=ga.dist(a,c);b=ga.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function H(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),d=0;d<a;d++)c.set(b,8*d);return c}function p(a){return{name:a,Ha:0,ma:null,aa:[],pa:{a_influence:new Float32Array(0),
a_color:new Float32Array(0),a_texcoord:new Float32Array(0)},eb:[],pf:{U:L.sd(),Z:L.qg(),va:L.fh(),fd:L.Cr()},ff:null}}function Q(a){var b=[],c;for(c in a)b.push(y(c,a[c]));return b}function y(a,b){return{Kh:new (D(a))(b),type:a}}function Z(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function S(a,b){var c=Z(a,b);return-1==c?null:a[c].Ri}function G(a,b){var c=Z(a,b);return-1==c?null:a[c].Kh}function D(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;
case "unsigned_byte":return Uint8Array;default:return Float32Array}}function X(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function V(a,
b,c,d){var f=X(b);b=Z(a,f);switch(f){case "float":a[b].Kh.set(c,d);break;case "short":for(f=0;f<c.length;f++)a[b].Kh[d+f]=U.$o(c[f]);break;case "unsigned_byte":for(f=0;f<c.length;f++)a[b].Kh[d+f]=U.tR(c[f])}}var L=r("__boundings"),ba=r("__extensions"),pa=r("__print"),Y=r("__quat"),ha=r("__tsr"),U=r("__util"),ga=r("__vec3"),ca=new Float32Array(3),M=new Float32Array(3),la=new Float32Array(3),aa=new Float32Array(4),P=new Float32Array(4),ma=new Float32Array(8);a.Jn=10;a.Nq=20;a.Qu=0;a.YS=1;a.Tl=a.Jn;
var W=null;a.Yl="float";a.aT="short";a.bT="unsigned_byte";a.mf=function(a){W=a};a.WE=function(a,f,g){b(a)&&n(a);var l=a.ma,k=a.Ha,v=a.aa,p={},q;for(q in a.pa)q in g&&!g[q].Sk||(p[q]=a.pa[q]);g=e();0<a.eb.length&&c(a,v[0]);q=a.ff;if(l.length){var z=l.length;if(65536>=k)var l=new Uint16Array(l),M=W.UNSIGNED_SHORT;else l=new Uint32Array(l),M=W.UNSIGNED_INT}else z=k,l=null;for(var y=h(v,p,q),y=Q(y),t={},K=0;K<y.length;K++)t[y[K].type]=0;var u={},B;for(B in p){var C=p[B],x=C.length;if(x){var I=X(B),K=
u[B]=d();K.length=x;K.Vb=A(C,k);K.offset=t[I];V(y,B,C,t[I]);t[I]+=x}}p=v.length;for(B in v[0])if(C=v[0][B],I=X(B),x=C.length,C=A(C,k),x)for(K=u[B]=d(),K.length=x,K.frames=p,K.Vb=C,K.offset=t[I],1<p&&(K=u[B+"_next"]=d(),K.length=x,K.frames=p,K.Vb=C,K.offset=t[I]+x),K=0;K<p;K++)C=v[K][B],I=X(B),V(y,B,C,t[I]),t[I]+=x;if(q){v=q.pq;B=q.zy;var p=q.Rm,x=q.cu,I=q.PE,k={a_part_ts:{data:[],Vb:4},a_part_r:{data:[],Vb:4}},D;for(D in p)k[D]={data:[],Vb:p[D].Vb};for(D in x)k[D]={data:[],Vb:1};for(C=0;C<v.length;C++){K=
v[C];I&&B&&!q.Or&&(K=ha.multiply(B,v[C],ma));!I&&q.Or&&ga.subtract(v[C],B,v[C]);k.a_part_ts.data.push(K[0],K[1],K[2],K[3]);k.a_part_r.data.push(K[4],K[5],K[6],K[7]);for(D in p)for(var K=p[D].Vb,L=0;L<K;L++)k[D].data.push(p[D].data[C*K+L]);for(D in x)k[D].data.push(x[D][0])}for(D in k)v=X(D),V(y,D,k[D].data,t[v]),B=d(),B.Vb=k[D].Vb,B.offset=t[v],B.Lk=1,B.length=k[D].data.length,u[D]=B,t[v]+=B.length;g.Zk=q.pq.length}g.count=z;g.zd=l;g.Kb=y;g.Tk=M;g.Fb=u;w(g,f);m(g);g.eb=a.eb;return g};a.hR=c;a.RN=
b;a.QN=g;a.bu=n;a.wF=function(a,b,c){w(a,b);a.count=c.length;a.zd=c;a.Tk=c instanceof Uint16Array?W.UNSIGNED_SHORT:W.UNSIGNED_INT};a.vF=function(a,b,c,f){var e=a.Fb,h=e[b],g=X(b);if(h)c&&h.Vb!=c&&U.D('invalid num_comp for "'+b+'"'),V(a.Kb,b,f,h.offset);else{h=Z(a.Kb,g);-1==h&&(a.Kb.push(y(g,0)),h=a.Kb.length-1);var g=a.Kb[h].Kh,l=new g.constructor(g.length+f.length);l.set(g);a.Kb[h].Kh=l;V(a.Kb,b,f,g.length);b=e[b]=d();b.Vb=c;b.offset=g.length;b.length=f.length}m(a)};a.dM=u;a.FU=function(a){a.usage=
W.STATIC_DRAW};a.AO=function(a){a.usage=W.DYNAMIC_DRAW};a.bz=m;a.uq=function(a,b,c,d){W.bindBuffer(W.ARRAY_BUFFER,a.Sc[Z(a.Sc,b)].Ri);W.bufferSubData(W.ARRAY_BUFFER,U.Oh*d,c)};a.hK=function(a){a.Jf&&W.deleteBuffer(a.Jf);for(var b=0;b<a.Sc.length;b++)a.Sc[b].Ri&&W.deleteBuffer(a.Sc[b].Ri);a.Sc.length=0};a.uC=function(a,b){return a.submeshes[b].base_length?!1:!0};a.au=function(a,b){for(var c=0;c<a.aa.length;c++){var d=a.aa[c].a_position;ha.transform_vectors(d,b,d,0);d=a.aa[c].a_tbn_quat;0<d.length&&
ha.pF(d,b,d,0);(d=a.aa[c].a_shade_tangs)&&0<d.length&&ha.transform_dir_vectors(d,b,d,0)}(c=a.pa.au_center_pos)&&c.length&&ha.transform_vectors(c,b,c,0);B(a.pf,b)};a.gR=function(a,b){var c=a.pa.au_center_pos;if(c&&c.length){var d=new Float32Array(c);ha.transform_vectors(d,b,d,0);for(var f=0;f<a.aa.length;f++)for(var e=0;e<d.length;e++)a.aa[f].a_position[e]+=d[e]-c[e];c.set(d)}else U.D('Attribute "au_center_pos" is missing in particle submesh');B(a.pf,b)};a.uJ=B;a.fR=function(a,b){var c=a.Ha,d;for(d in b){var f=
b[d].length;a.pa[d]=new Float32Array(f*c);for(var e=0;e<c;e++)for(var h=0;h<f;h++)a.pa[d][e*f+h]=b[d][h]}};a.VE=k;a.zO=function(a,b,c){if(!a.Ha)return p("EMPTY");var d=c.length;65536<a.Ha*d&&!ba.cC()&&n(a,d);var e=a.ma,h=a.Ha,g=a.pa,m=a.aa,l;for(l in b){var k=b[l].length,v=k*h;g[l]=new Float32Array(v);for(var q=0;q<h;q++)for(v=0;v<k;v++)g[l][q*k+v]=b[l][v]}b=p("CLONE_"+d+"_SUBMESHES");b.Ha=h*d;b.ma=new Uint32Array(e.length*d);for(q=0;q<d;q++)for(k=e.length*q,l=h*q,v=0;v<e.length;v++)b.ma[k+v]=e[v]+
l;for(var K in g)for(e=g[K],v=e.length*d,k=A(e,h),b.pa[K]=new Float32Array(v),q=0;q<d;q++)l=h*k*q,b.pa[K].set(e,l);for(K in m[0])for(q=0;q<m.length;q++)for(e=m[q][K],v=e.length*d,k=A(e,h),b.aa[q]=b.aa[q]||{},b.aa[q][K]=new Float32Array(v),v=0;v<d;v++)switch(g=c[v],l=h*k*v,K){case "a_position":ha.transform_vectors(e,g,b.aa[q][K],l);break;case "a_tbn_quat":ha.pF(e,g,b.aa[q][K],l);break;case "a_shade_tangs":ha.transform_tangents(e,g,b.aa[q][K],l);break;default:U.D("Wrong attribute name: "+K)}f(a,b,c);
return b};a.FA=f;a.jw=F;a.gM=function(a){var b=a.Ha,c=a.aa[0].a_position,d=new Float32Array(12*b);a=new Uint32Array(4*a.ma.length);for(var f=new Float32Array(4*b),e=0;e<b;e++){d[12*e]=c[3*e];d[12*e+1]=c[3*e+1];d[12*e+2]=c[3*e+2];d[12*e+3]=c[3*e];d[12*e+4]=c[3*e+1];d[12*e+5]=c[3*e+2];d[12*e+6]=c[3*e];d[12*e+7]=c[3*e+1];d[12*e+8]=c[3*e+2];d[12*e+9]=c[3*e];d[12*e+10]=c[3*e+1];d[12*e+11]=c[3*e+2];a[6*e]=4*e+2;a[6*e+1]=4*e+1;a[6*e+2]=4*e;a[6*e+3]=4*e+2;a[6*e+4]=4*e;a[6*e+5]=4*e+3;var h=Math.random();f[4*
e]=h;f[4*e+1]=h;f[4*e+2]=h;f[4*e+3]=h}c=p("HALO");c.aa[0]={};c.Ha=4*b;c.aa[0].a_position=d;c.pa.a_halo_bb_vertex=H(b);c.pa.a_random_vals=f;c.ma=a;return c};a.BN=E;a.HB=function(a,b,c){for(var d=[],f=0;f<a.submeshes.length;f++){var e=F(a,f,b,null,c,null);e.Ha&&d.push(e)}return d.length?1==d.length?d[0]:k(d):p("EMPTY")};a.FR=function(a,b,c,d){var f=a.zd,e=u(a,"a_position"),h=b.IO,g=b.JO;b=b.LL;for(var m=f,l=m.length/3,k=0;k<l;k++){var v=m[3*k],K=m[3*k+1],q=m[3*k+2],p=e[3*v+1],z=e[3*v+2],n=e[3*K+1],
M=e[3*K+2],y=e[3*q+1],t=e[3*q+2];h[3*k]=(e[3*v]+e[3*K]+e[3*q])/3;h[3*k+1]=(p+n+y)/3;h[3*k+2]=(z+M+t)/3}ha.transform_vectors(h,c,g);c=g.length/3;for(e=0;e<c;e++)h=g[3*e]-d[0],m=g[3*e+1]-d[1],l=g[3*e+2]-d[2],b[e]=h*h+m*m+l*l;d=f;f=b.length;if(!(2>f))for(g=f,e=!1;1<g||e;)for(1<g&&(g=Math.floor(g/1.247330950103979)),e=!1,c=0;g+c<f;c++)0>b[c]-b[c+g]&&(e=b[c],b[c]=b[c+g],b[c+g]=e,e=d,h=c,m=c+g,l=e[3*h],k=e[3*h+1],v=e[3*h+2],e[3*h]=e[3*m],e[3*h+1]=e[3*m+1],e[3*h+2]=e[3*m+2],e[3*m]=l,e[3*m+1]=k,e[3*m+2]=
v,e=!0);f=d;W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,a.Jf);W.bufferData(W.ELEMENT_ARRAY_BUFFER,f,W.DYNAMIC_DRAW)};a.RQ=I;a.DA=function(a,b,c){for(var d=b.length/3,f=a.length/3,e=[],h=Array(3),g=Array(3),m=Array(3),l=0;l<f;l++){for(var k=a[3*l],v=a[3*l+1],K=a[3*l+2],q=0;3>q;q++)h[q]=b[3*k+q],g[q]=b[3*v+q],m[q]=b[3*K+q];if(c)var q=C(h,g,m),p=C(g,m,h),z=Math.PI-q-p;else z=p=q=1;var n=e,M;M=h;var y=m,t=[],w=[],N=[];ga.subtract(g,M,t);ga.subtract(y,M,w);ga.cross(t,w,N);ga.normalize(N,N);M=N;for(y=0;3>y;y++)t=
3*v+y,w=3*K+y,n[3*k+y]=q*M[y],n[t]=p*M[y],n[w]=z*M[y]}if(c)for(var qa in c)for(l=c[qa],a=0;3>a;a++){b=3*l[0]+a;for(f=1;f<l.length;f++)h=3*l[f]+a,e[b]+=e[h];for(f=1;f<l.length;f++)h=3*l[f]+a,e[h]=e[b]}for(l=0;l<d;l++){c=l;qa=e;a=new Float32Array(3);for(b=0;3>b;b++)f=3*c+b,a[b]=qa[f];ga.normalize(a,a);for(b=0;3>b;b++)f=3*c+b,qa[f]=a[b]}return e};a.EA=function(a,b,c){for(var d={},f=b.length/3,e=0;e<f;e++){var h=String(b[3*e])+String(b[3*e+1])+String(b[3*e+2]);d[h]=[]}b=a.length;for(e=0;e<b;e++)f=a[e],
h=String(c[3*f])+String(c[3*f+1])+String(c[3*f+2]),h in d&&d[h].push(f);return d};a.nw=function(a,b,c,d){var f;f=v(a.aa[0].a_position,a);if(c){var e;e=a.aa[0].a_tbn_quat;for(var h=e.length/4,g=new Float32Array(3*h),m=0;m<h;m++){var l=aa;l[0]=e[4*m];l[1]=e[4*m+1];l[2]=e[4*m+2];l[3]=e[4*m+3];l=ga.transformQuat(U.AXIS_Y,l,ca);g[3*m]=l[0];g[3*m+1]=l[1];g[3*m+2]=l[2]}e=v(g,a)}g=f.length;m=new Float32Array(g);for(a=0;a<g;a++){var k=f[a];ca.set(k.subarray(0,3));M.set(k.subarray(3,6));la.set(k.subarray(6));
m[a]=Math.sqrt(z(ca,M,la))}h=new Float32Array(g);h[0]=m[0];for(a=1;a<g;a++)h[a]=h[a-1]+m[a];g=h[m.length-1];m=[];for(a=0;a<b;a++){var l=g*U.Uf(d),l=U.kr(h,l,0,h.length-1),k=c?e[l]:f[l],q=d;(l=ca)||(l=new Float32Array(3));var K=k[0],p=k[1],n=k[2],y=k[3],t=k[4],w=k[5],u=k[6],B=k[7],k=k[8],C=U.Uf(q),q=U.Uf(q);1<C+q&&(C=1-C,q=1-q);var N=1-C-q;l[0]=N*K+C*y+q*u;l[1]=N*p+C*t+q*B;l[2]=N*n+C*w+q*k;c?(m[a]=new Float32Array(4),ga.normalize(l,l),l=Y.rotationTo(U.AXIS_Y,l,aa),m[a][0]=l[0],m[a][1]=l[1],m[a][2]=
l[2],m[a][3]=l[3]):(m[a]=new Float32Array(3),m[a][0]=l[0],m[a][1]=l[1],m[a][2]=l[2])}return m};a.Tr=l;a.gV=z;a.PB=H;a.bE=function(a,b,c){a=a.aa[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.av=function(a,b,c){var d=a.K[0].R;a=a.o.nf;for(var f=1;f<a.length;f++)a[f].name==b&&(a[f].value=c);for(f=0;f<d.length;f++)if(!d[f].Ff&&d[f].me&&!d[f].di){b=d[f].da;c=X("a_position");var e=G(b.Kb,c);W.bindBuffer(W.ARRAY_BUFFER,
S(b.Sc,c));var h=b.Fb.a_position;c=d[f];var g=a;if(h){for(var m=h.offset,h=h.length+m,l=c.da.eb[0].cf.a_position,k=m;k<h;k++)e[k]=l[k-m];for(k=1;k<c.da.eb.length;k++){var l=c.da.eb[k].cf.a_position,v=g[k].value;if(v)for(var K=m;K<h;K++)e[K]+=v*l[K-m]}W.bufferSubData(W.ARRAY_BUFFER,U.Oh*m,e.subarray(m))}e=X("a_tbn_quat");c=G(b.Kb,e);W.bindBuffer(W.ARRAY_BUFFER,S(b.Sc,e));m=b.Fb.a_tbn_quat;b=d[f];e=a;if(m){g=m.offset;m=m.length+g;h=b.da.eb[0].cf.a_tbn_quat;k=aa;for(l=g;l<m;l+=4){k[0]=0;k[1]=0;k[2]=
0;for(v=k[3]=1;v<b.da.eb.length;v++){var K=b.da.eb[v].cf.a_tbn_quat,q=e[v].value;if(q){var p=P;p[0]=K[l-g];p[1]=K[l+1-g];p[2]=K[l+2-g];p[3]=K[l+3-g];K=Y.slerp(U.Wl,p,q,P);Y.multiply(K,k,k)}}v=P;v[0]=h[l-g];v[1]=h[l-g+1];v[2]=h[l-g+2];v[3]=h[l-g+3];K=0<v[3];Y.multiply(k,v,v);(0<v[3]&&!K||0>v[3]&&K)&&Y.scale(v,-1,v);c[l]=U.$o(v[0]);c[l+1]=U.$o(v[1]);c[l+2]=U.$o(v[2]);c[l+3]=U.$o(v[3])}W.bufferSubData(W.ARRAY_BUFFER,U.Oh*g,c.subarray(g))}}};a.check_shape_keys=function(a){return a.o.me};a.get_shape_keys_names=
function(a){var b=[];if(a.o)for(var c=1;c<a.o.nf.length;c++)b.push(a.o.nf[c].name);return b};a.get_shape_key_value=function(a,b){if(a.o)for(var c=1;c<a.o.nf.length;c++)if(b==a.o.nf[c].name)return a.o.nf[c].value;return 0};a.Kw=function(a,b){var c=a.o.nf;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.pj=function(a){return a&&a.o&&a.o.be?!0:!1};a.draw_line=function(b,c,d){var f=b.da;if(f){for(var e=d?c.length/3/2:c.length/3-1,h=new Float32Array(12*e),g=new Float32Array(12*e),l=
new Uint16Array(6*e),k=0;k<e;k++){if(d)var v=6*k,q=6*k+3;else v=3*k,q=3*(k+1);var p=c[v],K=c[v+1],v=c[v+2],z=c[q],n=c[q+1],q=c[q+2],M=z-p,y=n-K,t=q-v;h[12*k]=p;h[12*k+1]=K;h[12*k+2]=v;g[12*k]=M;g[12*k+1]=y;g[12*k+2]=t;h[12*k+3]=z;h[12*k+4]=n;h[12*k+5]=q;g[12*k+3]=-M;g[12*k+4]=-y;g[12*k+5]=-t;h[12*k+6]=p;h[12*k+7]=K;h[12*k+8]=v;g[12*k+6]=-M;g[12*k+7]=-y;g[12*k+8]=-t;h[12*k+9]=z;h[12*k+10]=n;h[12*k+11]=q;g[12*k+9]=M;g[12*k+10]=y;g[12*k+11]=t;l[6*k]=4*k;l[6*k+1]=4*k+1;l[6*k+2]=4*k+2;l[6*k+3]=4*k;l[6*
k+4]=4*k+3;l[6*k+5]=4*k+1}d=0;for(var w in f.Fb)c=f.Fb[w],d+=h.length/3*c.Vb;c={};c["float"]=d;d=f.Kb=Q(c);a.wF(f,b.tg,l);b=0;for(w in f.Fb)switch(c=f.Fb[w],w){case "a_position":V(d,w,h,b);c.offset=b;c.length=h.length;b+=c.length;break;case "a_direction":V(d,w,g,b);c.offset=b;c.length=g.length;b+=c.length;break;default:c.offset=b,c.length=h.length/3*c.Vb,l=new Float32Array(c.length),V(d,w,l,b),b+=c.length}m(f)}};a.nK=function(a){var b=e();if(a.zd)switch(a.Tk){case W.UNSIGNED_SHORT:b.zd=new Uint16Array(a.zd);
break;case W.UNSIGNED_INT:b.zd=new Uint32Array(a.zd)}else b.zd=null;for(var c=a.Kb,d=[],f=0;f<c.length;f++){var h=c[f].Kh,g=c[f].type;d.push({Kh:new h.constructor(h),type:g})}b.Kb=d;b.Tk=a.Tk;b.count=a.count;b.Fb=U.S(a.Fb);b.usage=a.usage;b.fm=a.fm;b.hm=a.hm;b.Jf=null;b.Bs=U.S(a.Bs);b.eb=U.S(a.eb);b.Zk=a.Zk;b.Bf=a.Bf;return b};a.ef=p;a.reset=function(){W=null};a.IN=Q;a.WP=Z;a.iU=S;a.ms=G;a.bC=D;a.nj=X;a.mC=function(a){switch(X(a)){case "float":return U.Oh;case "short":return U.Pn;case "unsigned_byte":return U.Cu;
default:return U.Oh}};a.kN=function(a){switch(X(a)){case "float":return W.FLOAT;case "short":return W.SHORT;case "unsigned_byte":return W.UNSIGNED_BYTE;default:return W.FLOAT}};a.Fq=V};b4w.module.__objects=function(a,r){function d(a){var b=a.K;a=a.o;for(var c=0;c<b.length;c++){var d=b[c].pb;d.F.outline&&a.Jg&&L.IP(d)}}function c(a){a.o.Jg=0;a=sa.indexOf(a);-1!=a&&sa.splice(a,1)}function b(a){if(a.pm)for(var b=a.K,c=0;c<b.length;c++)L.yF(b[c].pb,a)}function g(a,b){for(var c=a.K,d=b.K,f=0;f<c.length;f++){for(var e=!1,h=0;h<d.length;h++)if(c[f].pb==d[h].pb){e=!0;break}e||n(b,c[f].pb)&&Z.Xn(b,c[f].pb)}}function n(a,b){return!b.Uz&&"SPEAKER"==a.type||!b.tI&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function x(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.Vu||a.parent&&a.parent.Vu)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,d=a.b4w_collision,f=a.b4w_vehicle,h=a.b4w_floating,g=a.b4w_character,m=S.DN(a),l=Q.BA(a),k=0<a.data.b4w_shape_keys.length,v=a.b4w_dynamic_geometry;if(!(c=J.CA(a,b)||c||d||f||k||h||m||g||l||v))a:{c=a.data;for(d=0;d<c.materials.length;d++)if(f=c.materials[d],f.b4w_water||f.b4w_lens_flares||e(f.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=
Q.BA(a),d=a.b4w_do_not_batch,f=!!a.b4w_anchor,J.CA(a,b)||c||d||f;default:return!0}}function e(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,f=c.convert_to,e=c.outputs[0];if(!(!e.is_linked||"WORLD"==d&&"CAMERA"==f||"CAMERA"==d&&"WORLD"==f||"OBJECT"==d&&"OBJECT"==f))return!0}if("NORMAL_MAP"==c.type&&(d=c.space,e=c.outputs[0],e.is_linked&&("OBJECT"==d||"BLENDER_OBJECT"==d))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==
c.type&&(e=c.outputs[1],d=c.outputs[3],c.outputs[0].is_linked||e.is_linked||d.is_linked))return!0}return!1}function u(a,b){var c=a.animation_data,d=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.F.type==J.OBJ_ANIM_TYPE_OBJECT||c.F.type==J.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==b.type||c.F.type==J.nH&&"LAMP"==b.type||c.F.type==J.mH&&"WORLD"==b.type)&&b.sg.push(J.zC(null,c)));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.sg.push(J.zC(null,d.action));"MESH"==b.type&&b.sg.push.apply(b.sg,
J.TM(a))}function w(a,b,c){b=W[b]||[];for(var d=[],f=0;f<b.length;f++){var e=b[f];if(e.o.ud==c||-1==c)for(var h=e.K,g=0;g<h.length;g++)h[g].pb==a&&d.push(e)}return d}function h(a,b){var c=W[a]||[];if(-1==b)return c;for(var d=[],f=0;f<c.length;f++){var e=c[f];e.o.ud==b&&d.push(e)}return d}function m(a,b,c,d){for(var f=0;f<a.K.length;f++)for(var e=a.K[f].R,h=0;h<e.length;h++){var g=e[h];g.da&&(g.da.Bf=b);g.Bf=b;g.ib&&(g.ib.Bf=c);""!==g.Cj&&(g=y.hC(g.Cj))&&(g.WA=d)}}function B(a,b,c,d,f){for(var e=null,
h=0;h<b.length;h++){var g=b[h];if(!((c?g.Cd:g.name)!=a||g.o.ud!=d&&-1!=d||f&&!g.Zi||(e=g,Z.get_dg_parent(e))))break}return e}function k(a){W.ALL.push(a);W[a.type]||(W[a.type]=[]);W[a.type].push(a);var b=a.o.jd;if(null!=b)for(var c=0;c<wa.length;c++){var d=wa[c];d.o.jd==b&&d.Wp.push(a)}}function f(a,b){m(a,!0,!1,!0);for(var c=h("ALL",-1),d=0;d<c.length;d++){var f=c[d];f!=a&&m(f,!1,!1,!1)}L.SD(a,b);for(d=0;d<a.K.length;d++)for(f=a.K[d].R.length-1;0<=f;f--){var e=a.K[d].R[f];0!=e.Jb.length&&-1==e.Jb.indexOf(b)||
a.K[d].R.splice(f,1)}G.ka(a)&&G.remove_object(a);for(d=0;d<c.length;d++)c[d]!=a&&m(c[d],!0,!0,!0);c=a.ig.Ua;a.ig.Ua=a;return c}function F(a,b){a.ig.Ua=b;m(a,!0,!0,!0)}function t(a,b,c,d){var f=c.rc.Fj.indexOf(d);b=a.rc.Yi[a.rc.Fj.indexOf(b)];c.rc.Yi[f]=b;a=b.name;b.name=d;for(d=0;d<c.ig.data.materials.length;d++)c.ig.data.materials[d]=c.rc.Yi[d],c.rc.$k[d]=d!=f;return a}function q(a,b,c,d){for(var f=0;f<c.ig.data.materials.length;f++)c.rc.$k[f]=!1;a.rc.Yi[a.rc.Fj.indexOf(b)].name=d}function E(a,b,
c,d,f){for(var e=1;e<a.o.nf.length;e++)H.av(a,a.o.nf[e].name,a.o.nf[e].value);if(J.is_animated(a))for(e=0;e<a.fa.length;e++){var h=a.fa[e];if(h)switch(h.type){case J.OBJ_ANIM_TYPE_PARTICLES:J.set_frame(a,J.rw(a,e),e);break;case J.OBJ_ANIM_TYPE_MATERIAL:if(h.Dj)for(var g=h.Dj.length-1;0<=g;g--)-1!=h.Dj[g].Jb.indexOf(b)&&h.Dj.splice(g,1)}}d&&A.Xw(a,b,function(b){if(b.wa){var c=b.wa.name;if(d[c]){var f=b.wa.zr!=d[c].zr;b.wa=ga.S(d[c]);f&&S.set_factor(a,c,b.wa.zr)}}},"PARTICLES");f&&(e=A.Oa(a,b,"MAIN"))&&
(e.xd.set(f.xd),e.jh=f.jh,e.ih=f.ih,e.$c.set(f.$c),e.Yf.set(f.Yf),e.Ei=f.Ei,e.Rd.set(f.Rd),e.Cl=f.Cl,e.ug=f.ug,e.lg=f.lg,e.xf=f.xf,e.kl=f.kl,e.Pm=f.Pm,e.reflect_factor=f.reflect_factor,e.Vm=f.Vm,e.bf.set(f.bf),e.parallax_scale=f.parallax_scale,e.$f.set(f.$f),e.shallow_water_col.set(f.shallow_water_col),e.shallow_water_col_fac=f.shallow_water_col_fac,e.shore_water_col.set(f.shore_water_col),e.shore_water_col_fac=f.shore_water_col_fac,e.foam_factor=f.foam_factor,e.gk=f.gk,e.Gg=ga.S(f.Gg),e.Bd=ga.S(f.Bd));
A.Xw(a,b,function(b){for(var d=0;d<b.Ve.length;d++){var f=b.Ve[d],e=b.Sa[d];if("IMAGE"==e.source||"ENVIRONMENT"==e.source){var h=ha.Bw(c,f);h&&e.rj!=h.rj&&ha.zQ(a,f,h)}}})}var J=r("__animation"),A=r("__batch"),I=r("__boundings"),C=r("__camera"),v=r("__config"),l=r("__constraints"),z=r("__container"),H=r("__geometry"),p=r("__lights"),Q=r("__nla"),y=r("__nodemat"),Z=r("__obj_util"),S=r("__particles"),G=r("__physics"),D=r("__print"),X=r("__primitives"),V=r("__quat"),L=r("__scenes"),ba=r("__subscene"),
pa=r("__sfx"),Y=r("__transform"),ha=r("__textures"),U=r("__tsr"),ga=r("__util"),ca=r("__vec3"),M=r("__armature"),la=r("__anchors"),aa=r("__renderer"),P=v.H,ma=v.Ic,W={ALL:[]},ka=new Float32Array(24),da=0,va=0,wa=[],sa=[],ta=new Float32Array(3),ea=new Float32Array(4);a.Mu=0;a.Lu=1;a.Cc=2;a.DATA_ID_ALL=-1;a.update=function(a){for(var b=0;b<sa.length;b++){var f=sa[b],e=f,h=a,g=0,m=e.wD;0==m.du&&(m.du=h);h-=m.du;if(m.Wx&&h/m.kf>=m.Wx)c(e);else{h%=m.kf;if(h<m.Hx)switch(m=h/(m.Hx/5),h=Math.floor(m),h){case 0:g=
(m-h)/2;break;case 1:g=(m-h)/2+.5;break;case 2:g=1;break;case 3:g=1-(m-h)/2;break;case 4:g=.5-(m-h)/2}e.o.Jg=g}f.o.Jg&&d(f)}if(a=W.ARMATURE)for(b=0;b<a.length;b++)f=a[b],f.Ax&&(Y.L(f),f.Ax=!1)};a.set_outline_intensity=function(a,b){a.o.Jg=b;d(a)};a.apply_outline_anim=function(a,b,c,d){var f=a.wD;f.du=0;f.Hx=b;f.kf=c;f.Wx=d;-1==sa.indexOf(a)&&sa.push(a)};a.clear_outline_anim=c;a.bk=function(a,b){b.Pi=a.uuid;b.Zi=!0;if(a.b4w_dynamic_geometry){b.ig=a;for(var c=0;c<a.data.materials.length;c++){var d=
a.data.materials[c];b.rc.Fj.push(d.name);b.rc.Yi.push(d);b.rc.$k.push(!1)}}u(a,b);a.Vu=b.is_dynamic=x(a,b);a.uI=!0;b.Ce=a.b4w_vehicle;b.is_character=a.b4w_character;b.bl=a.b4w_floating;b.xn=a.b4w_collision;b.Tb=a.b4w_collision_id;b.yr=a.b4w_correct_bounding_offset;c=a.game;b.Kg={Lp:c.physics_type,Bq:c.use_ghost,NF:c.use_sleep,wh:c.mass,RF:c.velocity_min,QF:c.velocity_max,rB:c.damping,YD:c.rotation_damping,sO:c.lock_location_x,tO:c.lock_location_y,uO:c.lock_location_z,vO:c.lock_rotation_x,wO:c.lock_rotation_y,
xO:c.lock_rotation_z,Do:c.collision_margin,Bo:c.collision_group,Eo:c.collision_mask,ez:c.use_collision_bounds,vr:c.collision_bounds_type,yq:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.Le={name:c.name,Fe:c.part,jR:c.suspension_rest_length,Ey:c.suspension_compression,Gy:c.suspension_stiffness,Fy:c.suspension_damping,oz:c.wheel_friction,cy:c.roll_influence,mx:c.max_suspension_travel_cm,cp:c.force_max,no:c.brake_max,jn:c.steering_max,Jm:c.max_speed_angle,So:c.delta_tach_angle,kq:c.speed_ratio,
nq:c.steering_ratio,qp:c.inverse_control,Ok:c.floating_factor,Nl:c.water_lin_damp,Ol:c.water_rot_damp,$E:c.synchronize_position};if(c=a.b4w_floating_settings)b.rm={name:c.name,Fe:c.part,Ok:c.floating_factor,Nl:c.water_lin_damp,Ol:c.water_rot_damp,$E:c.synchronize_position};if(c=a.b4w_character_settings)b.NA={wS:c.walk_speed,TP:c.run_speed,dR:c.step_height,ZN:c.jump_strength,yS:c.waterline};for(c=0;c<a.constraints.length;c++)d=a.constraints[c],"RIGID_BODY_JOINT"==d.type&&b.Nx.push({target:d.target.Ua,
eP:d.pivot_type,fP:d.pivot_x,gP:d.pivot_y,hP:d.pivot_z,Ea:d.axis_x,Fa:d.axis_y,Ga:d.axis_z,jS:d.use_limit_x,kS:d.use_limit_y,lS:d.use_limit_z,fS:d.use_angular_limit_x,gS:d.use_angular_limit_y,hS:d.use_angular_limit_z,jO:d.limit_max_x,kO:d.limit_max_y,lO:d.limit_max_z,mO:d.limit_min_x,nO:d.limit_min_y,oO:d.limit_min_z,dO:d.limit_angle_max_x,eO:d.limit_angle_max_y,fO:d.limit_angle_max_z,gO:d.limit_angle_min_x,hO:d.limit_angle_min_y,iO:d.limit_angle_min_z});c=b.o=Z.No("MESH"===b.type?b.is_dynamic?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.Ua,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.Hp=a.parent_bone),a.pinverse_tsr&&(b.vt=U.create(),U.copy(a.pinverse_tsr,b.vt))):a.dg_parent&&(b.parent=a.dg_parent.Ua,b.Lj=!0);var d=a.location,f=a.scale[0];ga.Sx(a.rotation_quaternion,ea);Y.set_translation(b,d);Y.set_rotation(b,ea);Y.set_scale(b,f);b.zq=a.b4w_use_default_animation;b.mk=J.$u(a.b4w_anim_behavior);a.b4w_object_tags&&(b.Zs={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,
category:a.b4w_object_tags.category});b.Hr=a.b4w_custom_prop;a.b4w_viewport_alignment&&(b.tu={yI:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});c.hide=a.b4w_hidden_on_load;switch(a.type){case "ARMATURE":M.bk(a,b);d=c.zf;f=J.FJ(d);a.b4w_animation_mixing?(c.Pd=new Float32Array(f.wb),c.he=new Float32Array(f.wb),c.Td=new Float32Array(f.trans),c.ke=new Float32Array(f.trans)):(c.Pd=f.wb,c.he=f.wb,c.Td=f.trans,c.ke=f.trans);for(var e in d){var h=d[e];1==h.rr.length&&M.ER(h,
!0,f.trans,f.wb)}c.Pp=f;c.Be=0;c.Rh=a.b4w_animation_mixing;break;case "MESH":b.DC=a.data.is_boundings_overridden;c.jm=a.b4w_do_not_render;c.Uh=A.mJ(a.data.b4w_boundings.bb);c.Qj=ma.outlining_overview_mode||a.b4w_selectable;c.nt=a.b4w_selectable;c.Ic=ma.outlining_overview_mode||a.b4w_outlining;c.mt=a.b4w_outlining;c.ot=ma.outlining_overview_mode||a.b4w_outline_on_select;c.ng=a.b4w_billboard;c.ho=a.b4w_pres_glob_orientation;c.jo="BASIC";c.io="SPHERICAL"==a.b4w_billboard_geometry;e=c.Ah;e.Gj=a.b4w_outline_settings.outline_duration;
e.Hj=a.b4w_outline_settings.outline_period;e.Ij=a.b4w_outline_settings.outline_relapses;c.Qj&&(c.bj=ga.QB(da),da++);for(e=0;e<a.data.b4w_vertex_anim.length;e++)d=a.data.b4w_vertex_anim[e],b.Kc.push({name:d.name,sa:d.frame_start,Za:d.frame_end,lT:d.averaging,mT:d.averaging_interval,zI:d.allow_nla});b.o.Kc=b.Kc.length?!0:!1;"MESH"!=a.type&&ga.D("Wrong object type: "+a.name);e=b.o;if(a.data.b4w_shape_keys.length)for(e.me=!0,d=0;d<a.data.b4w_shape_keys.length;d++)f={},f.value=a.data.b4w_shape_keys[d].value,
f.name=a.data.b4w_shape_keys[d].name,e.nf.push(f);else e.me=!1;c.ie=a.b4w_shadow_cast;c.Gd=a.b4w_shadow_receive;c.Qd=a.b4w_shadow_cast_only&&c.ie;c.Ed=a.b4w_reflexible;c.md=a.b4w_reflexible_only&&c.Ed;c.ld=a.b4w_reflective;c.Mg=a.b4w_reflection_type;if(!c.ld)for(e=a.data.materials,d=0;d<e.length;d++)f=e[d],f.use_nodes&&-1!=f.node_tree.Uu.indexOf("BSDF_GLOSSY")&&(c.ld=!0,c.Mg="CUBE");c.og=a.b4w_caustics;if(c.Ud=a.b4w_wind_bending)c.Ql=a.b4w_wind_bending_angle,e=A.aG(a.b4w_wind_bending_angle,c.Uh,a.scale[0]),
c.Ne=e,c.Oe=a.b4w_wind_bending_freq,c.ye=a.b4w_detail_bending_freq,c.xe=a.b4w_detail_bending_amp,c.te=a.b4w_branch_bending_amp,c.pi=a.b4w_main_bend_stiffness_col,e=a.b4w_detail_bend_colors,c.ae.$w=e.leaves_stiffness_col,c.ae.Zw=e.leaves_phase_col,c.ae.Ix=e.overall_stiffness_col;c.be=a.b4w_dynamic_geometry;"MESH"!==a.type&&ga.D("Wrong object");e=a.data.materials[0];c.um=e.physics.friction;c.mm=e.physics.elasticity;c.Dg=0;c.De=Z.Mn;c.Eg=a.b4w_lod_transition;c.ut=a.pass_index;break;case "LINE":c.U=I.sd();
c.Z=I.qg();c.Pa=I.sd();c.jb=I.qg();break;case "CAMERA":C.LJ(a,b);C.dJ(b);break;case "LAMP":p.$N(a,b);break;case "SPEAKER":b.Y=pa.TK();e=!1;for(c=0;c<b.K.length;c++)if(b.K[c].pb.Dc){e=!0;break}e&&pa.bk(a,b);break;case "EMPTY":e=I.sd(),c.U=e,e=I.fh(),c.va=e,a.field&&(b.pm={type:a.field.type,TE:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,im:a.b4w_anchor.detect_visibility,gj:a.b4w_anchor.element_id,GO:a.b4w_anchor.max_width})}k(b)};a.bS=function(a,b){b.Pi=a.uuid;b.Zi=!0;u(a,b);
a.Vu=b.is_dynamic=x(a,b);a.uI=!0;b.o=Z.No(b.type);b.zq=a.b4w_use_default_animation;b.mk=J.$u(a.b4w_anim_behavior);k(b)};a.OR=function(a,b){var c=b.o;if(b.parent){!b.Lj&&b.Kg.yq&&b.parent.Kg.yq&&(b.xn=!1);for(var d=!1,f=0;f<b.K.length;f++)if(b.K[f].pb.jc){d=!0;break}if(f=d)f=b.Kg,f=b.Ce||b.bl||b.is_character||b.xn&&!f.Bq&&0<f.wh&&("DYNAMIC"==f.Lp||"RIGID_BODY"==f.Lp);if(f)f=b.Lj?U.copy(c.v,U.create()):c.v,U.multiply(b.parent.o.v,f,c.v),Y.set_translation(b,U.get_trans_view(c.v)),Y.set_scale(b,U.get_scale(c.v)),
Y.set_rotation(b,U.get_quat_view(c.v));else if(b.Lj||!b.Hp)if(f=U.copy(c.v,U.create()),b.tu&&"CAMERA"==b.parent.type){f={distance:b.tu.distance,rotation:U.get_quat_view(f)};switch(b.tu.yI){case "TOP_LEFT":f.top=0;f.left=0;break;case "TOP":f.top=0;f.left=.5;break;case "TOP_RIGHT":f.top=0;f.right=0;break;case "LEFT":f.top=.5;f.left=0;break;case "CENTER":f.top=.5;f.left=.5;break;case "RIGHT":f.top=.5;f.right=0;break;case "BOTTOM_LEFT":f.bottom=0;f.left=0;break;case "BOTTOM":f.bottom=0;f.left=.5;break;
case "BOTTOM_RIGHT":f.bottom=0,f.right=0}l.append_stiff_viewport(b,b.parent,f)}else l.DI(b,b.parent,f);else f=U.copy(c.v,U.create()),l.EI(b,b.parent,b.Hp,f)}if("ARMATURE"==b.type)for(d=a.pose.bones,f=0;f<d.length;f++){var e=d[f],h=e.constraints;if(h)for(var m=0;m<h.length;m++){var v=h[m];"COPY_TRANSFORMS"!=v.type||v.subtarget||v.mute||l.SI(b,v.target.Ua,e.name,ga.Sz,ga.Wl)}}if("MESH"==b.type){if(f=J.$B(a)){m=f.Ua;d=m.o.Pp;e=b.o;h=a.data;b.er=m;h=h.vertex_groups;if(h.length){var m=m.o.zf,v=0,q={},
p;for(p in m){var z=ga.keysearch("name",p,h);z&&(q[p]={UF:z.index,Vh:m[p].Vh,Uv:v++})}e.Wh=q;p=v;h=J.fC();e.Fg=p;p>2*h?(e.xj=!1,D.error('too many bones for "'+a.name+'" / '+e.Fg+" bones (max "+h+" with blending, "+2*h+" without blending). Skinning will be disabled.")):e.xj=!0}p=J.hM(d.trans,d.wb,c.Wh);f.b4w_animation_mixing?(c.Pd=new Float32Array(p.wb),c.he=new Float32Array(p.wb),c.Td=new Float32Array(p.trans),c.ke=new Float32Array(p.trans)):(c.Pd=p.wb,c.he=p.wb,c.Td=p.trans,c.ke=p.trans);c.Zn=new Float32Array(4);
c.Yn=V.create();c.Pp=p;c.Be=0}if(c.ld)if(c=b.o,"CUBE"==c.Mg)c.td=va++;else if("PLANE"==c.Mg){a:{p=a.constraints;for(f=0;f<p.length;f++)if(d=p[f],"LOCKED_TRACK"==d.type&&"REFLECTION PLANE"==d.name){if(d.target.Ua){p=d.target.Ua;break a}D.warn('Reflection plane target "'+d.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}p=null}p||(p=ga.sq("%reflection%"),p=Z.Mo(p,"EMPTY"),f=Z.No("EMPTY"),p.o=f,g(b,p),l.eA(p,b,[0,0,0],null,1),k(p));f=null;for(d=0;d<wa.length;d++)if(wa[d]==
p){f=d;break}null==f&&(f=wa.length,wa.push(p));p.o.jd=f;c.jd=f;p.Wp.push(b)}}};a.JR=b;a.AT=g;a.UJ=n;a.PR=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.o||"DYNAMIC"!=c.o.type&&"CAMERA"!=c.o.type||Y.L(c);c.zq&&J.uD(c)&&(J.apply_def(c),c.fa.length&&J.play(c,null,J.SLOT_ALL))}};a.get_meta_tags=function(a){return ga.S(a.Zs)};a.get_custom_prop=function(a){return a.Hr};a.cleanup=function(){va=da=0;wa.length=0;sa.length=0;W={ALL:[]}};a.copy=function(a,b,c){var d=b,f=Z.get_dg_parent(a);b=f?Z.RB(f.name,
b):b;if(B(b,W.ALL,!1,-1)){for(var f=1,e;;){e="."+(3>String(f).length?("000"+String(f)).slice(-3):String(f));if(!B(b+e,W.ALL,!1,-1))break;f++}D.error('Object "'+b+'" already exists. Name was replaced by "'+b+e+'".');d+=e;b+=e}d=Z.Mo(b,a.type,d);d.Zi=a.Zi;d.ig=a.ig;d.rc.Fj=Z.dm(a.rc.Fj);d.rc.Yi=Z.dm(a.rc.Yi);d.rc.$k=Z.dm(a.rc.$k);d.is_dynamic=a.is_dynamic;d.sp=a.sp;d.zq=a.zq;d.sg=a.sg;d.o=Z.zv(a.o);d.Zs=Z.Ko(a.Zs);d.Hr=Z.Ko(a.Hr);g(a,d);d.$q=Z.dm(a.$q);d.parent=Z.dm(a.parent);d.Lj=a.Lj;d.Hp=a.Hp;d.Kc=
Z.dm(a.Kc);d.mk=a.mk;!a.J||a.Ce||a.is_character||a.bl||(d.xn=a.xn,d.J=null);d.Tb=a.Tb;d.yr=a.yr;d.Kg=Z.Ko(a.Kg);b=[];for(f=0;f<a.K.length;f++){var h=d.K[f];e=a.K[f].R;if(c){for(var h=h.R,m=0;m<e.length;m++)if(!e[m].Ff){var l=Z.Ko(e[m]);l.da=H.nK(e[m].da);h.push(l);b.push(e[m].da)}for(m=0;m<e.length;m++)if(e[m].Ff){l=Z.Ko(e[m]);h.push(l);for(var v=0;v<b.length;v++)b[v]==e[m].da&&(l.da=h[v].da)}for(m=0;m<h.length;m++)h[m].da&&H.bz(h[m].da),P.Yu&&aa.gJ(h[m]),h[m].Ej=A.NM(h[m],d.o,d.Pi),A.zR(h[m]);ha.JQ(h)}else h.R=
e}c||(d.o.wn=!1);Z.iy(d,!1);k(d);d.o.Gs=!0;d.o.Hs=c;d.o.bj=ga.QB(da);da++;return d};a.update_boundings=function(a){for(var b=a.o,c=a.K[0].R,d,f,e,h,g,m,l,k,v,q,p,N,z=[],n=0;n<c.length;n++){var M=c[n];if("MAIN"==M.type){var y=H.nj("a_position");if(y=H.ms(M.da.Kb,y)){var t=M.da.Fb.a_position.offset;d=h=y[t];f=g=y[t+1];e=m=y[t+2]}}}for(n=0;n<c.length;n++)if(M=c[n],M.da&&M.jb&&M.Pa&&(y=H.nj("a_position"),y=H.ms(M.da.Kb,y))){var t=M.da.Fb.a_position.offset,w=M.da.Fb.a_position.length+t;l=q=y[t];k=p=y[t+
1];v=N=y[t+2];for(var u=t;u<w;u+=3){var t=y[u],B=y[u+1],C=y[u+2];l=Math.max(t,l);k=Math.max(B,k);v=Math.max(C,v);q=Math.min(t,q);p=Math.min(B,p);N=Math.min(C,N)}M.U.max_x=l.toFixed(3);M.U.max_y=k.toFixed(3);M.U.max_z=v.toFixed(3);M.U.min_x=q.toFixed(3);M.U.min_y=p.toFixed(3);M.U.min_z=N.toFixed(3);I.wk(M.U,b.v,M.Pa);I.GB(M.Pa,ka);for(y=z.length=0;y<ka.length;y++)z.push(ka[y]);M.jb=I.Ar(z,!0);M.Z=I.BJ(M.jb,b.v);M.va=I.Lo(M.Z);M.gb=I.Lo(M.jb);M.Je=I.Fs(M.Z,M.va);"MAIN"==M.type&&(d=Math.max(l,d),f=Math.max(k,
f),e=Math.max(v,e),h=Math.min(q,h),g=Math.min(p,g),m=Math.min(N,m))}z={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(f.toFixed(3)),max_z:parseFloat(e.toFixed(3)),min_x:parseFloat(h.toFixed(3)),min_y:parseFloat(g.toFixed(3)),min_z:parseFloat(m.toFixed(3))};l=d-h;k=f-g;v=e-m;h=.5*(d+h);q=.5*(f+g);N=.5*(e+m);var x=h,D=N;g=Math.max(l,Math.max(k,v))/2;m=Math.max(l,v)/2;var L=[h/(l?l:1),q/(k?k:1),N/(v?v:1)];p=.5;if(b.ng)t=Math.max(Math.abs(z.max_x),Math.abs(z.min_x)),B=Math.max(Math.abs(z.max_y),Math.abs(z.min_y)),
C=Math.max(Math.abs(z.max_z),Math.abs(z.min_z)),e=Math.sqrt(t*t+B*B+C*C),n=Math.sqrt(t*t+B*B),z.max_x=z.max_y=z.max_z=e,z.min_x=z.min_y=z.min_z=-e,m=n,g=e,d=new Float32Array([0,0,0]),y=new Float32Array([g,g,g]),e=new Float32Array([0,0,0]);else{for(n=0;n<c.length;n++)if(M=c[n],"MAIN"==M.type&&(y=H.nj("a_position"),y=H.ms(M.da.Kb,y)))for(w=c[n].da.Fb,t=w.a_position.offset,w=w.a_position.length+t,u=t;u<w;u+=3){var t=y[u],B=y[u+1],C=y[u+2],R=Math.sqrt((h-t)*(h-t)+(q-B)*(q-B)+(N-C)*(N-C));if(R>g){var M=
h-g*(t-h)/R,E=q-g*(B-q)/R,R=N-g*(C-N)/R;h=(M+t)/2;q=(E+B)/2;N=(R+C)/2;g=Math.sqrt((h-t)*(h-t)+(q-B)*(q-B)+(N-C)*(N-C))}E=Math.sqrt((x-t)*(x-t)+(D-C)*(D-C));E>m&&(M=x-m*(t-x)/E,R=D-m*(C-D)/E,x=(M+t)/2,D=(R+C)/2,m=Math.sqrt((x-t)*(x-t)+(D-C)*(D-C)));t/=l?l:1;B/=k?k:1;C/=v?v:1;R=Math.sqrt((L[0]-t)*(L[0]-t)+(L[1]-B)*(L[1]-B)+(L[2]-C)*(L[2]-C));R>p&&(M=L[0]-p*(t-L[0])/R,E=L[1]-p*(B-L[1])/R,R=L[2]-p*(C-L[2])/R,L[0]=(M+t)/2,L[1]=(E+B)/2,L[2]=(R+C)/2,p=Math.sqrt((L[0]-t)*(L[0]-t)+(L[1]-B)*(L[1]-B)+(L[2]-
C)*(L[2]-C)))}n=l?l*L[0]:d;f=k?k*L[1]:f;e=v?v*L[2]:e;d=new Float32Array([h,q,N]);y=new Float32Array([p*l,p*k,p*v]);e=new Float32Array([n,f,e]);m=parseFloat(m.toFixed(3))}b.U=z;A.qQ(b,m,m,z);n=I.ov(g,d);b.va=n;e=I.fo([y[0],0,0],[0,y[1],0],[0,0,y[2]],e);b.Z=e;Y.L(a);if(P.debug_view)for(n=0;n<c.length;n++)if("DEBUG_VIEW"===c[n].type&&c[n].di){a=X.ds(1,e.M);H.bE(a,[e.Ea[0],e.Fa[1],e.Ga[2]],e.M);H.bu(a,1,!0);a.pa.a_polyindex=H.Tr(a);A.yR(c[n],a);break}};a.Ib=w;a.kC=function(a,b,c){b=W[b]||[];for(var d=
[],f=0;f<b.length;f++){var e=b[f];if((e.o.ud==c||-1==c)&&e.Zi)for(var h=e.K,g=0;g<h.length;g++)h[g].pb==a&&d.push(e)}return d};a.get_all_objects=h;a.get_first_character=function(a){var b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];if(G.tC(d))for(var f=d.K,e=0;e<f.length;e++)if(f[e].pb==a)return d}return null};a.kt=m;a.get_selectable_objects=function(){var a=[],b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.o.Qj&&d.Zi&&a.push(d)}return a};a.get_outlining_objects=function(){var a=[],
b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.o.Ic&&d.Zi&&a.push(d)}return a};a.oc=function(b,c,d,f){var e=null,h=W.ALL;switch(b){case a.Mu:e=B(c,h,!0,d,f);break;case a.Lu:a:{for(b=0;b<h.length;b++)if(e=h[b],e.Cd==d&&(e.o.ud==f||-1==f)){var g=Z.get_dg_parent(e);if(g&&g.Cd==c)break a}e=null}break;case a.Cc:a:{for(f=0;f<h.length;f++){b=h[f];for(var e=c.length-1,g=b,m=!0;0<=e&&m;)m=g&&g.Cd==c[e]&&(g.o.ud==d||-1==d),g&&(g=Z.get_dg_parent(g)),e--;if(m&&!g){e=b;break a}}e=null}}return e};a.get_world_by_name=
function(a,b){return B("%meta_world%"+a,W.WORLD,!0,b)};a.pick_object=function(b,c){var d=L.oh();if(!d)return D.error("No active scene"),null;var f=L.Aa(d,ba.uf);f&&f.enable_hmd_stereo&&(f=z.get_canvas(),b=f.clientHeight/2,c=f.clientWidth/2);if(f=la.cP(b,c))return f;f=L.dP(d,b,c);if(!f)return null;for(var d=w(d,"MESH",-1),e=0;e<d.length;e++){var h=d[e].o,g=h.bj;if(g&&3>Math.abs(255*g[0]-f[0])&&3>Math.abs(255*g[1]-f[1])&&3>Math.abs(255*g[2]-f[2]))return h.Ic&&h.ot&&(ma.outlining_overview_mode?a.apply_outline_anim(d[e],
ma.Gj,ma.Hj,ma.Ij):(f=h.Ah,a.apply_outline_anim(d[e],f.Gj,f.Hj,f.Ij))),d[e]}return null};a.set_wind_params=function(a,c){for(var d=w(a,"EMPTY",-1),f=0;f<d.length;f++){var e=d[f];if(e.pm&&"WIND"===e.pm.type){var h=e;break}}if(!h)return D.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=ga.deg_to_rad(c.wind_dir),ca.set(Math.sin(d),-Math.cos(d),0,ta),ga.dir_to_quat(ta,ga.AXIS_Z,ea),Y.set_rotation(h,ea));"number"==typeof c.wind_strength&&(h.pm.TE=c.wind_strength);b(h)};a.remove_object=
function(a){l.VJ(a)&&l.remove(a);var b=W.ALL,c=W[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.VO=k;a.IU=function(a){return W[a.type]&&-1<W[a.type].indexOf(a)};a.kQ=function(a){var b=a.o,c=b.Ne,d=b.Oe,f=b.ye,e=b.xe,h=b.te;a=a.K;for(b=0;b<a.length;b++)for(var g=a[b].R,m=0;m<g.length;m++){var l=g[m].da,k=l.Fb,v=k.au_wind_bending_amp,q=k.au_wind_bending_freq,p=k.au_detail_bending_amp,N=k.au_detail_bending_freq,k=k.au_branch_bending_amp;if(q){var z=Array.apply(null,
Array(q.length)).map(function(){return d});H.uq(l,H.Yl,new Float32Array(z),q.offset)}v&&(z=Array.apply(null,Array(v.length)).map(function(){return c}),H.uq(l,H.Yl,new Float32Array(z),v.offset));p&&(z=Array.apply(null,Array(p.length)).map(function(){return e}),H.uq(l,H.Yl,new Float32Array(z),p.offset));N&&(z=Array.apply(null,Array(N.length)).map(function(){return f}),H.uq(l,H.Yl,new Float32Array(z),N.offset));k&&(z=Array.apply(null,Array(k.length)).map(function(){return h}),H.uq(l,H.Yl,new Float32Array(z),
k.offset))}};a.inherit_material=function(a,b,c,d){if(a.o.be&&c.o.be){var e=A.Oa(a,b,"MAIN"),h=null;A.Xw(c,d,function(a){h||(h={});a.wa&&(h[a.wa.name]=a.wa)},"PARTICLES");for(var g=f(c,d),m=t(a,b,c,d),l=L.get_active(),k=0;k<c.K.length;k++){var v=c.K[k].pb;L.set_active(v);var p=w(v,"LAMP",0),z=c.K[k].R;c.K[k].R=[];A.UB(v,[c.ig],p,[]);A.Br(c,L.ks(v),v);L.hA(v,[c]);L.append_object(v,c,!1,!0);c.K[k].R.push.apply(c.K[k].R,z)}q(a,b,c,m);F(c,g);E(c,d,a,h,e);L.set_active(l)}}};b4w.module.__obj_util=function(a,r){function d(a){a={type:a,ud:0,v:u.Ek(),Au:u.Ek(),pivot:new Float32Array(3),fc:new Float32Array(3),sj:0,tj:0,Gs:!1,Hs:!1,bj:null,Jg:0,Yj:!1,sf:h.create(),use_panning:!1,kb:0,An:1,zn:1,Bn:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,gd:!1,dof_object:null,Bb:null,Da:null,ub:null,cd:null,bd:null,Dd:null,kh:!0,Ah:{Gj:1,Hj:1,Ij:0},td:-1,jd:-1,hc:new Float32Array(4),um:0,mm:0,Bm:!1,hl:new Float32Array(3),
il:0,De:-1,Dg:0,Eg:0,jm:!1,ie:!1,Gd:!1,Qd:!1,Ed:!1,md:!1,ld:!1,Mg:"",Ud:!1,be:!1,yc:!1,hide:!1,Qj:!1,nt:!1,Ic:!1,mt:!1,ot:!1,vj:!1,is_visible:!1,ep:!1,Ql:0,Ne:0,Oe:0,ye:0,xe:0,te:0,pi:"",ae:{$w:"",Zw:"",Ix:""},rk:!1,so:new Float32Array(3),ng:!1,ho:!1,jo:"",io:!1,Be:0,lu:0,mu:0,Fg:0,Qk:!1,Kc:!1,me:!1,nf:[],xj:!1,Rh:!1,mg:1,Vn:0,Un:1,tn:new Int8Array([-1,-1]),dn:[],Xs:[],Lt:[],Pd:null,he:null,Td:null,ke:null,zf:null,Wh:null,Pp:null,Zn:null,Yn:null,Uh:null,U:x.sd(),Pa:x.sd(),va:x.fh(),gb:x.fh(),Z:x.qg(),
jb:x.qg(),fd:x.Cr(),pA:x.Cr(),eo:null,bo:null,co:null,wn:!0,Je:!1,ut:0};h.copy(w.AXIS_Z,a.sf);return a}function c(a){if(!(a instanceof Object))return a;var b=null,d=null,e=null,h=null,g=null,m=null;a.Sa&&(b=a.Sa,a.Sa=null);a.Ie&&(d=a.Ie,a.Ie=null);a.Ve&&(e=a.Ve,a.Ve=null);a.eb&&(h=a.eb,a.eb=null);a.ib&&(g=a.ib,a.ib=null);a.ne&&(m=a.ne,a.ne=null);var k;k=a.constructor;switch(k){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:k=
new k(a);break;case Array:k=new k(a.length);for(var n=0;n<a.length;n++)k[n]=c(a[n]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:k=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:k=null;break;case Function:k=a;break;default:for(n in k=new k,a)k[n]=c(a[n])}b&&(k.Sa=b,a.Sa=b);d&&(k.Ie=d,a.Ie=d);e&&(k.Ve=e,a.Ve=e);h&&(k.eb=h,a.eb=h);g&&(k.ib=g,a.ib=g);m&&(k.ne=w.ej(),a.ne=m);return k}function b(a,b){for(var c=a.K,d=0;d<c.length;d++){var f=c[d];if(f.pb==b)return f}return null}
function g(a){return{pb:a,Es:!1,R:[],Bh:[],bi:null,qy:[],Ap:0,tD:!1,ea:[],zE:[]}}function n(a){return a.Lj?a.parent:a.parent?n(a.parent):null}var x=r("__boundings"),e=r("__config"),u=r("__tsr"),w=r("__util"),h=r("__vec3"),m=r("__vec4"),B=e.H;a.Mn=-1;a.No=d;a.zv=function(a){var b=d(a.type);b.ud=a.ud;u.copy(a.v,b.v);u.copy(a.Au,b.Au);h.copy(a.pivot,b.pivot);h.copy(a.fc,b.fc);b.sj=a.sj;b.tj=a.tj;b.Gs=a.Gs;b.Hs=a.Hs;a.bj&&(b.bj=h.clone(a.bj));b.Jg=a.Jg;b.Yj=a.Yj;h.copy(a.sf,b.sf);b.use_panning=a.use_panning;
b.kb=a.kb;b.An=a.An;b.zn=a.zn;b.Bn=a.Bn;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.gd=a.gd;b.dof_object=a.dof_object;b.Bb=w.S(a.Bb);b.Da=w.S(a.Da);b.ub=w.S(a.ub);b.cd=w.S(a.cd);b.bd=w.S(a.bd);b.Dd=a.Dd;b.kh=a.kh;b.Ah.Gj=a.Ah.Gj;b.Ah.Hj=a.Ah.Hj;b.Ah.Ij=a.Ah.Ij;b.td=a.td;b.jd=a.jd;b.hc=a.hc;
b.um=a.um;b.mm=a.mm;b.Bm=a.Bm;h.copy(a.hl,b.hl);b.il=a.il;b.De=a.De;b.Dg=a.Dg;b.Eg=a.Eg;b.jm=a.jm;b.ie=a.ie;b.Gd=a.Gd;b.Qd=a.Qd;b.Ed=a.Ed;b.md=a.md;b.ld=a.ld;b.Mg=a.Mg;b.Ud=a.Ud;b.be=a.be;b.yc=a.yc;b.hide=a.hide;b.Qj=a.Qj;b.nt=a.nt;b.Ic=a.Ic;b.mt=a.mt;b.ot=a.ot;b.vj=a.vj;b.is_visible=a.is_visible;b.ep=a.ep;b.Ql=a.Ql;b.Ne=a.Ne;b.Oe=a.Oe;b.ye=a.ye;b.xe=a.xe;b.te=a.te;b.pi=a.pi;b.ae=a.ae;b.rk=a.rk;h.copy(a.so,b.so);b.ng=a.ng;b.ho=a.ho;b.jo=a.jo;b.io=a.io;b.Be=a.Be;b.lu=a.lu;b.mu=a.mu;b.Fg=a.Fg;b.Qk=
a.Qk;b.Kc=a.Kc;b.me=a.me;b.nf=w.S(a.nf);b.xj=a.xj;b.Rh=a.Rh;b.mg=a.mg;b.Vn=a.Vn;b.Un=a.Un;b.tn.set(a.tn);b.dn=w.S(a.dn);b.Xs=w.S(a.Xs);b.Lt=w.S(a.Lt);b.Pd=w.S(a.Pd);b.he=w.S(a.he);b.Td=w.S(a.Td);b.ke=w.S(a.ke);b.zf=w.S(a.zf);b.Wh=w.S(a.Wh);b.Pp=w.S(a.Pp);b.Zn=w.S(a.Zn);b.Yn=w.S(a.Yn);b.Uh=w.S(a.Uh);x.cm(a.U,b.U);x.cm(a.Pa,b.Pa);x.Gv(a.va,b.va);x.Gv(a.gb,b.gb);x.Fv(a.Z,b.Z);x.Fv(a.jb,b.jb);b.eo=w.S(a.eo);b.bo=w.S(a.bo);b.co=w.S(a.co);b.wn=a.wn;b.Je=a.Je;b.ut=a.ut;return b};a.Mo=function(a,b,c){c||
(c=a);return{name:a,Pi:w.mw(),Cd:c,type:b,Zi:!1,ig:null,rc:{Fj:[],Yi:[],$k:[]},is_dynamic:!1,sp:!1,zq:!1,DC:!1,o:null,cc:null,Y:null,nb:null,er:null,anchor:null,pm:null,Zs:null,Hr:null,K:[],Kc:[],ve:w.ej(),Ev:w.ej(),fa:[],Wp:[],Qf:[],$q:[],Og:null,zl:[],parent:null,Lj:!1,Hp:"",tu:null,vt:null,xn:!1,Tb:"",yr:"AUTO",Ce:!1,is_character:!1,bl:!1,iv:!1,J:null,I:null,Df:null,Le:null,rm:null,NA:null,Nx:[],Kg:{Lp:"NO_COLLISION",Bq:!1,NF:!1,wh:0,RF:0,QF:0,rB:0,YD:0,sO:!1,tO:!1,uO:!1,vO:!1,wO:!1,xO:!1,Do:0,
Bo:0,Eo:0,ez:!1,vr:"BOX",yq:!1},wD:{du:0,Hx:0,kf:0,Wx:0},mk:0,sg:[],Ax:!1,kD:!1,Ys:[]}};a.dm=function(a){return a instanceof Array?a.slice():a};a.zT=function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d],h={},g;for(g in e)e[g]==e.Pa?h.Pa=c(e.Pa):e[g]==e.jb?h.jb=c(e.jb):h[g]=e[g];b.push(h)}return b};a.Ko=c;a.is_dynamic=function(a){return a.is_dynamic};a.Ag=function(a){return"MESH"==a.type&&a.is_dynamic};a.Xn=function(a,b){a.K.push(g(b))};a.cr=function(a,c,d){b(a,c).R.push(d)};a.NU=function(a,b){for(var c=
a.K,d=0;d<c.length;d++)if(c[d].pb==b){c.splice(d,1);break}};a.oa=b;a.AF=function(a,b){for(var c=0;c<a.length;c++)m.copy(b,a[c].o.hc)};a.rU=g;a.iy=function(a,b,c){for(var d=0;d<a.K.length;d++){var e=a.K[d];c&&e.pb!=c||(e.Es=b)}};a.ls=function(a,b){for(var c=[],d=b?B.eD-1:B.eD,e=0;e<a.length;e++){var f=a[e];f.nb.VB&&c.length<d&&c.push(f)}return c.length?c:a[0]?[a[0]]:[]};a.KO=function(a,b){u.identity(b.v);b.bj=null;a.o=b};a.QA=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=
b.material-1,d=a.data.materials;if(0<=c&&c<d.length&&("ADD"==d[c].game_settings.alpha_blend||"ALPHA"==d[c].game_settings.alpha_blend||"ALPHA_SORT"==d[c].game_settings.alpha_blend))return!0}return!1};a.$J=function(a){a=a.K;for(var b=0;b<a.length;b++)for(var c=a[b].R,d=0;d<c.length;d++)for(var e=c[d].ab.ei,h=0;h<e.length;h++){var g=e[h];if("USE_MODEL_TSR_INVERSE"==g[0]&&"1"==g[1])return!0}return!1};a.RB=function(a,b){return a+"*"+b};a.get_parent=function(a){return a.Lj?null:a.parent};a.get_dg_parent=
n;a.sw=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];n(e)==a&&c.push(e)}return c};a.get_object_data_id=function(a){return a.o.ud};a.is_mesh=function(a){return"MESH"===a.type};a.is_armature=function(a){return"ARMATURE"===a.type};a.is_speaker=function(a){return"SPEAKER"===a.type};a.is_camera=function(a){return"CAMERA"===a.type};a.is_lamp=function(a){return"LAMP"===a.type};a.is_empty=function(a){return"EMPTY"===a.type};a.is_line=function(a){return"LINE"===a.type};a.is_world=function(a){return"WORLD"===
a.type}};b4w.module.__particles=function(a,r){function d(){h.D("_rand() undefined")}function c(a,b,c,d,e,h){var g=a.Kr,m=a.vg,q=a.time;a=a.HD;for(var n=0;n<g.length;n+=4){var p=g[n];if(q>a&&q>=p&&p>a||q<a&&(p>a||q>=p))for(p=0;8>p;p++)m[8*n+p]=d[p],f[p]=d[p];else for(p=0;8>p;p++)f[p]=m[8*n+p];p=F;p[0]=b[3*n];p[1]=b[3*n+1];p[2]=b[3*n+2];w.transform_vec3(p,f,p);e[3*n]=p[0];e[3*n+1]=p[1];e[3*n+2]=p[2];var t=k;t[0]=c[4*n];t[1]=c[4*n+1];t[2]=c[4*n+2];t[3]=c[4*n+3];w.rR(t,f,t);h[4*n]=t[0];h[4*n+1]=t[1];h[4*n+2]=
t[2];h[4*n+3]=t[3];for(p=1;4>p;p++)e[3*(n+p)]=e[3*n],e[3*(n+p)+1]=e[3*n+1],e[3*(n+p)+2]=e[3*n+2],h[4*(n+p)]=t[0],h[4*(n+p)+1]=t[1],h[4*(n+p)+2]=t[2],h[4*(n+p)+3]=t[3]}}function b(a){a?(h.bR(a),d=function(){return h.sP()}):d=function(){return Math.random()}}var g=r("__config"),n=r("__batch"),x=r("__geometry"),e=r("__textures"),u=r("__time"),w=r("__tsr"),h=r("__util"),m=r("__vec3"),B=g.H,k=new Float32Array(4),f=new Float32Array(8),F=new Float32Array(3),t=[];a.update=function(){for(var a=0;a<t.length;a++)for(var b=
t[a],d=b.K,e=0;e<d.length;e++)for(var f=b,h=d[e].R,g=0;g<h.length;g++){var m=h[g],k=m.wa;k&&k.iu&&!m.Ff&&(c(k,k.positions,k.eF,f.o.v,k.Px,k.Jy),k.jD=!0)}};a.Dx=function(a){a=a.K;for(var b=0;b<a.length;b++)for(var c=a[b].R,d=0;d<c.length;d++)if(c[d].wa)return!0;return!1};a.Ex=function(a,b){for(var c=a.K,d=0;d<c.length;d++)for(var e=c[d].R,f=0;f<e.length;f++){var h=e[f].wa;if(h&&h.name==b)return!0}return!1};a.sD=function(a){a=a.K;for(var b=0;b<a.length;b++)for(var c=a[b].R,d=0;d<c.length;d++){var e=
c[d].wa;if(e&&"EMITTER"==e.pt)return!0}return!1};a.wJ=function(a){return 0<a.particle_systems.length};a.vJ=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;return!1};a.DN=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.GN=function(a,b,c){var d=a.wa={name:b.name,pt:b.settings.type,time:0,HD:-1,iu:!1,zr:1,sa:0,Za:0,jF:0,bx:0,XC:0,
cyclic:0,wh:0,ht:0,qC:0,Nk:0,$e:0,bG:0,size:0,cA:0,bA:0,aB:0,$A:new Float32Array(16),jD:!1,positions:null,Px:null,eF:null,Jy:null,Kr:null,Vv:null,vg:null,xD:null,hF:0,iF:0};d.sa=b.settings.frame_start;d.Za=b.settings.frame_end;d.jF=(d.Za-d.sa)/u.ad();d.bx=b.settings.lifetime;d.XC=d.bx/u.ad();d.cyclic=b.settings.b4w_cyclic?1:0;d.wh=b.settings.mass;d.ht=b.settings.normal_factor;d.qC=9.81*b.settings.effector_weights.gravity;d.Nk=b.settings.b4w_fade_in/u.ad();d.$e=b.settings.b4w_fade_out/u.ad();d.bG=
b.settings.effector_weights.wind;d.iu="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,g,m;a.np?(f=c.halo.size,g=c.halo.hardness,30>g?(g=.5,m=.9):40>g?(g=.1,m=1):50>g?(g=0,m=.8):(g=0,m=.5)):(f=b.settings.particle_size,m=g=1);d.size=f;d.cA=g;d.bA=m;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(n.mb(a,"NODES",1),n.mb(a,"PARTICLE_BATCH",1),a.qj=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&B.br&&(b=b[0].texture,
f=[],e.CJ(b.color_ramp,e.Rz,f),f=new Uint8Array(f.map(function(a){return h.clamp(255*a,0,255)})),f=e.gB(f,e.Rz),n.Xi(a,f,"u_color_ramp_tex",b.name),n.mb(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(f=0;f<b;f+=4)g=c[f/4],a[f]=g.position,a[f+1]=g.color[0],a[f+2]=g.color[1],a[f+3]=g.color[2];
d.aB=c.length}d.$A.set(a)};a.HM=function(a,e,f,g){var k=a.wa,q=g.v;g=f.settings.count;var v=f.settings.frame_start/u.ad(),l=f.settings.frame_end/u.ad(),n=f.settings.lifetime/u.ad(),t=f.settings.lifetime_random,p=f.settings.emit_from,w=f.settings.factor_random;if(f.settings.use_rotations)var y=f.settings.angular_velocity_mode,B=f.settings.angular_velocity_factor;else y="NONE",B=0;var A=f.settings.b4w_randomize_emission,E=f.settings.b4w_cyclic;k.hF=f.settings.billboard_tilt;k.iF=f.settings.billboard_tilt_random;
b(f.seed);var D;e=x.HB(e,["a_position","a_tbn_quat"],null);switch(p){case "VERT":var F=e.aa[0].a_position;D=e.aa[0].a_tbn_quat;f=F.length/3;e=[];for(p=0;p<g;p++){var r=Math.round((f-1)*d());e.push(r);e.push(r);e.push(r);e.push(r)}f=[];for(p=0;p<e.length;p++)f.push(F[3*e[p]]),f.push(F[3*e[p]+1]),f.push(F[3*e[p]+2]);F=new Float32Array(f);f=[];for(p=0;p<e.length;p++)f.push(D[4*e[p]]),f.push(D[4*e[p]+1]),f.push(D[4*e[p]+2]),f.push(D[4*e[p]+3]);D=new Float32Array(f);break;case "FACE":F=[];D=[];p=[];h.Cs(0,
p);f=x.nw(e,g,!1,p);h.Cs(0,p);e=x.nw(e,g,!0,p);for(p=0;p<f.length;p++)F.push(f[p][0],f[p][1],f[p][2]),F.push(f[p][0],f[p][1],f[p][2]),F.push(f[p][0],f[p][1],f[p][2]),F.push(f[p][0],f[p][1],f[p][2]),D.push(e[p][0],e[p][1],e[p][2],e[p][3]),D.push(e[p][0],e[p][1],e[p][2],e[p][3]),D.push(e[p][0],e[p][1],e[p][2],e[p][3]),D.push(e[p][0],e[p][1],e[p][2],e[p][3]);F=new Float32Array(F);D=new Float32Array(D);break;case "VOLUME":h.D("Particle emission from volume is not supported");break;default:h.D("Wrong emit from option")}D=
[F,D];F=D[0];D=D[1];k.positions=new Float32Array(F);k.eF=new Float32Array(D);k.Px=new Float32Array(F.length);k.Jy=new Float32Array(D.length);e=[];l=(l-v)/g;for(f=0;f<g;f++)p=A?l*f+10*l*(.5-d()):l*f,E||(p+=v),e.push(p),e.push(p),e.push(p),e.push(p);v=new Float32Array(e);k.Kr=new Float32Array(v);k.Vv=new Float32Array(v);if(k.iu){k.vg=new Float32Array(8*v.length);for(A=0;A<8*v.length;A++)for(E=0;8>E;E++)k.vg[8*A+E]=q[E];c(k,F,D,q,F,D)}q=x.ef("EMITTER_PARTICLES");A=h.rg();A.a_position=F;A.a_tbn_quat=
D;q.aa[0]=A;a.tg=x.Nq;a=[];for(A=0;A<g;A++)a.push(4*A,4*A+2,4*A+1,4*A,4*A+3,4*A+2);a=new Uint16Array(a);q.ma=a;q.pa.a_p_bb_vertex=x.PB(g);q.Ha=F.length/3;a=[];t=n*t;for(A=0;A<g;A++)E=t*d(),a.push(n-E),a.push(n-E),a.push(n-E),a.push(n-E);n=q.pa;t=[];for(A=0;A<g;A++)E=Math.random(),t.push(a[4*A],v[4*A],E),t.push(a[4*A+1],v[4*A+1],E),t.push(a[4*A+2],v[4*A+2],E),t.push(a[4*A+3],v[4*A+3],E);t=new Float32Array(t);n.a_p_data=t;n=q.pa;t=[];for(a=0;a<g;a++){v=[d()-.5,d()-.5,d()-.5];m.normalize(v,v);t.push(w*
v[0]);t.push(w*v[1]);t.push(w*v[2]);switch(y){case "NONE":t.push(0);break;case "SPIN":case "VELOCITY":t.push(B);break;case "RAND":t.push(2*B*(d()-.5));break;default:h.D("Undefined velocity factor")}v=t.slice(-4);for(A=0;12>A;A++)t.push(v[A%4])}g=new Float32Array(t);n.a_p_vels=g;k.xD=new Float32Array(q.pa.a_p_data);return q};a.AQ=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f].wa;h&&h.name==b&&!e[f].Ff&&(h.HD=h.time,h.time=c)}};a.nP=function(a){for(var b=
a.Ha,c=a.aa[0].a_position,d=[],e=[],f=0;f<b;f++)e.push(c[3*f]),d.push(c[3*f+1]),e.push(c[3*f+2]);d=new Float32Array(d);e=new Float32Array(e);a.pa.a_lf_dist=d;a.pa.a_lf_bb_vertex=e;return a};a.set_size=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f].wa;h&&h.name==b&&(h.size=c)}};a.set_normal_factor=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f].wa;h&&h.name==b&&(h.ht=c)}};a.eU=function(a,b){for(var c=
a.K,d=0;d<c.length;d++)for(var e=c[d].R,f=0;f<e.length;f++){var h=e[f].wa;if(h&&h.name==b)return h.ht}return 0};a.set_factor=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f],g=h.wa;if(g&&g.name==b){g.zr=c;var m=g.Kr;if(1==c)var k=m;else if(0==c)for(var k=g.Vv,p=0;p<k.length;p+=4)k[p]=1E4,k[p+1]=k[p],k[p+2]=k[p],k[p+3]=k[p];else for(var n=4/c,k=g.Vv,q=0,p=0;p<k.length;p+=4)p>=q?(k[p]=m[p],q+=n):k[p]=1E4,k[p+1]=k[p],k[p+2]=k[p],k[p+3]=k[p];h=h.da;if(h.Fb.a_p_data){g=
g.xD;for(p=0;p<g.length;p+=3)g[p+1]=k[Math.round(p/3)];x.vF(h,"a_p_data",3,g)}}}};a.$R=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f].wa;if(h&&h.iu)for(var g=0;g<8*h.Kr.length;g++)h.vg[8*g]=b[0],h.vg[8*g+1]=b[1],h.vg[8*g+2]=b[2],h.vg[8*g+3]=b[3],h.vg[8*g+4]=c[0],h.vg[8*g+5]=c[1],h.vg[8*g+6]=c[2],h.vg[8*g+7]=c[3]}};a.SR=function(a,b,c){for(var d=[],e=0;e<c;e++)d.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.pa.a_tbn_quat=new Float32Array(d);if(b.Jp){d=[];
for(e=0;e<c;e++)d.push(e,e,e,e);a.pa[b.Jp.name]=new Float32Array(d)}};a.RR=function(a){-1==t.indexOf(a)&&t.push(a)};a.xP=function(a){a=t.indexOf(a);-1!=a&&t.splice(a,1)};a.cleanup=function(){t.length=0}};b4w.module.__primitives=function(a,r){function d(a,b,c,d){for(var h=[],f=[],g=[],m=[],n=2*c/(a-1),w=2*d/(b-1),u=0;u<a;u++)for(var B=-c+u*n,I=0;I<b;I++)if(f.push(B,-d+I*w,0),m.push(0,0,0,1),g.push(u/(a-1),I/(b-1)),u&&I){var C=u*b+I,v=C-1,l=(u-1)*b+I,z=l-1;h.push(C,v,l);h.push(v,z,l)}a=e.rg();a.a_position=new Float32Array(f);a.a_tbn_quat=new Float32Array(m);m=x.ef("GRID_PLANE");m.aa[0]=a;m.pa.a_texcoord=new Float32Array(g);m.ma=new Uint32Array(h);m.Ha=f.length/3;return m}function c(a){var b=a.length;
b%4&&e.D("Wrong array");for(var c=[],d=[],k=0;k<b;k+=4){var f=a[k+1],n=a[k+2],t=a[k+3];g(a[k],d);g(f,d);g(n,d);g(t,d);c.push(k,k+1,k+2);c.push(k,k+2,k+3)}a=e.rg();a.a_position=new Float32Array(d);b=x.ef("FROM_QUADS");b.aa[0]=a;b.ma=new Uint32Array(c);b.Ha=d.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function g(a,b){b.push(a[0],a[1],a[2])}var n=r("__config"),x=r("__geometry"),e=r("__util"),u=n.H;a.LM=function(){var a=x.ef("LINE"),b=e.rg();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.aa[0]=b;a.ma=new Uint32Array(1);a.Ha=1;return a};a.WT=function(a,b){var c=d(2,2,a,b);c.name="PLANE";return c};a.VT=d;a.EM=function(a,b,c){function d(a,b){return 1==a%2&&(0==b||b==m-1)||1==b%2&&(0==a||a==g-1)?!0:!1}var h=c/=Math.pow(2,a-1),f=c,g=b+1,m=b+1;b=[];c=[];for(var n=[],w=0,r=0,A=-1,I=[],C=0;C<a;C++){for(var v=2*h/(g-1),l=2*f/(m-1),z=[],H=[],p=0,Q=0;Q<g;Q++){for(var y=-h+Q*v,Z=[],S=0;S<m;S++){var G=-f+S*l;if(y>-w&&y<w&&G>-r&&G<r)Z.push(-1),p++;else{for(var D=
null,X=0;X<I.length;X+=3)if(y==I[X]&&G==I[X+1]){D=I[X+2];break}X=null!==D?D:A+1;d(Q,S)?(Z.push(-2),p++):(null==D&&(S&&S!=m-1&&Q&&Q!=g-1?D=v:(D=C==a-1?v:2*v,z.push(y,G,X)),c.push(y,G,D),n.push(.707,0,0,.707),A++),Z.push(X));if(Q&&S)if(1==Q)if(d(Q-1,S)){if(1<S){var G=X-1,D=H[Q-1][S+1],V=D-1;b.push(V,G,X)}else D=H[Q-1][S+1],V=D-1;b.push(D,V,X)}else d(Q,S)||(G=X-1,D=H[Q-1][S],b.push(D,G,X));else if(Q==g-1){if(!d(Q,S))if(S==m-1)G=X-1,D=H[Q-1][S-1],V=H[Q-2][S],b.push(D,G,X),b.push(V,D,X);else{var G=X-1,
D=H[Q-1][S],V=D-1,L=D+1;b.push(V,G,X);b.push(D,V,X);b.push(L,D,X);2==S&&(L=H[Q-2][S-2],b.push(V,L,G))}}else 1==S?d(Q,S-1)?(G=H[Q-1][S],D=H[Q-1][S-1],b.push(G,D,X)):(G=Z[S-1],D=H[Q-1][S],V=H[Q-2][S-1],b.push(D,G,X),b.push(D,V,G)):S==m-1?d(Q,S)||(G=Z[S-1],D=H[Q-1][S-1],V=H[Q-2][S],b.push(D,G,X),b.push(V,D,X)):-1!=H[Q-1][S]&&-1!=H[Q-1][S-1]&&-1!=Z[S-1]?(G=Z[S-1],D=H[Q-1][S],V=H[Q-1][S-1],b.push(D,G,X),b.push(D,V,G),S==m-2&&d(Q,S+1)&&(L=H[Q-1][S+1],b.push(L,D,X))):S==m-2&&d(Q,S+1)&&(D=H[Q-1][S],L=H[Q-
1][S+1],b.push(L,D,X))}}H.push(Z)}I=z;w=h;r=f;h*=2;f*=2}if(2E4>w)for(a=-(2*w)/(g-1),c.push(-2E4,-2E4,a),c.push(-2E4,2E4,a),c.push(-w,-r,a),c.push(-w,r,a),c.push(2E4,-2E4,a),c.push(2E4,2E4,a),c.push(w,-r,a),c.push(w,r,a),X=A+1,b.push(X+1,X+2,X+3,X+1,X+0,X+2,X+2,X+4,X+6,X+2,X+0,X+4,X+1,X+7,X+5,X+1,X+3,X+7,X+7,X+4,X+5,X+6,X+4,X+7),Q=0;8>Q;Q++)n.push(.707,0,0,.707);a=e.rg();a.a_position=new Float32Array(c);a.a_tbn_quat=new Float32Array(n);h=x.ef("MULTIGRID_PLANE");h.aa[0]=a;h.ma=new Uint32Array(b);h.Ha=
c.length/3;u.$F&&(x.bu(h,1,!0),a.a_polyindex=x.Tr(h));return h};a.UT=function(a){var b=a.length;b%3&&e.D("Wrong array");for(var c=[],d=[],k=0;k<b;k+=3){var f=a[k+1],n=a[k+2];g(a[k],d);g(f,d);g(n,d);c.push(k,k+1,k+2)}a=e.rg();a.a_position=new Float32Array(d);b=x.ef("FROM_TRIANGLES");b.aa[0]=a;b.ma=new Uint32Array(c);b.Ha=d.length/3;return b};a.TT=c;a.IM=function(a){a=e.oS(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],
a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};a.Gc=function(){var a=x.ef("FULLSCREEN_TRI"),b=e.rg();b.a_position=new Float32Array([0,0,1,0,0,1]);a.aa[0]=b;a.ma=new Uint32Array([0,1,2]);a.Ha=3;return a};a.JM=function(){var a=x.ef("FULLSCREEN_QUAD"),b=e.rg();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.aa[0]=b;a.ma=new Uint32Array([0,2,1,1,2,3]);a.Ha=4;return a};a.DM=function(){var a=x.ef("BILLBOARD"),b=e.rg();b.a_bb_vertex=x.PB(1);a.aa[0]=b;a.ma=new Uint32Array([0,
2,1,0,3,2]);a.Ha=4;return a};a.FM=function(){var a=x.ef("CUBEMAP_BOARD"),b=e.rg();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.aa[0]=b;a.ma=new Uint32Array([0,2,1,0,3,2]);a.Ha=4;return a};a.ds=function(a,c){var d=x.ef("UV_SPHERE"),h,k,f=[],n=[],t=[];for(k=0;8>=k;k++)for(h=0;16>=h;h++){var q=h/16,u=k/8;n.push(-a*Math.cos(2*q*Math.PI)*Math.sin(u*Math.PI)+c[0],a*Math.cos(u*Math.PI)+c[1],a*Math.sin(2*q*Math.PI)*Math.sin(u*Math.PI)+c[2])}for(k=q=0;8>k;k++)for(h=0;16>h;h++){var u=b(n,17*k+h+1),
w=b(n,17*k+h),A=b(n,17*(k+1)+h),I=b(n,17*(k+1)+h+1);Math.abs(u[1])==a+c[1]?(g(u,f),g(A,f),g(I,f),t.push(q,q+1,q+2),q+=3):Math.abs(A[1])==a+c[1]?(g(u,f),g(w,f),g(A,f),t.push(q,q+1,q+2),q+=3):(g(u,f),g(w,f),g(A,f),g(I,f),t.push(q,q+1,q+2),t.push(q,q+2,q+3),q+=4)}h={};h.a_position=f;n=x.EA(t,n,f);n=x.DA(t,f,n);h.a_tbn_quat=e.gen_tbn_quats(n);d.aa[0]=h;d.ma=t;d.Ha=f.length/3;return d};a.TB=function(a){var b=x.ef("INDEX"),c=e.rg();c.a_index=new Float32Array(3*a);for(var d=new Uint16Array(3*a),g=0;g<3*
a;g++)c.a_index[g]=g,d[g]=g;b.aa[0]=c;b.ma=d;b.Ha=3*a;return b}};b4w.module.__prerender=function(a,r){function d(a,c){var d=a.Ee;d.is_visible=!1;if(d.hide)return!1;var f=c.B,g=c.type==e.Xc?f.Rs:u.ec(f.v,B);if("STATIC"==d.type&&d.Bm)var m=d.hl,k=d.il;else m=d.gb.M,k=d.gb.Wa;var x=d.Dg,I=d.De,g=h.dist(m,g);if(!(g<x?0:I==n.Mn||g<I+d.Eg*k))return!1;d.is_visible=!0;g=a.qa;if(c.type==e.eg)return c.debug_view_mode==b.DV_BOUNDINGS?g.di:!g.di;if(c.type==e.fg&&0==d.Jg)return!1;d.wn?(k=g.gb,x=g.jb,I=g.Je):(k=d.gb,x=d.jb,I=d.Je);if(d=!g.fj)f=f.mh,d=x,x=k.M,w.XQ(x,f,k.Wa)?
d=!0:I?(k=d.Ea,I=d.Fa,g=d.Ga,x=d.M,d=w.VL(x,f,k,I,g)):d=!1;return d?!1:!0}function c(a){var b=a.wa;if(b&&b.jD){a=a.da;g.AO(a);var c=a.Fb;g.Fq(a.Kb,"a_position",b.Px,c.a_position.offset);g.Fq(a.Kb,"a_tbn_quat",b.Jy,c.a_tbn_quat.offset);g.bz(a)}}var b=r("__debug"),g=r("__geometry"),n=r("__obj_util"),x=r("__renderer"),e=r("__subscene"),u=r("__tsr"),w=r("__util"),h=r("__vec3"),m=[e.Db,e.Vc,e.qd,e.Wc,e.Qe,e.qe,e.Id,e.tf,e.Xc,e.Re,e.fg,e.eg,e.Wd,e.dg],B=new Float32Array(3);a.yt=function(a){if(-1<m.indexOf(a.type)){for(var b=
!1,h=a.type==e.Wc||a.type==e.qe,g=a.Qa,k=0;k<g.length;k++){for(var n=g[k],u=n.ra,w=!1,B=0;B<u.length;B++){var C=u[B],v=C.qa;if(h)for(var l=0;6>l;l++)a.B.mh=a.Po[l],C.aw[l]=d(C,a),C.aw[l]&&(w=b=!0,c(v));else C.Ub=d(C,a),C.Ub&&(w=b=!0,c(v));a.Ba&&(v.ib.Om=!0)}n.Ub=w}a.Ba=!1;switch(a.type){case e.eg:break;default:a.type==e.Db||a.type==e.Re||a.type==e.Id||a.type==e.qd||a.type==e.Wc||b?a.Ub=!0:(a.Ub&&x.clear(a),a.Ub=!1)}}else if(a.Ba){g=a.Qa;for(k=0;k<g.length;k++)for(u=g[k].ra,B=0;B<u.length;B++)C=u[B],
v=C.qa,v.ib.Om=!0;a.Ba=!1}a.xx&&e.QQ(a)}};b4w.module.__print=function(a){function r(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}function d(){n++;var a=r(arguments,"B4W ERROR");console.error.apply(console,a)}function c(a){a in e||(e[a]=a,d([a]))}function b(a,b){c(a+"() is deprecated, use "+b+"() instead.")}var g=!1,n=0,x=0,e={};a.BQ=function(a){g=a};a.dd=function(){console.log.apply(console,arguments)};a.log=function(){if(g){var a=r(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=d;a.ja=c;a.Ze=b;a.IT=function(a,d){switch(1<d.length){case !0:c(a+"() is deprecated, use "+d.slice(0,-1).join("(), ")+"() or "+d[d.length-1]+"() instead.");break;case !1:b(a,d[0])}};a.ZL=function(){c('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){x++;var a=r(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=r(arguments,"B4W INFO");console.info.apply(console,a)};a.bM=function(){n++;
var a=r(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.cM=function(){x++;var a=r(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){g&&console.time.apply(console,arguments)};a.timeEnd=function(){g&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.wN=function(){return x};a.aN=function(){return n};a.clear_errors_warnings=function(){n=x=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,r){function d(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.strips.length;e++){var f=d.strips[e];"action"in f||(f.action=null,b("strip",f,"action"));"action_frame_start"in f||(f.action_frame_start=0,b("strip",f,"action_frame_start"));"action_frame_end"in f||(f.action_frame_end=f.frame_end-f.frame_start,b("strip",f,"action_frame_end"));"repeat"in f||(f.repeat=1,b("strip",f,"repeat"));
"use_reverse"in f||(f.use_reverse=!1,b("strip",f,"use_reverse"));"scale"in f||(f.scale=1,b("strip",f,"scale"))}}function b(a,b,c){c=c+">>"+a;c in E||(E[c]={By:[],VD:"undefined",type:a});E[c].By.push(b.name)}function g(a,b,c){c=c+">>"+a;c in E||(E[c]={By:[],VD:"deprecated",type:a});E[c].By.push(b.name)}function n(a){h.warn(a)}function x(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=B.bh(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);
e.submeshes=[];for(c=0;c<d.length;c++){var f=B.zo(d[c]);e.submeshes.push(f)}return e}var e=r("__boundings"),u=r("__curve"),w=r("__mat4"),h=r("__print"),m=r("__quat"),B=r("__util"),k=r("__vec3"),f=r("__mat3"),F=r("__logic_nodes"),t=r("__animation"),q=[5,4],E={},J=f.create(),A=m.create();a.RA=function(a){return-1!=B.SF(a,q)};a.TJ=function(a){E={};var e=a.worlds;if(0==e.length){h.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var f={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};e.push(f)}for(var m=0;m<e.length;m++){f=e[m];"use_sky_blend"in f||(b("world",f,"use_sky_blend"),f.use_sky_blend=!1);"use_sky_paper"in f||(b("world",f,"use_sky_paper"),f.use_sky_paper=
!1);"use_sky_real"in f||(b("world",f,"use_sky_real"),f.use_sky_real=!1);"b4w_sky_settings"in f&&"rayleigh_brightness"in f.b4w_sky_settings||(b("world",f,"rayleigh_brightness"),f.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in f||(b("world",
f,"fog_settings"),f.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in f&&(f.fog_settings.use_custom_color=!0,f.fog_settings.color=f.b4w_fog_color),"b4w_fog_density"in f&&0<f.b4w_fog_density&&(f.fog_settings.depth=1/f.b4w_fog_density));"render_sky"in f.b4w_sky_settings||(b("world",f,"render_sky"),f.b4w_sky_settings.render_sky=!1);for(var k=f.texture_slots,q=0;q<k.length;q++){var p=k[q];"blend_type"in p||(p.blend_type=
"MIX",b("world_texture_slot",p,"blend_type"));"use_map_blend"in p||(p.use_map_blend=!1,b("world_texture_slot",p,"use_map_blend"));"use_map_horizon"in p||(p.use_map_horizon=!0,b("world_texture_slot",p,"use_map_horizon"));"use_map_zenith_up"in p||(p.use_map_zenith_up=!1,b("world_texture_slot",p,"use_map_zenith_up"));"use_rgb_to_intensity"in p||(p.use_rgb_to_intensity=!1,b("world_texture_slot",p,"use_rgb_to_intensity"));"invert"in p||(p.invert=!1,b("world_texture_slot",p,"invert"));"color"in p||(p.color=
[1,0,1],b("world_texture_slot",p,"color"));"blend_factor"in p||(p.blend_factor=0,b("world_texture_slot",p,"blend_factor"));"horizon_factor"in p||(p.horizon_factor=1,b("world_texture_slot",p,"horizon_factor"));"zenith_up_factor"in p||(p.zenith_up_factor=0,b("world_texture_slot",p,"zenith_up_factor"));"zenith_down_factor"in p||(p.zenith_down_factor=0,b("world_texture_slot",p,"zenith_down_factor"));"default_value"in p||(p.default_value=1,b("world_texture_slot",p,"default_value"))}"b4w_use_default_animation"in
f||(b("world",f,"b4w_use_default_animation"),f.b4w_use_default_animation=!1);"b4w_anim_behavior"in f||(b("world",f,"b4w_anim_behavior"),f.b4w_anim_behavior="CYCLIC")}q=a.scenes;for(m=0;m<q.length;m++)k=q[m],p=k.world,"timeline_markers"in k||(k.timeline_markers=null,b("scene",k,"timeline_markers")),"b4w_reflection_quality"in k||(k.b4w_reflection_quality="MEDIUM",b("scene",k,"b4w_reflection_quality")),"b4w_use_nla"in k||(k.b4w_use_nla=!1,b("scene",k,"b4w_use_nla")),"fps"in k||(k.fps=24,b("scene",k,
"fps")),"b4w_nla_cyclic"in k||(k.b4w_nla_cyclic=!1,b("scene",k,"b4w_nla_cyclic")),"b4w_logic_nodes"in k||(k.b4w_logic_nodes=[],b("scene",k,"b4w_logic_nodes")),"b4w_detect_collisions"in k&&(g("scene",k,"b4w_detect_collisions"),delete k.b4w_detect_collisions),"audio_doppler_speed"in k||(k.audio_doppler_speed=343.3),"audio_doppler_factor"in k||(k.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in k||(k.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",k,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in k||(k.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in k||(k.b4w_enable_bloom=!1,b("scene",k,"b4w_enable_bloom")),"b4w_enable_motion_blur"in k||(k.b4w_enable_motion_blur=!1,b("scene",k,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in k||(k.b4w_enable_color_correction=!1,b("scene",k,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in k||(k.b4w_antialiasing_quality="MEDIUM",b("scene",k,"b4w_antialiasing_quality")),
"b4w_tags"in k||(k.b4w_tags={title:"",description:""},b("scene",k,"b4w_tags")),"b4w_enable_object_selection"in k||(k.b4w_enable_object_selection="AUTO",b("scene",k,"b4w_enable_object_selection")),"b4w_enable_outlining"in k||(k.b4w_enable_outlining="AUTO",b("scene",k,"b4w_enable_outlining")),"b4w_enable_glow_materials"in k||(k.b4w_enable_glow_materials="AUTO",b("scene",k,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in k||(k.b4w_enable_anchors_visibility="AUTO",b("scene",k,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in k||(k.b4w_outline_color=[1,1,1],b("scene",k,"b4w_outline_color")),"b4w_outline_factor"in k||(k.b4w_outline_factor="b4w_glow_factor"in k?k.b4w_glow_factor:1,b("scene",k,"b4w_outline_factor")),"b4w_shadow_settings"in k||(b("scene",k,"b4w_shadow_settings"),e=p.b4w_shadow_settings,k.b4w_shadow_settings=e?e:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),e=k.b4w_shadow_settings,"csm_resolution"in e||(b("scene",k,"b4w_shadow_settings.csm_resolution"),e.csm_resolution=2048),"blur_samples"in e||(b("scene",k,"b4w_shadow_settings.blur_samples"),e.blur_samples="16x"),"soft_shadows"in e||(b("scene",k,"b4w_shadow_settings.soft_shadows"),e.soft_shadows=!0),"self_shadow_polygon_offset"in e||(b("scene",k,"b4w_shadow_settings.self_shadow_polygon_offset"),e.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in e||(b("scene",k,"b4w_shadow_settings.self_shadow_normal_offset"),e.self_shadow_normal_offset=.01),"b4w_enable_csm"in e||(b("scene",k,"b4w_shadow_settings.b4w_enable_csm"),e.b4w_enable_csm=!1),"csm_num"in e||(b("scene",k,"b4w_shadow_settings.csm_num"),e.csm_num=1),"csm_first_cascade_border"in e||(b("scene",k,"b4w_shadow_settings.csm_first_cascade_border"),e.csm_first_cascade_border=10),"first_cascade_blur_radius"in e||(b("scene",k,"b4w_shadow_settings.first_cascade_blur_radius"),
e.first_cascade_blur_radius=3),"csm_last_cascade_border"in e||(b("scene",k,"b4w_shadow_settings.csm_last_cascade_border"),e.csm_last_cascade_border=100),"last_cascade_blur_radius"in e||(b("scene",k,"b4w_shadow_settings.last_cascade_blur_radius"),e.last_cascade_blur_radius=1.5),"fade_last_cascade"in e||(b("scene",k,"b4w_shadow_settings.fade_last_cascade"),e.fade_last_cascade=!0),"blend_between_cascades"in e||(b("scene",k,"b4w_shadow_settings.blend_between_cascades"),e.blend_between_cascades=!0),"b4w_ssao_settings"in
k||(b("scene",k,"b4w_ssao_settings"),e=p.b4w_ssao_settings,k.b4w_ssao_settings=e?e:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),e=k.b4w_ssao_settings,"dist_factor"in e||(b("scene",k,"b4w_ssao_settings.dist_factor"),e.dist_factor=0),"samples"in e||(b("scene",k,"b4w_ssao_settings.samples"),e.samples=16),"hemisphere"in e||(b("scene",k,"b4w_ssao_settings.hemisphere"),e.hemisphere=!1),"blur_depth"in e||(b("scene",k,"b4w_ssao_settings.blur_depth"),e.blur_depth=!1),"blur_discard_value"in
e||(b("scene",k,"b4w_ssao_settings.blur_discard_value"),e.blur_discard_value=1),"b4w_bloom_settings"in k||(b("scene",k,"b4w_bloom_settings"),e=p.b4w_bloom_settings,k.b4w_bloom_settings=e?e:{key:.2,blur:4,edge_lum:1}),"key"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.key"),k.b4w_bloom_settings.key=.2),"blur"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.blur"),k.b4w_bloom_settings.blur=4),"edge_lum"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.edge_lum"),k.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in k||(b("scene",k,"b4w_motion_blur_settings"),e=p.b4w_motion_blur_settings,k.b4w_motion_blur_settings=e?e:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in k.b4w_motion_blur_settings||(b("scene",k,"b4w_motion_blur_settings.motion_blur_factor"),k.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in k.b4w_motion_blur_settings||(b("scene",k,"b4w_motion_blur_settings.motion_blur_decay_threshold"),k.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in k||(b("scene",k,"b4w_color_correction_settings"),e=p.b4w_color_correction_settings,k.b4w_color_correction_settings=e?e:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in k||(b("scene",k,"b4w_god_rays_settings"),e=p.b4w_god_rays_settings,k.b4w_god_rays_settings=e?e:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in k.b4w_god_rays_settings||(b("scene",k,"b4w_god_rays_settings.steps_per_pass"),k.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in k||(b("scene",k,"b4w_glow_settings"),k.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},e=k.b4w_glow_settings,"b4w_render_glow_over_blend"in p&&(e.render_glow_over_blend=p.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in p&&(e.small_glow_mask_coeff=p.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in p&&(e.large_glow_mask_coeff=p.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
p&&(e.small_glow_mask_width=p.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in p&&(e.large_glow_mask_width=p.b4w_large_glow_mask_width)),p=k.b4w_render_shadows,"AUTO"!=p&&"OFF"!=p&&"ON"!=p&&(k.b4w_render_shadows=p?"ON":"OFF"),p=k.b4w_render_reflections,"OFF"!=p&&"ON"!=p&&(k.b4w_render_reflections=p?"ON":"OFF"),p=k.b4w_render_refractions,"AUTO"!=p&&"OFF"!=p&&"ON"!=p&&(k.b4w_render_refractions=p?"ON":"OFF"),"b4w_render_dynamic_grass"in k||(b("scene",k,"b4w_render_dynamic_grass"),k.b4w_render_dynamic_grass=
"AUTO"),k.b4w_nla_script&&g("scene",k,"b4w_nla_script"),"audio_distance_model"in k||(b("scene",k,"audio_distance_model"),k.audio_distance_model="INVERSE_CLAMPED"),"b4w_custom_prop"in k||(b("scene",k,"b4w_custom_prop"),k.b4w_custom_prop=null);k=a.meshes;for(m=0;m<k.length;m++){p=k[m];p.b4w_boundings||(b("mesh",p,"b4w_boundings"),p.b4w_boundings={},e=p.b4w_boundings,e.bb=p.b4w_bounding_box?p.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},e.bb_src=p.b4w_bounding_box_source?p.b4w_bounding_box_source:
p.b4w_bounding_box,e.bs_cen=p.b4w_bounding_sphere_center?p.b4w_bounding_sphere_center:[0,0,0],e.bc_cen=p.b4w_bounding_cylinder_center?p.b4w_bounding_cylinder_center:[0,0,0],e.be_cen=p.b4w_bounding_ellipsoid_center?p.b4w_bounding_ellipsoid_center:[0,0,0],p.b4w_bounding_ellipsoid_axes?e.be_ax=p.b4w_bounding_ellipsoid_axes:(q=e.bb,e.be_ax=[(q.max_x-q.min_x)/2,(q.max_y-q.min_y)/2,(q.max_z-q.min_z)/2]),p.b4w_rotated_bounding_box?e.rbb=p.b4w_rotated_bounding_box:(q=e.bb,e.rbb={rbb_c:[(q.max_x+q.min_x)/
2,(q.max_y+q.min_y)/2,(q.max_z+q.min_z)/2],rbb_s:[1,1,1]}),e.caxis_x=p.b4w_cov_axis_x?p.b4w_cov_axis_x:[1,0,0],e.caxis_y=p.b4w_cov_axis_y?p.b4w_cov_axis_y:[0,1,0],e.caxis_z=p.b4w_cov_axis_z?p.b4w_cov_axis_z:[0,0,1]);"is_boundings_overridden"in p||(b("mesh",p,"is_boundings_overridden"),p.is_boundings_overridden=!1);"b4w_shape_keys"in p||(p.b4w_shape_keys=[],b("mesh",p,"b4w_shape_keys"));e=!0;for(f=0;f<p.submeshes.length;f++){var t=p.submeshes[f];"boundings"in t||(e=!1,t.boundings={be_ax:p.b4w_bounding_ellipsoid_axes,
be_cen:p.b4w_bounding_ellipsoid_center,bb:{max_x:p.b4w_bounding_box.max_x,max_y:p.b4w_bounding_box.max_y,max_z:p.b4w_bounding_box.max_z,min_x:p.b4w_bounding_box.min_x,min_y:p.b4w_bounding_box.min_y,min_z:p.b4w_bounding_box.min_z}});"uv_layers"in t||(b("submesh",p,"uv_layers"),t.uv_layers=p.uv_textures);"be_ax"in t.boundings||(t.boundings.be_ax=p.b4w_bounding_ellipsoid_axes);"be_cen"in t.boundings||(t.boundings.be_cen=p.b4w_bounding_ellipsoid_center);"bb"in t.boundings||(t.boundings.bb=p.b4w_bounding_box);
"rbb"in t.boundings||(q=p.b4w_bounding_box,t.boundings.rbb={rbb_c:[(q.max_x+q.min_x)/2,(q.max_y+q.min_y)/2,(q.max_z+q.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in t.boundings||(t.boundings.caxis_x=[1,0,0]);"caxis_y"in t.boundings||(t.boundings.caxis_y=[0,1,0]);"caxis_z"in t.boundings||(t.boundings.caxis_z=[0,0,1])}e||b("mesh",p,"submesh_bd");q=p;e=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];f=null;for(t=0;t<e.length;t++)q[e[t]]&&(f?
(q[e[t]]=!1,h.warn('WARNING property "'+e[t]+'" of object "'+q.name+'" has been set to "false". Foreground property "'+f+'" already exists.')):f=e[t]);for(q=0;q<p.b4w_vertex_anim.length;q++)e=p.b4w_vertex_anim[q],"allow_nla"in e||(b('mesh["b4w_vertex_anim"]',p,"allow_nla"),e.allow_nla=!0)}q=a.cameras;for(m=0;m<q.length;m++)k=q[m],k.type||(k.type="PERSP",b("camera",k,"type")),"b4w_eye_target_dist"in k&&(delete k.b4w_eye_target_dist,g("camera",k,"b4w_eye_target_dist")),"b4w_hover_zero_level"in k||(k.b4w_hover_zero_level=
0,b("camera",k,"b4w_hover_zero_level")),"b4w_trans_velocity"in k||(k.b4w_trans_velocity=1,b("camera",k,"b4w_trans_velocity")),"b4w_rot_velocity"in k||(k.b4w_rot_velocity=1,b("camera",k,"b4w_rot_velocity")),"b4w_zoom_velocity"in k||(k.b4w_zoom_velocity=.1,b("camera",k,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in k||(k.b4w_use_target_distance_limits=k.b4w_use_distance_limits||!1,b("camera",k,"b4w_use_target_distance_limits")),"b4w_use_zooming"in k||(k.b4w_use_zooming=k.b4w_use_distance_limits||
!1,b("camera",k,"b4w_use_zooming")),"b4w_distance_min"in k||(k.b4w_distance_min=1,b("camera",k,"b4w_distance_min")),"b4w_distance_max"in k||(k.b4w_distance_max=100,b("camera",k,"b4w_distance_max")),"b4w_horizontal_translation_min"in k||(k.b4w_horizontal_translation_min=-100,b("camera",k,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in k||(k.b4w_horizontal_translation_max=100,b("camera",k,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in k||(k.b4w_vertical_translation_min=
-100,b("camera",k,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in k||(k.b4w_vertical_translation_max=100,b("camera",k,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in k||(k.b4w_use_horizontal_clamping=!1,b("camera",k,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in k||(k.b4w_rotation_left_limit=-Math.PI,b("camera",k,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in k||(k.b4w_rotation_right_limit=Math.PI,b("camera",k,"b4w_rotation_right_limit")),
"b4w_horizontal_clamping_type"in k||(k.b4w_horizontal_clamping_type="LOCAL",b("camera",k,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in k||(k.b4w_use_vertical_clamping=!1,b("camera",k,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in k||(k.b4w_rotation_down_limit=-Math.PI/2,b("camera",k,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in k||(k.b4w_rotation_up_limit=Math.PI/2,b("camera",k,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in k||(k.b4w_vertical_clamping_type=
"LOCAL",b("camera",k,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in k||(k.b4w_hover_angle_min=Math.PI/6,b("camera",k,"b4w_hover_angle_min")),"b4w_hover_angle_max"in k||(k.b4w_hover_angle_max=Math.PI/6,b("camera",k,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in k||(k.b4w_enable_hover_hor_rotation=!0,b("camera",k,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in k||(k.b4w_use_panning=!0,b("camera",k,"b4w_use_panning")),"b4w_use_pivot_limits"in k||(k.b4w_use_pivot_limits=!1,k.b4w_pivot_z_min=
0,k.b4w_pivot_z_max=10,b("camera",k,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in k||(k.b4w_dof_bokeh=!1,b("camera",k,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in k||(k.b4w_dof_bokeh_intensity=.3,b("camera",k,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in k||(k.b4w_dof_foreground_blur=!1,b("camera",k,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in k||(k.b4w_dof_front_start=0,b("camera",k,"b4w_dof_front_start")),"b4w_dof_front_end"in k||(k.b4w_dof_front_end=k.b4w_dof_front,b("camera",k,
"b4w_dof_front_end")),"b4w_dof_rear_start"in k||(k.b4w_dof_rear_start=0,b("camera",k,"b4w_dof_rear_start")),"b4w_dof_rear_end"in k||(k.b4w_dof_rear_end=k.b4w_dof_rear,b("camera",k,"b4w_dof_rear_end")),"sensor_fit"in k||(k.sensor_fit="VERTICAL",b("camera",k,"sensor_fit"));q=a.lamps;for(m=0;m<q.length;m++)k=q[m],"b4w_generate_shadows"in k||(k.b4w_generate_shadows=!1,b("lamp",k,"b4w_generate_shadows")),"b4w_dynamic_intensity"in k||(k.b4w_dynamic_intensity=!1,b("lamp",k,"b4w_dynamic_intensity")),"use_diffuse"in
k||(k.use_diffuse=!0,b("lamp",k,"use_diffuse")),"use_specular"in k||(k.use_specular=!0,b("lamp",k,"use_specular")),"clip_start"in k||(k.clip_start=.1,b("lamp",k,"clip_start")),"clip_end"in k||(k.clip_end=30,b("lamp",k,"clip_end")),"POINT"!=k.type&&"SPOT"!=k.type||"use_sphere"in k||(k.use_sphere=!1,b("lamp",k,"use_sphere"));q=a.speakers;for(m=0;m<q.length;m++)k=q[m],"b4w_behavior"in k||(k.b4w_behavior=k.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in k||(k.b4w_auto_play=!1,
b("speaker",k,"b4w_auto_play")),"b4w_enable_doppler"in k||(k.b4w_enable_doppler=!1,b("speaker",k,"b4w_enable_doppler")),"b4w_delay"in k||(k.b4w_delay=0),"b4w_delay_random"in k||(k.b4w_delay_random=0),"b4w_volume_random"in k||(k.b4w_volume_random=0),"b4w_pitch_random"in k||(k.b4w_pitch_random=0),"b4w_fade_in"in k||(k.b4w_fade_in=0),"b4w_fade_out"in k||(k.b4w_fade_out=0),"b4w_loop"in k||(k.b4w_loop=!1),"b4w_loop_start"in k||(k.b4w_loop_start=0,b("speaker",k,"b4w_loop_start")),"b4w_loop_end"in k||(k.b4w_loop_end=
0,b("speaker",k,"b4w_loop_end")),k.animation_data&&c(k.animation_data);q=a.textures;for(m=0;m<q.length;m++)k=q[m],"b4w_anisotropic_filtering"in k||(k.b4w_anisotropic_filtering="OFF",b("texture",k,"b4w_anisotropic_filtering")),"b4w_water_foam"in k||(k.b4w_water_foam=!1,b("texture",k,"b4w_water_foam")),"b4w_foam_uv_freq"in k||(k.b4w_foam_uv_freq=[1,1],b("texture",k,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in k||(k.b4w_foam_uv_magnitude=[1,1],b("texture",k,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in
k||(k.b4w_parallax_steps=5,b("material",k,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in k||(k.b4w_parallax_lod_dist=10,b("material",k,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in k||(k.b4w_shore_dist_map=!1,b("texture",k,"b4w_shore_dist_map")),"b4w_shore_boundings"in k||(k.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",k,"b4w_shore_boundings")),"b4w_max_shore_dist"in k||(k.b4w_max_shore_dist=100,b("texture",k,"b4w_max_shore_dist")),"b4w_disable_compression"in k||(k.b4w_disable_compression=
!1,b("texture",k,"b4w_disable_compression")),"b4w_source_type"in k||(k.b4w_source_type="",b("texture",k,"b4w_source_type")),"b4w_source_id"in k||(k.b4w_source_id="",b("texture",k,"b4w_source_id")),"b4w_source_size"in k||(k.b4w_source_size=1024,b("texture",k,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in k||(k.b4w_enable_canvas_mipmapping=!0,b("texture",k,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in k||(k.b4w_nla_video=!1,b("texture",k,"b4w_nla_video"));q=a.images;for(m=0;m<q.length;m++)k=
q[m],"colorspace_settings_name"in k||(k.colorspace_settings_name="sRGB",b("image",k,"colorspace_settings_name"));e=a.materials;for(m=0;m<e.length;m++){f=e[m];"ALPHA_ANTIALIASING"==f.game_settings.alpha_blend&&(f.game_settings.alpha_blend="CLIP");"use_tangent_shading"in f||(f.use_tangent_shading=!1,b("material",f,"use_tangent_shading"));"b4w_node_mat_type"in f&&g("material",f,"b4w_node_mat_type");"b4w_skydome"in f&&g("material",f,"b4w_skydome");"b4w_procedural_skydome"in f&&g("material",f,"b4w_procedural_skydome");
"b4w_lens_flares"in f||(f.b4w_lens_flares=!1,b("material",f,"b4w_lens_flares"));"LENS_FLARES"===f.name&&(f.b4w_lens_flares||h.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),f.b4w_lens_flares=!0);f.b4w_water&&("b4w_water_shore_smoothing"in f||(f.b4w_water_shore_smoothing=!1,b("material",f,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in f||(f.b4w_water_dynamic=!1,b("material",f,"b4w_water_dynamic")),"b4w_waves_height"in f||(f.b4w_waves_height=
1,b("material",f,"b4w_waves_height")),"b4w_waves_length"in f||(f.b4w_waves_length=1,b("material",f,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in f||(f.b4w_water_dst_noise_scale0=.05,b("material",f,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in f||(f.b4w_water_dst_noise_scale1=.03,b("material",f,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in f||(f.b4w_water_dst_noise_freq0=1.3,b("material",f,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in f||(f.b4w_water_dst_noise_freq1=
1,b("material",f,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in f||(f.b4w_water_dir_min_shore_fac=.4,b("material",f,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in f||(f.b4w_water_dir_freq=.5,b("material",f,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in f||(f.b4w_water_dir_noise_scale=.05,b("material",f,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in f||(f.b4w_water_dir_noise_freq=.07,b("material",f,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in
f||(f.b4w_water_dir_min_noise_fac=.5,b("material",f,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in f||(f.b4w_water_dst_min_fac=.2,b("material",f,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in f||(f.b4w_water_waves_hor_fac=5,b("material",f,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in f||(f.b4w_water_absorb_factor=6,b("material",f,"b4w_water_absorb_factor")),"b4w_water_fog_color"in f||(f.b4w_water_fog_color=[.5,.7,.7],b("material",f,"b4w_water_fog_color")),"b4w_foam_factor"in
f||(f.b4w_foam_factor=5,b("material",f,"b4w_foam_factor")),"b4w_generated_mesh"in f||(f.b4w_generated_mesh=!1,b("material",f,"b4w_generated_mesh")),"b4w_water_num_cascads"in f||(f.b4w_water_num_cascads=5,b("material",f,"b4w_water_num_cascads")),"b4w_water_subdivs"in f||(f.b4w_water_subdivs=64,b("material",f,"b4w_water_subdivs")),"b4w_water_detailed_dist"in f||(f.b4w_water_detailed_dist=1E3,b("material",f,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in f||(f.b4w_water_enable_caust=!1,b("material",
f,"b4w_water_enable_caust")),"b4w_water_caust_scale"in f||(f.b4w_water_caust_scale=.25,b("material",f,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in f||(f.b4w_water_caust_brightness=.5,b("material",f,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in f||(f.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in f||(f.b4w_dynamic_grass_color="");"diffuse_intensity"in f||(f.diffuse_intensity=1,b("material",f,"diffuse_intensity"));"b4w_use_ghost"in f||(f.b4w_use_ghost=!1);"b4w_collision_margin"in
f||(f.b4w_collision_margin=.04,b("material",f,"b4w_collision_margin"));"b4w_collision_group"in f||(f.b4w_collision_group=128,b("material",f,"b4w_collision_group"));"b4w_collision_mask"in f||(f.b4w_collision_mask=127,b("material",f,"b4w_collision_mask"));"b4w_do_not_render"in f||(f.b4w_do_not_render=!1,b("material",f,"b4w_do_not_render"));"HALO"!=f.type||"b4w_halo_sky_stars"in f||(f.b4w_halo_sky_stars=!1,b("material",f,"b4w_halo_sky_stars"));"HALO"!=f.type||"b4w_halo_stars_blend_height"in f||(f.b4w_halo_stars_blend_height=
10,b("material",f,"b4w_halo_stars_blend_height"));"HALO"!=f.type||"b4w_halo_stars_min_height"in f||(f.b4w_halo_stars_min_height=0,b("material",f,"b4w_halo_stars_min_height"));"specular_shader"in f||(f.specular_shader="COOKTORR",b("material",f,"specular_shader"));"diffuse_shader"in f||(f.diffuse_shader="LAMBERT",b("material",f,"diffuse_shader"));"roughness"in f||(f.roughness=.5,b("material",f,"roughness"));"diffuse_fresnel"in f||(f.diffuse_fresnel=.1,b("material",f,"diffuse_fresnel"));"diffuse_fresnel_factor"in
f||(f.diffuse_fresnel_factor=.5,b("material",f,"diffuse_fresnel_factor"));"specular_slope"in f||(f.specular_slope=.2,b("material",f,"specular_slope"));"specular_toon_size"in f||(f.specular_toon_size=.5,b("material",f,"specular_toon_size"));"specular_toon_smooth"in f||(f.specular_toon_smooth=.1,b("material",f,"specular_toon_smooth"));"specular_alpha"in f||(f.specular_alpha=1,b("material",f,"specular_alpha"));"b4w_wettable"in f||(f.b4w_wettable=!1,b("material",f,"b4w_wettable"));"b4w_refractive"in f||
(f.b4w_refractive=!1,b("material",f,"b4w_refractive"));"b4w_refr_bump"in f||(f.b4w_refr_bump=0,b("material",f,"b4w_refr_bump"));"b4w_shallow_water_col"in f||(f.b4w_shallow_water_col=[0,.8,.3],b("material",f,"b4w_shallow_water_col"));"b4w_shore_water_col"in f||(f.b4w_shore_water_col=[0,.9,.2],b("material",f,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in f||(f.b4w_shallow_water_col_fac=1,b("material",f,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in f||(f.b4w_shore_water_col_fac=.5,
b("material",f,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in f||(f.b4w_water_sss_strength=5.9,b("material",f,"b4w_water_sss_strength"));"b4w_water_sss_width"in f||(f.b4w_water_sss_width=.45,b("material",f,"b4w_water_sss_width"));"b4w_render_above_all"in f||(f.b4w_render_above_all=!1,b("material",f,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in f||(f.b4w_water_norm_uv_velocity=.05,b("material",f,"b4w_water_norm_uv_velocity"));"specular_ior"in f||(f.specular_ior=1,b("material",f,"specular_ior"));
"darkness"in f||(f.darkness=0,b("material",f,"darkness"));"diffuse_toon_size"in f||(f.diffuse_toon_size=0,b("material",f,"diffuse_toon_size"));"diffuse_toon_smooth"in f||(f.diffuse_toon_smooth=0,b("material",f,"diffuse_toon_smooth"));"pass_index"in f||(f.pass_index=0,b("material",f,"pass_index"));k=f.texture_slots;for(q=0;q<k.length;q++)p=k[q],"blend_type"in p||(p.blend_type="MIX",b("texture_slot",p,"blend_type"));if(f.node_tree){k=f.node_tree.nodes;for(q=0;q<k.length;q++)d(k[q]);f.node_tree.animation_data&&
c(f.node_tree.animation_data)}}p=a.node_groups;for(m=0;m<p.length;m++)for(k=p[m].node_tree.nodes,q=0;q<k.length;q++)d(k[q]);k=a.objects;for(m=0;m<k.length;m++){p=k[m];switch(p.type){case "MESH":"b4w_dynamic_geometry"in p||(p.b4w_dynamic_geometry=!1);"b4w_reflexible"in p||(p.b4w_reflexible=!1);"b4w_reflexible_only"in p||(p.b4w_reflexible_only=!1);"b4w_reflective"in p||(p.b4w_reflective=!1);"b4w_reflection_type"in p||(p.b4w_reflection_type="PLANE",b("object",p,"b4w_reflection_type"));"b4w_wind_bending"in
p||(p.b4w_wind_bending=!1,b("object",p,"b4w_wind_bending"));"b4w_wind_bending_angle"in p||(p.b4w_wind_bending_angle=10,p.b4w_wind_bending_freq=.25,b("object",p,"wind bending params"));"b4w_detail_bending_amp"in p||(p.b4w_detail_bending_amp=.1,p.b4w_branch_bending_amp=.3,b("object",p,"detail bending params"));"b4w_detail_bending_freq"in p||(p.b4w_detail_bending_freq=1,b("object",p,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in p||(p.b4w_main_bend_stiffness_col="",b("object",p,"b4w_main_bend_stiffness_col"));
"b4w_detail_bend_colors"in p||(p.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",p,"b4w_detail_bend_colors"));"b4w_caustics"in p||(p.b4w_caustics=!1);"vertex_groups"in p&&p.vertex_groups.length&&p.data&&0==p.data.vertex_groups.length&&(p.data.vertex_groups=p.vertex_groups,delete p.vertex_groups,b("object",p,"vertex_groups"));"b4w_vertex_anim"in p&&p.b4w_vertex_anim.length&&p.data&&0==p.data.b4w_vertex_anim.length&&(p.data.b4w_vertex_anim=p.b4w_vertex_anim,
delete p.b4w_vertex_anim,b("object",p,"b4w_vertex_anim"));"b4w_do_not_render"in p||(p.b4w_do_not_render=!1);"b4w_hidden_on_load"in p||(p.b4w_hidden_on_load=!1);"use_ghost"in p.game||(p.game.use_ghost=!1);"use_sleep"in p.game||(p.game.use_sleep=!1);"velocity_min"in p.game||(p.game.velocity_min=0);"velocity_max"in p.game||(p.game.velocity_max=0);"collision_group"in p.game||(p.game.collision_group=1);"collision_mask"in p.game||(p.game.collision_mask=255);q=p;e=q.game;f=e.collision_bounds_type;e.use_collision_bounds&&
"BOX"!=f&&"CYLINDER"!=f&&"CONE"!=f&&"SPHERE"!=f&&"CAPSULE"!=f&&"EMPTY"!=f&&(h.error("Wrong collision bounds type "+f+". Disable physics for object "+q.name),q.b4w_collision=!1,q.b4w_floating=!1,q.b4w_vehicle=!1,q.b4w_character=!1);"b4w_vehicle_settings"in p?p.b4w_vehicle_settings&&("steering_ratio"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.steering_ratio=10),"steering_max"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.steering_max=1),"inverse_control"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.inverse_control=
!1),"force_max"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.force_max=1500),"brake_max"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.brake_max=100),"speed_ratio"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.suspension_compression=
4.4),"suspension_stiffness"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in p.b4w_vehicle_settings||
(p.b4w_vehicle_settings.floating_factor=3),"floating_factor"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.water_rot_damp=.9)):(p.b4w_vehicle_settings=null,b("object",p,"b4w_vehicle_settings"));"b4w_floating_settings"in p?p.b4w_floating_settings&&("floating_factor"in p.b4w_floating_settings||(p.b4w_floating_settings.floating_factor=
3),"water_lin_damp"in p.b4w_floating_settings||(p.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in p.b4w_floating_settings||(p.b4w_floating_settings.water_rot_damp=.8)):(p.b4w_floating_settings=null,b("object",p,"b4w_floating_settings"));"b4w_character_settings"in p?p.b4w_character_settings&&("walk_speed"in p.b4w_character_settings||(p.b4w_character_settings.walk_speed=4),"run_speed"in p.b4w_character_settings||(p.b4w_character_settings.run_speed=8),"step_height"in p.b4w_character_settings||
(p.b4w_character_settings.step_height=.25),"jump_strength"in p.b4w_character_settings||(p.b4w_character_settings.jump_strength=5),"waterline"in p.b4w_character_settings||(p.b4w_character_settings.waterline=0)):(p.b4w_character_settings=null,b("object",p,"b4w_character_settings"));"b4w_selectable"in p||(p.b4w_selectable=!1,b("object",p,"b4w_selectable"));"b4w_outlining"in p||(p.b4w_outlining=!1,b("object",p,"b4w_outlining"));"b4w_outline_on_select"in p||(p.b4w_outline_on_select=!1,b("object",p,"b4w_outline_on_select"));
"b4w_billboard"in p||(p.b4w_billboard=!1,b("object",p,"b4w_billboard"));"b4w_billboard_geometry"in p||(p.b4w_billboard_geometry="SPHERICAL",b("object",p,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in p||(p.b4w_pres_glob_orientation=!1,b("object",p,"b4w_pres_glob_orientation"));"b4w_outline_settings"in p||("b4w_glow_settings"in p?p.b4w_outline_settings=p.b4w_glow_settings:(p.b4w_outline_settings={},p.b4w_outline_settings.outline_duration=1,p.b4w_outline_settings.outline_period=1,p.b4w_outline_settings.outline_relapses=
0),b("object",p,"b4w_outline_settings"));"b4w_lod_transition"in p||(p.b4w_lod_transition=.01,b("object",p,"b4w_lod_transition"));"lod_levels"in p||(p.lod_levels=[],b("object",p,"lod_levels"));"b4w_animation_mixing"in p||(p.b4w_animation_mixing=!1,b("object",p,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in p||(p.b4w_anchor=null,b("object",p,"b4w_anchor")),!p.b4w_anchor||"max_width"in p.b4w_anchor||(p.b4w_anchor.max_width=250)}"collision_margin"in p.game||(p.game.collision_margin=.04,b("object",
p,"collision_margin"));"b4w_anim_behavior"in p||(p.b4w_anim_behavior=p.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",p,"b4w_anim_behavior"));if(!("rotation_quaternion"in p)){q=[0,0,0,1];B.euler_to_quat(p.rotation_euler,q);var e=q,f=q[0],t=q[1],y=q[2];e[0]=q[3];e[1]=f;e[2]=t;e[3]=y;p.rotation_quaternion=q;b("object",p,"rotation_quaternion")}"webgl_do_not_batch"in p&&(p.b4w_do_not_batch=p.webgl_do_not_batch)&&g("object",p,"webgl_do_not_batch");"b4w_shadow_cast_only"in p||(p.b4w_shadow_cast_only=
!1,b("object",p,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in p||(p.b4w_correct_bounding_offset="AUTO",b("object",p,"b4w_correct_bounding_offset"));e=p.particle_systems;for(q=0;q<e.length;q++)f=e[q],t=f.settings,"use_rotation_dupli"in t||(t.use_rotation_dupli=!1,b("particle_settings",t,"use_rotation_dupli")),"use_whole_group"in t||(t.use_whole_group=!1,b("particle_settings",t,"use_whole_group")),f.transforms||(f.transforms=new Float32Array,b("particle_system",f,"transforms")),"b4w_billboard_align"in
t||(t.b4w_billboard_align="VIEW",b("particle_settings",t,"b4w_billboard_align")),"b4w_dynamic_grass"in t||(t.b4w_dynamic_grass=!1,b("object",t,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in t||(t.b4w_dynamic_grass_scale_threshold=.01,b("object",t,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in t||(t.b4w_initial_rand_rotation=!1,b("particle_settings",t,"b4w_initial_rand_rotation")),"b4w_rotation_type"in t||(t.b4w_rotation_type="Z",b("particle_settings",t,"b4w_rotation_type")),
"b4w_rand_rotation_strength"in t||(t.b4w_rand_rotation_strength=1,b("particle_settings",t,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in t||(t.b4w_hair_billboard=!1,b("particle_settings",t,"b4w_hair_billboard")),"b4w_hair_billboard_type"in t||(t.b4w_hair_billboard_type="BASIC",b("particle_settings",t,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in t||(t.b4w_hair_billboard_jitter_amp=0,b("particle_settings",t,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in
t||(t.b4w_hair_billboard_jitter_freq=0,b("particle_settings",t,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in t||(t.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",t,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in t||(t.b4w_wind_bend_inheritance="PARENT",b("particle_settings",t,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in t||(t.b4w_shadow_inheritance="PARENT",b("particle_settings",t,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in
t||(t.b4w_reflection_inheritance="PARENT",b("particle_settings",t,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in t||(t.b4w_vcol_from_name="",b("particle_settings",t,"b4w_vcol_from_name")),"b4w_vcol_to_name"in t||(t.b4w_vcol_to_name="",b("particle_settings",t,"b4w_vcol_to_name")),"b4w_coordinate_system"in t||(t.b4w_coordinate_system="LOCAL",b("particle_settings",t,"b4w_coordinate_system")),"b4w_allow_nla"in t||(t.b4w_allow_nla=!0,b("particle_settings",t,"b4w_allow_nla")),"b4w_enable_soft_particles"in
t||(t.b4w_enable_soft_particles=!1,b("particle_settings",t,"b4w_enable_soft_particles")),"b4w_particles_softness"in t||(t.b4w_particles_softness=1,b("particle_settings",t,"b4w_particles_softness")),"billboard_tilt"in t||(t.billboard_tilt=0,b("particle_settings",t,"billboard_tilt")),"billboard_tilt_random"in t||(t.billboard_tilt_random=0,b("particle_settings",t,"billboard_tilt_random")),"use_rotations"in t||(t.use_rotations=!1,b("particle_settings",t,"use_rotations"));"constraints"in p||(p.constraints=
[],b("object",p,"constraints"));e=p.modifiers;for(q=0;q<e.length;q++){a:{f=e[q];switch(f.type){case "ARRAY":if(!("fit_type"in f)){h.error("WARNING Incomplete modifier "+String(f.type)+' for "'+p.name+'", reexport "'+a.b4w_filepath_blend+'" scene');f=!1;break a}}f=!0}f||(e.splice(q,1),q--)}"animation_data"in p||(p.animation_data={action:null,nla_tracks:[]},b("object",p,"animation_data"));p.animation_data&&("action"in p.animation_data||(p.animation_data.action=null,n("no action in animation data "+
p.name)),"nla_tracks"in p.animation_data||(p.animation_data.nla_tracks=[],n("no NLA in animation data "+p.name)),c(p.animation_data));"b4w_collision_id"in p||(p.b4w_collision_id="",b("object",p,"b4w_collision_id"));"b4w_viewport_alignment"in p||(p.b4w_viewport_alignment=null,b("object",p,"b4w_viewport_alignment"));"pinverse_tsr"in p||(p.pinverse_tsr=null,b("object",p,"pinverse_tsr"));"b4w_cluster_data"in p||(p.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",p,"b4w_cluster_data"));
"pass_index"in p||(p.pass_index=0,b("object",p,"pass_index"));"b4w_custom_prop"in p||(b("object",p,"b4w_custom_prop"),p.b4w_custom_prop=null);(0>p.scale[0]||0>p.scale[1]||0>p.scale[2])&&n('negative scale for object "'+p.name+'", can lead to some errors');q=p.scale;0==q[0]&&0==q[1]&&0==q[2]?q=!0:(e=Math.abs((q[1]-q[2])/q[1]),q=.005>Math.abs((q[0]-q[1])/q[0])&&.005>e);q||n("non-uniform scale for object "+p.name)}for(var u in E)m=E[u],q=u.match(/.*?(?=>>|$)/i)[0],h.warn('Property "'+String(q)+'" is '+
m.VD+' for "'+m.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.QJ=function(a,b){"num_channels"in a||(a.num_channels=1,n('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.$I=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;b=x(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var h=a[c];switch(h.type){case "ARRAY":for(var d=b,g=h,p=
0,q=0,n=0,t=new Float32Array(16),h=[],E=1;E<g.count;E++){g.use_constant_offset&&(p+=g.constant_offset_displace[0],q+=g.constant_offset_displace[1],n+=g.constant_offset_displace[2]);if(g.use_relative_offset)var r=d.b4w_boundings.bb,p=p+(r.max_x-r.min_x)*g.relative_offset_displace[0],q=q+(r.max_y-r.min_y)*g.relative_offset_displace[1],n=n+(r.max_z-r.min_z)*g.relative_offset_displace[2];B.nR(p,q,n,t);for(var D=r=x(d),F=t,I=f.fromMat4(F,J),I=m.fromMat3(I,A),L=0;L<D.submeshes.length;L++){var ba=D.submeshes[L];
B.Um(ba.position,F,ba.position,0);B.MD(ba.tbn_quat,I,ba.tbn_quat,0)}h.push(r)}for(E=0;E<h.length;E++)for(g=d,p=h[E],q=0;q<g.submeshes.length;q++){n=g.submeshes[q];t=p.submeshes[q];r=n.base_length;D=n.indices.length;n.base_length+=t.base_length;for(var pa in n)if("base_length"!=pa&&"boundings"!=pa)if("indices"==pa)for(n[pa]=B.uR(n[pa],t[pa]),F=D;F<n.indices.length;F++)n.indices[F]+=r;else"vertex_colors"!=pa&&(n[pa]=B.qM(n[pa],t[pa]))}break;case "CURVE":for(d=b,E=u.WK(h.object),g=new Float32Array(16),
q=E.uj?4:3,p=new Float32Array(q),q=new Float32Array(q),n=new Float32Array(3),t=new Float32Array(4),r=new Float32Array(4),D=new Float32Array(3),F=new Float32Array(3),I=new Float32Array(3),L=0;L<d.submeshes.length;L++){var Y=d.submeshes[L],ba=Y.position,Y=Y.tbn_quat,ha;a:{ha=h.deform_axis;switch(ha){case "POS_X":case "NEG_X":ha=0;break a;case "POS_Y":case "NEG_Y":ha=1;break a;case "POS_Z":case "NEG_Z":ha=2;break a;default:B.D("Wrong deform axis value "+ha)}ha=void 0}D[0]=0;D[1]=0;D[2]=0;D[ha]=1;for(var U=
u.$Q(E),ga=0;ga<ba.length/3;ga++){I[0]=ba[3*ga];I[1]=ba[3*ga+1];I[2]=ba[3*ga+2];var ca=I[ha],M=u.ZQ(E,ca);u.aR(E,M,p);n[0]=p[0];n[1]=p[1];n[2]=p[2];u.YQ(E,M,q);F[0]=q[0];F[1]=0;F[2]=q[2];k.normalize(F,F);m.rotationTo(D,F,t);0>ca?(p[0]=F[0],p[1]=F[1],p[2]=F[2],k.scale(p,ca,p),k.add(n,p,n)):ca>U&&(p[0]=F[0],p[1]=F[1],p[2]=F[2],k.scale(p,ca-U,p),k.add(n,p,n));w.fromRotationTranslation(t,n,g);E.uj&&(m.setAxisAngle(D,p[3],r),k.transformQuat(I,r,I));I[ha]=0;k.transformMat4(I,g,I);ba[3*ga]=I[0];ba[3*ga+
1]=I[1];ba[3*ga+2]=I[2];Y.length&&(A[0]=Y[4*ga],A[1]=Y[4*ga+1],A[2]=Y[4*ga+2],A[3]=Y[4*ga+3],m.multiply(A,t,A),Y[4*ga]=A[0],Y[4*ga+1]=A[1],Y[4*ga+2]=A[2],Y[4*ga+3]=A[3])}}}e.tP(b)}return b};a.MK=function(){return{name:"DEFAULT",uuid:B.mw(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,
specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,
b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.eJ=function(a,b){function c(b,c){for(var d in b){var f=b[d],e=f[0];if(1<f.length)for(var g=1;g<
f.length;g++)e+="*"+f[g];for(g=0;g<a.length;g++)if(f=a[g],f.name==e)for(var h in c)f[h]=c[h]}}for(var d=b.b4w_logic_nodes,f=0;f<d.length;f++)for(var e=d[f],h=0;h<e.length;h++){var g=e[h],m={register1:"variable1",register2:"variable2",registerd:"variabled"},k;for(k in m)k in g&&(g[m[k]]=g[k]);for(var q in g.variables)"boolean"!=typeof g.variables[q][0]&&(g.variables[q]=[!1,g.variables[q]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(g.type)&&("variable1"in g&&(g.variables.v1=[!1,g.variable1]),
"variable2"in g&&(g.variables.v2=[!1,g.variable2]),"variabled"in g&&(g.variables.vd=[!1,g.variabled]));switch(g.type){case "SELECT":for(var u=0;u<a.length;u++)m=a[u],m.name==g.object&&(m.b4w_selectable=!0);g.bools||(g.bools={});g.bools.not_wait||(g.bools.not_wait=!1);n('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":c(g.objects_paths,{b4w_selectable:!0});if(g.links instanceof Array){n('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+
'"');var m={},B=0;for(u in g.objects_paths)m[u]=g.links[B],B++;g.links=m}break;case "SELECT_PLAY":n('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');g.mute=!0;break;case "SELECT_PLAY_ANIM":n('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":g.bools||(g.bools={}),void 0===g.bools.ch&&(g.bools.ch=!1);case "HIDE":c(g.objects_paths,{b4w_do_not_batch:!0});break;case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(g.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(g.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(g.objects_paths,{b4w_do_not_batch:!0});switch(g.common_usage_names.space_type){case "WORLD":g.common_usage_names.space_type=F.jH;break;case "PARENT":g.common_usage_names.space_type=F.iH;break;case "LOCAL":g.common_usage_names.space_type=F.hH}break;case "OUTLINE":c(g.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":g.condition&&(g.common_usage_names.condition=
g.condition);if("cnd"in g.floats)g.common_usage_names.condition=g.floats.cnd;else switch(g.common_usage_names.condition){case "GEQUAL":g.common_usage_names.condition=F.Iz;break;case "LEQUAL":g.common_usage_names.condition=F.Kz;break;case "GREATER":g.common_usage_names.condition=F.Jz;break;case "LESS":g.common_usage_names.condition=F.Lz;break;case "NOTEQUAL":g.common_usage_names.condition=F.Mz;break;case "EQUAL":g.common_usage_names.condition=F.Hz}void 0!=g.number1&&(g.input1=g.number1);void 0!=g.number2&&
(g.input2=g.number2);g.bools||(g.bools={});void 0===g.bools.str&&(g.bools.str=!1,g.floats.inp1=g.input1,g.floats.inp2=g.input2);break;case "SEND_REQ":g.bools||(g.bools={});g.strings||(g.strings={});void 0===g.bools.ct&&(g.bools.ct=!1);void 0!=g.url&&(g.bools.url=!1,g.strings.url=g.url);break;case "MATH":void 0!=g.number1&&(g.input1=g.number1);void 0!=g.number2&&(g.input2=g.number2);void 0!=g.input1&&(g.floats.inp1=g.input1);void 0!=g.input2&&(g.floats.inp2=g.input2);switch(g.operation){case "DIV":g.operation=
F.PG;break;case "SUB":g.operation=F.YG;break;case "MUL":g.operation=F.UG;break;case "ADD":g.operation=F.KG;break;case "RAND":g.operation=F.VG;break;case "SIN":g.operation=F.XG;break;case "COS":g.operation=F.OG;break;case "TAN":g.operation=F.ZG;break;case "ARCSIN":g.operation=F.MG;break;case "ARCCOS":g.operation=F.LG;break;case "ARCTAN":g.operation=F.NG;break;case "LOG":g.operation=F.QG;break;case "MIN":g.operation=F.SG;break;case "MAX":g.operation=F.RG;break;case "ROUND":g.operation=F.WG;break;case "MOD":g.operation=
F.TG;break;case "ABS":g.operation=F.JG}break;case "REGSTORE":g.floats||(g.floats={});g.strings||(g.strings={});void 0!=g.number1&&(g.input1=g.number1);if(void 0!=g.input1)switch(typeof g.input1){case "number":g.floats.inp1=g.input1;g.common_usage_names.variable_type="NUMBER";break;default:g.strings.inp1=g.input1,g.common_usage_names.variable_type="STRING"}switch(g.common_usage_names.variable_type){case "NUMBER":g.common_usage_names.variable_type=F.kH;break;case "STRING":g.common_usage_names.variable_type=
F.lH}break;case "PAGEPARAM":g.bools||(g.bools={});void 0===g.bools.hsh&&(g.bools.hsh=!1);g.floats||(g.floats={});void 0===g.floats.ptp&&(g.floats.ptp=0);break;case "PLAY_ANIM":c(g.objects_paths,{b4w_do_not_batch:!0});g.bools||(g.bools={});void 0===g.bools.env&&(g.bools.env=!1);(m=g.common_usage_names.param_anim_behavior)||(m="FINISH_STOP");g.common_usage_names.param_anim_behavior=t.$u(m);break;case "STOP_ANIM":g.bools||(g.bools={});void 0===g.bools.env&&(g.bools.env=!1);break;case "STRING":switch(g.common_usage_names.string_operation){case "JOIN":g.common_usage_names.string_operation=
F.eH;break;case "FIND":g.common_usage_names.string_operation=F.dH;break;case "REPLACE":g.common_usage_names.string_operation=F.fH;break;case "SPLIT":g.common_usage_names.string_operation=F.gH;break;case "COMPARE":g.common_usage_names.string_operation=F.cH}if("cnd"in g.floats)g.common_usage_names.condition=g.floats.cnd;else switch(g.common_usage_names.condition){case "GEQUAL":g.common_usage_names.condition=F.Iz;break;case "LEQUAL":g.common_usage_names.condition=F.Kz;break;case "GREATER":g.common_usage_names.condition=
F.Jz;break;case "LESS":g.common_usage_names.condition=F.Lz;break;case "NOTEQUAL":g.common_usage_names.condition=F.Mz;break;case "EQUAL":g.common_usage_names.condition=F.Hz}break;case "REDIRECT":void 0!=g.url&&(g.bools.url=!1,g.strings.url=g.url);break;case "SET_CAMERA_MOVE_STYLE":switch(g.common_usage_names.camera_move_style){case "STATIC":g.common_usage_names.camera_move_style=F.FG;break;case "TARGET":g.common_usage_names.camera_move_style=F.GG;break;case "EYE":g.common_usage_names.camera_move_style=
F.DG;break;case "HOVER":g.common_usage_names.camera_move_style=F.EG}break;case "ENTRYPOINT":g.bools||(g.bools={});void 0===g.bools.js&&(g.bools.js=!1);g.bools.js&&(g.mute=!0);break;case "JS_CALLBACK":for(k in g=g.common_usage_names.js_cb_params,g)switch(g[k]){case "OBJECT":g[k]=F.HG;break;case "VARIABLE":g[k]=F.IG}}}}};b4w.module.__scenegraph=function(a,r){function d(a,b){var c=[];y.ag(a,function(b,d,f){-1<c.indexOf(f)?y.FP(a,b,d,f,E(f)):c.push(f)});y.ha(a,function(a,d){for(var f=0;f<d.Xa.length;f++){var e=d.Xa[f];b||d.type!=G.qd&&d.type!=G.Wc&&d.type!=G.tf||(e.Ke=!0);-1<c.indexOf(e)?d.Xa[f]=E(e):c.push(e)}})}function c(a,c){y.ha(a,function(b,d){d.type==G.pz&&y.Ih(a,b,function(a,b){if(b.type==G.Ug)for(var c=0;c<b.Xa.length;c++){var d=b.Xa[c];d.Ma=D.P;d.La=D.P}});c||y.Ih(a,b,function(a,b,c){"DEPTH"==c.from&&(c.Ke=
!0)})});y.ha(a,function(c){var d={};b(a,c,d);for(var f in d){c=d[f];for(var e=c[0],g=0;g<c.length;g++)if(c[g].Ma==D.P){e=c[g];break}for(var h=c[0],g=0;g<c.length;g++)if(c[g].La==D.P){h=c[g];break}for(var m=c[0],g=0;g<c.length;g++)if(!c[g].Ke){m=c[g];break}for(g=0;g<c.length;g++)c[g].Ma=e.Ma,c[g].La=h.La,c[g].Ke=m.Ke}})}function b(a,c,d){y.Ih(a,c,function(c,f,e){e.active&&e.from==e.to&&(d[e.from]=d[e.from]||[],-1==d[e.from].indexOf(e)&&d[e.from].push(e),b(a,c,d))});y.Zj(a,c,function(a,b,c){c.active&&
(d[c.from]=d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=y.Ra(a,c);if(c.type==G.Ug)for(var f=0;f<c.Xa.length;f++){var e=c.Xa[f];d[e.from].push(e)}}function g(a){var b=[G.Ug,G.Pu,G.Sq,G.qd,G.Wc,G.On],c=y.Oy(a),d=[];y.ha(c,function(a,f){for(var g=0;g<f.Xa.length;g++){var h=f.Xa[g];-1<b.indexOf(f.type)&&(h.un=!0);var m=w(d,h,n(h));h.Ya=m;f.Hh[g]=m}for(g=0;g<f.Hh.length;g++)m=f.Hh[g],u(d,m);y.Zj(c,a,function(g,h,m){if(!m.Ya){if(-1<b.indexOf(f.type))m.un=!0;else if((g=x(c,a,m.from))&&
m.active&&!m.Ya){e(d,g);m.Ya=g;return}g=w(d,m,n(m));m.Ya=g}});y.Ih(c,a,function(a,b,c){u(d,c.Ya)});y.Zj(c,a,function(a,b,c){c.Ya&&"NONE"==c.to&&u(d,c.Ya)})})}function n(a){a=X.bh(a);delete a.to;delete a.active;delete a.Ya;return JSON.stringify(a)}function x(a,b,c){var d=null;y.Ih(a,b,function(a,b,f){if(f.active&&f.from==f.to&&f.from==c&&f.Ya)return d=f.Ya,!0});y.Zj(a,b,function(a,b,f){if(f.active&&f.from==c&&f.Ya)return d=f.Ya,!0});return d}function e(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Ky===
b&&d.Vp++}}function u(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Ky===b&&d.Vp&&d.Vp--}}function w(a,b,c){if(b.tl)return e(a,b.tl.Ya),b.tl.Ya;if(b.un)return h(b);for(var d=null,f=0;f<a.length;f++){var g=a[f];if(g.id==c&&0===g.Vp){d=g;break}}if(d&&!L.IB)return d.Vp++,d.Ky;b=h(b);a.push({id:c,Vp:1,Ky:b});return b}function h(a){var b=a.Al*a.size,c=a.Bl*a.size,d=a.FF;switch(a.from){case "COLOR":return a.Ke?(d=D.Gk(a.Aj?D.Xq:D.Wq,d),D.resize(d,b,c)):(d=D.Gk(D.Vg,d),D.resize(d,b,c),D.ky(d,a.Ma,a.La)),
d;case "DEPTH":return a.Ke?(d=D.Gk(a.Aj?D.Vq:D.Uq,d),D.resize(d,b,c)):(d=D.Gk(D.ik,d),D.resize(d,b,c),D.ky(d,a.Ma,a.La)),d;case "CUBEMAP":return d=D.hB(b);case "SCREEN":case "NONE":return null;default:X.D("Wrong slink param: "+a.from)}}function m(a,b){var c=!1;y.ag(a,function(d,f,e){if(e&&(d=y.Ra(a,d),f=y.Ra(a,f),b(e,!1,d,f)))return c=!0});c||y.ha(a,function(a,c){for(var d=0;d<c.Xa.length;d++)if(b(c.Xa[d],!0,c,null))return!0})}function B(a){y.ha(a,function(b,c){if(c.type!=G.Xl){var d=c.B;y.Zj(a,b,
function(a,b,c){c.active&&c.Ya&&(H.Jt(d,c.from,c.Ya),c.from==c.to&&b.B&&H.Jt(b.B,c.from,c.Ya))});for(var f=0;f<c.Xa.length;f++){var e=c.Xa[f];e.active&&e.from==e.to&&H.Jt(d,e.from,c.Hh[f])}!d.lc&&!d.we||d.ee||(d.ee=Z.BP(d.lc,d.we))}});y.ha(a,function(b,c){if(c.type==G.Qq||c.type==G.Fu){var d=I(a,c);c.B.fp=d[0].B.ee}})}function k(a){var b=null,c=0;y.ha(a,function(a,d){if(d.type==V.oq){if(c==V.iR)return b=d,!0;c++}});return b}function f(a,b){var c=y.yh(a,b),d=G.Fc("NONE"),f=y.O(a,d),e=y.kp(a)[0];y.ag(a,
function(b,c){c==e&&y.uP(a,b,e,b,f)});var g=F(b,a);y.ag(a,function(f,e,h){if(f==c){if(g){f=G.Dr();y.O(a,f);e=q("COLOR","RESOLVE",1,1,1,!0);e.Aj=!0;e.Ke=!0;var m=q("DEPTH","RESOLVE",1,1,1,!0);m.Aj=!0;m.Ke=!0;y.C(a,b,f,e);y.C(a,b,f,m);b=f}y.C(a,b,d,q(V.LQ,"u_color",h.size,h.Al,h.Bl,h.tq));return!0}});y.Nc(a,f,e,q("SCREEN","NONE",.5,.5,.5,!0))}function F(a,b){var c=!1,d=y.yh(b,a);y.Ig(b,d)&&(c=y.qh(b,d,0),d=y.yd(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=y.Ra(b,c),c=F(d,
b)):c="RESOLVE"==d.to);return c}function t(a,b,c,d){var f=c.ea,e=b.zs,g=b.Eh.Bh,h=b.Eh.wt,m=y.mn(a,y.pN(a,d),y.Sl),k=[],l=[],p=[],m=y.clone(m,function(b){var d;if(-1<pa.indexOf(b.type))l.push(b),d=b;else{d=G.oK(b);if(d.type==G.qd)for(var m=0;m<g.length;m++)if(g[m][0]==b){g[m]=[b,d];d.B.hc=b.B.hc;c.ea.push(d.B);break}if(b.type==G.Qe)for(m=0;m<g.length;m++){if(h[m][0]==b){h[m]=[b,d];d.B=g[m][1].B;break}}else-1<f.indexOf(b.B)&&(e?(H.Us(b.B,H.re),H.Us(d.B,H.Yd),d.Zr=!0):(H.Us(b.B,H.pc),H.Us(d.B,H.wc)),
f.push(d.B));var n=y.yh(a,b);y.Ih(a,n,function(a,b,c){-1<pa.indexOf(b.type)&&k.push([b,d,c])});if(b.type!==G.Ug)for(m=0;m<b.Xa.length;m++)d.Xa[m].tl=b.Xa[m];b=!0;for(m=0;m<y.Yk(a,n);m++){var q=y.nh(a,n,m),q=y.Ra(a,q);-1==pa.indexOf(q.type)&&(b=!1)}b&&p.push(d)}return d},function(a){var b=E(a,!0);b.tl=a;return b});y.ag(m,function(a,b,c){y.Ra(m,a).type===G.Ug&&(c.tl=null)});for(var n=0;n<l.length;n++)y.Vf(m,y.yh(m,l[n]));y.xv(m);b=G.uL(e);n=y.O(a,b);if(L.Ds)var t=G.Fc("NONE"),v=q("COLOR","u_color",
1,1,1,!0);else t=G.Lv(),v=q("COLOR","COPY",1,1,1,!0);y.O(a,t);y.C(a,d,t,v);var u=q("COLOR","u_sampler_left",1,1,1,!0);u.un=!0;u.Ma=D.P;u.La=D.P;y.C(a,t,b,u);if(!d.gc){if(L.Ds)var u=G.Fc("NONE"),B=q("COLOR","u_color",1,1,1,!0);else u=G.Lv(),B=q("COLOR","COPY",1,1,1,!0);y.O(m,u);B.tl=v;var w=y.kp(m)[0],w=y.Ra(m,w);y.C(m,w,u,B)}u=q("COLOR","u_sampler_right",1,1,1,!0);d.gc&&(u.tl=v);u.Ma=D.P;u.La=D.P;y.fA(m,a,[y.kp(m)[0],n,u]);for(n=0;n<k.length;n++)y.C(a,k[n][0],k[n][1],k[n][2]);d=q("SCREEN","NONE",
0,0,0,!1);for(n=0;n<p.length;n++)y.C(a,t,p[n],d);return b}function q(a,b,c,d,f,e){return{from:a,to:b,size:c,Al:d,Bl:f,tq:e,active:!0,Ya:null,Aj:!1,Ke:!1,Ma:D.Se,La:D.Se,un:!1,FF:!1}}function E(a,b){if(b){var c=a.Ya;a.Ya=null}a.Ya&&X.D("Failed to clone slink with attached texture");var d=X.bh(a);b&&(a.Ya=c,d.Ya=c);return d}function J(a,b,c){if(b.type==c)return!0;b=C(a,b);for(var d=0;d<b.length;d++)if(J(a,b[d],c))return!0;return!1}function A(a,b,c){if(b.type==c)return!0;b=I(a,b);for(var d=0;d<b.length;d++)if(A(a,
b[d],c))return!0;return!1}function I(a,b){var c=y.yh(a,b);c==y.Ou&&X.D("Subscene not in graph");for(var d=[],f=y.Yk(a,c),e=0;e<f;e++){var g=y.nh(a,c,e);g!=c&&d.push(y.Ra(a,g))}return d}function C(a,b){var c=y.yh(a,b);c==y.Ou&&X.D("Subscene not in graph");for(var d=[],f=y.Ig(a,c),e=0;e<f;e++){var g=y.qh(a,c,e);g!=c&&d.push(y.Ra(a,g))}return d}function v(a){var b=[],c=[];m(a,function(a){a.Ya&&-1==b.indexOf(a.Ya)&&(b.push(a.Ya),c.push(a.Ya,b.length-1))});return c}function l(a,b){var c;c=""+(a.from+"\\n");
c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.tq){var d=a.Al,f=a.Bl;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(f)!=f&&(f=f.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==f?"":f)+"S")}else d=a.Al,f=a.Bl,c+=a.size*d+"x"+a.size*f;if("SCREEN"!=a.from){c+=" ";if(a.Ke)c+="RR";else{var d=a.Ma,f=a.La,e="";d==D.P?e+="L":d==D.Se&&(e+="N");f==D.P?e+="L":f==D.Se&&(e+="N");c+=e}for(d=0;d<b.length;d+=2)b[d]==a.Ya&&(c+=" "+b[d+1])}return c+")\\n"}var z=r("__batch"),H=r("__camera"),p=r("__config"),Q=r("__debug"),y=r("__graph"),
Z=r("__renderer"),S=r("__shaders"),G=r("__subscene"),D=r("__textures"),X=r("__util"),V=p.Jk,L=p.H,ba=p.$m,pa=[G.Ph,G.Xc,G.Wc,G.qe];a.bK=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.sR=m;a.RK=function(a,b,e,h){function m(c){var d=H.xc(La,!0);b.ea.push(d);d=G.Fk(c,d,!1,F,r,Aa,Sa,T,a.Ji);y.O(l,d);c==G.tf?(y.C(l,p[0],d,q("COLOR","COLOR",1,1,1,!0)),d.Xa.push(q("DEPTH","DEPTH",1,1,1,
!0))):(c=U&&p[0].type==G.Qq?Wa:p[0],y.C(l,c,d,Fa),y.C(l,c,d,ga));fa&&(y.C(l,fa,d,ja),y.C(l,fa,d,R));for(c=0;c<v.length;c++)y.C(l,v[c],d,u[c]);Gc&&y.C(l,Gc,d,hd);if(w.length){var f=w.length;for(c=0;c<f;c++)y.C(l,w[c],d,x[c])}if(z.length)for(c=0;c<z.length;c++)y.C(l,z[c],d,A[c]);Qb&&y.C(l,Qb,d,Qc);return d}var l=y.create(),p=[],n=[],v=[],u=[],w=[],x=[],z=[],A=[],r=a.aO,F=a.Bc,J=a.shore_smoothing,Y=a.NQ,S=a.ssao,O=a.god_rays,pa=a.Eh,Z=a.cD,ha=a.sJ,K=a.motion_blur,ia=a.compositing,na=a.antialiasing,Sa=
a.Gn,Aa=a.dG,T=a.Jc,ua=a.HO,Ca=a.PJ,Ga=a.yN,N=a.XO,qa=a.dof,Ta=a.HL,Ea=a.refractions,Ba=!!h.length,U=1<L.uc,ga=q("COLOR","COLOR",1,1,1,!0),Fa=q("DEPTH","DEPTH",1,1,1,!0);if(U){var Ra=E(Fa);ga.Aj=!0;ga.Ke=!0;Fa.Aj=!0;Fa.Ke=!0}var La=b.ea[0];if(a.yc){var fa=G.iL();y.O(l,fa);var Ha=ba.mp;fa.B.width=Ha;fa.B.height=Ha;var ja=q("DEPTH","u_grass_map_depth",Ha,1,1,!1);L.Yb||(ja.Ma=D.P,ja.La=D.P);var R=q("COLOR","u_grass_map_color",Ha,1,1,!1);R.Ma=D.P;R.La=D.P}else R=ja=fa=null;if(T){H.$y(La,T);for(var Da=
0;Da<T.Cg.length;Da++)for(var ab=T.csm_num,ya=0;ya<ab;ya++){var Xa=G.pL(ya,Da,T,r);y.O(l,Xa);v.push(Xa);var Ha=T.csm_resolution,Qa=Xa.B;b.zE.push(Qa);Qa.width=Ha;Qa.height=Ha;Xa.rb=!1;var Bb=q("DEPTH","u_shadow_map"+(0<Da?Da:ya),Ha,1,1,!1);L.Go&&(Bb.Ma=D.P,Bb.La=D.P,Bb.FF=!0);u.push(Bb);(Q.WJ()||L.AE)&&Xa.Xa.push(q("COLOR","COLOR",Ha,1,1,!1));fa&&(y.C(l,fa,Xa,ja),y.C(l,fa,Xa,R))}}if(pa&&pa.pD&&!Ba)for(ya=0;ya<pa.pD;ya++){Qa=H.Pc(H.Zc);Qa.width=a.ci;Qa.height=a.ci;H.jE(Qa,Math.PI/2,.1,100);H.Sj(Qa,
!1);var Ma=G.Fk(G.Wc,Qa,!1,F,r,Aa,Sa,null,a.Ji);Ma.Hk=X.KM();for(Da=0;6>Da;Da++)Ma.Po.push(H.GK());y.O(l,Ma);var za=q("CUBEMAP","u_cube_reflection",a.ci,1,1,!1);za.Ma=D.P;za.La=D.P;A.push(za);fa&&(y.C(l,fa,Ma,ja),y.C(l,fa,Ma,R));if(pa.sC){var Oa=G.Fk(G.qe,Qa,!1,F,r,Aa,Sa,null,a.Ji);Oa.Hk=Ma.Hk;Oa.Po=Ma.Po;y.O(l,Oa);var $a=q("DEPTH","DEPTH",a.ci,1,1,!1),db=q("COLOR","COLOR",a.ci,1,1,!1);y.C(l,Ma,Oa,$a);y.C(l,Ma,Oa,db);z.push(Oa);pa.Pv.push(Oa);fa&&(y.C(l,fa,Oa,ja),y.C(l,fa,Oa,R))}else{var wb=q("DEPTH",
"DEPTH",a.ci,1,1,!1);Ma.Xa.push(wb);z.push(Ma)}pa.bi.push(Ma)}if(pa&&0<pa.QD.length&&!Ba)for(Da=0;Da<pa.QD.length;Da++)Qa=H.xc(La,!0),Qa.hc=new Float32Array(4),b.ea.push(Qa),Ma=G.Fk(G.qd,Qa,!1,F,r,Aa,Sa,null,a.Ji),y.O(l,Ma),za=q("COLOR","u_plane_reflection",1,a.Lg,a.Lg,!0),za.Ma=D.P,za.La=D.P,x.push(za),fa&&(y.C(l,fa,Ma,ja),y.C(l,fa,Ma,R)),pa.sC?(Oa=G.Fk(G.Qe,Qa,!1,F,r,Aa,Sa,null,a.Ji),y.O(l,Oa),$a=q("DEPTH","DEPTH",1,a.Lg,a.Lg,!0),db=q("COLOR","COLOR",1,a.Lg,a.Lg,!0),db.Ma=D.Se,db.La=D.Se,y.C(l,
Ma,Oa,$a),y.C(l,Ma,Oa,db),pa.wt.push([Oa]),w.push(Oa),fa&&(y.C(l,fa,Oa,ja),y.C(l,fa,Oa,R))):(wb=q("DEPTH","DEPTH",1,a.Lg,a.Lg,!0),Ma.Xa.push(wb),w.push(Ma)),pa.Bh.push([Ma]);if(Ta&&T){var xb=H.xc(La,!0);b.ea.push(xb);var Ua=G.qL(xb,r);y.O(l,Ua);Ua.self_shadow_normal_offset=T.self_shadow_normal_offset;for(ya=0;ya<v.length;ya++)Xa=v[ya],y.C(l,Xa,Ua,u[ya]);var xc=q("COLOR","u_color",1,1,1,!0),eb=q("DEPTH","u_depth",1,1,1,!0);if(S){var lb=H.xc(La,!0);b.ea.push(lb);var Ya=a.cR,Va=G.sL(lb,Aa,Ya);y.O(l,
Va);var Cb=q("COLOR","u_ssao_mask",1,1,1,!0);y.C(l,Ua,Va,xc);y.C(l,Ua,Va,eb);var Yc=H.xc(La,!0);b.ea.push(Yc);var Mb=G.tL(Yc,Ya);y.O(l,Mb);var Nb=q("COLOR","u_shadow_mask",1,1,1,!0);y.C(l,Va,Mb,Cb);y.C(l,Ua,Mb,eb)}U?Ua.Xa.push(q("DEPTH","DEPTH",1,1,1,!0)):Ua.Xa.push(Fa);fa&&(y.C(l,fa,Ua,ja),y.C(l,fa,Ua,R))}else Ua=null;var Wa=G.Fk(G.Db,La,!0,F,r,Aa,Sa,null,a.Ji);y.O(l,Wa);if(U){var Hb=G.Dr();y.O(l,Hb);n.push(Hb);var qb=q("COLOR","RESOLVE",1,1,1,!0);qb.Aj=!0;qb.Ke=!0;var dc=q("DEPTH","RESOLVE",1,1,
1,!0);dc.Aj=!0;dc.Ke=!0;y.C(l,Wa,Hb,qb);y.C(l,Wa,Hb,dc)}else n.push(Wa);Ua&&(Cb?y.C(l,Mb,Wa,Nb):T?y.C(l,Ua,Wa,q("COLOR","u_shadow_mask",1,1,1,!0)):X.D("Internal error"));fa&&(y.C(l,fa,Wa,ja),y.C(l,fa,Wa,R));if(w.length)for(var Rc=w.length,Da=0;Da<Rc;Da++)y.C(l,w[Da],Wa,x[Da]);if(z.length)for(Da=0;Da<z.length;Da++)y.C(l,z[Da],Wa,A[Da]);p=n;n=[];if(!Ba&&a.rK){var kc=V.enabled&&(V.oq===G.Wd||V.oq===G.dg),Qa=H.xc(La,!0);kc||(Qa.width=Qa.height=1);b.ea.push(Qa);var Ub=G.kB(Qa,!1,r);y.O(l,Ub);if(a.Tg){Qa=
H.xc(La,!0);kc||(Qa.width=Qa.height=1);b.ea.push(Qa);var Yb=G.kB(Qa,!0,r);y.O(l,Yb);y.C(l,Ub,Yb,q("COLOR","COLOR",1,1,1,kc));y.C(l,Ub,Yb,q("DEPTH","DEPTH",1,1,1,kc))}}else Ub=null;if(!Z.refractions&&!Ea||Ba)Qb=null;else{if(U)Qb=Hb;else{if(L.Ds)var Qb=G.Fc("NONE"),Sc=q("COLOR","u_color",1,1,1,!0);else Qb=G.Lv(),Sc=q("COLOR","COPY",1,1,1,!0);y.O(l,Qb);y.C(l,p[0],Qb,Sc)}var Qc=q("COLOR","u_refractmap",1,1,1,!0)}if(Ta&&(Ea||J||Y)){var yc=H.xc(La,!0);b.ea.push(yc);var Gc=G.fL(yc);y.O(l,Gc);y.C(l,U?Hb:
Wa,Gc,q("DEPTH","u_depth",1,1,1,!0));var hd=q("COLOR","u_scene_depth",1,1,1,!0);hd.Ma=D.Se;hd.La=D.Se}else Gc=null;if(a.lp){var Hc=m(G.Vc);n.push(Hc);p=n;n=[]}if(a.ii){var qc=H.xc(La,!0);b.ea.push(qc);var ec=G.Fk(G.Id,qc,!1,F,r,Aa,Sa);y.O(l,ec);Gc&&y.C(l,Gc,ec,hd);Qb&&y.C(l,Qb,ec,Qc);fa&&(y.C(l,fa,ec,ja),y.C(l,fa,ec,R));if(w.length)for(Rc=w.length,Da=0;Da<Rc;Da++)y.C(l,w[Da],ec,x[Da]);if(z.length)for(Da=0;Da<z.length;Da++)y.C(l,z[Da],ec,A[Da]);a.lp&&y.C(l,ec,Hc,q("SCREEN","NONE",0,0,0,!0));y.C(l,
U?Hb:Wa,ec,U?Ra:Fa);var rb=G.Fc("X_GLOW_BLUR");rb.sb="GLOW_MASK_SMALL";rb.Zf=a.oj.small_glow_mask_width;var rc=q("COLOR","u_color",1,1,1,!0);rc.Ma=D.P;rc.La=D.P;y.O(l,rb);y.C(l,ec,rb,rc);var Ib=G.Fc("Y_GLOW_BLUR");Ib.sb="GLOW_MASK_SMALL";Ib.Zf=a.oj.small_glow_mask_width;var ib=q("COLOR","u_color",1,.5,.5,!0);ib.Ma=D.P;ib.La=D.P;y.O(l,Ib);y.C(l,rb,Ib,ib);var bb=G.Fc("X_GLOW_BLUR");bb.sb="GLOW_MASK_LARGE";bb.Zf=a.oj.large_glow_mask_width;var zc=q("COLOR","u_color",1,.5,.5,!0);zc.Ma=D.P;zc.La=D.P;y.O(l,
bb);y.C(l,Ib,bb,zc);var fb=G.Fc("Y_GLOW_BLUR");fb.sb="GLOW_MASK_LARGE";fb.Zf=a.oj.large_glow_mask_width;var Zc=q("COLOR","u_color",1,.25,.25,!0);Zc.Ma=D.P;Zc.La=D.P;y.O(l,fb);y.C(l,bb,fb,Zc);var ld=H.xc(La,!0);b.ea.push(ld);var Ob=G.gL(ld,a);y.O(l,Ob);var $c=q("COLOR","u_src_color",1,1,1,!0);if(a.lp)if(U){var sc=G.Dr();y.O(l,sc);y.C(l,Hc,sc,qb);y.C(l,Hc,sc,dc);y.C(l,sc,Ob,$c)}else y.C(l,Hc,Ob,$c);else y.C(l,U?Hb:Wa,Ob,$c);y.C(l,a.lp?Hc:Wa,Ob,Fa);var Zb=q("COLOR","u_glow_mask_small",1,.5,.5,!0);Zb.Ma=
D.P;Zb.La=D.P;y.C(l,Ib,Ob,Zb);var Tc=q("COLOR","u_glow_mask_large",1,.25,.25,!0);Tc.Ma=D.P;Tc.La=D.P;y.C(l,fb,Ob,Tc);p=[Ob];n=[]}a.lp||(Hc=m(G.Vc),n.push(Hc),p=n,n=[]);if(L.debug_view){Qa=H.xc(La,!0);b.ea.push(Qa);var Jb=G.eL(Qa);n.push(Jb);y.O(l,Jb);y.C(l,p[0],Jb,ga);y.C(l,p[0],Jb,Fa);fa&&(y.C(l,fa,Jb,ja),y.C(l,fa,Jb,R));Q.dQ(Jb);p=n;n=[]}if(U){var Vb=G.Dr();y.O(l,Vb);n.push(Vb);y.C(l,p[0],Vb,qb);y.C(l,p[0],Vb,dc);p=n;n=[]}var Kb=p.slice(0);if(!Ba&&a.AI){Qa=H.xc(La,!0);b.ea.push(Qa);var lc=G.aL(Qa);
y.O(l,lc);y.C(l,p[0],lc,U?Ra:Fa)}if(O&&Ta&&!Ba){var tc=Ga.Im,id=Ga.Rw,yb=Ga.ln,Za=p[0],gb=F?!0:!1,cb=q("DEPTH","u_input",1,1,1,!0),fc=q("COLOR","u_input",1,.25,.25,!0);fc.Ma=D.P;fc.La=D.P;var Ac=tc/yb,Uc=H.xc(La,!0);b.ea.push(Uc);var mc=G.Mv(Uc,gb,tc,!0,Ac,r,yb);y.O(l,mc);y.C(l,Za,mc,cb);var Ac=tc/yb*.5,Bc=H.xc(La,!0);b.ea.push(Bc);var Rb=G.Mv(Bc,gb,tc,!1,Ac,r,yb);y.O(l,Rb);y.C(l,mc,Rb,fc);var Ac=tc/yb*.25,Cc=H.xc(La,!0);b.ea.push(Cc);var Dc=G.Mv(Cc,gb,tc,!1,Ac,r,yb);y.O(l,Dc);y.C(l,Rb,Dc,fc);var gc=
G.hL(id,r);n.push(gc);y.O(l,gc);y.C(l,Za,gc,q("COLOR","u_main",1,1,1,!0));y.C(l,Dc,gc,q("COLOR","u_god_rays",1,1,1,!0));p=n;n=[]}if(ha&&!Ba){var Za=p[0],Wb=G.jL();y.O(l,Wb);y.C(l,Za,Wb,q("COLOR","u_input",1,1,1,!0));var $b=G.bL();y.O(l,$b);$b.B.width=1;$b.B.height=1;var sb=q("COLOR","u_input",1,.25,.25,!0);sb.Ma=D.P;sb.La=D.P;var tb=q("COLOR","u_luminance",1,.25,.25,!0);tb.Ma=D.P;tb.La=D.P;y.C(l,Wb,$b,sb);var mb=ha.key,Ic=ha.edge_lum,ad=H.xc(La,!0);b.ea.push(ad);var ub=G.kL(mb,Ic,r,ad);y.O(l,ub);
y.C(l,Za,ub,q("COLOR","u_main",1,1,1,!0));y.C(l,Wb,ub,tb);y.C(l,$b,ub,q("COLOR","u_average_lum",1,1,1,!1));var Db=q("COLOR","u_color",1,.25,.25,!0);Db.Ma=D.P;Db.La=D.P;rb=G.jB("X_BLUR");y.O(l,rb);y.C(l,ub,rb,Db);Ib=G.jB("Y_BLUR");y.O(l,Ib);y.C(l,rb,Ib,Db);var vb=G.cL(ha.blur);y.O(l,vb);var Jc=q("COLOR","u_bloom",1,.25,.25,!0);Jc.Ma=D.P;Jc.La=D.P;y.C(l,Ib,vb,Jc);y.C(l,Za,vb,q("COLOR","u_main",1,1,1,!0));n.push(vb);p=n;n=[]}if(qa&&Ta&&!Ba){var Za=p[0],Na=H.xc(La,!0);b.ea.push(Na);if(e.dof_bokeh){var hb=
q("COLOR","u_color",1,1,1,!0);hb.Ma=D.P;hb.La=D.P;var zb=q("DEPTH","u_depth",1,1,1,!0),hc=q("COLOR","u_color",1,.5,.5,!0);hc.Ma=D.Se;hc.La=D.Se;Db=q("COLOR","u_color",1,.5,.5,!0);Db.Ma=D.Se;Db.La=D.Se;var Ja=q("COLOR","u_blurred1",1,.5,.5,!0);Ja.Ma=D.P;Ja.La=D.P;var ac=q("COLOR","u_blurred2",1,.5,.5,!0);ac.Ma=D.P;ac.La=D.P;var Lb=Kb[0];if(e.gd){var Eb=H.xc(La,!0);b.ea.push(Eb);var jb=G.Kv(Eb,"COC_FOREGROUND");Eb.dof_distance=e.dof_distance;Eb.dof_object=e.dof_object;Eb.dof_front_start=e.dof_front_start;
Eb.dof_front_end=e.dof_front_end;Eb.dof_rear_start=e.dof_rear_start;Eb.dof_rear_end=e.dof_rear_end;Eb.dof_power=e.dof_power;Eb.dof_bokeh=e.dof_bokeh;Eb.dof_bokeh_intensity=e.dof_bokeh_intensity;Eb.gd=e.gd;Eb.dof_on=!0;y.O(l,jb);y.C(l,Za,jb,hb);y.C(l,Lb,jb,zb);var Pb=G.Fc("X_ALPHA_BLUR");y.O(l,Pb);y.C(l,jb,Pb,hc);var Ab=G.Fc("Y_ALPHA_BLUR");y.O(l,Ab);y.C(l,Pb,Ab,Db);var Pa=H.xc(La,!0),Sb=G.Kv(Pa,"COC_COMBINE");b.ea.push(Pa);Pa.dof_distance=e.dof_distance;Pa.dof_object=e.dof_object;Pa.dof_front_start=
e.dof_front_start;Pa.dof_front_end=e.dof_front_end;Pa.dof_rear_start=e.dof_rear_start;Pa.dof_rear_end=e.dof_rear_end;Pa.dof_power=e.dof_power;Pa.dof_bokeh=e.dof_bokeh;Pa.dof_bokeh_intensity=e.dof_bokeh_intensity;Pa.gd=e.gd;Pa.dof_on=!0;y.O(l,Sb);y.C(l,Za,Sb,hb);y.C(l,Lb,Sb,zb);y.C(l,Ab,Sb,q("COLOR","u_coc_fg",1,.5,.5,!0))}else Pa=H.xc(La,!0),b.ea.push(Pa),Sb=G.Kv(Pa,"COC_ALL"),Pa.dof_distance=e.dof_distance,Pa.dof_object=e.dof_object,Pa.dof_front_start=e.dof_front_start,Pa.dof_front_end=e.dof_front_end,
Pa.dof_rear_start=e.dof_rear_start,Pa.dof_rear_end=e.dof_rear_end,Pa.dof_power=e.dof_power,Pa.dof_bokeh=e.dof_bokeh,Pa.dof_bokeh_intensity=e.dof_bokeh_intensity,Pa.gd=e.gd,Pa.dof_on=!0,y.O(l,Sb),y.C(l,Za,Sb,hb),y.C(l,Lb,Sb,zb);var Fb=G.Fc("X_DOF_BLUR");Fb.B.dof_bokeh_intensity=e.dof_bokeh_intensity;y.O(l,Fb);y.C(l,Sb,Fb,hc);var Ec=G.Fc("Y_DOF_BLUR");Ec.B.dof_bokeh_intensity=e.dof_bokeh_intensity;y.O(l,Ec);y.C(l,Fb,Ec,Db);var Kc=G.Fc("Y_DOF_BLUR");Kc.B.dof_bokeh_intensity=e.dof_bokeh_intensity;y.O(l,
Kc);y.C(l,Fb,Kc,Db);var Gb=G.lB(Na);Na.dof_distance=e.dof_distance;Na.dof_object=e.dof_object;Na.dof_front_start=e.dof_front_start;Na.dof_front_end=e.dof_front_end;Na.dof_rear_start=e.dof_rear_start;Na.dof_rear_end=e.dof_rear_end;Na.dof_power=e.dof_power;Na.dof_bokeh=e.dof_bokeh;Na.dof_bokeh_intensity=e.dof_bokeh_intensity;Na.gd=e.gd;Na.dof_on=!0;n.push(Gb);y.O(l,Gb);y.C(l,Za,Gb,q("COLOR","u_sharp",1,1,1,!0));y.C(l,Ec,Gb,Ja);y.C(l,Kc,Gb,ac)}else{var Lc=q("COLOR","u_color",1,1,1,!0);Lc.Ma=D.P;Lc.La=
D.P;var Xb=q("COLOR","u_color",1,1,1,!0);Xb.Ma=D.P;Xb.La=D.P;Fb=G.Fc("X_BLUR");y.O(l,Fb);y.C(l,Za,Fb,Lc);var nc=G.Fc("Y_BLUR");y.O(l,nc);y.C(l,Fb,nc,Xb);var oc=Kb[0],Gb=G.lB(Na);Na.dof_distance=e.dof_distance;Na.dof_object=e.dof_object;Na.dof_front_start=e.dof_front_start;Na.dof_front_end=e.dof_front_end;Na.dof_rear_start=e.dof_rear_start;Na.dof_rear_end=e.dof_rear_end;Na.dof_power=e.dof_power;Na.dof_bokeh=e.dof_bokeh;Na.dof_bokeh_intensity=e.dof_bokeh_intensity;Na.gd=e.gd;Na.dof_on=!0;n.push(Gb);
y.O(l,Gb);y.C(l,Za,Gb,q("COLOR","u_sharp",1,1,1,!0));y.C(l,nc,Gb,q("COLOR","u_blurred",1,1,1,!0));y.C(l,oc,Gb,q("DEPTH","u_depth",1,1,1,!0))}p=n;n=[]}if(a.Tg){var bd=m(G.tf);n.push(bd);p=n;n=[]}if(K&&!Ba){var Vc=p[0],uc=G.lL(ua.mb_decay_threshold,ua.mb_factor);n.push(uc);y.O(l,uc);y.C(l,Vc,uc,q("COLOR","u_mb_tex_curr",1,1,1,!0));uc.Xa.push(q("COLOR","u_mb_tex_accum",1,1,1,!0));p=n;n=[]}if(!Ba&&a.outline){var Za=p[0],bc=H.xc(La,!0);b.ea.push(bc);var Mc=G.nL(bc,r);y.O(l,Mc);var Fc=G.Fc("X_EXTEND"),
Nc=q("COLOR","u_color",1,1,1,!0),cc=q("COLOR","u_outline_mask",1,1,1,!0);Fc.rp=!0;y.O(l,Fc);y.C(l,Mc,Fc,Nc);var nb=q("COLOR","u_color",1,.5,.5,!0);nb.Ma=D.P;nb.La=D.P;var ob=G.Fc("Y_EXTEND");ob.rp=!0;y.O(l,ob);y.C(l,Fc,ob,nb);Fb=G.Fc("X_BLUR");Fb.rp=!0;y.O(l,Fb);y.C(l,ob,Fb,nb);var Wc=q("COLOR","u_color",1,.25,.25,!0);Wc.Ma=D.P;Wc.La=D.P;var Oc=q("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Oc.Ma=D.P;Oc.La=D.P;nc=G.Fc("Y_BLUR");nc.rp=!0;y.O(l,nc);y.C(l,Fb,nc,Wc);var vc=G.mL(N);y.O(l,vc);y.C(l,Za,
vc,q("COLOR","u_outline_src",1,1,1,!0));y.C(l,Mc,vc,cc);y.C(l,nc,vc,Oc);n.push(vc);p=n;n=[]}d(l,Ta);if((a.anaglyph_use||a.zs)&&!Ba){var md=t(l,a,b,p[0]);n.push(md);p=n;n=[]}if(ia&&!Ba){var Za=p[0],cd=G.dL(Ca.brightness,Ca.contrast,Ca.exposure,Ca.saturation),pc=q("COLOR","u_color",1,1,1,!0);!a.anaglyph_use&&!a.zs||Ba||(pc.un=!0);y.O(l,cd);y.C(l,Za,cd,pc);n.push(cd);p=n;n=[]}if(na){Za=p[0];if(L.smaa){var ic=q("COLOR","u_color",1,1,1,!0);ic.Ma=D.P;ic.La=D.P;var Tb=G.Nv(G.Rq,a);y.O(l,Tb);y.C(l,Za,Tb,
ic);var wc=G.Nv(G.Qn,a);y.O(l,wc);y.C(l,Tb,wc,ic);var nd=q("COLOR","u_search_tex",1,1,1,!1),jc=q("COLOR","u_area_tex",1,1,1,!1);nd.Ma=D.P;nd.La=D.P;jc.Ma=D.P;jc.La=D.P;wc.Xa.push(nd);wc.Xa.push(jc);var od=G.Nv(G.Sq,a);y.O(l,od);y.C(l,Za,od,ic);var pd=q("COLOR","u_blend",1,1,1,!0);pd.Ma=D.P;pd.La=D.P;y.C(l,wc,od,pd);n.push(od)}else{var dd=G.$K(a);y.O(l,dd);var qd=q("COLOR","u_color",1,1,1,!0);qd.Ma=D.P;qd.La=D.P;!a.anaglyph_use&&!a.zs||Ba||(qd.un=!0);y.C(l,Za,dd,qd);n.push(dd)}p=n;n=[]}var xd=y.yh(l,
p[0]);if(p[0].type==G.Ug||p[0].type==G.Qq)var ed=!0;else ed=!1,y.Ih(l,xd,function(a,b,c){if(c.from==c.to)return ed=!0});if(ed){var fd=G.Fc("NONE");y.O(l,fd);y.C(l,p[0],fd,q("COLOR","u_color",1,1,1,!0));n.push(fd);p=n;n=[]}n.push(p[0]);Ub&&(Yb?n.push(Yb):n.push(Ub));lc&&n.push(lc);Ha=ba.Fr;if(a.Ot.TD){var Bd=a.Ot,td=a.Gn,yd=td.fn,Ha=yd?yd.kR:Ha,ud=G.rL(td,r,Bd,Ha);y.O(l,ud);n.push(ud)}var pb=G.mB();y.O(l,pb);for(ya=0;ya<n.length;ya++){var jd=n[ya];switch(jd.type){case G.Wd:case G.dg:y.C(l,jd,pb,q("COLOR",
"NONE",1,1,1,kc));y.C(l,jd,pb,q("DEPTH","NONE",1,1,1,kc));break;case G.gg:y.C(l,jd,pb,q("CUBEMAP","u_sky",Ha,1,1,!1));break;case G.Rl:y.C(l,jd,pb,q("COLOR","NONE",1,1,1,!0));break;default:if(Ba){var Xc=h[0],kd=q("COLOR","OFFSCREEN",1,1,1,!0);kd.Ya=Xc;y.C(l,n[ya],pb,kd);for(Da=1;Da<h.length;Da++){var vd=h[Da],rd=G.Fc("NONE");y.O(l,rd);y.C(l,n[ya],rd,q("COLOR","SCALE",1,1,1,!0));var gd=vd.Ci/Xc.Ci,kd=q("COLOR","OFFSCREEN",1,gd,gd,!0);kd.Ya=vd;y.C(l,rd,pb,kd)}}else y.C(l,n[ya],pb,q("SCREEN","NONE",1,
1,1,!0))}}Hb&&!C(l,Hb).length&&(y.Vf(l,y.yh(l,Hb)),y.xv(l));d(l,Ta);c(l,Ta);if(V.enabled){var zd=k(l);zd&&f(l,zd)}g(l);B(l);T&&y.ha(l,function(a,b){if(b.type==G.Re||b.type==G.Vc||b.type==G.tf){for(var c=0,d=I(l,b),f=0,e=0;e<d.length;e++){var g=d[e];g.type==G.Xc&&(f++,b.rl=b.rl||[],b.rl[0<g.Pg?g.Pg:c]=g.B.lb,c++)}b.ku&&b.ju||(L.Ts?b.gz=new Float32Array(9*f):(b.ku=new Float32Array(4*f),b.ju=new Float32Array(4*f)))}});return l};a.NO=function(a,b,c){var d=[];y.ha(a,function(b,c){if(-1==pa.indexOf(c.type)&&
c.Xa.length&&J(a,c,G.uf))for(var f=0;f<c.Xa.length;f++){var e=c.Xa[f];-1==d.indexOf(e)&&d.push(e)}});y.ag(a,function(b,c,f){b=y.Ra(a,b);c=y.Ra(a,c);-1==pa.indexOf(b.type)&&J(a,c,G.uf)&&-1==d.indexOf(f)&&d.push(f)});for(var f=0;f<d.length;f++)d[f].Al*=b,d[f].Bl*=c};a.od=function(a,b,c){var d=a.Zf;a.Ly[0]=b*a.xb[0]*d;a.Ly[1]=c*a.xb[1]*d};a.Ac=function(a,b){a.Zf=b};a.QK=function(){var a=y.create(),b=G.oL(),c=H.Pc(H.Yc);c.width=512;c.height=512;b.B=c;y.O(a,b);b.Xa.push(q("COLOR","u_color",512,1,1,!1));
c=G.mB();y.O(a,c);y.C(a,b,c,q("COLOR","NONE",512,1,1,!1));g(a);B(a);return a};a.oM=function(a){var b=null;y.ha(a,function(a,c){return c.B&&null===c.B.ee?(b=c,!0):!1});return b};a.mc=function(a,b,c){a=I(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.ww=function(a,b,c){a=I(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.lU=J;a.nU=A;a.mN=I;a.qN=C;a.dc=function(a,b){var c=null;y.ha(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.CL=function(a){var b=
"digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=v(a);y.ha(a,function(a,d){var f=b+="    ",e=G.Cy(d);if(d.B){for(var e=e+"\\n",g=0;g<c.length;g+=2){var h=d.B.lc;c[g]==h&&(e=D.Dm(h)?e+("CR"+c[g+1]+" "):e+("C"+c[g+1]+" "))}for(g=0;g<c.length;g+=2)h=d.B.we,c[g]==h&&(e=D.Dm(h)?e+("DR"+c[g+1]):e+("D"+c[g+1]))}d.Xa.length&&(e+="\\n-----\\n");for(g=0;g<d.Xa.length;g++)e+=l(d.Xa[g],c);b=f+(String(a)+' [label="'+
e+'" color="black" style="'+((d.type==G.Xl?"dotted":d.enqueue?"solid":"dashed")+",bold")+'"];\n')});y.ag(a,function(a,d,f){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+l(f,c)+'" style="'+(f.active?"solid":"dotted")+'"];\n'});return b+="}"};a.SK=function(a){a=y.mR(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b};a.Ck=function(a,b,c){var d=y.yh(a,b);y.Ih(a,d,function(a,b,d){if(d.active){switch(d.from){case "COLOR":case "CUBEMAP":var f=b.B.lc;break;case "DEPTH":f=
b.B.we;break;case "SCREEN":f=null;break;case G.Wc:return;default:X.D("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;default:f||X.D("Connection of SCREEN is forbidden"),f.pe&&X.D("Batch texture can't use renderbuffer"),S.TA(c.ib,d.to)&&z.Xi(c,f,d.to)}}});for(a=0;a<b.Xa.length;a++){var d=b.Xa[a],f=b.Hh[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;
default:f.pe&&X.D("Batch texture can't use renderbuffer"),S.TA(c.ib,d.to)&&z.Xi(c,f,d.to)}}}};b4w.module.__subscene=function(a,r){function d(a,b){a.jt=b;a.cx=new Float32Array(3*b);a.Bp=new Float32Array(4*b);a.zp=new Float32Array(4*b)}function c(a){a={type:a,sb:"",Zr:!1,yb:!1,yD:!1,cv:!1,ft:!1,Ro:0,Xe:0,Ik:[],debug_view_mode:0,debug_colors_seed:0,sB:1,$v:!1,time:0,B:null,Hk:null,Po:[],Qa:[],Xa:[],Hh:[],Ui:new Float32Array(3),hd:new Float32Array(3),ce:new Float32Array(4),Ef:new Float32Array(4),$d:new Float32Array(16),Qt:0,wg:0,jt:0,cx:null,Bp:null,zp:null,CU:null,Md:new Float32Array(3),Vd:new Float32Array(3),
Rt:new Float32Array(4),YE:new Float32Array(3),Dy:new Float32Array([0,0,1]),ZE:new Float32Array(4),Pt:new Float32Array(3),Fp:0,cw:0,rp:!1,wi:new Float32Array(3),Lh:!1,tv:0,Mh:null,kz:0,lz:0,fk:0,Bc:null,og:!1,KA:0,LA:new Float32Array(2),JA:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,en:new Float32Array(3),Xt:!1,
Ut:!1,Vt:0,Zt:0,Yt:0,Wt:0,mq:0,ssao_only:!1,ssao_white:!1,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Im:0,Ct:0,ln:0,Ov:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,ku:null,ju:null,gz:null,rl:null,gc:!1,NB:"",mr:0,$l:0,lr:0,hv:0,hw:0,mb_decay_threshold:0,mb_factor:0,iD:0,xt:"",YA:"",VN:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Ly:new Float32Array(2),xb:new Float32Array(2),Kk:new Float32Array(4),
chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,Pg:0,xx:!0,DE:!1,IE:!1,EE:!1,FE:!1,HE:!1,GE:!1,CE:"",Cq:!1,Dq:!1,Eq:!1,Ub:!0,enqueue:!0,rb:!0,tb:!0,wd:!0,Ba:!0,Zf:1};a.xb[0]=1;a.xb[1]=1;a.Kk[2]=.5;a.Kk[3]=.5;a.mq=8;return a}function b(a,b){return a==b?0:a>b?1:-1}function g(a,c){return-b(a.kg,c.kg)||b(a.Sf,c.Sf)||b(a.ib.py,c.ib.py)}var n=r("__camera"),x=r("__config"),e=r("__util"),u=r("__boundings"),w=x.Ic;a.Db=0;a.Vc=1;a.tf=2;a.qd=3;a.Wc=4;a.Qe=5;a.qe=6;a.Id=7;a.Xc=8;a.Re=9;a.Ph=
10;a.Zb=11;a.In=12;a.Ln=13;a.Qq=14;a.Wd=15;a.dg=16;a.eg=17;a.Rl=18;a.wz=19;a.Tq=20;a.Ru=21;a.pz=22;a.Qn=23;a.Rq=24;a.Pu=25;a.Sq=26;a.Eu=27;a.Ug=28;a.Du=29;a.Kn=30;a.fg=31;a.Vl=32;a.Ul=33;a.Oq=34;a.gg=35;a.Fu=36;a.uf=37;a.LUMINANCE=38;a.hG=39;a.Pq=40;a.Hn=41;a.kI=42;a.Xl=43;a.On=44;a.pL=function(a,b,e,g){var f=c(8);f.Ov=a;f.self_shadow_polygon_offset=e.self_shadow_polygon_offset;f.Pg=b;switch(e.Cg[b]){case "SPOT":case "POINT":f.B=n.Pc(n.Zc);n.jE(f.B,e.NE[b],e.xo[b],e.wo[b]);break;default:f.B=n.Pc(n.Qh)}d(f,
g);return f};a.oK=function(a){var b=a.B;a.B=null;var c=e.S(a);a.B=b;c.B=n.xc(b,!0);return c};a.iL=function(){var a=c(10);a.B=n.Pc(n.hg);return a};a.Fc=function(a){var b=c(11);b.rb=!1;b.tb=!1;b.wd=!1;b.gc=!0;b.B=n.Pc(n.Yc);b.xt=a;switch(a){case "NONE":b.xb[0]=1;b.xb[1]=1;break;case "GRAYSCALE":b.xb[0]=1;b.xb[1]=1;break;case "X_BLUR":b.xb[0]=1;b.xb[1]=0;break;case "Y_BLUR":b.xb[0]=0;b.xb[1]=1;break;case "X_GLOW_BLUR":b.xb[0]=1;b.xb[1]=0;break;case "Y_GLOW_BLUR":b.xb[0]=0;b.xb[1]=1;break;case "X_DOF_BLUR":b.xb[0]=
1;b.xb[1]=1;break;case "Y_DOF_BLUR":b.xb[0]=1;b.xb[1]=1;break;case "X_ALPHA_BLUR":b.xb[0]=1;b.xb[1]=0;b.Zf=3;break;case "Y_ALPHA_BLUR":b.xb[0]=0;b.xb[1]=1;b.Zf=3;break;case "X_EXTEND":b.xb[0]=1;b.xb[1]=0;break;case "Y_EXTEND":b.xb[0]=0;b.xb[1]=1;break;default:e.D("Wrong postprocessing effect: "+a)}return b};a.jB=function(a){var b=c(12);b.rb=!1;b.tb=!1;b.wd=!1;b.B=n.Pc(n.Yc);b.xt=a;b.gc=!0;switch(a){case "X_BLUR":b.xb[0]=1;b.xb[1]=0;break;case "Y_BLUR":b.xb[0]=0;b.xb[1]=1;break;default:e.D("Wrong postprocessing effect for bloom blur: "+
a)}return b};a.gL=function(a,b){var d=c(13);d.rb=!1;d.tb=!1;d.wd=!1;d.small_glow_mask_coeff=b.oj.small_glow_mask_coeff;d.large_glow_mask_coeff=b.oj.large_glow_mask_coeff;d.small_glow_mask_width=b.oj.small_glow_mask_width;d.large_glow_mask_width=b.oj.large_glow_mask_width;d.B=a;d.gc=!0;return d};a.Fk=function(a,b,g,k,f,n,t,q,u){var h=c(a);0==a?(h.rb=!0,h.tb=g,h.yb=!1):1==a?(h.rb=!1,h.tb=!1,h.yb=!0):2==a?(h.rb=!1,h.tb=!0,h.yb=!0):3==a||4==a?(h.rb=!0,h.tb=!0,h.yb=!1):5==a||6==a?(h.rb=!1,h.tb=!1,h.yb=
!0):7==a?(h.rb=!0,h.tb=!1,h.yb=!0):e.D("wrong main subscene type");h.yb&&q&&(h.self_shadow_normal_offset=q.self_shadow_normal_offset);h.B=b;if(a=t.fn)h.Rt.set([a.yA,a.xC,a.fG,a.eG]),h.Pt.set(a.color),h.Qt=a.ya;h.Md.set(t.Md);h.Vd.set(t.Vd);h.wg=t.wg;h.ce=n.ce;h.Ef=n.Ef;k&&(h.Bc=k,k.ce&&(h.Mh=new Float32Array(k.ce)),h.kz=k.waves_height,h.lz=k.waves_length,h.fk=k.fk,k.og&&u&&(h.og=!0,h.KA=k.NJ,h.JA=k.MJ,h.LA.set(k.OJ)));d(h,f);return h};a.Dr=function(){var a=c(14);a.gc=!0;a.B=n.Pc(n.Yc);return a};a.kB=
function(a,b,e){var g=c(15);b&&(g.type=16,g.rb=!1,g.tb=!0);g.enqueue=!1;g.B=a;d(g,e);return g};a.eL=function(a){var b=c(17);b.Ub=!1;b.rb=!1;b.tb=!1;b.B=a;return b};a.aL=function(a){var b=c(18);b.rb=!0;b.tb=!1;b.B=a;return b};a.qL=function(a,b){var e=c(9);e.B=a;d(e,b);return e};a.fL=function(a){var b=c(19);b.rb=!1;b.tb=!1;b.B=a;b.gc=!0;return b};a.sL=function(a,b,d){var e=c(20);e.rb=!1;e.tb=!1;e.wd=!1;e.B=a;e.ce=b.ce;e.Mh=new Float32Array(b.ce);e.Zt=d.radius_increase;e.Xt=d.EN;e.Yt=d.influence;e.Wt=
d.dist_factor;e.mq=d.UP;e.gc=!0;return e};a.tL=function(a,b){var d=c(21);d.rb=!1;d.tb=!1;d.wd=!1;d.B=a;d.Ut=b.tJ;d.Vt=b.blur_discard_value;d.gc=!0;return d};a.$K=function(a){var b=c(22);b.rb=!1;b.tb=!1;b.wd=!1;b.Zf=1/a.Xm;b.NB=a.Vz;b.B=n.Pc(n.Yc);b.gc=!0;return b};a.Nv=function(a,b){var d=c(a);d.rb=23==a||24==a?!0:!1;d.tb=!1;d.wd=!1;d.Zf=1/b.Xm;d.B=n.Pc(n.Yc);23==a&&(d.WN=new Float32Array(4));d.gc=!0;return d};a.dL=function(a,b,d,e){var f=c(27);f.rb=!1;f.tb=!1;f.wd=!1;f.B=n.Pc(n.Yc);f.brightness=
a;f.contrast=b;f.exposure=d;f.saturation=e;f.gc=!0;return f};a.lL=function(a,b){var d=c(28);d.rb=!1;d.tb=!1;d.wd=!1;d.B=n.Pc(n.Yc);d.cv=!0;d.mb_decay_threshold=a;d.mb_factor=b;d.gc=!0;return d};a.Kv=function(a,b){var d=c(29);d.rb=!1;d.tb=!1;d.wd=!1;d.B=a;d.Zf=d.B.dof_power;d.YA=b;d.gc=!0;return d};a.lB=function(a){var b=c(30);b.rb=!1;b.tb=!1;b.wd=!1;b.B=a;b.Zf=b.B.dof_power;b.gc=!0;return b};a.nL=function(a,b){var e=c(31);e.wd=!1;e.B=a;d(e,b);return e};a.mL=function(a){var b=c(32);w.outlining_overview_mode?
b.wi.set(w.wi):b.wi.set(a.wi);b.Fp=a.Fp;b.hw=5;b.hv=3;b.wd=!1;b.B=n.Pc(n.Yc);b.gc=!0;return b};a.Mv=function(a,b,e,g,f,n,t){var h=c(33);h.rb=!1;h.tb=!1;h.wd=!1;h.Md=new Float32Array([1,1,1]);h.Vd=new Float32Array([1,1,1]);h.wg=1;h.yD=g;h.Lh=b;h.Ct=f;h.Im=e;h.ln=t;h.B=a;d(h,n);return h};a.hL=function(a,b){var e=c(34);e.rb=!1;e.tb=!1;e.wd=!1;e.B=n.Pc(n.Yc);e.god_rays_intensity=a;d(e,b);e.gc=!0;return e};a.rL=function(a,b,g,k){var f=c(35);f.enqueue=!1;f.rb=!1;f.tb=!1;f.wd=!1;var h=n.Pc(n.Yc);h.width=
k;h.height=k;f.B=h;f.Hk=e.GM();d(f,b);f.Md=new Float32Array([1,1,1]);f.Vd=new Float32Array([1,1,1]);f.wg=1;f.en.set(g.en);f.procedural_skydome=g.procedural_skydome;f.use_as_environment_lighting=g.use_as_environment_lighting;f.rayleigh_brightness=g.rayleigh_brightness;f.mie_brightness=g.mie_brightness;f.spot_brightness=g.spot_brightness;f.scatter_strength=g.scatter_strength;f.rayleigh_strength=g.rayleigh_strength;f.mie_strength=g.mie_strength;f.rayleigh_collection_power=g.rayleigh_collection_power;
f.mie_collection_power=g.mie_collection_power;f.mie_distribution=g.mie_distribution;if(a){f.Md.set(a.Md);f.Vd.set(a.Vd);f.wg=a.wg;if(b=a.fn)f.Rt.set([b.yA,b.xC,b.fG,b.eG]),f.Pt.set(b.color),f.Qt=b.ya,f.DE=b.invert,f.IE=b.MF,f.EE=b.HF,f.FE=b.IF,f.HE=b.KF,f.GE=b.JF,f.CE=b.zA;f.Cq=a.Cq;f.Dq=a.Dq;f.Eq=a.Eq}return f};a.Lv=function(){var a=c(36);a.rb=!1;a.tb=!1;a.B=n.Pc(n.Yc);a.gc=!0;return a};a.uL=function(a){var b=c(37);b.rb=!1;b.tb=!1;b.sb=a?"HMD":"ANAGLYPH";b.B=n.Pc(n.Yc);b.gc=!0;return b};a.jL=function(){var a=
c(38);a.rb=!1;a.tb=!1;a.B=n.Pc(n.Yc);a.gc=!0;return a};a.bL=function(){var a=c(39);a.rb=!1;a.tb=!1;a.B=n.Pc(n.Yc);a.gc=!0;return a};a.kL=function(a,b,e,g){var f=c(40);f.rb=!1;f.tb=!1;f.mr=a;f.lr=b;f.B=g;d(f,e);f.gc=!0;return f};a.cL=function(a){var b=c(41);b.rb=!1;b.tb=!1;b.B=n.Pc(n.Yc);b.$l=a;b.gc=!0;return b};a.DT=function(a){var b=c(42);b.rb=!1;b.tb=!1;b.B=a;b.gc=!0;return b};a.mB=function(){var a=c(43);a.enqueue=!1;return a};a.oL=function(){var a=c(44);a.gc=!0;return a};a.Cy=function(a){switch(a.type){case 0:return"MAIN OPAQUE";
case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.xt.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";
case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";
case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Ec=function(a,b){for(var c=b.qa,d=c.ib,f=0;f<a.Qa.length;f++){var e=a.Qa[f].ra,g=e.indexOf(b);if(-1!=g&&(e.splice(g,1),!e.length)){a.Qa.splice(f,1);break}}f=a.yb?c.Sf:0;a:{e=a.Qa;for(g=0;g<e.length;g++){var h=e[g];if(h.ib==
d&&f==h.Sf){e=h;break a}}e=null}e?e.ra.push(b):(a.Qa.push({ib:d,ra:[b],kg:c.kg,Sf:f,Ub:!0}),a.xx=!0)};a.th=function(a,b){var c={Ub:!0,aw:[!0,!0,!0,!0,!0,!0],Ee:b,qa:a,Bs:null};if(a.Pe&&a.da.zd){var d=a.da.zd;c.Bs={IO:new Float32Array(d.length),JO:new Float32Array(d.length),LL:new Float32Array(d.length/3),gG:new Float32Array(3),nJ:u.EJ(a.U)}}return c};a.QQ=function(a){a.Qa.sort(g);a.xx=!1}};b4w.module.__texcomp=function(a,r){function d(a,b,c,d){var f=new Int32Array(c,0,31),h,k,m,x,B,A;if(542327876!=f[0])return n.error("Invalid magic number in DDS header"),0;if(!f[20]&4)return n.error("Unsupported format, must contain a FourCC code"),0;h=f[21];switch(h){case e:k=8;m=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case u:k=16;m=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case w:k=16;m=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return n.error("Unsupported FourCC code:",g(h)),null}A=
1;f[2]&131072&&!1!==d&&(A=Math.max(1,f[7]));x=f[4];B=f[3];f=f[1]+4;if(b)for(h=0;h<A;++h)d=Math.max(4,x)/4*Math.max(4,B)/4*k,b=new Uint8Array(c,f,d),a.compressedTexImage2D(a.TEXTURE_2D,h,m,x,B,0,b),f+=d,x=Math.max(.5*x,1),B=Math.max(.5*B,1);else if(h==e){c=b=new Uint16Array(c);k=f/2;m=x;f=new Uint16Array(4);b=new Uint16Array(m*B);for(var r,C,v,l,z,H,p=m/4,Q=B/4,y=0;y<Q;y++)for(var Z=0;Z<p;Z++)h=k+4*(y*p+Z),f[0]=c[h],f[1]=c[h+1],r=f[0]&31,C=f[0]&2016,v=f[0]&63488,l=f[1]&31,z=f[1]&2016,H=f[1]&63488,
f[2]=5*r+3*l>>3|5*C+3*z>>3&2016|5*v+3*H>>3&63488,f[3]=5*l+3*r>>3|5*z+3*C>>3&2016|5*H+3*v>>3&63488,r=c[h+2],C=4*y*m+4*Z,b[C]=f[r&3],b[C+1]=f[r>>2&3],b[C+2]=f[r>>4&3],b[C+3]=f[r>>6&3],C+=m,b[C]=f[r>>8&3],b[C+1]=f[r>>10&3],b[C+2]=f[r>>12&3],b[C+3]=f[r>>14],r=c[h+3],C+=m,b[C]=f[r&3],b[C+1]=f[r>>2&3],b[C+2]=f[r>>4&3],b[C+3]=f[r>>6&3],C+=m,b[C]=f[r>>8&3],b[C+1]=f[r>>10&3],b[C+2]=f[r>>12&3],b[C+3]=f[r>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,x,B,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,b);d&&a.generateMipmap(a.TEXTURE_2D)}else return n.error("No manual decoder for",
g(h),"and no native support"),0;return A}function c(a,b,c,e,f){var g=new XMLHttpRequest;g.open("GET",c,!0);g.responseType="arraybuffer";g.onload=function(){if(200==g.status){a.bindTexture(a.TEXTURE_2D,e);var c=d(a,b,g.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}f&&f(e)};g.send(null)}function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}
function g(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var n=r("__print"),x=r("__util"),e=b("DXT1"),u=b("DXT3"),w=b("DXT5");a.cS=d;a.dS=function(a,b,c){var d=new Uint32Array(c,0,13);if(55727696==d[0]){var f=d[7],e=d[6],g=d[11],h=52+d[12];switch(d[2]){case 0:var m=2,n=1;break;case 1:m=2;n=3;break;case 2:m=4;n=0;break;case 3:m=4;n=2;break;default:x.D("Unsupported PVR V3 format.")}}else if(559044176==d[11]){f=d[2];e=d[1];g=d[3];h=d[0];g++;var u=d[4]&255,d=0<d[10];25==u?(m=4,n=d?
2:0):24==u?(m=2,n=d?3:1):x.D("Unsupported PVR V2 format.")}else x.D("Unsupported PVR version.");u=2==m?8:4;d=4;switch(n){case 0:var w=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:w=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:w=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:w=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=u*d*m/8;for(m=0;m<g;m++){var n=Math.max(f>>m,1),B=Math.max(e>>m,1),v=n/u,l=B/d;2>v&&(v=2);2>l&&(l=2);v=v*l*b;l=new Uint8Array(c,h,v);a.compressedTexImage2D(a.TEXTURE_2D,m,w,n,B,0,l);
h+=v}};a.pC=function(a,b){switch(b){case "dds":var c=new Int32Array(a,0,31);return{width:c[4],height:c[3]};case "pvr":c=new Uint32Array(a,0,13);if(55727696==c[0])var d=c[7],c=c[6];else d=c[2],c=c[1];return{width:d,height:c}}};a.WM=function(a,b){var c=1;if("dds"==b){var d=new Int32Array(a,0,31),f=d[21];switch(f){case e:c=6;break;case u:case w:c=4;break;default:n.error("Unsupported FourCC code:",g(f))}}else if("pvr"==b)if(d=new Uint32Array(a,0,13),55727696==d[0])switch(d[2]){case 0:c=12;break;case 1:c=
16;break;case 2:c=6;break;case 3:c=8}else f=d[4]&255,d=0<d[10],25==f?c=d?8:6:24==f&&(c=d?16:12);return c};a.DU=function(a,b,d,e){var f=a.createTexture();c(a,b,d,f,e);return f}};b4w.module.__textures=function(a,r){function d(){sa||(sa=O.createFramebuffer());return sa}function c(){wa||(wa=O.createTexture());return wa}function b(){return{type:0,source:"",iq:"",width:0,height:0,Io:1,anisotropic_filtering:"",Ci:1024,hj:!1,Af:null,qb:0,Cb:null,pe:null,mi:!1,Iq:-1,Ta:null,pu:"",zj:0,zg:0,sa:0,Mb:0,jj:0,Of:!1,Ng:1,ed:null,aq:0,$p:0,Bi:-1,cq:!1,Rj:-1,Gq:!1,dz:!1,Oi:!1,ck:!1,repeat:!0,rj:"",ym:"",zm:"",Nw:"",Mw:"",Vk:""}}function g(a,b,c){a.zm=b.uuid;a.ym=b.filepath;a.Nw=b.source;
a.Mw=b.name;a.rj=ca.zh(c+b.filepath);a.Vk=b.jg;-1==ta.indexOf(a)&&ta.push(a)}function n(a,b,c){var d=-1<b.indexOf(".pvr");a.Vk=-1<b.indexOf(".dds")?"dds":d?"pvr":"";a.ym=b;a.rj=c;ta.push(a)}function x(c,d){var f=b();f.type=c;f.source="NONE";if(c==a.Wq||c==a.Uq||c==a.Xq||c==a.Vq)f.pe=O.createRenderbuffer();else{var e=O.TEXTURE_2D,g=O.createTexture();O.bindTexture(e,g);O.texParameteri(e,O.TEXTURE_MAG_FILTER,O.LINEAR);O.texParameteri(e,O.TEXTURE_MIN_FILTER,O.LINEAR);O.texParameteri(e,O.TEXTURE_WRAP_S,
O.CLAMP_TO_EDGE);O.texParameteri(e,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE);var h=q(f),l=E(f),k=A(f);O.texImage2D(e,0,l,1,1,0,h,k,c==a.ik?null:new Uint8Array([204,204,204,255]));W.Go&&d&&O.texParameterf(e,O.TEXTURE_COMPARE_MODE,O.COMPARE_REF_TO_TEXTURE);O.bindTexture(e,null);f.qb=e;f.Cb=g}return f}function e(a){var b=a.qb;O.bindTexture(b,a.Cb);var c=q(a),d=E(a),f=A(a),e=a.Af.canvas;O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,!0);O.texImage2D(b,0,d,c,f,e);O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,!1);a.hj&&O.generateMipmap(b);
O.bindTexture(b,null);a.width=e.width;a.height=e.height}function u(a){var b=a.qb;O.bindTexture(b,a.Cb);O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Ta.length?a.Of?m(a,a.Ta,a.width*a.Ng,a.height*a.Ng,!1):O.texImage2D(b,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,a.Ta):O.texImage2D(b,0,O.RGBA,1,1,0,O.RGBA,O.UNSIGNED_BYTE,a.Ta);O.bindTexture(b,null)}function w(a){var b=a.qb;O.bindTexture(b,a.Cb);O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,!0);a.Of?m(a,a.ed[a.Bi],a.width*a.Ng,a.height*a.Ng,!1):O.texImage2D(b,0,O.RGBA,O.RGBA,
O.UNSIGNED_BYTE,a.ed[a.Bi]);O.bindTexture(b,null)}function h(){va||(va=document.createElement("canvas"));return va}function m(a,b,e,f,g){g||(k(O.TEXTURE_2D),O.texImage2D(O.TEXTURE_2D,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,b));O.bindTexture(O.TEXTURE_2D,null);b=d();g=c();M.PL(a,e,f,b,g)}function B(a,b,c){for(var d=0;6>d;d++){var e=xa[d],f=oa[d],g=h();g.width=c;g.height=c;var l=g.getContext("2d");"TEXTURE_CUBE_MAP_POSITIVE_Y"==e||"TEXTURE_CUBE_MAP_NEGATIVE_Y"==e?(l.translate(0,c),l.scale(1,-1)):(l.translate(c,
0),l.scale(-1,1));l.drawImage(a,f[0]*b,f[1]*b,b,b,0,0,c,c);O.texImage2D(O[e],0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,g)}}function k(a){O.bindTexture(a,null);var b=c();O.bindTexture(a,b);O.texParameteri(a,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE);O.texParameteri(a,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE);O.texParameteri(a,O.TEXTURE_MAG_FILTER,O.LINEAR);O.texParameteri(a,O.TEXTURE_MIN_FILTER,O.LINEAR)}function f(a,b,e){var f=a.source,g=a.Cb,l=a.qb,n=a.Vk,p=a.ym,q;O.bindTexture(l,g);a.repeat?(O.texParameteri(l,O.TEXTURE_WRAP_S,
O.REPEAT),O.texParameteri(l,O.TEXTURE_WRAP_T,O.REPEAT)):(O.texParameteri(l,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(l,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE));a.mi||"NODE_TEX"==f?O.texParameteri(l,O.TEXTURE_MIN_FILTER,O.LINEAR):O.texParameteri(l,O.TEXTURE_MIN_FILTER,Ia[W.El]);a.anisotropic_filtering&&O.texParameterf(l,ha.pw().TEXTURE_MAX_ANISOTROPY_EXT,a.anisotropic_filtering);4==b.length&&(q=!0,b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]]));if("IMAGE"==f)if(q)O.texImage2D(l,0,O.RGBA,
1,1,0,O.RGBA,O.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(n){q=pa.pC(b,n);e=ca.vo(q.width)||ca.vo(q.height);if(q.width>ka.tc||q.height>ka.tc){U.error('Image "'+p+'" has unsupported size: '+q.width+"x"+q.height+". Max available: "+ka.tc+"x"+ka.tc+".");return}f=q.width;q=q.height;if(e||"pvr"==n)a.Of=!0,k(l),f=t(f*a.Ng),q=t(q*a.Ng);"dds"==n?pa.cS(O,ha.jC(),b,!0):"pvr"==n&&pa.dS(O,ha.iC(),b);a.Of&&(m(a,null,f,q,!0),O.bindTexture(l,g),O.generateMipmap(l));a.width=f;a.height=q;a.Io=pa.WM(b,n)}else{O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,
!0);a.mi?W.bq?(f=b[0].width,q=b[0].height):(f=b.videoWidth,q=b.videoHeight):(f=b.width,q=b.height);a.width=f;a.height=q;if(f>ka.tc||q>ka.tc)U.warn('Image "'+p+'" has unsupported size: '+f+"x"+q+". Max available: "+ka.tc+"x"+ka.tc+". Reduced image size will be used."),a.Ng=Math.min(ka.tc/f,ka.tc/q),a.Of=!0;a.mi&&(e in ra||(ra[e]={}),ra[e][a.pu]=a,W.bq?(a.ed=b,a.aq=b.length,a.zg=a.$p*a.zj/b.length,b=b[0]):(a.Ta=b,a.Ta.loop=a.Oi,a.zg=b.duration?a.zj/b.duration:ga.ad(),da.zB||(b.playbackRate=ga.ad()/
a.zg,da.VA&&2<b.playbackRate&&(b.playbackRate=2)),F(a)));f=t(a.width*a.Ng);q=t(a.height*a.Ng);a.Of?(p=h(),n=p.getContext("2d"),p.width=f,p.height=q,n.drawImage(b,0,0,a.width,a.height,0,0,f,q),O.texImage2D(l,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,p)):W.Yb||!ca.vo(a.width)&&!ca.vo(a.height)?O.texImage2D(l,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,b):(m(a,b,f,q,!1),a.Of=!0);a.width=f;a.height=q;a.mi||(O.bindTexture(l,g),O.generateMipmap(l))}else if("ENVIRONMENT_MAP"==f)if(q){for(g=0;6>g;g++)O.texImage2D(O["TEXTURE_CUBE_MAP_"+
xa[g]],0,O.RGBA,1,1,0,O.RGBA,O.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){U.error('Cubemap Image "'+p+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}g=b.width/3;g>ka.ri?(U.warn('Cubemap Image "'+p+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*ka.ri+"x"+2*ka.ri+". Reduced image size will be used."),p=t(ka.ri/g*g),a.Of=!0):(p=t(g),
!W.Yb&&(3*p>ka.tc||2*p>ka.tc)&&(a.Of=!0));if(a.Of||W.ay)B(b,g,p);else{n=b;f=p;k(O.TEXTURE_2D);O.texImage2D(O.TEXTURE_2D,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,n);O.bindTexture(O.TEXTURE_2D,null);for(n=0;6>n;n++)O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,O.RGBA,f,f,0,O.RGBA,O.UNSIGNED_BYTE,null);O.bindTexture(a.qb,null);n=d();O.bindFramebuffer(O.FRAMEBUFFER,n);q=c();for(n=0;6>n;n++)M.OL(a,O[xa[n]],f,g,q,n);O.bindFramebuffer(O.FRAMEBUFFER,null);O.bindTexture(a.qb,a.Cb);O.texParameteri(a.qb,O.TEXTURE_MIN_FILTER,
Ia[W.El]);O.texParameteri(a.qb,O.TEXTURE_MAG_FILTER,O.LINEAR)}Y.YJ()&&(U.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),B(b,g,L.Nz));a.width=3*p;a.height=2*p;O.generateMipmap(l)}else"NODE_TEX"==f&&(O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,!1),O.texImage2D(l,0,O.RGBA,b.width,b.height,0,O.RGBA,O.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);O.bindTexture(l,null)}function F(a){a.Ta.oncanplay=function(){z(a)&&u(a)}}function t(a){return ca.vo(a)?ca.clamp(Math.pow(2,
(a|0).toString(2).length),2,ka.tc):a}function q(b){var c;switch(b.type){case a.Vg:c=O.RGBA;break;case a.Yq:c=O.RGB;break;case a.Rn:c=O.RGBA;break;case a.Sn:c=O.RGB;break;case a.ik:c=O.DEPTH_COMPONENT;break;default:ca.D("Wrong texture type")}return c}function E(b){var c;switch(b.type){case a.Vg:c=W.Yb?O.RGBA8:O.RGBA;break;case a.Yq:c=W.Yb?O.RGB8:O.RGB;break;case a.Rn:c=W.Yb?O.RGBA8:O.RGBA;break;case a.Sn:c=W.Yb?O.RGB8:O.RGB;break;case a.ik:c=W.Yb?J(ka.hh):O.DEPTH_COMPONENT;break;default:ca.D("Wrong texture type")}return c}
function J(a){switch(a){case 16:a=O.DEPTH_COMPONENT16;break;case 24:a=O.DEPTH_COMPONENT24;break;case 32:a=O.DEPTH_COMPONENT32F;break;default:a=O.DEPTH_COMPONENT24}return a}function A(b){var c;switch(b.type){case a.Vg:c=O.UNSIGNED_BYTE;break;case a.Yq:c=O.UNSIGNED_BYTE;break;case a.Rn:c=O.FLOAT;break;case a.Sn:c=O.FLOAT;break;case a.ik:c=16==ka.hh?O.UNSIGNED_SHORT:O.UNSIGNED_INT;break;default:ca.D("Wrong texture type")}return c}function I(a){a.Ta?a.Ta.play():a.ed&&(a.cq=!0);a.Gq=!1}function C(a){a.Ta?
a.Ta.pause():a.ed&&(a.cq=!1);a.Gq=!0}function v(a){a.Ta?a.Ta.currentTime=a.Mb/a.zg:a.ed&&(a.Bi=H(a,a.Mb),w(a))}function l(a){return a.Ta?!a.Ta.paused:a.ed?a.cq:!1}function z(a){return a.Ta||a.ed?a.Ta?2<=a.Ta.readyState:!0:0}function H(a,b){return Math.round(b*a.aq/a.zj)}function p(a,b){if(la.is_dynamic(a))return y(a,b);for(var c=a.Ys,d=0;d<c.length;d++){var f=y(c[d],b);if(f)return f}return null}function Q(a,b,c){if(la.is_dynamic(a))Z(a,b,c);else{a=a.Ys;for(var d=0;d<a.length;d++)Z(a[d],b,c)}}function y(a,
b){var c=a.K;if(c.length)for(var c=c[0].R,d=0;d<c.length;d++){var f=c[d];if("MAIN"==f.type||"SKY"==f.type)for(var e=0;e<f.Sa.length;e++)if(f.Ve[e]==b)return f.Sa[e]}return null}function Z(a,b,c){a=a.K;if(a.length){a=a[0].R;for(var d=0;d<a.length;d++){var f=a[d];if("MAIN"==f.type)for(var e=0;e<f.Sa.length;e++)f.Ve[e]==b&&(f.Sa[e]=c)}}}function S(a,b){var c=a.K;if(c.length)for(var c=c[0].R,d=0;d<c.length;d++){var f=c[d];if("MAIN"==f.type)for(var e=0;e<f.Sa.length;e++){var g=f.Sa[e],h=f.Ve[e];-1==b.indexOf(h)&&
"NODE_TEX"!=g.source&&b.push(h)}}}function G(a,b,c){var d=a.elements;a=a.interpolation;for(var f=0;f<b;f++){var e=f/(b-1),g=D(d,e,!0),h=X(d,e,!0);if(g&&h)if("CONSTANT"==a)c.push.apply(c,g.color);else{var l=c,k=g,m=h;k==m?l.push.apply(l,k.color):(l.push(aa.Ps(m.color[0],m.position,k.color[0],k.position,e)),l.push(aa.Ps(m.color[1],m.position,k.color[1],k.position,e)),l.push(aa.Ps(m.color[2],m.position,k.color[2],k.position,e)),l.push(aa.Ps(m.color[3],m.position,k.color[3],k.position,e)))}h&&!g&&c.push.apply(c,
h.color);g&&!h&&c.push.apply(c,g.color)}}function D(a,b,c){for(var d=null,f=0;f<a.length;f++){var e=c?b-a[f].position:b-a[f][1][0];0<=e&&(d?e<=(c?b-d.position:b-a[f][1][0])&&(d=a[f]):d=a[f])}return d}function X(a,b,c){for(var d=null,f=0;f<a.length;f++){var e=c?a[f].position-b:a[f][1][0]-b;0<=e&&(d?e<=(c?d.position-b:d[1][0]-b)&&(d=a[f]):d=a[f])}return d}function V(a,b){for(var c=0;c<ta.length;c++){var d=ta[c];if(d.rj==a&&d.type==b.type&&d.source==b.source&&d.repeat==b.repeat&&d.anisotropic_filtering==
b.anisotropic_filtering&&d.ck==b.ck)return d}return null}var L=r("__compat"),ba=r("__config"),pa=r("__texcomp"),Y=r("__debug"),ha=r("__extensions"),U=r("__print"),ga=r("__time"),ca=r("__util"),M=r("__renderer");r("__objects");var la=r("__obj_util"),aa=r("__curve"),P=r("__vec3"),ma=r("__scenes"),W=ba.H,ka=ba.pg,da=ba.Y,va=null,wa=null,sa=null;a.Se=0;a.P=0;a.jI=0;a.hI=0;a.iI=0;a.gI=0;a.Vg=10;a.Yq=20;a.Rn=30;a.Sn=40;a.ik=50;a.Wq=60;a.Uq=70;a.Xq=80;a.Vq=90;a.vz=128;a.iG=128;a.Rz=128;var ta=[],ea={},ra=
{},O=null,Ia,xa="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),oa=[[2,0],[0,0],[1,1],[0,1],[1,0],[2,1]];a.mf=function(b){Ia=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Se=b.NEAREST;a.P=b.LINEAR;a.jI=b.NEAREST_MIPMAP_NEAREST;a.hI=b.LINEAR_MIPMAP_NEAREST;a.iI=b.NEAREST_MIPMAP_LINEAR;a.gI=b.LINEAR_MIPMAP_LINEAR;O=
b};a.ZT=function(a,b){return b in ea&&a in ea[b]?ea[b][a].Af:null};a.iV=function(a,b){return b in ea&&a in ea[b]?(e(ea[b][a]),!0):!1};a.dA=g;a.Gk=x;a.hB=function(c){var d=O.createTexture(),f=O.TEXTURE_CUBE_MAP;O.bindTexture(f,d);O.texParameteri(f,O.TEXTURE_MAG_FILTER,O.LINEAR);O.texParameteri(f,O.TEXTURE_MIN_FILTER,O.LINEAR);O.texParameteri(f,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE);O.texParameteri(f,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE);for(var e=0;6>e;e++)O.texImage2D(O[xa[e]],0,O.RGBA,c,c,0,O.RGBA,O.UNSIGNED_BYTE,
null);O.bindTexture(f,null);f=b();f.type=a.Vg;f.source="NONE";f.width=3*c;f.height=2*c;f.Io=1;f.Cb=d;f.qb=O.TEXTURE_CUBE_MAP;return f};a.ky=function(a,b,c){var d=a.qb;O.bindTexture(d,a.Cb);b&&O.texParameteri(d,O.TEXTURE_MIN_FILTER,b);c&&O.texParameteri(d,O.TEXTURE_MAG_FILTER,c);O.bindTexture(d,null)};a.resize=function(b,c,d){c=Math.max(c,1);d=Math.max(d,1);if(b.width!=c||b.height!=d){switch(b.type){case a.Wq:O.bindRenderbuffer(O.RENDERBUFFER,b.pe);O.renderbufferStorage(O.RENDERBUFFER,O.RGB565,c,d);
O.bindRenderbuffer(O.RENDERBUFFER,null);break;case a.Uq:O.bindRenderbuffer(O.RENDERBUFFER,b.pe);O.renderbufferStorage(O.RENDERBUFFER,J(ka.hh),c,d);O.bindRenderbuffer(O.RENDERBUFFER,null);break;case a.Xq:O.bindRenderbuffer(O.RENDERBUFFER,b.pe);O.renderbufferStorageMultisample(O.RENDERBUFFER,W.uc,O.RGBA8,c,d);O.bindRenderbuffer(O.RENDERBUFFER,null);break;case a.Vq:O.bindRenderbuffer(O.RENDERBUFFER,b.pe);O.renderbufferStorageMultisample(O.RENDERBUFFER,W.uc,J(ka.hh),c,d);O.bindRenderbuffer(O.RENDERBUFFER,
null);break;default:var f=b.qb;O.bindTexture(f,b.Cb);var e=q(b),g=E(b),h=A(b);O.texImage2D(f,0,g,c,d,0,e,h,null);O.bindTexture(f,null)}c>ka.tc||d>ka.tc?ca.D('Slink texture "'+b.type+'" has unsupported size: '+c+"x"+d+". Max available: "+ka.tc+"x"+ka.tc+"."):(b.width=c,b.height=d)}};a.vL=function(c,d,f,h,l){var k=c.type;if("BLEND"==k)return null;var m=c.image,n=b();n.type=a.Vg;n.width=1;n.height=1;var p=c.b4w_anisotropic_filtering;"DEFAULT"===p&&(p=d);"OFF"!==p&&W.anisotropic_filtering&&ha.pw()&&(p=
parseFloat(p.split("x")[0]),n.anisotropic_filtering=p);if("REPEAT"!=c.extension||c.b4w_shore_dist_map)n.repeat=!1;if(m){"IMAGE"==k&&"MOVIE"==m.source&&(n.mi=!0,n.pu=c.name,n.sa=c.frame_start,n.Mb=c.frame_offset,n.jj=c.frame_duration,n.dz=c.use_auto_refresh,n.Oi=c.use_cyclic,n.zj=c.movie_length,n.ck=c.b4w_nla_video,0!=n.Mb&&U.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));n.source=k;d=ca.zh(l+m.filepath);if(d=V(d,n))return d;
g(n,m,l)}d=new Uint8Array([204,204,204,255]);switch(k){case "IMAGE":l=O.createTexture();m=O.TEXTURE_2D;O.bindTexture(m,l);O.texImage2D(m,0,O.RGBA,1,1,0,O.RGBA,O.UNSIGNED_BYTE,d);break;case "NONE":if("NONE"==c.b4w_source_type)return null;l=O.createTexture();m=O.TEXTURE_2D;n.source=c.b4w_source_type;if("SCENE"==n.source){if(!c.b4w_source_id)return null;h=ca.keysearch("name",c.b4w_source_id,f);if(!h)return null;n.iq=c.b4w_source_id;n.Ci=c.b4w_source_size;h.wf=h.wf||[];h.wf.push(n);O.bindTexture(m,l);
O.texImage2D(m,0,O.RGBA,1,1,0,O.RGBA,O.UNSIGNED_BYTE,d)}else"CANVAS"==n.source&&(f=c.b4w_source_id,d=c.b4w_source_size,n.iq=f,n.hj=c.b4w_enable_canvas_mipmapping,c=document.createElement("canvas"),c.width=d,c.height=d,n.Af=c.getContext("2d"),h in ea||(ea[h]={}),ea[h][f]=n,O.bindTexture(m,l));break;case "ENVIRONMENT_MAP":l=O.createTexture();m=O.TEXTURE_CUBE_MAP;O.bindTexture(m,l);c="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(h=0;6>h;h++)O.texImage2D(O["TEXTURE_CUBE_MAP_"+
c[h]],0,O.RGBA,1,1,0,O.RGBA,O.UNSIGNED_BYTE,d);break;default:return U.error('texture "'+c.name+'" has unsupported type "'+k+'"'),null}n.Cb=l;n.qb=m;"NONE"==k?(n.hj?O.texParameteri(m,O.TEXTURE_MIN_FILTER,Ia[W.El]):O.texParameteri(m,O.TEXTURE_MIN_FILTER,O.LINEAR),n.anisotropic_filtering&&O.texParameterf(m,ha.pw().TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropic_filtering),"CANVAS"==n.source&&e(n)):(O.generateMipmap(m),O.bindTexture(m,null));return n};a.aS=e;a.DF=u;a.CF=w;a.wq=f;a.GJ=t;a.Em=function(a){return a&&
(a.Cb||a.pe)?!0:!1};a.Dm=function(a){return a&&a.pe?!0:!1};a.vU=function(b){return b.type==a.Rn||b.type==a.Sn?!0:!1};a.uN=function(b){var c=0;switch(b.type){case a.Vg:case a.Yq:c=4;break;case a.Rn:case a.Sn:c=16;break;case a.ik:c=3;break;case a.Wq:case a.Uq:c=2;break;case a.Xq:c=4*W.uc;break;case a.Vq:c=3*W.uc}return c};a.cleanup=function(){if(!W.bq)for(var a in ra)for(var b in ra[a])ra[a][b].Ta.pause(),ra[a][b].Ta.src="",ra[a][b].Ta.load();ta.length=0;ea={};ra={}};a.pause=function(){for(var a in ra)for(var b in ra[a]){var c=
ra[a][b];l(c)&&C(c)}};a.reset=function(){for(var a in ra)for(var b in ra[a])v(ra[a][b])};a.play=function(a){for(var b in ra)for(var c in ra[b]){var d=ra[b][c];a&&!d.Gq||I(d)}};a.Ew=function(a,b){return b in ra&&a in ra[b]?ra[b][a]:null};a.iz=function(a){return a.ck};a.play_video=I;a.pause_video=C;a.reset_video=v;a.hQ=function(a,b){if(void 0 in ra&&a in ra[void 0]){var c=ra[void 0][a];c.Ta?c.Ta.currentTime=b/c.zg:c.ed&&(c.Bi=b,w(c))}};a.YF=l;a.ZF=z;a.VF=function(a){return a.Ta||a.ed?a.Ta?Math.round(a.Ta.currentTime*
a.zg):a.Bi:0};a.XF=function(a){return a.Ta||a.ed?a.Ta?a.Mb:H(a,a.Mb):0};a.qS=function(a){if(!a.Ta&&!a.ed)return 0;var b=Math.min(a.jj,a.zj-a.Mb);return a.Ta?a.Mb+b:H(a,a.Mb+b)};a.It=function(a,b){return Math.round(b*a.$p*(ga.ad()/a.zg))};a.WF=function(a){return Math.min(a.jj,a.zj-a.Mb)};a.pS=H;a.UM=function(a,b){var c=p(a,b);return c&&"CANVAS"==c.source?c.Af:null};a.Bw=p;a.zQ=Q;a.get_texture_names=function(a){var b=[];if(la.is_dynamic(a))S(a,b);else{a=a.Ys;for(var c=0;c<a.length;c++)S(a[c],b)}return b};
a.JQ=function(a){for(var c={},d=0;d<a.length;d++){for(var f=a[d].Sa,g=a[d].Ie,h=[],l=[],k=0;k<f.length;k++){var m=f[k],N=g[k];if("CANVAS"==m.source)if(N in c)m=c[N];else{var n=f[k],m=b();m.source="CANVAS";m.width=n.width;m.height=n.height;m.hj=n.hj;m.type=n.type;n=document.createElement("canvas");n.width=m.width;n.height=m.height;m.Af=n.getContext("2d");m.qb=O.TEXTURE_2D;m.Cb=O.createTexture();O.bindTexture(O.TEXTURE_2D,m.Cb);m.hj?O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,Ia[W.El]):O.texParameteri(O.TEXTURE_2D,
O.TEXTURE_MIN_FILTER,O.LINEAR);O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.LINEAR);O.bindTexture(O.TEXTURE_2D,null);n=m;n.Af.drawImage(f[k].Af.canvas,0,0);e(n);c[N]=m}h.push(m);l.push(N)}a[d].Sa=h}};a.eM=function(a,b){for(var c=[],d=0;d<a.length;d++)G(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return ca.clamp(255*a,0,255)}))};a.CJ=G;a.iM=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),f=[],e=0;e<a.length;e++){for(var g=a[e].data.value,h=[],l=
g.curve_mapping.curves_data,k=g.curve_mapping.curve_extend,m=g.curve_mapping.curves_handle_types,g=0;g<l.length;g++){for(var n=k[g],p=l[g],q=[],t=m[g],y=0;y<p.length;y++)q.push([new Float32Array(3),new Float32Array(p[y].concat(0)),new Float32Array(3)]);aa.rv(q[0],null,q[1],t[0],t[0]);for(y=1;y<q.length-1;y++)aa.rv(q[y],q[y-1],q[y+1],t[y],t[y]);aa.rv(q[q.length-1],q[q.length-2],null,t[q.length-1],t[q.length-1]);if(2<q.length){if("AUTO"==t[0]){P.subtract(q[0][2],q[0][1],c);y=P.length(c);P.copy(q[1][0],
d);d[0]<q[0][1][0]&&(d[0]=q[0][1][0]);P.subtract(d,q[0][1],d);var v=P.length(d);1E-8<v&&(P.scale(d,y/v,d),P.add(q[0][1],d,q[0][2]),P.subtract(q[0][1],d,q[0][0]))}p=q.length-1;"AUTO"==t[0]&&(P.subtract(q[p][0],q[p][1],c),y=P.length(c),P.copy(q[p-1][2],d),d[0]>q[p][1][0]&&(d[0]=q[p][1][0]),P.subtract(d,q[p][1],d),v=P.length(d),1E-8<v&&(P.scale(d,y/v,d),P.add(q[p][1],d,q[p][0]),P.subtract(q[p][1],d,q[p][2])))}for(p=0;p<q.length-1;p++)aa.tK(q[p][1],q[p][2],q[p+1][0],q[p+1][1]);p=[];3>=l.length?(y=Math.round(-b/
2),t=Math.round(b/2)):(y=0,t=b);for(;y<t;y++){var v=y/(t-1),u=D(q,v,!1),w=X(q,v,!1);u&&w?p.push(aa.tA(v,u[1],u[2],w[0],w[1],.001)):w&&!u?"EXTRAPOLATED"==n?(v=w[1][0]==w[2][0]?w[1][1]:aa.YC(v,w[1],w[2]),p.push(v)):p.push(w[1][1]):u&&!w&&("EXTRAPOLATED"==n?(v=u[0][0]==u[1][0]?u[1][1]:aa.YC(v,u[0],u[1]),p.push(v)):p.push(u[1][1]))}h.push(p)}f.push(h)}c=[];for(y=0;y<f.length;y++)for(h=f[y],g=0;g<h[0].length;g++)3>=h.length?(d=ca.clamp(127.5*(h[0][g]+1),0,255),e=ca.clamp(127.5*(h[1][g]+1),0,255),l=ca.clamp(127.5*
(h[2][g]+1),0,255),p=255):(d=ca.clamp(255*h[0][g],0,255),e=ca.clamp(255*h[1][g],0,255),l=ca.clamp(255*h[2][g],0,255),p=ca.clamp(255*h[3][g],0,255)),c.push(d,e,l,p);return new Uint8Array(c)};a.gB=function(b,c){var d=x(a.Vg,!1);d.source="NODE_TEX";d.repeat=!1;f(d,{width:c,height:b.length/(4*c),data:b});return d};a.change_image=function(a,c,d,e,g){var h=ca.zh(g);if("WORLD"!=a.type){var l=V(h,c);if(!l){l=b();l.type=c.type;l.source=c.source;l.iq=c.iq;l.width=c.width;l.height=c.height;l.Io=c.Io;l.Ci=c.Ci;
l.hj=c.hj;l.Af=c.Af;l.qb=c.qb;l.Cb=c.Cb;l.pe=c.pe;l.mi=c.mi;l.Iq=c.Iq;l.Ta=c.Ta;l.pu=c.pu;l.zj=c.zj;l.zg=c.zg;l.sa=c.sa;l.Mb=c.Mb;l.jj=c.jj;l.Of=c.Of;l.Ng=c.Ng;l.ed=c.ed;l.aq=c.aq;l.$p=c.$p;l.Bi=c.Bi;l.cq=c.cq;l.Rj=c.Rj;l.Gq=c.Gq;l.dz=c.dz;l.Oi=c.Oi;l.ck=c.ck;l.repeat=c.repeat;l.ym=c.ym;l.rj=c.rj;l.zm=c.zm;l.Nw=c.Nw;l.Mw=c.Mw;l.Vk=c.Vk;var k=l;O.bindTexture(c.qb,c.Cb);var m=O.getTexParameter(c.qb,O.TEXTURE_MAG_FILTER),N=O.getTexParameter(c.qb,O.TEXTURE_MIN_FILTER),p=O.getTexParameter(c.qb,O.TEXTURE_WRAP_S);
c=O.getTexParameter(c.qb,O.TEXTURE_WRAP_T);k.Cb=O.createTexture();O.bindTexture(k.qb,k.Cb);O.texParameteri(k.qb,O.TEXTURE_MAG_FILTER,m);O.texParameteri(k.qb,O.TEXTURE_MIN_FILTER,N);O.texParameteri(k.qb,O.TEXTURE_WRAP_S,p);O.texParameteri(k.qb,O.TEXTURE_WRAP_T,c);O.bindTexture(k.qb,null);n(l,g,h);f(l,e,0)}Q(a,d,l)}else l=c,n(l,g,h),f(l,e,0),ma.YR(a)};a.uT=function(){};a.Ld=function(a){return a.texture.F};a.KP=function(){O=null};a.eC=function(){return ta}};b4w.module.__assets=function(a,r){function d(){return f.EC()?r(f.ge.pr).data:null}function c(){var a={Zq:null,vI:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),f=0;f<c;f++)d[f]=b.charCodeAt(f);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.Zq=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=d();b&&a.Zq in b&&(a.status=200,b[a.Zq]&&(a.response=a.vI(b[a.Zq])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var f=b[d];20===f.state&&c++;if(c>=I.FO)break;if(10===f.state)switch(f.state=20,c++,f.type){case a.AT_ARRAYBUFFER:g(f,"arraybuffer");break;case a.AT_JSON:g(f,"json");break;case a.AT_TEXT:g(f,"text");break;case a.AT_AUDIOBUFFER:n(f);break;case a.AT_IMAGE_ELEMENT:x(f);
break;case a.AT_AUDIO_ELEMENT:e(f);break;case a.Lq:u(f);break;case a.Kq:w(f);break;default:E.D("Wrong asset type: "+f.type)}}}function g(b,f){var e=b.url.split("?v=")[0];if(e in z)"json"==f?b.Rb(E.S(z[e]),b.id,b.type,b.url,b.vb):b.Rb(z[e],b.id,b.type,b.url,b.vb);else{var g=d(),h=g&&b.url in g?new c:new XMLHttpRequest,g=null;if("GET"==b.request)h.open("GET",b.url,!0);else if("POST"==b.request)switch(h.open("POST",b.url,!0),b.ul){case a.rz:g="text/plain";break;case a.qz:g="application/json"}if(b.Jj)for(var l in b.Jj)"Content-Type"==
l?g=b.Jj[l]:h.setRequestHeader(l,b.Jj[l]);g&&h.setRequestHeader("Content-Type",g);"text"==f?(h.overrideMimeType("text/plain"),h.responseType="text"):"json"==f?(h.overrideMimeType("application/json"),h.responseType="text"):h.responseType=f;h.onreadystatechange=function(){if(40!=b.state&&4==h.readyState){if(200==h.status||0==h.status){var a=h.response;if(a){if("json"==f&&"string"==typeof a)try{a=JSON.parse(a,b.XN)}catch(L){t.error(L+" (parsing JSON "+b.url+")");b.Rb(null,b.id,b.type,b.url,b.vb);return}b.Bg&&
(z[e]="json"==f?E.S(a):a);b.Rb(a,b.id,b.type,b.url,b.vb)}else t.error("empty responce when trying to get "+b.url),b.Rb(null,b.id,b.type,b.url,b.vb)}else t.error(h.status+" when trying to get "+b.url),b.Rb(null,b.id,b.type,b.url,b.vb);b.state=30}};h.addEventListener("progress",function(a){a.lengthComputable&&b.JD(a.loaded/a.total)},!1);h.send(b.Mj)}}function n(a){var b=a.url.split("?v=")[0];if(b in Q)a.Rb(Q[b],a.id,a.type,a.url,a.vb),a.state=30;else{"GET"!=a.request&&E.D("Unsupported request type for audio buffer");
var f=(b=d())&&a.url in b?new c:new XMLHttpRequest;f.open("GET",a.url,!0);f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState)if(200==f.status||0==f.status){var b=f.response;b?q.GL(b,function(b){a.Rb(b,a.id,a.type,a.url,a.vb);a.state=30;a.Bg&&(Q[a.url.split("?v=")[0]]=b)},function(){a.Rb(null,a.id,a.type,a.url,a.vb);t.error("failed to decode "+a.url);a.state=30}):(a.Rb(null,a.id,a.type,a.url,a.vb),t.error("empty responce when trying to get "+a.url),a.state=
30)}else a.Rb(null,a.id,a.type,a.url,a.vb),t.error(f.status+" when trying to get "+a.url),a.state=30};f.send(a.Mj)}}function x(a){var b=a.url.split("?v=")[0];if(b in H)a.Rb(H[b],a.id,a.type,a.url,a.vb),a.state=30;else{"GET"!=a.request&&E.D("Unsupported request type for image element");var c=document.createElement("img");A.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.Rb(c,a.id,a.type,a.url,a.vb),a.state=30,a.Bg&&(H[a.url.split("?v=")[0]]=c))};c.addEventListener("error",
function(){40!=a.state&&(a.Rb(null,a.id,a.type,a.url,a.vb),t.error("could not load image: "+a.url),a.state=30)},!1);if((b=d())&&a.url in b)if(b[a.url]){var f=m(a.url);c.src="data:"+f+";base64,"+b[a.url]}else F.is_ie11()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function e(a){var b=a.url.split("?v=")[0];if(b in p)a.Rb(p[b],a.id,a.type,a.url,a.vb),a.state=30;else{"GET"!=a.request&&E.D("Unsupported request type for audio element");
var c=document.createElement("audio");A.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.Rb(c,a.id,a.type,a.url,a.vb),a.state=30,a.Bg&&(p[a.url.split("?v=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(a.Rb(null,a.id,a.type,a.url,a.vb),t.error("could not load sound: "+a.url),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(a.Rb(null,a.id,a.type,a.url,a.vb),t.error("could not load sound: "+a.url),a.state=30)},
!1);if((b=d())&&a.url in b)if(b[a.url]){var f=B(a.url);c.src="data:"+f+";base64,"+b[a.url];40!=a.state&&(a.Rb(c,a.id,a.type,a.url,a.vb),a.state=30)}else F.is_ie11()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,A.is_mobile_device&&c.load();A.rx&&(c.autoplay=!0,c.pause());setTimeout(function(){c.wI=1},5E3)}}function u(a){function b(){40!=a.state&&(a.Rb(null,a.id,a.type,a.url),t.error("could not load video: "+
a.url,a.vb),a.state=30)}var c=a.url.split("?v=")[0];if(c in H)a.Rb(H[c],a.id,a.type,a.url,a.vb),a.state=30;else{"GET"!=a.request&&E.D("Unsupported request type for video element");var f=document.createElement("video");f.muted=!0;A.allow_cors&&(f.crossOrigin="Anonymous");f.addEventListener("loadeddata",function(){f.removeEventListener("error",b,!1);40!=a.state&&(a.Rb(f,a.id,a.type,a.url,a.vb),a.state=30,a.Bg&&(H[a.url.split("?v=")[0]]=f))},!1);f.addEventListener("error",b,!1);if((c=d())&&a.url in c)if(c[a.url]){var e=
k(a.url);f.src="data:"+e+";base64,"+c[a.url];40!=a.state&&f.addEventListener("loadeddata",function(){a.Rb(f,a.id,a.type,a.url,a.vb);a.state=30},!1)}else F.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),f.dispatchEvent(c);else f.src=a.url,A.is_mobile_device&&f.load();A.rx&&(f.autoplay=!0,f.pause());setTimeout(function(){f.wI=1},1E4)}}function w(b){function f(a){b.Rb(a,b.id,b.type,b.url,b.vb);b.state=30;b.Bg&&(H[b.url.split("?v=")[0]]=
a)}var e=b.url.split("?v=")[0];if(e in H)b.Rb(H[e],b.id,b.type,b.url,b.vb),b.state=30;else{"GET"!=b.request&&E.D("Unsupported request type for seq video element");var g=(e=d())&&b.url in e?new c:new XMLHttpRequest;if(null==b.ul&&null==b.Mj)g.open("GET",b.url,!0);else switch(g.open("POST",b.url,!0),b.ul){case a.rz:g.setRequestHeader("Content-type","text/plain");break;case a.qz:g.setRequestHeader("Content-type","application/json")}g.responseType="arraybuffer";g.onreadystatechange=function(){if(40!=
b.state&&4==g.readyState)if(200==g.status||0==g.status){var a=g.response;a?h(a,f):(b.Rb(null,b.id,b.type,b.url,b.vb),t.error("empty responce when trying to get "+b.url),b.state=30)}else b.Rb(null,b.id,b.type,b.url,b.vb),t.error(g.status+" when trying to get "+b.url),b.state=30};g.addEventListener("progress",function(a){a.lengthComputable&&b.JD(a.loaded/a.total)},!1);g.send(b.Mj)}}function h(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),f=c[3],e={images:[],AA:[],zg:c[4]},g=20,h=0;h<f;h++){var l=
c[g/4],k=new Blob([d.subarray(g+4,g+4+l)],{type:"image/jpg"}),m=document.createElement("img");m.src=window.URL.createObjectURL(k);e.images.push(m);e.AA.push(k);g+=l+8-l%4}m.onload=function(){for(var a=0;a<e.images.length;a++)window.URL.revokeObjectURL(e.images[a].src);delete e.AA;b(e)}}function m(a){var b="image";switch(E.uw(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function B(a){var b="audio";switch(E.uw(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";
break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function k(a){var b="video";switch(E.uw(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var f=r("__config"),F=r("__compat"),t=r("__print"),q=r("__sfx"),E=r("__util"),J=r("__version"),A=f.H,I=f.rd;a.AT_ARRAYBUFFER=10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.Lq=70;a.Kq=80;a.qz=a.AT_JSON;a.rz=
a.AT_TEXT;var C=[],v=0,l={},z={},H={},p={},Q={};a.gn=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.gU=function(a){if(l[a])return l[a];var b=I.prevent_caching?a+J.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200!=c.status&&c.status)E.D("Error XHR: "+c.status+", GET "+a);else{b=c.responseText;if(b.length)return l[a]=b;E.D("Error XHR: responce is empty, GET "+a)}};a.cleanup=function(){for(var a=
0;a<C.length;a++)C[a].state=40;C=[];v=0;l={}};a.enqueue=function(a,c,f,e,g){for(var h=0;h<a.length;h++){var l=a[h],l={id:l.id,type:l.type,url:l.url,Bg:l.Bg,request:l.request?l.request:"GET",ul:l.ul?l.ul:null,Jj:l.Jj?l.Jj:null,Mj:l.Mj?l.Mj:null,vb:l.vb?l.vb:null,state:10,Rb:c||function(){},zD:f||function(){},JD:e||function(){},XN:g||null,AD:v};if(I.prevent_caching){var k=d();k&&l.url in k||(l.url+=J.timestamp())}C.push(l)}b(C);v++};a.update=function(){b(C);for(var a=C,c=0,d=!0,f=0;f<a.length;f++){var e=
a[f];e.AD===a[c].AD?30!==e.state&&(d=!1):(d&&(a[f-1].zD(),d=f-c,a.splice(c,d),f-=d),c=f,d=30===a[f].state?!0:!1);f===a.length-1&&d&&(a[f].zD(),a.splice(c))}};a.ZJ=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.lK=function(){z={};H={};p={};Q={}}};b4w.module.__loader=function(a,r){function d(b,d,e,g){var h=E,l=F.create(),k;for(k in d){var n=c(d[k]);(g&&n.Nb||!b&&n.bc)&&m(n);F.O(l,n)}for(k in d)for(n=d[k],n.name=k,b=0;b<n.inputs.length;b++)F.C(l,d[n.inputs[b]],n,null);d=c({name:"out",Gb:a.kG,Sb:function(a,b,c,d,e){b.Eb&&(h.yy=!0);f(b)||(b.status=2);b.$C(b.id,!0);e(b,c);t.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Pb:5});if(e)e=F.kp(l);else{k=F.clone(l);do{e=F.kp(k);n=[];for(b=0;b<e.length;b++){g=e[b];var p=F.Ra(k,g);p.Lb&&n.push(g)}for(b=
0;b<n.length;b++)F.Vf(k,n[b]);n.length&&F.xv(k)}while(n.length)}F.O(l,d);for(b=0;b<e.length;b++)g=e[b],p=F.Ra(l,g),d.inputs.push(p.name),F.C(l,p,d,null);return l}function c(a){a.Lb=a.Lb||!1;a.Gb||0===a.Gb||(a.Gb=a.Xd);a.inputs=a.inputs||[];a.al=a.al||!1;a.uy=a.uy||!1;a.Pb=a.Pb||0;a.Nb=a.Nb||!1;a.bc=a.bc||!1;a.status=0;a.EU=0;a.ex=0;a.ro=a.ro||null;return a}function b(a,b){for(var c=[],d=[],f=0;f<b.length;f++){var e=b[f];F.Ra(a.Gh,e).al&&(F.Zj(a.Gh,e,function(d){var f=!0;F.Ih(a.Gh,d,function(a,b){if(!b.al)return f=
!1,1});f&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(f))}for(f=d.length-1;0<=f;f--)b.splice(d[f],1);return c}function g(a){function c(b,c){var d=F.Ra(a.Gh,b),f=F.Ra(a.Gh,c),e=f.Gb-d.Gb;e||(e=d.Lb-f.Lb);return e}var d=[],f=a.Fi,e=!1;do{var g=b(a,f);d.push.apply(d,f);0<g.length&&(e=!0);f=g}while(0<g.length);e&&d.sort(c);a.Fi=d;return a.Fi.length}function n(a,b,c){if(b.uy)return b.al=!0,e(a,b),!1;if(!b.Sb&&!b.$i&&!b.qo)return e(a,b),!1;if(0==b.status&&(b.status++,b.Sb))return b.Sb(c,a,b,
b.ro,e,u),!0;if(1==b.status){if(b.$i)return b.$i(c,a,b,b.ro,e,u),!0;b.status++}return 2==b.status&&(b.status++,b.qo)?(b.qo(c,a,b,b.ro,e,u),!0):!1}function x(a){if(0==a.$t)return 100;var b=0;F.ha(a.Gh,function(c,d){a.do_not_load_resources&&d.Nb||(b+=d.ex*d.Pb)});return q.trunc(100*b/a.$t)}function e(a,b){b.al=!0;b.status=3;w(a,b,1)}function u(a,b,c){1>c?w(a,b,c):b.status++}function w(a,b,c){var d=E;if(b.Sb||b.$i||b.qo)if(b.ex=c,b=x(a),a.qB!=b||1==c)a.xy(b,performance.now()-a.kF),a.qB=b,d.gx=!0}function h(a,
b){var c=null;F.ha(a.Gh,function(a,d){if(d.name==b)return c=d,1});return c}function m(a){a.uy=!0;a.ex=1}function B(a){a.xy=null;a.Dv=null;a.Gh=null;a.Fi=null}function k(){return 0==E.ar}function f(a){return a&&(3==a.status||4==a.status)}var F=r("__graph"),t=r("__print"),q=r("__util");a.Xd=0;a.cg=1;a.kG=2;var E=null;a.yw=function(){return E};a.iB=function(){var a={Qg:[],Sv:0,ar:0,yy:!1,gx:!1};return E=a};a.nB=function(a,b,c,f,e,g,h,k,m){var l=E,n=l.Qg.length,p={id:n,Eb:0==n,status:0,xg:b,wA:"",$C:c||
function(){},ZC:k||!1,lV:g,kF:0,qB:0,$t:0,$x:!1,xy:f||function(){},Dv:e||function(){},Gh:null,Fi:null,Lw:!1,Jw:!1,Ow:!1,wj:m};a=d(p.Eb,a,g,h);p.Gh=a;b=[];c=F.sN(a);for(f=0;f<c.length;f++)b.push(c[f]);p.Fi=b;F.ha(a,function(a,b){!(b.Sb||b.$i||b.qo)||p.do_not_load_resources&&b.Nb||(p.$t+=b.Pb)});l.Qg.push(p);l.ar++;return p.id};a.UR=function(b){var c=E;if(c&&!k())if(c.gx)c.gx=!1;else{var d=performance.now();do{var e=c.Qg[c.Sv],h=b[e.id];if(!f(e))if(0==e.status&&(e.status=1,e.kF=performance.now(),e.xy(0,
0)),g(e)){var l=e,m=l.Fi.length;do{var q=F.Ra(l.Gh,l.Fi[0]),p=n(l,q,h);q.Gb==a.cg&&(l.$x=!0);q=l.Fi.shift();l.Fi.push(q);m--}while(!p&&0!=m)}else l=c,m=e,m.Dv(h,m),m.status=3,l.ar--,B(m);c.yy&&(c.Sv=(c.Sv+1)%c.Qg.length);if(e.$x){e.$x=!1;break}}while(16>performance.now()-d)}};a.Wz=function(a){var b=E;a.Dv(null,a);a.status=3;b.ar--;B(a);a.status=4;a.Eb&&(b.yy=!0);a.$C(a.id,!1)};a.aV=u;a.Nt=function(a,b){var c=h(a,b);null!==c&&m(c)};a.al=k;a.lR=f;a.is_primary_loaded=function(a){var b=E;if(!b)return!1;
a|=0;return b.Qg[a]&&(3==b.Qg[a].status||2==b.Qg[a].status)};a.zN=function(){t.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.cleanup=function(){E=null}};b4w.module.__logic_nodes=function(a,r){function d(){return function(a,b,c,d){c=d[0];var f=d[1];d=d[2];if(-2==c.state){for(var e=0;e<c.Ht;e++)if(I.get_sensor_value(a,b,e))for(var g=0;g<c.Gt.length;g++)if(c.Gt[g]==e){f.nl==c.gF?(t.is_play(f.na)&&(c.state=-1),d.qf.df||(c.state=1,c.gq=c.Qs[g])):(c.state=1,c.gq=c.Qs[g]);return}c.state=0}}}function c(){return function(a,b,c,d){c=d[0];var f=d[1];d=d[2];for(var e=0;e<c.Ht;e++)if(I.get_sensor_value(a,b,e)&&e==c.eE){if(t.is_play(f.na)&&f.nl==c.gF)c.state=-1;
else if(!d.qf.df||c.T.no_wait)c.state=1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Na:a.slot_idx_order,gq:a.slot_idx_jump,sa:a.frame_range[0],Za:a.frame_range[1],wM:a.frame_range_mask?a.frame_range_mask[0]:!0,vM:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,Ht:-1,eE:-1,ZO:a.param_name,WO:a.operation,mute:a.mute,Wo:a.object,obj:null,$b:null,kc:null,$a:{},yf:a.anim_name,qc:k.SLOT_ALL,aP:a.parse_json_vars,$O:a.parse_json_paths,zc:a.objects_paths,oD:a.nodes_paths,
zb:a.floats,T:a.bools,W:a.variables,Hi:a.strings,hx:a.materials_names,xE:a.shader_nd_type,Zd:a.common_usage_names,XL:a.encode_json_vars,WL:a.encode_json_paths,gF:b,ID:ha[a.type]?ha[a.type]:e,zt:!1,eu:0,Gt:null,pO:a.links,Qs:[]}}function g(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function n(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function x(a,b,c){switch(b.state){case 2:c.la=a.Na}}function e(a,b,c){switch(b.state){case 1:E.error("Unknown node type: "+a.type);break;case 2:c.la=a.Na}}function u(a){return q.oc(q.Cc,
a.Wo||[],0)}function w(a,c){var d=a.b4w_logic_nodes,f=c.Od;c.state=1;for(var e=0;e<d.length;e++){var g={V:[],qf:{pb:a,la:0,df:!1,My:e,G:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};f.push(g);for(var h=f[f.length-1],l=d[e],k=0;k<l.length;k++){var m=b(l[k],h);h.V.push(m)}for(l=0;l<h.V.length;l++)m=h.V[l],m.mute||m.ID(m,c,g.qf,0,0)}var d=a.timeline_markers,n;for(n in d)c.hq.push(d[n]);c.hq.sort(function(a,b){return a-b});c.state=2;U.push(c)}function h(a,b){switch(b){case 0:return Number(a)?Number(a):
0;case 1:return String(a);default:return null}}function m(a){switch(typeof a){case "string":return h(a,1);case "number":return h(a,0);default:return h(a,1)}}function B(a){ca[a]||(ca[a]=0);var b=a+"_"+ca[a],b=b.replace(/ /g,"_").replace(/\//g,"_");ca[a]++;return b}var k=r("__animation"),f=r("__assets"),F=r("__camera"),t=r("__nla"),q=r("__objects"),E=r("__print"),J=r("__scenes"),A=r("__config"),I=r("__controls"),C=r("__batch"),v=r("__geometry"),l=r("__mat3"),z=r("__mat4"),H=r("__physics"),p=r("__quat"),
Q=r("__sfx"),y=r("__time"),Z=r("__transform"),S=r("__tsr"),G=r("__util"),D=r("__vec3"),X=new Float32Array(4),V=new Float32Array(3),L=new Float32Array(3),ba=new Float32Array(2),pa=new Float32Array(9),Y=new Float32Array(16);a.kH=0;a.lH=1;a.PG=0;a.YG=1;a.UG=2;a.KG=3;a.VG=4;a.XG=5;a.OG=6;a.ZG=7;a.MG=8;a.LG=9;a.NG=10;a.QG=11;a.SG=12;a.RG=13;a.WG=14;a.TG=15;a.JG=16;a.eH=0;a.dH=1;a.fH=2;a.gH=3;a.cH=4;a.Iz=0;a.Kz=1;a.Jz=2;a.Lz=3;a.Mz=4;a.Hz=5;a.jH=0;a.iH=1;a.hH=2;a.FG=0;a.GG=1;a.DG=2;a.EG=3;a.HG=0;a.IG=1;
var ha={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.la=a.Na}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=u(a);a.obj||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:a.T.ch?J.sr(a.obj,!0):J.uo(a.obj,!0),c.la=a.Na}},SHOW:function(a,b,c){switch(b.state){case 1:a.obj=u(a);a.obj||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:a.T.ch?J.sr(a.obj,!1):J.uo(a.obj,!1),c.la=a.Na}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=
a.W.vd;b=b.G;var f=c.G,e;a:{e=a.ZO;var g=a.zb.ptp,l=a.T.hsh,k=A.get("url_params");if(k&&e in k)e=Number(k[e]);else{if(l=l?location.hash:location.search)for(l=l.slice(1).split("&"),k=0;k<l.length;k++){var m=l[k].split("=");if(1<m.length&&m[0]==e){e=h(m[1],g);break a}}e=0}}n(d,b,f,e);c.la=a.Na}},SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.Od[c.My];var f=q.get_selectable_objects();a.Gt=[];a.Qs=[];for(var e in a.zc){var g=q.oc(q.Cc,a.zc[e],0),h=f.indexOf(g);if(-1==h){E.error("logic script error: non-selectable object:",
a.zc[e][a.zc[e].length-1]);break a}a.Gt.push(h);a.Qs.push(a.pO[e])}a.state=-1;a.Ht=f.length;e=[];for(h=0;h<f.length;h++)e.push(I.create_selection_sensor(f[h],!1));f=d();I.create_sensor_manifold(g,"LOGIC_NODES_SWITCH_SELECT_"+B(a.label),I.CT_SHOT,e,I.default_OR_logic_fun,f,[a,b,c])}break;case 2:if(-1==a.state){b=b.Od[c.My].V;for(g=0;g<b.length;g++)f=b[g],"SWITCH_SELECT"==f.type&&(f.state=-1);a.state=-2}if(0==a.state||1==a.state)c.la=a.state?a.gq:a.Na,a.state=-1}},SELECT:function(a,b,d){switch(b.state){case 1:d=
b.Od[d.My];var f=u(a),e=q.get_selectable_objects(),g=e.indexOf(f);if(-1==g)E.error("logic script error: non-selectable object:",a.Wo[a.Wo.length-1]);else{a.state=-1;a.Ht=e.length;a.eE=g;for(var g=[],h=0;h<e.length;h++)g.push(I.create_selection_sensor(e[h],!1));e=c();I.create_sensor_manifold(f,"LOGIC_NODES_SELECT_"+B(a.label),I.CT_SHOT,g,I.default_OR_logic_fun,e,[a,b,d])}break;case 2:0==a.state||1==a.state?(d.la=a.state?a.gq:a.Na,a.state=-1):a.T.not_wait&&(d.la=a.Na)}},PLAY:function(a,b,c,d){switch(b.state){case 1:t.Ay();
a.state=-1;a.T.not_wait||(a.T.not_wait=!1);break;case 2:switch(a.state){case -1:if(t.is_play(b.na))if(b.Qv==b.nl&&c.df)break;else{var f=b.nl;if(f){f.qf.la=f.V[f.qf.la].Na;f.V[f.qf.la].state=-1;for(var f=b.nl.V,e=0;e<f.length;e++){var g=f[e];"PLAY"==g.type&&(g.state=-1)}}}c.df=!a.T.not_wait;b.nl=b.Qv;a.state=0;a.wM&&(t.vQ(a.sa),t.pE(d));if(a.vM)t.ly(a.Za);else{d=t.get_frame(d);var f=-1,h;for(h in b.hq)if(d<b.hq[h]){f=h;break}0<=f?t.ly(b.hq[f]):t.ly(t.get_frame_end())}t.FD(null);a.T.not_wait&&(c.la=
a.Na,a.state=-1,c.df=!1);break;case 0:t.is_play()||(c.la=a.Na,a.state=-1,c.df=!1);break;case 1:c.la=a.Na;a.state=-1;b.nl=null;c.df=!1;break;default:G.D("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.T.url?h(g(a.W.url,b.G,c.G),1):a.Hi.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.W.v1[1]?a.zb.inp1:h(g(a.W.v1,b.G,c.G),0),f=-1==a.W.v2[1]?a.zb.inp2:h(g(a.W.v2,b.G,c.G),0),e=0;switch(a.WO){case 3:e=d+f;break;case 2:e=
d*f;break;case 1:e=d-f;break;case 0:0==f&&G.D("Division by zero in Logic script");e=d/f;break;case 4:e=Math.random()*(f-d)+d;break;case 5:e=Math.sin(d);break;case 6:e=Math.cos(d);break;case 7:e=Math.tan(d);break;case 8:e=Math.asin(d);break;case 9:e=Math.acos(d);break;case 10:e=Math.atan(d);break;case 11:e=Math.log(d);break;case 12:e=Math.min(d,f);break;case 13:e=Math.max(d,f);break;case 14:e=Math.round(d);break;case 15:e=d%f;break;case 16:e=Math.abs(d)}n(a.W.vd,b.G,c.G,e);c.la=a.Na}},CONDJUMP:function(a,
b,c){switch(b.state){case 2:var d=a.T.str?1:0,f=a.T.str?a.Hi:a.zb,e=-1==a.W.v1[1]?f.inp1:h(g(a.W.v1,b.G,c.G),d);b=-1==a.W.v2[1]?f.inp2:h(g(a.W.v2,b.G,c.G),d);d=!1;switch(a.Zd.condition){case 5:e==b&&(d=!0);break;case 4:e!=b&&(d=!0);break;case 3:e<b&&(d=!0);break;case 2:e>b&&(d=!0);break;case 1:e<=b&&(d=!0);break;case 0:e>=b&&(d=!0)}c.la=d?a.gq:a.Na}},REGSTORE:function(a,b,c){switch(b.state){case 2:n([a.T.gl||a.W.vd[0],a.W.vd[1]],b.G,c.G,(1==a.Zd.variable_type?a.Hi:a.zb).inp1),c.la=a.Na}},PLAY_ANIM:function(a,
b,c){switch(b.state){case 1:a.obj=a.T.env?q.get_world_by_name(a.Wo[0],0):u(a);a.obj||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:switch(0!=a.state||k.is_play(a.obj,a.qc)||(a.state=1),a.state){case -1:for(var d in b.Od){var f=b.Od[d].qf.la;-1!=f&&(f=b.Od[d].V[f],"PLAY_ANIM"==f.type&&f!=a&&0==f.state&&f.obj==a.obj&&(f.state=1))}b=a.Zd.param_anim_behavior;if(""==a.yf)k.apply_def(a.obj),k.set_behavior(a.obj,b,k.SLOT_ALL);else{a:{d=a.obj;for(var f=a.yf,e=-1,
g=0;8>g;g++){var h=d.fa[g];if(h&&h.Sh&&k.UE(h.Sh)==k.UE(f))if(-1!=e)e=g;else{d=-1;break a}}d=e}-1==d?(a.qc=k.MQ(a.obj,a.yf),k.apply(a.obj,null,a.yf,a.qc)):a.qc=d;k.set_behavior(a.obj,b,a.qc)}a.T.not_wait||(c.df=!0);k.play(a.obj,null,a.qc);a.state=0;a.T.not_wait&&(c.la=a.Na,a.state=-1);break;case 0:break;case 1:a.T.not_wait||(c.df=!1);c.la=a.Na;a.state=-1;break;default:G.D("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:x,SEND_REQ:function(a,b,c){function d(a,d,f,e,g){a=JSON.stringify(a);n(g[0].W.dst,
b.G,c.G,a);g[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.T.url?h(g(a.W.url,b.G,c.G),1):a.Hi.url,l={};a.T.ct&&(l["Content-Type"]=a.Hi.ct);"GET"==a.Zd.request_type?f.enqueue([{id:e,type:f.AT_JSON,url:e,Jj:l,vb:[a,c.G]}],d,null,null,null):"POST"==a.Zd.request_type&&f.enqueue([{id:e,type:f.AT_JSON,url:e,Jj:l,request:"POST",ul:f.AT_JSON,Mj:h(g(a.W.dst1,b.G,c.G),1),vb:[a,c.G]}],d,null,null,null);break;case 1:a.state=-1,c.la=a.Na}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=
0;2>b;b++)a.$a["id"+b]=q.oc(q.Cc,a.zc["id"+b],0),a.$a["id"+b]||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:q.inherit_material(a.$a.id0,a.hx.id0,a.$a.id1,a.hx.id1),c.la=a.Na}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.zc.id0&&(a.$a.id0=q.oc(q.Cc,a.zc.id0,0),a.zc.id0||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0),a.oD.id0.unshift(a.hx.id0));break;case 2:var d=a.$a.id0,f=a.oD.id0,e=f[0],l=C.Oa(d,e,"MAIN");c.la=
a.Na;if(null===l)E.error('Material "'+e+'" was not found in the object "'+d.name+'".');else{if("ShaderNodeRGB"==a.xE){var k=C.ph(l.hf,f);C.set_nodemat_rgb(d,e,k,a.T.id0?h(g(a.W.id0,b.G,c.G),0):a.zb.id0,a.T.id1?h(g(a.W.id1,b.G,c.G),0):a.zb.id1,a.T.id2?h(g(a.W.id2,b.G,c.G),0):a.zb.id2)}"ShaderNodeValue"==a.xE&&(k=C.ph(l.jf,f),C.set_nodemat_value(d,e,k,a.T.id0?h(g(a.W.id0,b.G,c.G),0):a.zb.id0))}}},DELAY:function(a,b,c,d,f){switch(b.state){case 2:-1==a.state?(a.state=0,a.eu=0,c.df=!0):0==a.state&&(a.eu+=
f,(a.T.dl?h(g(a.W.dl,b.G,c.G),0):a.zb.dl)<a.eu&&(a.state=-1,c.la=a.Na,c.df=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.$a.id0=q.oc(q.Cc,a.zc.id0,0);b||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c=a.Zd.sk;v.check_shape_keys(b)?v.Kw(b,c)||(E.error("Wrong key name:",c),a.mute=!0):(E.error("No shape keys in object:",b.name),a.mute=!0);break;case 2:v.av(a.$a.id0,a.Zd.sk,a.T.skv?h(g(a.W.skv,b.G,c.G),0):a.zb.skv),c.la=a.Na}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=
a.$a.id0=q.oc(q.Cc,a.zc.id0,0);d||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);d&&d.o&&d.o.Ic||(E.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0);break;case 2:d=a.$a.id0;switch(a.Zd.outline_operation){case "PLAY":b=d.o.Ah;q.apply_outline_anim(d,b.Gj,b.Hj,b.Ij);break;case "STOP":q.clear_outline_anim(d);break;case "INTENSITY":d.o.Jg=a.T["in"]?h(g(a.W["in"],b.G,c.G),0):a.zb["in"]}c.la=a.Na}},MOVE_CAMERA:function(a,b,c){function d(a,b,c,d){switch(F.get_move_style(a)){case F.MS_TARGET_CONTROLS:F.my(a,
b,c);break;case F.MS_EYE_CONTROLS:case F.MS_STATIC:Z.set_tsr(a,d);break;case F.MS_HOVER_CONTROLS:D.sub(c,b,V),D.normalize(V,V),F.nE(a,c),L[0]=V[0],L[1]=0,L[2]=V[2],b=D.dot(L,V),c=Math.acos(b/(D.length(L)*D.length(V))),b=V[2]?Math.atan(V[0]/V[2]):0<V[0]?0:Math.PI,0<V[2]&&0<V[0]?ba[1]=-(Math.PI+ba[1]):0<V[2]&&0>V[0]?ba[1]=-(Math.PI+ba[1]):0>V[2]&&0>V[0]?(ba[0]+=Math.PI,b=-(Math.PI-b)):0>V[2]&&0<V[0]&&(ba[0]+=Math.PI,b-=Math.PI),F.ey(a,b+Math.PI,-c,!0,!0)}Z.L(a);H.sync_transform(a)}function f(a,b,c,
d){z.lookAt(b,c,G.AXIS_Z,Y);z.invert(Y,Y);l.fromMat4(Y,pa);p.fromMat3(pa,X);p.normalize(X,X);a=S.get_scale(a.o.v);S.set_sep(b,a,X,d)}switch(b.state){case 1:var e=null,e=a.$a.ca=q.oc(q.Cc,a.zc.id0,0);e||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.$a.tr=q.oc(q.Cc,a.zc.id1,0);a.$a.tr||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.$a.ta=q.oc(q.Cc,a.zc.id2,0);a.$a.ta||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=
!0);a.state=-1;a.kc={oF:new Float32Array(3),nF:new Float32Array(3),Tw:new Float32Array(3),Iy:new Float32Array(3),dF:new Float32Array(3),Sw:new Float32Array(3),$j:new Float32Array(8),Jh:new Float32Array(8),pp:new Float32Array(8)};break;case 2:var k=a.$a.ca,e=S.get_trans_view(a.$a.tr.o.v),m=S.get_trans_view(a.$a.ta.o.v);switch(a.state){case -1:b=a.T.dur?h(g(a.W.dur,b.G,c.G),0):a.zb.dur;if(0==b){f(k,e,m,a.kc.Jh);d(k,e,m,a.kc.Jh);c.la=a.Na;break}c=S.get_trans_view(k.o.v);D.copy(c,a.kc.oF);var n=F.get_move_style(k);
n==F.MS_HOVER_CONTROLS?D.copy(k.o.fc,a.kc.Iy):n==F.MS_STATIC||n==F.MS_EYE_CONTROLS?(S.copy(k.o.v,a.kc.$j),f(k,e,m,a.kc.Jh)):D.copy(k.o.pivot,a.kc.Iy);D.copy(e,a.kc.nF);D.copy(m,a.kc.dF);a.state=0;var t=y.animate(0,1,1E3*b,function(b){J.xa()&&(n==F.MS_STATIC||n==F.MS_EYE_CONTROLS?S.interpolate(a.kc.$j,a.kc.Jh,G.smooth_step(b),a.kc.pp):(a.kc.Sw=D.lerp(a.kc.Iy,a.kc.dF,G.smooth_step(b),a.kc.Sw),a.kc.Tw=D.lerp(a.kc.oF,a.kc.nF,G.smooth_step(b),a.kc.Tw)),d(k,a.kc.Tw,a.kc.Sw,a.kc.pp),1==b&&(a.state=1))});
break;case 1:y.clear_animation(t),a.state=-1,c.la=a.Na}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d;d=a.$a.ca=q.oc(q.Cc,a.zc.id0,0);d||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);b=d.o;a.KJ={Yj:b.Yj,use_panning:b.use_panning,Bb:b.Bb,Da:b.Da,ub:b.ub,bd:b.bd,cd:b.cd,Dd:b.Dd,kh:b.kh};break;case 2:d=a.$a.ca;var f=d.o,e=a.KJ;F.Jq(d);switch(a.Zd.camera_move_style){case 0:f.kb=F.MS_STATIC;break;case 2:f.kb=F.MS_EYE_CONTROLS;var l=S.get_trans_view(f.v);
F.tE(d,l,null,e.Bb,e.Da);break;case 3:f.kb=F.MS_HOVER_CONTROLS;var l=S.get_trans_view(f.v),k=V;a.T.pvo?(k=q.oc(q.Cc,a.zc.id1,0),k=S.get_trans_view(k.o.v)):(k[0]=a.T.pvx?h(g(a.W.pvx,b.G,c.G),0):a.zb.pvx,k[1]=a.T.pvy?h(g(a.W.pvy,b.G,c.G),0):a.zb.pvy,k[2]=a.T.pvz?h(g(a.W.pvz,b.G,c.G),0):a.zb.pvz);F.uE(d,l,k,e.ub,e.Da,e.bd,e.cd,e.kh);break;case 1:f.kb=F.MS_TARGET_CONTROLS,l=S.get_trans_view(f.v),k=V,a.T.pvo?(k=q.oc(q.Cc,a.zc.id1,0),k=S.get_trans_view(k.o.v)):(k[0]=a.T.pvx?h(g(a.W.pvx,b.G,c.G),0):a.zb.pvx,
k[1]=a.T.pvy?h(g(a.W.pvy,b.G,c.G),0):a.zb.pvy,k[2]=a.T.pvz?h(g(a.W.pvz,b.G,c.G),0):a.zb.pvz),F.vE(d,l,k,e.Bb,e.Da,e.ub,e.Dd,e.use_panning)}L[0]=a.T.vtr?h(g(a.W.vtr,b.G,c.G),0):a.zb.vtr;L[1]=a.T.vro?h(g(a.W.vro,b.G,c.G),0):a.zb.vro;L[2]=a.T.vzo?h(g(a.W.vzo,b.G,c.G),0):a.zb.vzo;L[0]=G.clamp(L[0],0,Infinity);L[1]=G.clamp(L[1],0,Infinity);L[2]=G.clamp(L[2],0,.99);f.An=L[0];f.zn=L[1];f.Bn=L[2];Z.L(d);H.sync_transform(d);F.Am(d);c.la=a.Na}},MOVE_TO:function(a,b,c){function d(a,b){Z.set_tsr(a,b);Z.L(a);
H.sync_transform(a)}switch(b.state){case 1:a.$a.ob=q.oc(q.Cc,a.zc.id0,0);a.$a.ob||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.$a.de=q.oc(q.Cc,a.zc.id1,0);a.$a.de||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.state=-1;a.$b={yB:new Float32Array(8),Xv:new Float32Array(8),BC:new Float32Array(8)};break;case 2:var f=a.$a.ob;S.copy(a.$a.ob.o.v,a.$b.yB);S.copy(a.$a.de.o.v,a.$b.Xv);switch(a.state){case -1:b=a.T.dur?h(g(a.W.dur,b.G,c.G),0):a.zb.dur;
if(0==b){d(f,a.$b.Xv);c.la=a.Na;break}a.state=0;var e=y.animate(0,1,1E3*b,function(b){J.xa()&&(a.$b.sU=S.interpolate(a.$b.yB,a.$b.Xv,G.smooth_step(b),a.$b.BC),d(f,a.$b.BC),1==b&&(a.state=1))});break;case 1:y.clear_animation(e),a.state=-1,c.la=a.Na}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?Z.set_tsr(a,b):Z.set_tsr_rel(a,b);Z.L(a);H.sync_transform(a)}switch(b.state){case 1:a.$a.ob=q.oc(q.Cc,a.zc.id0,0);a.$a.ob||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=
!0);a.state=-1;a.$b={Tt:0,$j:new Float32Array(8),Jh:new Float32Array(8),pp:new Float32Array(8)};break;case 2:var f=a.$a.ob;switch(a.state){case -1:L[0]=a.T.trx?h(g(a.W.trx,b.G,c.G),0):a.zb.trx;L[1]=a.T["try"]?h(g(a.W["try"],b.G,c.G),0):a.zb["try"];L[2]=a.T.trz?h(g(a.W.trz,b.G,c.G),0):a.zb.trz;V[0]=a.T.rox?h(g(a.W.rox,b.G,c.G),0)*Math.PI/180:a.zb.rox;V[1]=a.T.roy?h(g(a.W.roy,b.G,c.G),0)*Math.PI/180:a.zb.roy;V[2]=a.T.roz?h(g(a.W.roz,b.G,c.G),0)*Math.PI/180:a.zb.roz;var e=a.T.sc?g(a.W.sc,b.G,c.G):a.zb.sc;
G.euler_to_quat(V,X);S.set_sep(L,e,X,a.$b.Jh);a.$b.Tt=a.Zd.space_type;switch(a.$b.Tt){case 0:Z.get_tsr(f,a.$b.$j);break;case 1:Z.get_tsr_rel(f,a.$b.$j);break;case 2:Z.get_tsr_rel(f,a.$b.$j),S.multiply(a.$b.$j,a.$b.Jh,a.$b.Jh)}b=a.T.dur?h(g(a.W.dur,b.G,c.G),0):a.zb.dur;if(0==b){d(f,a.$b.Jh,a.$b.Tt);c.la=a.Na;break}a.state=0;e=y.animate(0,1,1E3*b,function(b){J.xa()&&(S.interpolate(a.$b.$j,a.$b.Jh,G.smooth_step(b),a.$b.pp),d(f,a.$b.pp,a.$b.Tt),1==b&&(a.state=1))});break;case 1:y.clear_animation(e),a.state=
-1,c.la=a.Na}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.obj=q.oc(q.Cc,a.zc.id0,0);a.obj||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);void 0==a.T.not_wait&&(a.T.not_wait=!0);break;case 2:switch(Q.is_playing(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.Od){var f=b.Od[d].qf.la;-1!=f&&(f=b.Od[d].V[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==f.state&&f.obj==a.obj&&(f.state=1))}a.T.not_wait||(c.df=!0);Q.play_def(a.obj);a.state=0;break;case 0:a.T.not_wait&&
(c.la=a.Na,a.state=-1);break;case 1:a.T.not_wait||(c.df=!1);c.la=a.Na;a.state=-1;break;default:G.D("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.obj=q.oc(q.Cc,a.zc.id0,0);a.obj||(E.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:Q.stop(a.obj),c.la=a.Na}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.T.env?q.get_world_by_name(a.Wo[0],0):u(a);a.obj||(E.error("Logic script error: object not found. Node: ",
a.name),a.mute=!0);break;case 2:k.stop(a.obj,k.SLOT_ALL),a.T.rst&&k.set_first_frame(a.obj,k.SLOT_ALL),c.la=a.Na}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.T.rst&&t.pE(d),t.Ay(),c.la=a.Na}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},f;for(f in a.W)d[a.W[f][1]]=g(a.W[f],b.G,c.G);E.log(a.Zd.msg,JSON.stringify(d));c.la=a.Na}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.T.id0?h(g(a.W.id0,b.G,c.G),1):a.Hi.id0,f=a.T.id1?h(g(a.W.id1,b.G,c.G),1):a.Hi.id1,e=0;switch(a.Zd.string_operation){case 0:e=
d+f;break;case 1:e=d.indexOf(f);break;case 2:e=d.replace(f,a.T.id2?h(g(a.W.id2,b.G,c.G),1):a.Hi.id2);break;case 3:var l=a.W,e=d.substring(0,d.indexOf(f));n(l.dst1,b.G,c.G,d.substring(d.indexOf(f)+1,d.length));""==g(l.dst,b.G,c.G)&&(e=g(l.dst1,b.G,c.G),n(l.dst1,b.G,c.G,""));break;case 4:switch(a.Zd.condition){case 5:e=d==f?1:0;break;case 4:e=d!=f?1:0;break;case 3:e=d<f?1:0;break;case 2:e=d>f?1:0;break;case 1:e=d<=f?1:0;break;case 0:e=d>=f?1:0}}n(a.W.dst,b.G,c.G,e);c.la=a.Na}},GET_TIMELINE:function(a,
b,c,d){switch(b.state){case 2:d=a.T.nla?h(t.get_frame(d),0):h(y.get_frame(d),0),n(a.W.vd,b.G,c.G,d),c.la=a.Na}},JSON:function(a,b,c){function d(a,b,c,d){for(var f=0;f<b.length;f++){for(var e=b[f].split("."),g=a,h=c[f],l=0;l<e.length&&(g=g[e[l]],void 0!==g&&null!==g);l++);g=m(g);d[h]=g}}function f(a,b,c,d){d||(d={});for(var f=0;f<b.length;f++){var e=b[f].split("."),g=d,h=c[f];if(h in a){for(var l=0;l<e.length-1;l++)void 0===g[e[l]]&&(g[e[l]]=isNaN(e[l+1])?{}:[]),g=g[e[l]];g[e[e.length-1]]=m(a[h])}}}
switch(b.state){case 2:switch(a.Zd.json_operation){case "PARSE":try{var e=JSON.parse(h(g(a.W.jsn,b.G,c.G),1));d(e,a.$O,a.aP,c.G)}catch(ka){E.error("logic script error: non valid JSON string")}break;case "ENCODE":e={},f(c.G,a.WL,a.XL,e),e=h(JSON.stringify(e),1),n(a.W.jsn,b.G,c.G,e)}c.la=a.Na}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var d=a.T.cb?h(g(a.W.cb,b.G,c.G),1):a.Hi.cb,f=[],e=0,l="id"+e,k=a.Zd.js_cb_params;l in k;)l=0==k[l]?q.oc(q.Cc,a.zc[l],0):g(a.W[l],b.G,c.G),f.push(l),e++,
l="id"+e;k=[];e=0;for(l="out"+e;l in a.W;)l=g(a.W[l],b.G,c.G),k.push(l),e++,l="out"+e;e=1;if(d in ga){if(e=!ga[d](f,k))for(d=0;d<k.length;d++)l="out"+d,l in a.W&&n(a.W[l],b.G,c.G,m(k[d]))}else E.error("logic script error: no custom callback with id "+d);e&&(c.la=a.Na)}},EMPTY:x},U=[],ga={},ca={};a.FN=function(a,b){var c={ud:b,cE:a.name,state:0,nl:null,pb:a,Qv:null,Od:[],hq:[],G:{}};a.fT=c;w(a,c)};a.update=function(a,b){var c=t.tN();if(!(0>=c))for(var d=0;d<U.length;d++)for(var f=d,e=a,g=b,h=c,l=U[f],
k=0;k<U[f].Od.length;k++){l.Qv=U[f].Od[k];var m=U[f].Od[k],n=l,p=e,q=g,v=h,u=m.V;if(u.length){for(var w=0;w<u.length;w++)u[w].zt=!1;for(w=0;w<u.length;w++){if(0<=m.qf.la)var x=u[m.qf.la];else break;if(x.zt)break;if(x.mute)if("ENTRYPOINT"==x.type)break;else m.qf.la=x.Na,x.zt=!0;else x.ID(x,n,m.qf,p,q,v),x.zt=!0}}}};a.HI=function(a,b){ga[a]=b};a.wP=function(a){delete ga[a]};a.RP=function(a,b){for(var c=0;c<U.length;c++)if(U[c].cE==a){for(var c=U[c],d=0;d<c.Od.length;d++){var f=c.Od[d].V[0];if(f.name==
b){f.T.js&&(f.mute=!1);c.Od[d].qf.la=0;break}}break}};a.cleanup=function(){U.length=0;ga={};ca={}}};b4w.module.__main=function(a,r){function d(a,b,d){var e=c.get_canvas();if(e.toBlob)e.toBlob(a,b,d);else{d=atob(e.toDataURL(b,d).split(",")[1]);for(var e=new Uint8Array(d.length),g=0;g<d.length;g++)e[g]=d.charCodeAt(g);a(new Blob([e],{type:b||"image/png"}))}}var c=r("__container"),b=null,g="image/png",n=1,x="",e=!1,u=!1;a.canvas_data_url=function(a,c,d,x){e=u="undefined"===typeof x?x:!0;b=a;g=c||g;n=d||n};a.frame=function(){var a=b;a&&(e&&URL.revokeObjectURL(x),d(function(b){x=URL.createObjectURL(b);
a(x)},g,n),b=null,g="image/png",n=1)}};b4w.module.__math=function(a,r){function d(a,b){for(var c=a[1],d=1,e=2;e<a.length;e++)4!=e&&8!=e&&Math.abs(a[e])>Math.abs(c)&&(c=a[e],d=e);for(var g=Math.floor(d/3),d=d%3,c=.5*Math.atan(2*c/(a[3*g+g]-a[3*d+d])),e=0;e<b.length;e++)b[e]=e&&4!=e&&8!=e?0:1;b[d+3*g]=-Math.sin(c);b[g+3*d]=Math.sin(c);b[g+3*g]=Math.cos(c);b[d+3*d]=Math.cos(c);return b}function c(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var c=a.content[b];0<b;){var d=(b+1>>1)-1,e=a.content[d];if(a.yl(c)<a.yl(e))a.content[d]=
c,a.content[b]=e,b=d;else break}}function g(a,b){for(var c=a.content.length,d=a.content[b],e=a.yl(d);;){var g=b+1<<1,h=g-1,k=null;if(h<c){var m=a.yl(a.content[h]);m<e&&(k=h)}g<c&&a.yl(a.content[g])<(null===k?e:m)&&(k=g);if(null!==k)a.content[b]=a.content[k],a.content[k]=d,b=k;else break}}var n=r("__mat3"),x=r("__vec3"),e=new Float32Array(3),u=new Float32Array(9),w=new Float32Array(9),h=new Float32Array(9),m=new Float32Array(9);a.get_pline_directional_vec=function(a,b){b=b||new Float32Array(3);b[0]=
a[3];b[1]=a[4];b[2]=a[5];return b};a.get_pline_initial_point=function(a,b){b=b||new Float32Array(3);return x.copy(a,b)};a.set_pline_initial_point=function(a,b){x.copy(b,a)};a.set_pline_directional_vec=function(a,b){x.normalize(b,e);a[3]=e[0];a[4]=e[1];a[5]=e[2]};a.calc_pline_point=function(a,b,c){c=c||new Float32Array(3);c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b;return c};a.IJ=function(a,b){b[0]=0;b[1]=0;for(var c=b[2]=0;c<a.length;c+=3)b[0]+=a[c],b[1]+=a[c+1],b[2]+=a[c+2];return x.scale(b,
3/a.length,b)};a.DJ=function(a,b,c){for(var d=0;d<c.length;d++)c[d]=0;for(d=0;d<a.length;d+=3){var e=a[d]-b[0],f=a[d+1]-b[1],g=a[d+2]-b[2];c[0]+=e*e;c[1]+=e*f;c[2]+=e*g;c[4]+=f*f;c[5]+=f*g;c[8]+=g*g}c[3]=c[1];c[6]=c[2];c[7]=c[5];for(d=0;d<c.length;d++)c[d]*=3/a.length;return c};a.mM=function(a,b){var e=n.copy(a,u);if(5E-4>c(e))return n.identity(b);var g=d(e,w),k=n.transpose(g,h);n.multiply(e,k,m);n.multiply(g,m,e);for(var q=n.copy(g,b),x=1;5E-4<=c(e)&&100>x;)g=d(e,w),k=n.transpose(g,h),n.multiply(e,
k,m),n.multiply(g,m,e),n.multiply(g,q,q),x++;return q};a.point_plane_dist=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]};a.pJ=function(a){return{content:[],yl:a}};a.vA=function(a,c){a.content.push(c);b(a,a.content.length-1)};a.qJ=function(a){var b=a.content[0],c=a.content.pop();0<a.content.length&&(a.content[0]=c,g(a,0));return b};a.oT=function(a,c){var d=a.content.indexOf(c),e=a.content.pop();d!==a.content.length-1&&(a.content[d]=e,a.yl(e)<a.yl(c)?b(d):g(d))};a.rJ=function(a,c){b(a,a.content.indexOf(c))}};b4w.module.__navmesh=function(a,r){function d(a,c){function d(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var e=a.ek,f=c.ek,g=[],h=0;h<e.length;h++)0<=b(f,e[h])&&g.push(e[h]);if(2>g.length)return[];0<=b(g,e[0])&&0<=b(g,e[e.length-1])&&d(e);0<=b(g,f[0])&&0<=b(g,f[f.length-1])&&d(f);g=[];for(h=0;h<e.length;h++)0<=b(f,e[h])&&g.push(e[h]);return g}function c(a){function b(a){for(var c=a.Pf,d=0;d<c.length;d++){var e=c[d];void 0==e.island&&(e.island=a.island,b(e))}}a=a.kP;for(var c=[],d=0,e=0;e<a.length;e++){var f=
a[e];void 0==f.island&&(f.island=d++,b(f));c[f.island]||(c[f.island]=[]);c[f.island].push(a[e])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function g(a){function b(a,b){for(var c=0;c<a.length;c++)if(b===a[c])return c}for(var e={},f=a.Dn,g=0;g<f.length;g++)f[g][0]=parseFloat(f[g][0].toFixed(2)),f[g][1]=parseFloat(f[g][1].toFixed(2)),f[g][2]=parseFloat(f[g][2].toFixed(2));e.Dn=a.Dn;a=c(a);e.Ww=[];for(g=0;g<a.length;g++){for(var f=
[],h=a[g],l=0;l<h.length;l++){for(var k=[],m=h[l],n=0;n<m.Pf.length;n++)k.push(b(h,m.Pf[n]));for(var p=[],n=0;n<m.Pf.length;n++)p.push(d(m,m.Pf[n]));m.Oc[0]=parseFloat(m.Oc[0].toFixed(2));m.Oc[1]=parseFloat(m.Oc[1].toFixed(2));m.Oc[2]=parseFloat(m.Oc[2].toFixed(2));f.push({id:b(h,m),Pf:k,ek:m.ek,Oc:m.Oc,Hc:m.Hc,lP:p,kw:0,gp:0,Ab:0,uK:1,jz:!1,closed:!1,parent:null})}e.Ww.push(f)}return e}function n(a,b,c,d,e){function f(a,b){E.subtract(a,b,A);return E.dot(A,A)}function g(a,b){for(var c=[],d=0;d<b.Pf.length;d++)c.push(a[b.Pf[d]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.kw=0;c.gp=0;c.Ab=0;c.uK=1;c.jz=!1;c.closed=!1;c.parent=null}})(a);var h=F.pJ(function(a){return a.kw});for(F.vA(h,b);0<h.content.length;){var l=F.qJ(h);if(l===c){a=l;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}l.closed=!0;for(var k=g(a,l),m=0,n=k.length;m<n;m++){var p=k[m];if(!p.closed){var q=l.gp+E.dist(p.Oc,l.Oc),t=p.jz;if(!t||q<p.gp)p.jz=!0,p.parent=l,p.Ab=p.Ab||f(p.Oc,e)+f(p.Oc,d),p.gp=q,p.kw=p.gp+p.Ab,t?F.rJ(h,
p):F.vA(h,p)}}}return[]}function x(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function e(a,b,c,d){b=E.subtract(b,a,A);a=E.subtract(c,a,I);a=E.cross(b,a,A);return q.sign(E.dot(d,a))}function u(a,b){E.subtract(a,b,A);return 1E-5>E.dot(A,A)}function w(a,b,c){var d=E.subtract(b.right,b.left,A),e=c.Hc,f=b.Hc;c=Math.acos(E.dot(e,f));e=q.sign(E.dot(d,E.cross(e,f,I)));c*=-e;e=t.identity(p);t.translate(e,b.left,e);t.rotate(e,c,d,e);t.translate(e,E.scale(b.left,-1,I),e);t.multiply(a,e,a)}function h(a,b,c,
d,e,f,g,h,k){for(var m=t.identity(z),n=e;n<c;n++)if(a[n].HC&&(n>e||!n)){var p,q=b,u=d;p=a[n].left;var y=a[n].right,L=f,D=m,r=E.create(),B=E.transformMat4(p,D,C);B[3]=1;D=E.transformMat4(y,D,A);D=E.subtract(D,B,v);q=E.subtract(u,q,A);L=E.cross(L,q,l);.01>Math.abs(E.dot(L,D))?u=.5:(E.normalize(L,L),L[3]=-E.dot(L,u),u=-J.dot(L,B)/J.dot(L,D));y=E.subtract(y,p,A);p=E.scaleAndAdd(p,y,u,r);x(g,p);h&&x(k,a[n].Hc);n&&w(m,a[n],a[n-1])}}function m(a,b){function c(b,c){z=v=q=c;k=l=g=b;E.copy(b,m);E.copy(b,n);
E.copy(a[q].Hc,p)}var d=[],f=[],g,l,k,m,n,p,q=0,v=0,z=0;g=a[0].right;l=a[0].left;k=a[0].right;m=E.copy(l,Q);n=E.copy(k,y);p=E.copy(a[0].Hc,G);x(d,g);b&&x(f,a[0].Hc);for(var D=t.identity(H),r=1;r<a.length;r++){var B=a[r].left,C=a[r].right,A=E.transformMat4(B,D,Z),F=E.transformMat4(C,D,S);a[r].HC&&w(D,a[r],a[r-1]);if(0>=e(g,n,F,p)){var I=u(g,k);if(I||0<e(g,m,F,p))k=C,E.copy(F,n),z=r;else{(B=u(m,g))||h(a,m,v,g,q,p,d,b,f);D=t.identity(D);c(l,v);r=q;B||(x(d,g),b&&x(f,a[r].Hc));continue}}0<=e(g,m,A,p)&&
((I=u(g,l))||0>e(g,n,A,p)?(l=B,E.copy(A,m),v=r):((B=u(n,g))||h(a,n,z,g,q,p,d,b,f),D=t.identity(D),c(k,z),r=q,B||(x(d,g),b&&x(f,a[r].Hc))))}D=a.length-1;r=a[D].left;(B=u(g,r))||h(a,m,D,g,q,p,d,b,f);B&&q||x(d,r);return b?(x(f,a[D].Hc),{positions:new Float32Array(d),normals:new Float32Array(f)}):{positions:new Float32Array(d),normals:null}}function B(a,b,c,d,e){for(var f=null,g=Number.MAX_VALUE,h=0;h<a.length;h++){var l=a[h],k=e(c,l.Oc,l.ek,b,g);k<g&&(f=l,g=k)}return 0<d&&g>d?null:f}function k(a,b,c,
d,e){a.push({left:b,right:c,HC:d,Hc:e})}var f=r("__geometry"),F=r("__math"),t=r("__mat4"),q=r("__util"),E=r("__vec3"),J=r("__vec4"),A=E.create(),I=E.create(),C=J.create(),v=J.create(),l=J.create(),z=t.create(),H=t.create(),p=t.create(),Q=E.create(),y=E.create(),Z=E.create(),S=E.create(),G=E.create();a.PO=function(a){var b=f.ms(a.Kb,f.Yl),c=a.zd;a=[];for(var d=0;d<c.length;d+=3)a.push({ma:new Uint32Array([c[d],c[d+1],c[d+2]]),Oc:new Float32Array(3),Hc:new Float32Array(3)});c=[];for(d=0;d<b.length;d+=
3){var e=new Float32Array(3);e[0]=b[d];e[1]=b[d+1];e[2]=b[d+2];c.push(e)}for(b=0;b<a.length;b++)d=a[b],E.add(c[d.ma[0]],c[d.ma[1]],A),E.add(A,c[d.ma[2]],A),E.scale(A,1/3,d.Oc);for(b=0;b<a.length;b++){var d=a[b],e=E.subtract(c[d.ma[1]],c[d.ma[0]],A),h=E.subtract(c[d.ma[2]],c[d.ma[0]],I),e=E.cross(e,h,A);E.normalize(e,e);E.copy(e,d.Hc)}for(var l={},b=[],d=[],k,m,n=Math.pow(10,4),e=0,h=c.length;e<h;e++)k=c[e],m=Math.round(k[0]*n)+"_"+Math.round(k[1]*n)+"_"+Math.round(k[2]*n),void 0===l[m]?(l[m]=e,b.push(k),
d[e]=b.length-1):d[e]=d[l[m]];l=[];e=0;for(h=a.length;e<h;e++)for(k=a[e],k.ma[0]=d[k.ma[0]],k.ma[1]=d[k.ma[1]],k.ma[2]=d[k.ma[2]],k=[k.ma[0],k.ma[1],k.ma[2]],m=0;3>m;m++)if(k[m]==k[(m+1)%3]){l.push(e);break}for(e=l.length-1;0<=e;e--)a.splice(l[e],1);for(e=c.length=0;e<b.length;e++)c.push(b[e]);d=[];for(b=e=0;b<a.length;b++)h=a[b],d.push({id:e++,ek:h.ma,Oc:h.Oc,Hc:h.Hc,Pf:[]});a={kP:d,Dn:c};c={};for(b=0;b<d.length;b++)for(e=0;3>e;e++)h=d[b].ek[e],l=d[b].ek[(e+1)%3],h=h>l?l+"-"+h:h+"-"+l,h in c||(c[h]=
[]),c[h].push(d[b]);d=Object.keys(c);b=0;for(l=d.length;b<l;b++)for(h=d[b],e=0;e<c[h].length;e++)for(k=e+1;k<c[h].length;k++)c[h][e].Pf.push(c[h][k]),c[h][k].Pf.push(c[h][e]);return g(a)};a.navmesh_get_island=function(a,b,c){for(var d=null,e=Number.MAX_VALUE,f=a.Ww,g=0;g<f.length;g++)for(var h=0;h<f[g].length;h++){var l=f[g][h];E.subtract(l.Oc,b,A);l=c(b,l.Oc,l.ek,a.Dn,e);l<e&&(d=g,e=l)}return d};a.UN=function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(c[b[e]]);b=!1;c=-1;for(var e=d.length,f=e-
1;++c<e;f=c)(d[c][1]<=a[1]&&a[1]<d[f][1]||d[f][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[f][0]-d[c][0])*(a[1]-d[c][1])/(d[f][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};a.navmesh_find_path=function(a,b,c,d){var e;e=a.Ww[d.island];var f=a.Dn,g=B(e,f,b,d.allowed_distance,d.distance_to_closest);e=g?(f=B(e,f,c,d.allowed_distance,d.distance_to_farthest))?n(e,g,f,b,c):null:null;if(e&&e.length)if(d.do_not_pull_string)if(c=e,d.return_normals){b=new Float32Array(3*c.length);for(e=0;e<c.length;e++)b.set(c[e].Oc,3*e);
c={positions:b,normals:null}}else{b=new Float32Array(3*c.length);a=new Float32Array(3*c.length);for(e=0;e<c.length;e++)b.set(c[e].Oc,3*e),a.set(c[e].Hc,3*e);c={positions:b,normals:a}}else{a=a.Dn;d=d.return_normals;g=[];k(g,b,b,!1,e[0]&&e[0].Hc||q.AXIS_Z);for(b=0;b<e.length;b++){var h=e[b];if(f=e[b+1]){var l=.999>Math.abs(E.dot(h.Hc,f.Hc));a:{for(var p=0;p<h.Pf.length;p++)if(h.Pf[p]===f.id){h=h.lP[p];break a}h=void 0}k(g,a[h[0]],a[h[1]],l,f.Hc)}}k(g,c,c,!1,g[g.length-1].Hc);c=m(g,d)}else c=null;return c}};b4w.module.__nla=function(a,r){function d(){return{type:"CLIP",sa:0,Za:0,zi:!1,paused:!1,yf:"",Wn:"",qc:0,Nm:null,Wi:0,jk:0,FB:0,EB:0,LF:!1,scale:1,repeat:1,Yz:0}}function c(a,b,d){if(a.animation_data){var e=a.animation_data.nla_tracks;if(e)for(var f=0;f<e.length;f++)e[f].Nm=d,b.push(e[f])}a=a.nodes;for(f=0;f<a.length;f++)if(e=a[f],e.node_group){var g=e.node_group.node_tree;if(g){var h=d.slice();h.push(e.name);c(g,b,h)}}}function b(a,b){var c=Math.round(a)-b.sa;b.Oi&&(c%=b.jj,0>c&&(c+=b.jj));return b.Mb+
c}function g(a,b){var c=(b-A)*q.ad()+a.Mb;c>a.sa?(c-=a.sa,a.cyclic&&(c%=a.Za-a.sa+1),c+=a.sa):c=a.sa;return c}function n(a,b){a=E.clamp(a,b.sa,b.Za);var c=a==b.Za?b.Yz:b.Wi+(a-b.sa)/b.scale%(b.jk-b.Wi);b.LF&&(c=b.jk-c+b.Wi);return c}function x(a,b){for(var c=[],e=0;e<a.length;e++){var f=a[e],g=f.strips;if(g)for(var h=0;h<g.length;h++){var k=g[h],m=d();m.type=k.type;m.sa=k.frame_start;m.Za=k.frame_end;m.qc=b;m.Wi=k.action_frame_start;m.jk=k.action_frame_end;m.LF=k.use_reverse;m.scale=k.scale;m.repeat=
k.repeat;k.action&&(m.yf=k.action.name,m.Wn=k.action.uuid,m.Nm=f.Nm);c.push(m)}}return c}function e(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function u(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function w(a,b){var c=f.get_active();if(c.na){var d=g(c.na,b);c.na.Mb-=d-a;c.na.tm=!0}}var h=r("__animation"),m=r("__objects"),B=r("__obj_util"),k=r("__print"),f=r("__scenes"),F=r("__sfx"),t=r("__textures"),q=r("__time"),E=r("__util"),J=[],A=-1;a.bk=function(a,b){var f,g=null;for(f=b.K.length-1;0<=f;f--){var k=b.K[f];if(k.pb.b4w_use_nla&&(g=k,k.pb.Uz))break}if(f=g){f.tD=!0;var m=0;if((g=a.animation_data)&&g.nla_tracks.length){var n=g.nla_tracks;if(B.is_armature(b)||B.is_camera(b)||B.is_mesh(b)||B.is_empty(b)||
B.is_lamp(b)||B.is_speaker(b)||B.is_world(b))n=x(n,m),n.length&&(b.Qf=b.Qf.concat(n),m++)}e(a)&&(n=a.data.animation_data.nla_tracks,n=x(n,m),n.length&&(b.Qf=b.Qf.concat(n),m++));if(B.is_mesh(b))for(k=a.data.materials,g=0;g<k.length;g++){var q=k[g];if(q.use_nodes&&q.node_tree&&(n=[],c(q.node_tree,n,[q.name]),n=x(n,m),n.length)){for(var q=m,t=n,u=h.PM(),w=[],r=0,D=0;D<t.length;D++){var A=t[D];""!=A.Wn?A=E.keysearch("uuid",A.Wn,u):(A=A.yf,A=E.keysearch("name",A,u)||E.keysearch("name",A+"_B4W_BAKED",
u));if(A){var A=A.fcurves,C=[],L;for(L in A)C.push(L);w.push(C)}}for(D=0;D<w.length;D++){u=!1;for(A=0;A<D;A++)if(E.cJ(w[D],w[A])){t[D].qc=t[A].qc;u=!0;break}u||(t[D].qc=m+r++)}m=q+r;b.Qf=b.Qf.concat(n)}}if(!B.is_world(b)){for(g=0;g<a.particle_systems.length;g++)k=a.particle_systems[g],L=k.settings,"EMITTER"==L.type&&L.b4w_allow_nla&&(L=d(),L.type="CLIP",L.sa=f.pb.frame_start,L.Za=f.pb.frame_end+1,L.yf=k.name,L.qc=m,L.Wi=L.sa,L.jk=L.Za,b.Qf.push(L),m++);f=m+1;for(g=0;g<b.Kc.length;g++)k=b.Kc[g],k.zI&&
(m=f,L=d(),L.type="CLIP",L.sa=k.sa,L.Za=k.Za,L.yf=k.name,L.qc=m,L.Wi=L.sa,L.jk=L.Za,b.Qf.push(L))}}};a.TR=function(a,b,c){a.na||(a.na={sa:a.frame_start,Za:a.frame_end,Mb:0,yp:-1,Rp:a.frame_end,Sp:a.frame_start,Kl:null,cyclic:b,$a:[],Sa:[],cE:a.name,yj:!1,tm:!1,by:!0},J.push(a.na));b=a.na;for(var e=m.kC(a,"ALL",c),f=0;f<e.length;f++){var g=e[f];if(g.Qf.length){b.$a[c]||(b.$a[c]=[]);for(var h=0;h<g.K.length;h++){var n=g.K[h];n.pb==a&&n.tD&&b.$a[c].push(g)}for(var h=g.Qf,n=b,q=g.name,t=0;t<h.length;t++){var v=
h[t];n.sa>v.Za||n.Za<v.sa?(k.warn("NLA: Strip is out of scene range: "+(q+" ["+v.sa+":"+v.Za+"]")),h.splice(t,1),t--):v.yf||"CLIP"!=v.type||(k.warn('NLA: no action in strip for object "'+q+'".'),h.splice(t,1),t--)}g=g.Qf;h=b;for(n=0;n<g.length;n++){for(var q=g[n],t=h.sa,v=h.Za+1,u=0;u<g.length;u++){var w=g[u];q.qc==w.qc&&(w.Za<=q.sa&&(t=q.sa),w.sa>=q.Za&&(v=Math.min(v,w.sa)))}q.FB=t;q.EB=v;q.Yz=q.repeat%1?q.Wi+q.repeat%1*(q.jk-q.Wi):q.jk}}}a=a.F.En;for(f=0;f<a.length;f++)e=a[f].F,e.ck&&(e.Ta||e.ed)&&
e.Iq==c&&(g=d(),g.type="VIDEO",e.Oi?(g.sa=0,g.Za=b.Za):(g.sa=E.clamp(e.sa,0,b.Za),g.Za=E.clamp(e.sa+e.jj,0,b.Za)),g.yf=a[f].name,b.Sa.push(e))};a.start=function(){A=0};a.tN=function(){return A};a.dU=function(a){return a.na?a.na.Mb:null};a.QU=function(a,b){return a.na?(a.na.Mb=b,!0):!1};a.update=function(a,c){if(!(0>A)){0==A&&(A=a);for(var d=0;d<J.length;d++){var e=J[d];e.yj&&(e.Mb-=q.ad()*c);var f=g(e,a);if((!e.yj||e.tm)&&f>=e.Rp)if(e.cyclic){var f=e,k=a;f.Kl&&f.Kl();w(f.Sp,k);f.by=!0;f=g(f,k)}else{var k=
e,m=f;k.yj=!0;k.Mb-=m-k.Rp;k.Kl&&k.Kl()}if(!e.yj||e.tm){for(var k=e,m=f,u=0;u<k.$a.length;u++){var x=k.$a[u];if(x)for(var r=0;r<x.length;r++){for(var B=x[r],C=B.Qf,D=0;D<C.length;D++){var I=C[D];"SOUND"==I.type&&m<k.yp-1E-6&&(I.zi=!1)}for(D=0;D<C.length;D++)switch(I=C[D],I.type){case "CLIP":if(I.FB<=m&&m<I.EB&&!I.zi){var u=B,V=I,L=V.Nm;""!=V.Wn?h.YI(u,L,V.Wn,V.qc):h.apply(u,L,V.yf,V.qc);h.set_behavior(u,h.AB_FINISH_STOP,V.qc);L=n(V.sa,V);h.set_frame(u,L,V.qc);for(u=0;u<C.length;u++)C[u]!=I&&C[u].qc==
I.qc&&(C[u].zi=!1);I.zi=!0}I.zi&&(V=B,L=n(m,I),1E-6<Math.abs(L-h.rw(V,I.qc))&&h.set_frame(V,L,I.qc));break;case "SOUND":if((m<k.yp-1E-6||k.yp<I.sa)&&I.sa<=m&&m<I.Za&&!I.zi){var V=B,ba=I,L=(ba.sa-m)/q.ad(),ba=(ba.Za-ba.sa)/q.ad();F.play(V,L,ba);I.zi=!0}k.yp<I.Za&&I.Za<=m&&I.zi&&(I.zi=!1)}}}k=a;m=e;x=f;for(r=0;r<m.Sa.length;r++)if(B=m.Sa[r],B.Ta||B.ed){C=t.VF(B);D=B;I=E.clamp(b(x,D),D.Mb,D.Mb+t.WF(D)-1);D.ed&&(I=t.pS(D,I),I==D.aq&&I--);D=I;I=t.XF(B);V=u=!1;if(m.tm||m.by)V=!0;m.yj||(L=b(x,B),L=B.Mb<=
L&&L<=B.Mb+t.WF(B),ba=t.YF(B),B.Oi&&D==I&&(V=!0),ba||C==D||(V=!0),L&&!ba?t.play_video(B):L&&ba?u=!0:!L&&ba&&(B.Ta&&C<D?u=!0:t.pause_video(B)));V?(t.hQ(B,D),B.ed&&(B.Rj=t.It(B,k))):u&&t.ZF(B)&&(B.Ta?t.DF(B):(C=t.It(B,k),C!=B.Rj&&(B.Bi=D,t.CF(B)),B.Rj=C))}e.yp=f}e.tm=!1;e.by=!1}}};a.cleanup=function(a){if(0==a)J.length=0,A=-1;else for(var b=0;b<J.length;b++)J[b].$a[a]=null};a.BA=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||e(a)||u(a)?!0:!1};a.set_frame=w;a.get_frame=function(a){var b=
f.get_active();return b.na?g(b.na,a):-1};a.Ay=function(){var a=f.get_active();if(a.na){a.na.yj=!0;for(var a=a.na.Sa,b=0;b<a.length;b++)t.pause_video(a[b])}};a.FD=function(a){var b=f.get_active();b.na&&(b.na.yj=!1,a?b.na.Kl=a:b.na.Kl=null)};a.get_frame_start=function(){var a=f.get_active();return a.na?a.na.sa:-1};a.get_frame_end=function(){var a=f.get_active();return a.na?a.na.Za:-1};a.is_play=function(){var a=f.get_active();return a.na?!a.na.yj:!1};a.check_nla=function(){var a=f.get_active();return a.na?
a.b4w_use_nla:!1};a.check_logic_nodes=function(){var a=f.get_active();return a.na?0<a.b4w_logic_nodes.length:!1};a.set_range=function(a,b){var c=f.get_active();if(c.na)c.na.Sp=a,c.na.Rp=b;else return!1};a.ly=function(a){var b=f.get_active();b.na&&(b.na.Rp=a)};a.vQ=function(a){var b=f.get_active();b.na&&(b.na.Sp=a)};a.reset_range=function(){var a=f.get_active();if(a.na)a=a.na,a.Sp=a.sa,a.Rp=a.Za;else return!1};a.set_cyclic=function(a){var b=f.get_active();if(b.na)b.na.cyclic=a;else return!1};a.clear_callback=
function(){var a=f.get_active();a.na&&(a.na.Kl=null)};a.pE=function(a){var b=f.get_active().na;b&&(b.Mb=-(a-A)*q.ad()+b.Sp,b.tm=!0)};a.get_frame_end=function(){var a=f.get_active().na;return a?a.Za:null}};b4w.module.__camera=function(a,r){function d(a,b,c,d,e){Ia.set_translation(a,b);c&&J(a,b,c);v(a,d);l(a,e)}function c(a,b,c,d,e,f,g,h){var k=a.o;Ia.set_translation(a,b);k.pivot.set(c);J(a,b,c);v(a,d);l(a,e);Q(a,f);y(a,g);k.use_panning=h}function b(a,b,c,d,e,f,g,h){var l=a.o;Ia.set_translation(a,b);l.fc.set(c);J(a,b,c);p(a,d);z(a,e);Z(a,f);S(a,g);l.kh=h}function g(a,b,c){var d=a.o,e=xa.get_trans_view(d.v),f=xa.get_quat_view(d.v),d=Ea;d.set(oa.AXIS_Z);d[3]=0;a=B(a,T)[1];f=oa.quat_to_dir(f,oa.AXIS_MZ,
Ca);wa.set_pline_initial_point(Fa,e);wa.set_pline_directional_vec(Fa,f);if(!oa.line_plane_intersect(d,-b,Fa,c)||Math.abs(a)<Aa)ta.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),c[0]=e[0],c[1]=0,c[2]=e[2];return c}function n(b){for(var c=b.o,d=0;d<b.K.length;d++){var e=b.K[d].ea[0];if(e.type==a.Jd)switch(c.kb){case a.MS_TARGET_CONTROLS:var f=xa.get_trans_view(c.v);c.sj=K.dist(f,c.pivot);c.tj=e.nc;break;
case a.MS_HOVER_CONTROLS:f=xa.get_trans_view(c.v),c.sj=K.dist(f,c.fc),c.tj=e.nc}}}function x(a){a={type:a,name:"",BE:1,width:0,height:0,ee:null,fp:null,lc:null,we:null,fb:0,nc:0,qm:"VERTICAL",near:0,far:0,left:0,right:0,top:0,bottom:0,Rc:ia.create(),v:new Float32Array(9),Hb:new Float32Array(16),ru:new Float32Array(16),lb:new Float32Array(16),Tc:new Float32Array(16),qu:new Float32Array(16),Qx:new Float32Array(16),Wf:new Float32Array(16),direction:new Float32Array(3),Me:xa.Ek(),su:xa.Ek(),Up:xa.Ek(),
Et:xa.Ek(),fq:xa.Ek(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,dof_bokeh:!1,gd:!1,dof_on:!1,Rs:new Float32Array(3),mh:u(),Vj:0,He:0,hc:null,gh:null,Oo:null,Er:new Float32Array(4),Sm:new Float32Array(4)};a.Rc[0]=a.Rc[2]=0;a.Rc[1]=a.Rc[3]=0;return a}function e(a,b){var c=x(a.type);c.name=a.name;c.BE=a.BE;c.width=a.width;c.height=a.height;b||(c.ee=a.ee,c.fp=a.fp,c.lc=a.lc,c.we=a.we);c.fb=a.fb;c.qm=a.qm;c.nc=a.nc;
c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;ia.copy(a.Rc,c.Rc);xa.copy(a.v,c.v);va.copy(a.Hb,c.Hb);va.copy(a.lb,c.lb);va.copy(a.Tc,c.Tc);va.copy(a.qu,c.qu);va.copy(a.Qx,c.Qx);va.copy(a.Wf,c.Wf);xa.copy(a.Me,c.Me);xa.copy(a.su,c.su);xa.copy(a.Up,c.Up);xa.copy(a.Et,c.Et);xa.copy(a.fq,c.fq);c.dof_distance=a.dof_distance;c.dof_front_start=a.dof_front_start;c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=
a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.dof_bokeh=a.dof_bokeh;c.gd=a.gd;c.dof_on=a.dof_on;K.copy(a.Rs,c.Rs);var d=a.mh,e=c.mh;ia.copy(d.left,e.left);ia.copy(d.right,e.right);ia.copy(d.top,e.top);ia.copy(d.bottom,e.bottom);ia.copy(d.near,e.near);ia.copy(d.far,e.far);c.Vj=a.Vj;c.He=a.He;a.hc&&(c.hc=ia.clone(a.hc));if(a.gh){d=a.gh.length;c.gh=Array(d);for(e=0;e<d;e++)c.gh[e]=K.clone(a.gh[e]);c.Oo=new Float32Array(a.Oo)}ia.copy(a.Er,c.Er);ia.copy(a.Sm,c.Sm);
return c}function u(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function w(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:oa.D("Unknown move style")}}function h(b){var c=x(b);if(b==a.Yc)return c;switch(b){case a.Zc:F(c,
Sa,.1,1E3);break;case a.Jd:F(c,2.5,.1,1E3);break;case a.vf:break;case a.hg:break;case a.Qh:break;case a.pc:case a.wc:case a.re:case a.Yd:oa.D("Stereo camera may only be created from perspective one");break;default:oa.D("Unknown camera type")}return c}function m(b,c,d){b.type!=a.pc&&b.type!=a.wc&&b.type!=a.re&&b.type!=a.Yd&&oa.D("set_stereo_params(): wrong camera type");if(b.type==a.pc||b.type==a.wc)b.Vj=c;b.He=d;Y(b,!1);if(ra.xa()&&(c=ra.get_active(),b=c.F.Jc))for(c=sa.oa(ra.mj(c),c).ea,d=0;d<c.length;d++)ca(c[d],
b)}function B(a,b){var c=xa.get_quat_view(a.o.v);return k(c,b)}function k(a,b){var c=oa.quat_to_dir(a,oa.AXIS_Z,Ca),d=oa.quat_to_dir(a,oa.AXIS_MY,Ga),e=-Math.asin(c[2]/K.length(c)),c=Math.abs(e)>Math.PI/4?K.scale(d,-oa.sign(e),N):K.scale(c,-oa.sign(d[2]),N),f=Math.atan(Math.abs(c[0]/c[1]));0<d[2]&&(e=oa.sign(e)*Math.PI-e);d=f;0<c[1]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function f(a){switch(a.qm){case "AUTO":return 1<a.fb?aa(a)?a.nc/a.fb:2*Math.atan(Math.tan(a.nc/2)/a.fb):
a.nc;case "HORIZONTAL":return aa(a)?a.nc/a.fb:2*Math.atan(Math.tan(a.nc/2)/a.fb);case "VERTICAL":return a.nc}}function F(b,c,d,e){switch(b.type){case a.Zc:case a.pc:case a.wc:b.nc=c;b.fb=1;break;case a.Jd:b.nc=c;b.fb=1;break;case a.re:case a.Yd:break;default:oa.D("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=e}function t(b,c){var d=xa.ec(c.o.v,Ca),e=xa.Qc(c.o.v,qa),f=va.fromRotationTranslation(e,d,Ka);va.invert(f,b.Hb);if(ra.xa())var f=ra.get_active(),g=ra.Aa(f,O.uf);if(b.type==
a.pc||g&&g.enable_hmd_stereo&&b.type==a.re)b.Hb[12]+=b.He/2;else if(b.type==a.wc||g&&g.enable_hmd_stereo&&b.type==a.Yd)b.Hb[12]-=b.He/2;if(b.hc){xa.from_mat4(b.Hb,b.Up);xa.invert(b.Up,b.Et);var f=b.hc[0],g=b.hc[1],h=b.hc[2],l=b.hc[3],k=b.ru;k[0]=1-2*f*f;k[1]=-2*f*g;k[2]=-2*f*h;k[3]=0;k[4]=-2*f*g;k[5]=1-2*g*g;k[6]=-2*g*h;k[7]=0;k[8]=-2*f*h;k[9]=-2*g*h;k[10]=1-2*h*h;k[11]=0;k[12]=-2*f*l;k[13]=-2*g*l;k[14]=-2*h*l;k[15]=1;va.multiply(b.Hb,b.ru,b.Hb);Y(b,!0);f=Ea;g=Ka;va.invert(b.Hb,g);va.transpose(g,
g);ia.transformMat4(b.hc,g,f);g=Ba;g[0]=(oa.sign(f[0])+b.lb[8])/b.lb[0];g[1]=(oa.sign(f[1])+b.lb[9])/b.lb[5];g[2]=-1;g[3]=(1+b.lb[10])/b.lb[14];ia.scale(f,2/(f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.lb[2]=f[0];b.lb[6]=f[1];b.lb[10]=f[2]+1;b.lb[14]=f[3];K.transformMat4(d,b.ru,d)}xa.from_mat4(b.Hb,b.Me);xa.invert(b.Me,b.su);U(b);ha(b);xa.set_sep(d,1,e,b.v)}function q(b,c,d,e){va.lookAt(c,d,e,b.Hb);d=ra.get_active();d=ra.Aa(d,O.uf);if(b.type==a.pc||d&&d.enable_hmd_stereo&&b.type==a.re)b.Hb[12]+=
b.He/2;else if(b.type==a.wc||d&&d.enable_hmd_stereo&&b.type==a.Yd)b.Hb[12]-=b.He/2;xa.from_mat4(b.Hb,b.Me);U(b);ha(b);xa.set_trans(c,b.v)}function E(a,b,c){c=K.subtract(c,b,Ca);K.length(c)&&(K.normalize(c,c),c=oa.hy(oa.AXIS_MZ,c,qa),Ia.set_rotation(a,c));Ia.set_translation(a,b)}function J(a,b,c){var d=a.o,e=C(a);E(a,b,c);e?(b=K.copy(d.sf,Ca),K.negate(b,b),ka.correct_up(a,b,!0)):ka.correct_up(a,d.sf,!0)}function A(a,b){for(var c=a.o,d=b.ea,e=xa.Qc(c.v,qa),e=oa.quat_to_dir(e,oa.AXIS_MZ,Ca),f=xa.ec(c.v,
Ga),g=b.zE,h=0;h<g.length;h++){var l=g[h];K.copy(e,l.direction);xa.ec(c.v,l.Rs)}for(h=0;h<d.length;h++)l=d[h],t(l,a),K.copy(e,l.direction),oa.om(l.Tc,l.mh),l.dof_object&&l.dof_on&&(c=Ia.get_translation(l.dof_object,N),c=K.dist(f,c),l.dof_distance=c)}function I(b){var c=b.o;c.kb==a.MS_TARGET_CONTROLS&&(c.Yj=C(b))}function C(a){a=xa.get_quat_view(a.o.v);return 0>oa.quat_to_dir(a,oa.AXIS_Y,Ca)[2]}function v(b,c){var d=b.o;if(c){d.Bb=d.Bb||{};d.Bb.left=c.left;d.Bb.right=c.right;d.Bb.Gm=c.left;d.Bb.Zm=
c.right;d.Bb.camera_space=!!c.camera_space;var e=b.o;!(d=e.Bb)||e.kb!=a.MS_EYE_CONTROLS&&e.kb!=a.MS_TARGET_CONTROLS||(e=B(b,T),d.camera_space?(d.left+=e[0],d.right+=e[0]):(d.Gm-=e[0],d.Zm-=e[0]),d.left=oa.angle_wrap_0_2pi(d.left),d.right=oa.angle_wrap_0_2pi(d.right),d.Gm=oa.angle_wrap_0_2pi(d.Gm),d.Zm=oa.angle_wrap_0_2pi(d.Zm))}else d.Bb=null}function l(a,b){var c=a.o;b?(c.Da=c.Da||{},c.Da.down=b.down,c.Da.up=b.up,c.Da.km=b.down,c.Da.vn=b.up,c.Da.camera_space=!!b.camera_space,H(a)):c.Da=null}function z(a,
b){var c=a.o;if(!b){var d=B(a,T);b={down:d[1],up:d[1]}}c.Da=c.Da||{};c.Da.down=b.down;c.Da.up=b.up;H(a);c.ub&&c.Da&&pa(a)}function H(b){var c=b.o,d=c.Da;if(d)switch(c.kb){case a.MS_EYE_CONTROLS:case a.MS_TARGET_CONTROLS:b=B(b,T);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.vn-=b[1],d.km-=b[1]);d.up=oa.angle_wrap_periodic(d.up,-Math.PI,Math.PI);d.down=oa.angle_wrap_periodic(d.down,-Math.PI,Math.PI);d.vn=oa.angle_wrap_periodic(d.vn,-Math.PI,Math.PI);d.km=oa.angle_wrap_periodic(d.km,-Math.PI,Math.PI);
break;case a.MS_HOVER_CONTROLS:d.up=oa.angle_wrap_periodic(d.up,-Math.PI,Math.PI),d.down=oa.angle_wrap_periodic(d.down,-Math.PI,Math.PI),d.up=oa.clamp(d.up,-Math.PI/2,0),d.down=oa.clamp(d.down,-Math.PI/2,0)}}function p(a,b){var c=a.o;if(!b){var d=Ia.Dp(a,c.fc);b={min:d,max:d}}c.ub=c.ub||{};c.ub.min=b.min;c.ub.max=b.max;c.ub&&c.Da&&pa(a)}function Q(a,b){var c=a.o;b?(c.ub=c.ub||{},c.ub.min=b.min,c.ub.max=b.max):c.ub=null}function y(a,b){var c=a.o;b?(c.Dd=c.Dd||{},c.Dd.min_z=b.min_z,c.Dd.max_z=b.max_z):
c.Dd=null}function Z(a,b){var c=a.o;b?(c.bd=c.bd||{},c.bd.min=b.min,c.bd.max=b.max):c.bd=null}function S(a,b){var c=a.o;b?(c.cd=c.cd||{},c.cd.min=b.min,c.cd.max=b.max):c.cd=null}function G(b){var c=b.o;if(sa.is_camera(b))for(var d=b.K,e=0;e<d.length;e++){var f=d[e].ea;if(f[0].type===a.Jd){switch(c.kb){case a.MS_TARGET_CONTROLS:var g=xa.get_trans_view(c.v),g=K.dist(g,c.pivot),g=g/c.sj*c.tj;break;case a.MS_HOVER_CONTROLS:g=xa.get_trans_view(c.v);g=K.distance(g,c.fc);g=g/c.sj*c.tj;break;default:g=f[0].nc}for(var h=
0;h<f.length;h++){var l=f[h];l.nc=g;Y(l,!1)}A(b,d[e])}}}function D(b){var c=b.o,d=c.kb;if(d===a.MS_TARGET_CONTROLS||d===a.MS_EYE_CONTROLS){if(c.Bb){var e=c.Bb.left,f=c.Bb.right,g=B(b,T);(g=d==a.MS_TARGET_CONTROLS?oa.xk(g[0],e,f):oa.xk(g[0],f,e))&&(d==a.MS_TARGET_CONTROLS?V(b,g,0):X(b,g,0))}c.Da&&(e=c.Da.down,f=c.Da.up,g=B(b,T),(g=d==a.MS_TARGET_CONTROLS?oa.xk(g[1],f,e):oa.xk(g[1],e,f))&&(d==a.MS_TARGET_CONTROLS?V(b,0,g):X(b,0,g)));if(d===a.MS_TARGET_CONTROLS&&c.ub){var g=b.o,e=xa.get_trans_view(g.v),
f=K.subtract(e,g.pivot,Ca),h=K.length(f);h>g.ub.max?(K.scale(f,g.ub.max/h,f),K.add(g.pivot,f,e)):h<g.ub.min&&(h=xa.get_quat_view(g.v),h=oa.quat_to_dir(h,oa.AXIS_MZ,Ga),K.scale(h,100*g.ub.min,h),K.add(f,h,f),K.scale(f,-g.ub.min/K.length(f),f),K.add(g.pivot,f,e))}}d===a.MS_TARGET_CONTROLS&&c.Dd&&(c=b.o,g=c.pivot[2],e=oa.clamp(c.pivot[2],c.Dd.min_z,c.Dd.max_z),e!=g&&(g=K.set(0,0,e-g,Ca),K.add(c.pivot,g,c.pivot),c=xa.get_trans_view(c.v),K.add(c,g,c)));d===a.MS_HOVER_CONTROLS&&(d=b.o,d.bd&&(g=oa.clamp(d.fc[0],
d.bd.min,d.bd.max)-d.fc[0],d.fc[0]+=g,c=xa.get_trans_view(d.v),c[0]+=g),d.cd&&(g=oa.clamp(d.fc[1],d.cd.min,d.cd.max)-d.fc[1],d.fc[1]+=g,c=xa.get_trans_view(d.v),c[1]+=g),d=b.o,c=B(b,T)[1],(d=oa.xk(c,d.Da.up,d.Da.down))&&L(b,0,d))}function X(a,b,c,d,e){var f=a.o,g=b,h=c;if(d||e)a=B(a,ua),d&&(g=b-a[0]),e&&(h=c-a[1]);if(g||h)b=ea.identity(qa),g&&(g=ea.setAxisAngle(f.sf,g,Ta),ea.multiply(b,g,b)),f=xa.get_quat_view(f.v),h&&(g=oa.quat_to_dir(f,oa.AXIS_X,Ca),h=ea.setAxisAngle(g,h,Ta),ea.normalize(h,h),ea.multiply(b,
h,b)),ea.multiply(b,f,f)}function V(a,b,c,d,e){var f=a.o,g=b,h=c;if(d||e){var l=B(a,ua);d&&(g=b-l[0]);e&&(h=c-l[1])}ba(a,a.o.pivot,g,h);a=B(a,ua);a=oa.angle_wrap_periodic(a[1],-Math.PI,Math.PI);f.Yj=Math.abs(a)>Math.PI/2}function L(a,b,c,d,e){var f=a.o,g=b,h=c;if(d||e){var l=B(a,ua);d&&(g=b-l[0]);e&&(h=c-l[1])}f.kh||(g=0);ba(a,f.fc,g,h);h&&pa(a)}function ba(a,b,c,d){var e=a.o;if(c||d){a=ea.identity(qa);c&&(c=ea.setAxisAngle(oa.AXIS_Z,c,Ta),ea.multiply(a,c,a));c=xa.get_quat_view(e.v);if(d){var f=oa.quat_to_dir(c,
oa.AXIS_X,Ca);d=ea.setAxisAngle(f,d,Ta);ea.normalize(d,d);ea.multiply(a,d,a)}d=xa.get_trans_view(e.v);oa.PP(d,b,a,d);ea.multiply(a,c,c)}}function pa(a){var b=a.o,c=B(a,T)[1],d=a.o;a=d.Da;d=d.ub;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=xa.get_trans_view(b.v);d=xa.get_quat_view(b.v);d=oa.quat_to_dir(d,oa.AXIS_MZ,Ca);K.normalize(d,d);K.scale(d,c,d);K.subtract(b.fc,d,a)}function Y(b,c){switch(b.type){case a.Zc:case a.vf:va.perspective(f(b),b.fb,b.near,b.far,
b.lb);break;case a.Jd:case a.hg:var d=f(b),e=d*b.fb;va.ortho(-e,e,-d,d,b.near,b.far,b.lb);break;case a.Qh:va.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.lb);break;case a.pc:case a.wc:var e=Math.tan(f(b)/2),d=b.near*e,g=b.fb*b.Vj*e;b.type==a.pc?(e=g-b.He/2,g+=b.He/2):(e=g+b.He/2,g-=b.He/2);e=-(b.near/b.Vj*e);g*=b.near/b.Vj;va.frustum(e,g,-d,d,b.near,b.far,b.lb);b.left=e;b.right=g;break;case a.re:case a.Yd:ra.xa()&&(d=ra.get_active(),(d=ra.Aa(d,O.uf))&&d.enable_hmd_stereo?(d=Math.tan(b.Rc[1]),
e=Math.tan(b.Rc[2]),g=Math.tan(b.Rc[3]),b.top=b.near*Math.tan(b.Rc[0]),b.right=b.near*d,b.bottom=-b.near*e,b.left=-b.near*g,va.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.lb)):(b.top=b.near*Math.tan(f(b)/2),b.bottom=-b.top,b.right=b.top*b.fb,b.left=-b.right,va.perspective(f(b),b.fb,b.near,b.far,b.lb)));break;case a.Yc:return;default:oa.D("Wrong camera type: "+b.type)}c||(U(b),ha(b))}function ha(a){va.copy(a.Hb,a.Wf);a.Wf[12]=0;a.Wf[13]=0;a.Wf[14]=0;a.Wf[15]=1;va.multiply(a.lb,a.Wf,a.Wf);
va.invert(a.Wf,a.Wf)}function U(a){va.copy(a.Hb,a.Tc);va.multiply(a.lb,a.Tc,a.Tc);va.invert(a.Tc,a.qu)}function ga(b,c,d,e,g){e||(e=new Float32Array(24));c||(c=b.near);d||(d=b.far);var h,l,k,m,n,N,p,q;switch(b.type){case a.Yc:oa.D("Extraction from NONE camera is not possible");break;case a.Zc:case a.vf:h=c*Math.tan(f(b)/2);m=-h;l=h*b.fb;k=-l;n=d/c*h;q=-n;N=n*b.fb;p=-N;break;case a.Jd:case a.hg:m=f(b);k=m*b.fb;h=n=m;l=N=k;m=q=-m;k=p=-k;break;case a.Qh:h=n=b.top;l=N=b.right;m=q=b.bottom;k=p=b.left;
break;case a.pc:case a.wc:n=c/b.near;h=c*Math.tan(f(b)/2);m=-h;l=b.right*n;k=b.left*n;p=d/c;n=h*p;q=-n;N=l*p;p*=k;break;case a.re:case a.Yd:n=c/b.near;h=b.top*n;m=b.bottom*n;l=b.right*n;k=b.left*n;p=d/c;n=h*p;q=m*p;N=l*p;p*=k;break;default:oa.D("Wrong camera type: "+b.type)}e[0]=k;e[1]=m;e[2]=-c;e[3]=l;e[4]=m;e[5]=-c;e[6]=l;e[7]=h;e[8]=-c;e[9]=k;e[10]=h;e[11]=-c;e[12]=p;e[13]=q;e[14]=-d;e[15]=p;e[16]=n;e[17]=-d;e[18]=N;e[19]=n;e[20]=-d;e[21]=N;e[22]=q;e[23]=-d;g&&(c=Ka,va.invert(b.Hb,c),oa.Um(e,c,
e,0));return e}function ca(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.gh){var d=b.csm_num;a.gh=Array(d);for(var e=0;e<d;e++)a.gh[e]=new Float32Array(3);a.Oo=new Float32Array(d)}for(d=0;d<c;d++){var e=d?M(b,a,d-1):a.near,f=M(b,a,d),e=ga(a,e,f,kb),e=ma.hN(e);a.gh[d].set(e.M);a.Oo[d]=e.Wa;a.Er[d]=K.length(e.M);a.Sm[d]=la(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.Sm[0]=b.first_cascade_blur_radius}function M(a,b,c){var d=a.csm_num,e=oa.clamp(a.csm_first_cascade_border,b.near,
b.far);a=oa.clamp(a.csm_last_cascade_border,b.near,b.far);return oa.clamp(la(e,a,d,c),b.near,b.far)}function la(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}function aa(b){switch(b.type){case a.Jd:case a.hg:case a.Qh:return!0;default:return!1}}function P(a,b){b||(b=new Float32Array(3));var c=xa.get_trans_view(a.o.v);K.copy(c,b);return b}var ma=r("__boundings"),W=r("__config"),ka=r("__constraints"),da=r("__container"),va=r("__mat4"),wa=r("__math"),
sa=r("__obj_util"),ta=r("__print"),ea=r("__quat"),ra=r("__scenes"),O=r("__subscene"),Ia=r("__transform"),xa=r("__tsr"),oa=r("__util"),K=r("__vec3"),ia=r("__vec4"),na=W.H;a.Yc=10;a.Zc=20;a.Jd=30;a.vf=40;a.hg=50;a.Qh=60;a.pc=70;a.wc=80;a.re=90;a.Yd=100;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var Sa=oa.deg_to_rad(40),Aa=oa.deg_to_rad(.5),T=new Float32Array(2),ua=new Float32Array(2),Ca=new Float32Array(3),Ga=new Float32Array(3),N=new Float32Array(3),qa=new Float32Array(4),
Ta=new Float32Array(4),Ea=new Float32Array(4),Ba=new Float32Array(4),Ka=new Float32Array(16),kb=new Float32Array(24),Fa=new Float32Array(6);a.LJ=function(f,l){var k=l.o,m=f.data;switch(m.type){case "PERSP":var N=h(a.Zc);N.qm=m.sensor_fit;var p=m.angle;if(na.xB){var q=m.clip_start,t=m.clip_end,v=65534/65535;.05<1-(-t*q/((t-q)*v-t)-q)/(t-q)&&(v=.95*t*(1-v)/v/.05,ta.warn('Changing the clip range of the camera "'+f.name+'" from ['+q+", "+t+"] to ["+v+", "+t+"] because of the 16bit depth buffer."),q=v)}else q=
m.clip_start;F(N,p,q,m.clip_end);break;case "ORTHO":N=h(a.Jd),N.qm=m.sensor_fit,F(N,m.ortho_scale/2,m.clip_start,m.clip_end)}N.name=l.name;p=l.K;p[0].ea.push(N);for(q=1;q<p.length;q++)t=e(N,!1),p[q].ea.push(t);k.kb=w(m.b4w_move_style);k.dof_distance=m.dof_distance;N=m.dof_object;k.dof_object=N?N.Ua:null;k.dof_front_start=m.b4w_dof_front_start;k.dof_front_end=m.b4w_dof_front_end;k.dof_rear_start=m.b4w_dof_rear_start;k.dof_rear_end=m.b4w_dof_rear_end;k.dof_power=m.b4w_dof_power;k.dof_bokeh=m.b4w_dof_bokeh;
k.dof_bokeh_intensity=m.b4w_dof_bokeh_intensity;k.gd=m.b4w_dof_foreground_blur;k.An=m.b4w_trans_velocity;k.zn=m.b4w_rot_velocity;k.Bn=m.b4w_zoom_velocity;N=l.o.kb;p=f.data;q=null;N!=a.MS_TARGET_CONTROLS&&N!=a.MS_EYE_CONTROLS||!p.b4w_use_horizontal_clamping||(q={left:p.b4w_rotation_left_limit,right:p.b4w_rotation_right_limit,camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},N==a.MS_EYE_CONTROLS&&(q.left*=-1,q.right*=-1));N=q;p=l.o.kb;q=f.data;t=null;p!=a.MS_TARGET_CONTROLS&&p!=a.MS_EYE_CONTROLS||
!q.b4w_use_vertical_clamping?p==a.MS_HOVER_CONTROLS&&q.b4w_use_zooming&&(q.b4w_hover_angle_min<=q.b4w_hover_angle_max?(t={down:q.b4w_hover_angle_min,up:q.b4w_hover_angle_max},t.down*=-1,t.up*=-1):ta.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(t={down:q.b4w_rotation_down_limit,up:q.b4w_rotation_up_limit,camera_space:"LOCAL"==q.b4w_vertical_clamping_type},p==a.MS_TARGET_CONTROLS&&(t.down*=-1,t.up*=-1));p=t;q=l.o.kb;t=f.data;v=null;q==a.MS_TARGET_CONTROLS&&t.b4w_use_target_distance_limits&&
t.b4w_distance_min<=t.b4w_distance_max?v={min:t.b4w_distance_min,max:t.b4w_distance_max}:q===a.MS_HOVER_CONTROLS&&t.b4w_use_zooming&&(t.b4w_distance_min<=t.b4w_distance_max?v={min:t.b4w_distance_min,max:t.b4w_distance_max}:ta.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));q=v;t=f.data;v=null;l.o.kb==a.MS_HOVER_CONTROLS&&t.b4w_use_horizontal_clamping&&t.b4w_horizontal_translation_min<=t.b4w_horizontal_translation_max&&(v={min:t.b4w_horizontal_translation_min,max:t.b4w_horizontal_translation_max});
var t=v,v=f.data,u=null;l.o.kb==a.MS_HOVER_CONTROLS&&v.b4w_use_vertical_clamping&&v.b4w_vertical_translation_min<=v.b4w_vertical_translation_max&&(u={min:v.b4w_vertical_translation_min,max:v.b4w_vertical_translation_max});var v=u,u=f.data,qa=null;l.o.kb==a.MS_TARGET_CONTROLS&&u.b4w_use_pivot_limits&&(qa={min_z:u.b4w_pivot_z_min,max_z:u.b4w_pivot_z_max});u=qa;switch(k.kb){case a.MS_EYE_CONTROLS:k=xa.get_trans_view(l.o.v);d(l,k,null,N,p);break;case a.MS_TARGET_CONTROLS:k=xa.get_trans_view(l.o.v);c(l,
k,m.b4w_target,N,p,q,u,m.b4w_use_panning);break;case a.MS_HOVER_CONTROLS:k=xa.get_trans_view(l.o.v),N=g(l,f.data.b4w_hover_zero_level,Ga),b(l,k,N,q,p,t,v,m.b4w_enable_hover_hor_rotation)}D(l);n(l)};a.tE=d;a.vE=c;a.uE=b;a.Am=n;a.xc=e;a.GK=u;a.HU=w;a.Pc=h;a.pT=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return!!a.lc;case "DEPTH":return!!a.we;case "SCREEN":return!a.lc&&!a.we;default:oa.D("Wrong attachment type: "+b)}};a.Jt=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.lc=c;break;case "DEPTH":a.we=
c;break;case "SCREEN":a.lc=null;a.we=null;break;default:oa.D("Wrong attachment type: "+b)}};a.YT=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.lc;case "DEPTH":return a.we;case "SCREEN":return null;default:oa.D("Wrong attachment type: "+b)}};a.Us=function(b,c){(b.type!=a.Zc||c!=a.pc&&c!=a.wc&&c!=a.re&&c!=a.Yd)&&oa.D("make_stereo(): wrong camera type");b.type=c;m(b,6,.065)};a.xQ=m;a.get_camera_angles=B;a.qw=k;a.get_camera_angles_char=function(a,b){B(a,b);b[0]=oa.angle_wrap_0_2pi(b[0]+
Math.PI);b[1]*=-1;return b};a.set_fov=function(b,c){switch(b.type){case a.Zc:case a.vf:case a.pc:case a.wc:b.nc=c}};a.get_fov=function(b){switch(b.type){case a.Zc:case a.vf:case a.pc:case a.wc:return b.nc;default:return 0}};a.vN=f;a.jE=F;a.kE=function(b,c,d,e,f){switch(b.type){case a.Zc:case a.pc:case a.wc:case a.Jd:b.nc=d;b.fb=1;break;case a.vf:case a.hg:b.nc=d;b.fb=c/d;break;case a.re:case a.Yd:break;default:oa.D("set_frustum2(): Unsupported camera type: "+b.type)}b.near=e;b.far=f};a.jQ=function(b,
c,d,e,f,g,h){switch(b.type){case a.Qh:b.left=c;b.right=d;b.bottom=e;b.top=f;b.near=g;b.far=h;break;default:oa.D("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.o.kb};a.DQ=t;a.TU=q;a.ny=function(a,b,c){var d=Ca;d[0]=0;d[1]=0;d[2]=-1;K.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=Ga;e[0]=0;e[1]=1;e[2]=0;K.transformQuat(e,c,e);q(a,b,d,e)};a.oE=E;a.rQ=J;a.HR=A;a.GR=function(b){var c=b.o;D(b);G(b);switch(c.kb){case a.MS_TARGET_CONTROLS:var d=
xa.get_trans_view(c.v),e=xa.get_quat_view(c.v);ka.QP(d,e,c.pivot);for(e=0;e<b.K.length;e++)for(var f=b.K[e].ea,g=0;g<f.length;g++){var h=f[g];h.type!=a.pc&&h.type!=a.wc||m(h,K.dist(d,c.pivot),h.He)}ka.correct_up(b,c.sf);break;case a.MS_EYE_CONTROLS:b.cc||ka.correct_up(b,c.sf)}I(b)};a.az=I;a.mE=v;a.rE=l;a.hover_set_vertical_limits=z;a.hover_set_distance_limits=p;a.fQ=Q;a.uQ=y;a.lQ=Z;a.CQ=S;a.QR=G;a.dy=X;a.XD=V;a.ey=L;a.wU=function(b){switch(b.type){case a.Zc:case a.Jd:case a.pc:case a.wc:return!0;
default:return!1}};a.QM=function(b){switch(b.type){case a.Zc:case a.vf:case a.pc:case a.wc:var c;a:{switch(b.qm){case "AUTO":c=1<b.fb?b.nc:aa(b)?b.nc*b.fb:2*Math.atan(Math.tan(b.nc/2)*b.fb);break a;case "HORIZONTAL":c=b.nc;break a;case "VERTICAL":c=aa(b)?b.nc*b.fb:2*Math.atan(Math.tan(b.nc/2)*b.fb);break a}c=void 0}return Math.min(f(b),c);default:return ta.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.$P=function(b,c){switch(b.type){case a.vf:case a.hg:ta.error("set_aspect(): Unsupported camera type: "+
b.type);break;default:b.fb=c}};a.XT=function(a){return a.fb};a.Sj=Y;a.aQ=function(b,c,d,e,g){var h=1/Math.max(g,e);switch(b.type){case a.Zc:case a.vf:g/=2;e/=2;d=-(d-g)/g*Math.tan(f(b)/2);c=(c-e)/e*Math.tan(f(b)/2)*b.fb;e=b.near*(d+h);g=b.near*(c+h);d=b.near*(d-h);c=b.near*(c-h);va.frustum(c,g,d,e,b.near,b.far,b.lb);break;case a.Jd:case a.hg:d=-d/g;c/=e;e=f(b);g=e*b.fb;va.ortho(-g+(c-h)*(g+g),-g+(c+h)*(g+g),e+(d-h)*(e+e),e+(d+h)*(e+e),b.near,b.far,b.lb);break;case a.Qh:d=-d/g,c/=e,e=b.top+(d+h)*(b.top-
b.bottom),g=b.left+(c+h)*(b.right-b.left),d=b.top+(d-h)*(b.top-b.bottom),c=b.left+(c-h)*(b.right-b.left),va.ortho(c,g,d,e,b.near,b.far,b.lb)}va.copy(b.Hb,b.Tc);va.multiply(b.lb,b.Tc,b.Tc);oa.om(b.Tc,b.mh)};a.qv=ha;a.GA=U;a.fM=ga;a.dJ=function(a){a=a.o;var b=ma.sd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.U=b;var c=ma.ov(1,oa.f32([0,0,0]));a.va=c;a.bo=ma.qA(1,b);a.eo=ma.sA(1,b);a.co=ma.rA(1,b)};a.is_static_camera=function(b){return sa.is_camera(b)&&b.o&&b.o.kb==a.MS_STATIC};
a.is_target_camera=function(b){return sa.is_camera(b)&&b.o&&b.o.kb==a.MS_TARGET_CONTROLS};a.is_eye_camera=function(b){return sa.is_camera(b)&&b.o&&b.o.kb==a.MS_EYE_CONTROLS};a.is_hover_camera=function(b){return sa.is_camera(b)&&b.o&&b.o.kb==a.MS_HOVER_CONTROLS};a.is_ortho_camera=function(b){return sa.is_camera(b)&&b.o&&b.K[0].ea[0].type==a.Jd};a.$y=ca;a.zL=M;a.project_point=function(b,c,d){b=b.K[0].ea[0];switch(b.type){case a.Zc:case a.vf:case a.Jd:case a.hg:case a.pc:case a.wc:case a.re:case a.Yd:var e=
Ea;e.set(c);e[3]=1;ia.transformMat4(e,b.Tc,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;da.rS(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return ta.error("Non-compatible camera"),d}};a.bN=function(a){return a.K[0].ea[0]};a.gs=function(b,c){switch(b.type){case a.Zc:case a.vf:case a.pc:case a.wc:var d=Math.tan(f(b)/2);switch(c){case "LEFT":return-d*b.fb;case "RIGHT":return d*b.fb;case "TOP":return d;case "BOTTOM":return-d}break;case a.Jd:case a.hg:switch(c){case "LEFT":return-f(b)*
b.fb;case "RIGHT":return f(b)*b.fb;case "TOP":return f(b);case "BOTTOM":return-f(b)}break;case a.Qh:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.re:case a.Yd:d=ra.get_active();if((d=ra.Aa(d,O.uf))&&d.enable_hmd_stereo)switch(c){case "LEFT":return-Math.tan(Math.min(b.Rc[1],b.Rc[3]));case "RIGHT":return Math.tan(Math.min(b.Rc[1],b.Rc[3]));case "TOP":return Math.tan(Math.min(b.Rc[0],b.Rc[2]));case "BOTTOM":return-Math.tan(Math.min(b.Rc[0],
b.Rc[2]))}else switch(d=Math.tan(f(b)/2),c){case "LEFT":return-d*b.fb;case "RIGHT":return d*b.fb;case "TOP":return d;case "BOTTOM":return-d}break;default:oa.D("Unknown camera type")}};a.TN=aa;a.my=function(a,b,c){a=a.o;xa.set_trans(b,a.v);K.copy(c,a.pivot)};a.nE=function(a,b){var c=a.o,d=K.subtract(b,c.fc,Ca),e=xa.get_trans_view(c.v),d=K.add(d,e,d);Ia.set_translation(a,d);K.copy(b,c.fc)};a.yQ=function(a,b){var c=a.o,d=K.subtract(b,c.pivot,Ca),e=xa.get_trans_view(c.v),d=K.add(d,e,d);Ia.set_translation(a,
d);K.copy(b,c.pivot)};a.bU=P;a.SU=function(c,d){c.o.kb=d;c.o.Bb=null;c.o.Da=null;c.o.ub=null;c.o.bd=null;c.o.cd=null;n(c);switch(d){case a.MS_HOVER_CONTROLS:var e=xa.get_trans_view(c.o.v),f=g(c,0,Ga);b(c,e,f,null,null,null,null,c.o.kh);break;case a.MS_TARGET_CONTROLS:e=P(c,Ca),f=xa.get_quat_view(c.o.v),f=oa.quat_to_dir(f,oa.AXIS_MZ,Ga),f=K.scaleAndAdd(e,f,10,f),K.copy(f,c.o.pivot)}};a.Jq=function(a){a=a.o;a.kb=0;K.set(0,0,0,a.pivot);K.set(0,0,0,a.fc);a.Yj=!1;a.use_panning=!1;a.Bb=null;a.Da=null;a.ub=
null;a.bd=null;a.cd=null;a.Dd=null;a.kh=!0};a.set_eye_distance=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];70!=d.type&&80!=d.type&&90!=d.type&&100!=d.type||m(d,d.Vj,b)}};a.set_hmd_fov=function(a,b,c){var d=ra.get_active();a=sa.oa(a,d).ea;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||100==e.type)90==e.type&&ia.copy(b,e.Rc),100==e.type&&ia.copy(c,e.Rc),e.hc||Y(e,!1),U(e),ha(e)}};a.RU=function(a,b,c){var d=ra.get_active();a=sa.oa(a,d).ea;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||
100==e.type)90==e.type&&b&&va.copy(b,e.lb),100==e.type&&c&&va.copy(c,e.lb),U(e),ha(e)}}};b4w.module.__lights=function(a,r){function d(a){g.scale(a.color,a.Ye,a.Fo)}var c=r("__tsr"),b=r("__util"),g=r("__vec3"),n=new Float32Array(3);a.$N=function(a,e){var u=a.data,w=e.nb={name:"",type:u.type,GD:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Fo:new Float32Array(3),uB:0,fz:!1,Dl:0,lq:0,xo:.1,wo:30,VB:!1,lD:!1,CB:!1,Hl:!0,Il:!0,Ye:1,distance:25,LT:"INVERSE_SQUARE"};w.name=e.name;w.Hl=u.use_diffuse;w.Il=u.use_specular;var h=c.get_quat_view(e.o.v),h=b.quat_to_dir(h,
b.AXIS_Z,n);g.normalize(h,h);w.direction.set(h);w.color[0]=u.color[0];w.color[1]=u.color[1];w.color[2]=u.color[2];w.Ye=w.uB=u.energy;d(w);w.distance=u.distance;w.fz=u.use_sphere;w.xo=u.clip_start;w.wo=u.clip_end;if("POINT"===w.type||"SPOT"===w.type)w.distance=u.distance;"SPOT"===w.type?(w.lq=u.spot_blend,w.Dl=u.spot_size):"POINT"===w.type&&(w.Dl=Math.PI/2);w.VB=u.b4w_generate_shadows;w.CB=u.b4w_dynamic_intensity};a.set_light_color=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];d(a)};
a.oQ=function(a,b){a.lq=b};a.nQ=function(a,b){a.distance=b};a.pQ=function(a,b){a.Dl=b};a.set_light_energy=function(a,b){a.Ye=b;d(a)};a.LR=function(a){var d=a.nb;if(d){a=c.get_quat_view(a.o.v);b.quat_to_dir(a,b.AXIS_Z,d.direction);g.normalize(d.direction,d.direction);if("SUN"==d.type){a=Math.acos(g.dot(d.GD,b.Tu));var n=Math.acos(g.dot(d.direction,b.Tu));d.lD=Math.floor(a/.025)!=Math.floor(n/.025)?!0:!1}g.copy(d.direction,d.GD)}}};b4w.module.__scenes=function(a,r){function d(){lb||(lb=c(Va));return lb}function c(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.wf||!c.wf.length)return c}return null}function b(){Ya||ya.D("No active scene available");return Ya}function g(a,b,c){if(!za.Lr||!n(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>Oa.tc?(d.csm_resolution=Oa.tc,Fa.error("Shadow map texture has unsupported size. Changed to "+Oa.tc+".")):d.csm_resolution=c.csm_resolution;za.shadow_blur_samples=za.shadow_blur_samples?
za.shadow_blur_samples:c.blur_samples;d.OQ=c.soft_shadows;a=Ea.ls(b,za.ssao&&a.b4w_enable_ssao);d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;c.b4w_enable_csm&&1<c.csm_num&&1<a.length&&Fa.warn("Disabling Cascaded Shadow Maps because of multiple shadow casting lamps.");d.Cg=[];d.NE=[];d.xo=[];d.wo=[];for(b=0;b<a.length;b++)d.Cg.push(a[b].nb.type),d.NE.push(a[b].nb.Dl),d.xo.push(a[b].nb.xo),
d.wo.push(a[b].nb.wo),"SPOT"!=d.Cg[b]&&"POINT"!=d.Cg[b]||!d.enable_csm||(Fa.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):
(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function n(a,b,c){if(0!=b.length&&za.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,e=!1;a=za.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=
c[b];f.b4w_shadow_cast&&(d=!0);f.b4w_shadow_receive&&(e=!0);if((a||d)&&e)return!0}return!1}function x(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].nb.type)return!0;return!1}function e(a){if(!za.shore_smoothing)return!1;a=aa(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function u(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(Ea.QA(a[b],c[d].settings))return!0;return!1}function w(a){for(var b=aa(a),c=[],
d=0;d<b.length;d++){var e=b[d];if(e.b4w_water){for(var f={},g=0;g<a.length;g++)for(var h=a[g],l=h.data.materials,k=0;k<l.length;k++)l[k]==e&&(f.fk=h.location[2]);f.ce=e.b4w_water_fog_color.slice(0);f.ce.push(e.b4w_water_fog_density);e.b4w_water_dynamic?(f.Xo=!0,f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,
f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,f.dst_min_fac=e.b4w_water_dst_min_fac,f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.Xo=!1,f.waves_height=0,f.waves_length=0);f.og=e.b4w_water_enable_caust;f.NJ=e.b4w_water_caust_scale;f.MJ=e.b4w_water_caust_brightness;f.OJ=new Float32Array([.3,.7]);f.Tj=null;e=e.texture_slots;for(g=
0;g<e.length;g++)h=e[g].texture,!0===h.b4w_shore_dist_map&&"FILE"==h.image.source&&(f.Tj=h.image,f.sy=h.image.size[0],f.lx=h.b4w_max_shore_dist,h=h.b4w_shore_boundings,f.bn=[(h[0]+h[1])/2,(h[2]+h[3])/2],f.cn=[h[0]-h[1],h[2]-h[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.Xo)for(d=0;d<c.length;d++)c[d].Xo&&(f=c[d]);return f}return null}function h(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==
e.node_tree_name&&(c.refractions=!0);"BSDF_TRANSPARENT"==e.type&&(c.refractions=!0)}}}var c={refractions:!1};a=aa(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.refractions=!0);e.node_tree&&b(e.node_tree)}return c}function m(a,b,c){if(za.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;a=[];for(var d=0,e=!1,f=0;f<b.length;f++){var g=b[f];g.o.ld&&"CUBE"==g.o.Mg&&d++;if(g.Wp.length){for(var h=null,l=0;l<a.length;l++)if(a[l]==g){h=l;break}null==h&&a.push(g)}}for(f=
0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(g=0;g<b.length;g++)if(h=b[g].game_settings.alpha_blend,"OPAQUE"!=h&&"CLIP"!=h){b=!0;break a}b=!1}else b=void 0;b&&(e=!0)}return{QD:a,pD:d,bi:[],Pv:[],Bh:[],wt:[],sC:e}}function B(a,b){var c=a.b4w_sky_settings,d={};d.TD=c.render_sky||c.procedural_skydome;d.procedural_skydome=c.procedural_skydome;d.use_as_environment_lighting=c.use_as_environment_lighting;d.en=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=
c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.Ed=c.reflexible;d.md=c.reflexible_only;!b&&c.procedural_skydome&&Fa.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return d}function k(a){var b={};a=a.b4w_ssao_settings;
b.radius_increase=a.radius_increase;b.EN=a.hemisphere;b.tJ=a.blur_depth;b.blur_discard_value=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.UP=a.samples;return b}function f(a){if(!(za.bloom&&a.b4w_enable_bloom&&a.F.Ji))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}function F(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function t(a){var b=
{};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function q(a){var b={};a=a.b4w_god_rays_settings;b.Rw=a.intensity;b.Im=a.max_ray_length;b.ln=a.steps_per_pass;return b}function E(a){var b={};b.wi=a.b4w_outline_color;b.Fp=a.b4w_outline_factor;return b}function J(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=
a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function A(a,b){var c=a.light_settings,d={};d.wg=c.environment_energy;d.Aq=c.use_environment_light;d.ew=c.environment_color;d.Md=a.horizon_color.slice(0);d.Vd=a.zenith_color.slice(0);d.Dq=a.use_sky_paper;d.Cq=a.use_sky_blend;d.Eq=a.use_sky_real;d.St=null;d.fn=null;d.Sr=null;c=!0;if(d.Aq&&"SKY_TEXTURE"==d.ew&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var e=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&
!a.texture_slots[f].texture.b4w_use_as_skydome){e=a.texture_slots[f];break}e?d.Sr=e:c=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){c=!0;e=a.texture_slots[f];d.St=e;f=Math.min(Oa.ri,Da.GJ(e.texture.image.size[0]/3));d.fn={kR:f,yA:e.blend_factor,xC:e.horizon_factor,fG:e.zenith_up_factor,eG:e.zenith_down_factor,color:e.color,ya:e.default_value,invert:e.invert,MF:e.use_rgb_to_intensity,zA:e.blend_type,HF:e.use_map_blend,IF:e.use_map_horizon,KF:e.use_map_zenith_up,
JF:e.use_map_zenith_down};break}d.Aq=d.Aq?c:!1;return d}function I(a){var b=a.fog_settings,c={};c.iS=b.use_fog;c.Rw=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.jM=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.ce=new Float32Array([a[0],a[1],a[2],1/c.depth]);c.Ef=new Float32Array([c.Rw,c.depth,c.start,c.height]);return c}function C(a,b){if(!za.yc)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=
!1,d=!1,e=0;e<b.length;e++){for(var f=b[e],g=f.data.materials,h=0;h<g.length;h++)g[h].b4w_terrain&&(c=!0);f=f.particle_systems;for(h=0;h<f.length;h++)g=f[h].settings,"HAIR"==g.type&&g.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function v(a,b){if($a.outlining_overview_mode)return!0;if(za.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Ua.o.Qj)return!0;return!1}else return!1}function l(a,b){if($a.outlining_overview_mode)return!0;
if(za.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Ua.o.Ic)return!0;return!1}else return!1}function z(a,b){if(za.ii)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++)if(qa.PA(d[e]))return!0;return!1}else return!1}function H(a,b){if(za.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;
case "ON":return!0;case "AUTO":return b.refractions}else return!1}function p(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var e=c[d],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function Q(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].Ua;if(d.anchor&&d.anchor.im)return!0}return!1}}function y(a){if(a&&a.F&&a.F.Ja){var b=fa.dc(a.F.Ja,
R.gg);b&&la(a,b)}}function Z(a,b,c,d,e,f){for(var g=b.o,h=Ea.oa(b,e).R,l=0;l<h.length;l++){var k=h[l];if(!(k.Qd||k.md||"MAIN"!=k.type&&"NODES_GLOW"!=k.type&&"PARTICLES"!=k.type&&"LINE"!=k.type)&&("OPAQUE"==k.sb&&"OPAQUE"==d||"BLEND"==k.sb&&"BLEND"==d||"XRAY"==k.sb&&"XRAY"==d||"NODES_GLOW"==k.type&&"GLOW"==d)){if(!f&&(S(k,a,b,c,d,e),!K.vc(k)))if("DEBUG"===Bb.type())K.dr(k,"error.glslv","error.glslf"),K.vc(k);else continue;var m=R.th(k,g);R.Ec(a,m);fa.Ck(c,a,k);G(k)}}}function S(a,b,c,d,e,f){var g=
c.o,h=f.F,l=Ea.oa(c,f),k="NO_SHADOWS";c=ma(f,[R.Xc]);if(c.length&&a.Gd){switch(e){case "OPAQUE":k="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":k="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":k="NO_SHADOWS";break;case "SHADOW":k="SHADOW_MASK_GENERATION";break;default:ya.D("Wrong subscene type")}for(var m=0;m<c.length;m++)K.iA(a,f.F.Jc)}m="NO_SOFT_SHADOWS";if(h.Jc&&h.Jc.OQ)switch(za.shadow_blur_samples){case "16x":m="POISSON_X_16";break;case "8x":m="POISSON_X_8";
break;case "4x":m="POISSON_X_4"}c=a.ab;ja.ia(c,"SHADOW_USAGE",k);ja.ia(c,"POISSON_DISK_NUM",m);a.yc&&(m=fa.dc(d,R.Ph))&&D(a,m,g);m=b.B;m.type==na.Jd||m.type==na.hg||m.type==na.Qh?ja.ia(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):ja.ia(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.qj){e=b.jt;ja.ia(c,"NUM_LIGHTS",e);ja.ia(c,"NUM_LFACTORS",e%2?Math.floor(e/2)+1:e/2);ja.ia(c,"REFLECTION_PASS","REFL_PASS_NONE");ja.ia(c,"SSAO_ONLY",0);if(e=h.Bc)ja.ia(c,"WATER_EFFECTS",1),ja.ia(c,"WAVES_HEIGHT",
ja.N(e.waves_height)),ja.ia(c,"WAVES_LENGTH",ja.N(e.waves_length)),ja.ia(c,"WATER_LEVEL",ja.N(e.fk));if(b.og&&a.og){ja.ia(c,"CAUSTICS",1);if(m=h.Jc){g=m.Cg;for(m=k=0;m<g.length;m++)"SUN"==g[m]&&(k=m);ja.ia(c,"SUN_NUM",k)}ja.ia(c,"CAUST_SCALE",ja.N(b.KA));ja.ia(c,"CAUST_SPEED",ja.N(b.LA,2));ja.ia(c,"CAUST_BRIGHT",ja.N(b.JA))}b=l.bi;l=l.Bh;if(-1!==a.Ie.indexOf("u_mirrormap"))ja.ia(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.ld&&b)b=b.B.lc,K.Xi(a,b,"u_cube_reflection"),ja.ia(c,"REFLECTION_TYPE",
"REFL_CUBE");else if(a.ld&&l)for(m=0;m<l.length;m++)b=l[m].B.lc,K.Xi(a,b,"u_plane_reflection"),ja.ia(c,"REFLECTION_TYPE","REFL_PLANE");else ja.ia(c,"REFLECTION_TYPE","REFL_NONE");(l=fa.dc(d,R.gg))?a.Mr?(b=l.B.lc,K.Xi(a,b,"u_sky")):l.procedural_skydome&&(a.$d=l.$d,ja.ia(c,"PROCEDURAL_FOG",1)):ja.ia(c,"PROCEDURAL_FOG",0);b=h.Gn;b.Aq&&(ja.ia(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.ew?(b.Sr?(l=b.Sr.texture,b=Da.Ld(b.Sr),K.Xi(a,b,"u_sky_texture",l.name)):l&&(b=l.B.lc,K.Xi(a,b,"u_sky_texture")),ja.ia(c,
"SKY_TEXTURE",1)):"SKY_COLOR"==b.ew&&ja.ia(c,"SKY_COLOR",1));b=h.dG;b.iS&&(ja.ia(c,"USE_FOG",1),ja.ia(c,"FOG_TYPE",b.jM));a.xi&&a.yb?(za.Lr&&ja.ia(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.qj||"NODES_GLOW"==a.type?(ja.ia(c,"REFRACTIVE",1),h.refractions?ja.ia(c,"USE_REFRACTION",1):ja.ia(c,"USE_REFRACTION",0)):h.refractions?ja.ia(c,"REFRACTIVE",1):ja.ia(c,"REFRACTIVE",0),(h.cD.refractions||h.refractions)&&ja.ia(c,"HAS_REFRACT_TEXTURE",1)):(ja.ia(c,"REFRACTIVE",0),ja.ia(c,"USE_REFRACTION",0),
ja.ia(c,"USE_REFRACTION_CORRECTION",0));a.Lh&&(za.shore_smoothing&&a.Fn&&fa.dc(d,R.wz)?ja.ia(c,"SHORE_SMOOTHING",1):ja.ia(c,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?ja.ia(c,"DYNAMIC",1):ja.ia(c,"DYNAMIC",0));"PARTICLES"==a.type&&ja.ia(c,"COLOR_RAMP_LENGTH",a.wa.aB);if(!a.Ff)for(a=a.Sa,d=0;d<a.length;d++)if(b=a[d],"SCENE"==b.source)for(h=0;h<Va.length;h++)for(c=Va[h],l=Va[h].wf,e=0;e<l.length;e++)l[e]==b&&ua.C(Cb,c,f,null)}}function G(a){8<a.Sa.length&&Fa.warn(a.type,"too many textures used - "+
a.Sa.length+' (max 8), materials "'+a.Jb.join(", ")+'"')}function D(a,b,c){a.hd=b.hd;var d=b.hd[0],e=b.hd[1],f=b.hd[2];c=c.U;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.hd[2]=f;b=b.B;na.kE(b,f/2,f/2,-e,-d);na.Sj(b,!1);d=a.ji||0;d=0==d?c:Math.max(d,c);a.ji=d}function X(a,b,c,d,e,f){for(var g=b.o,h=Ea.oa(b,e).R,l=0;l<h.length;l++){var k=h[l];if(("MAIN"==k.type||"PARTICLES"==k.type||"LINE"==k.type)&&"REFLECT"==k.sb&&k.yb==d){if(a.type==R.qd||a.type==R.Qe){var m;a:{var n=e.F.Eh.Bh;
for(m=0;m<n.length;m++)for(var N=0;N<n[m].length;N++)if(n[m][N]==a)break a;n=e.F.Eh.wt;for(m=0;m<n.length;m++)for(N=0;N<n[m].length;N++)if(n[m][N]==a)break a;m=null}if(m==g.jd)continue}else if(m=oa(e,a),m==g.td)continue;if(!f&&(S(k,a,b,c,"REFLECT",e),m=k.ab,ja.ia(m,"WATER_EFFECTS",0),a.type==R.qd||a.type==R.Qe?ja.ia(m,"REFLECTION_PASS","REFL_PASS_PLANE"):ja.ia(m,"REFLECTION_PASS","REFL_PASS_CUBE"),ja.ia(m,"TEXTURE_NORM",0),!K.vc(k)))if("DEBUG"===Bb.type())K.dr(k,"error.glslv","error.glslf"),K.vc(k);
else continue;m=R.th(k,g);R.Ec(a,m);fa.Ck(c,a,k);G(k)}}}function V(a){M(a);var b=W(a,R.Db),c=!0,d=a.F.Jc;ua.ha(a.F.Ja,function(e,f){f.type===R.Xc&&(ba(f,a,b.B,d,c),c=!1)})}function L(a){ua.ha(a.F.Ja,function(a,b){b.type===R.Vl&&(b.cw=1)})}function ba(a,b,c,d,e){if(0!=a.Qa.length){var f=a.B;ab.copy(c.v,f.v);ab.copy(c.Me,f.fq);if("SUN"===d.Cg[a.Pg]||"HEMI"===d.Cg[a.Pg]){var g=c.v,h=Ub;ia.BS(h);for(var l=0;l<a.Qa.length;l++)for(var k=a.Qa[l].ra,m=0;m<k.length;m++){var n=k[m].qa,p=k[m].Ee;if(n.yc){var p=
ab.Qc(g,Hb),q=Xa.transformQuat(ya.AXIS_MZ,p,Wa),p=-q[0],q=q[1],t=ab.ec(g,Wa),p=t[0]-n.ji*(1+p)/2,q=t[1]-n.ji*(1-q)/2,t=n.Pa.max_z-n.Pa.min_z,v=Yb;v.min_x=p;v.min_y=q;v.min_z=n.hd[0]-t;v.max_x=p+n.ji;v.max_y=q+n.ji;v.max_z=n.hd[1]+t}else v=p.Pa;l||m?ia.fw(h,v):ia.cm(v,h)}g=ia.GB(h,Rc);ya.Um(g,f.Hb,g);if(d.enable_csm){b=Xa.copy(c.gh[a.Ov],Nb);d=N.invert(c.Hb,dc);ya.Um(b,d,b);ya.Um(b,f.Hb,b);a=c.Oo[a.Ov];if(e)for(Qb=0,Sc=-Infinity,e=2;e<g.length;e+=3)Qb=Math.min(Qb,g[e]),Sc=Math.max(Sc,g[e]);e=Ub;e.max_x=
b[0]+a;e.max_y=b[1]+a;e.max_z=Sc;e.min_x=b[0]-a;e.min_y=b[1]-a;e.min_z=Qb}else{c=e=Ub;d=kc;d.set(g);g=Yc/9;h=N.identity(dc);N.rotate(h,g,ya.AXIS_MZ,h);k=l=-1;for(m=0;10>m;m++){n=ia.oA(d,Yb);p=(n.max_x-n.min_x)*(n.max_y-n.min_y);if(-1==l||.1<l-p)l=p,k=m,ia.cm(n,c);ya.Um(d,h,d)}c=k*g;0<c&&(d=N.identity(dc),N.rotate(d,c,ya.AXIS_MZ,d),N.multiply(d,f.Hb,f.Hb),ab.from_mat4(f.Hb,f.Me));c=e.max_x-e.min_x;d=e.max_y-e.min_y;c&&d&&(g=Math.abs(c-d)/2,2<c/d?(e.max_y+=g,e.min_y-=g):2<d/c&&(e.max_x+=g,e.min_x-=
g));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;pa(a,b.F.Ja)}na.jQ(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);na.Sj(f,!1);ya.om(f.Tc,f.mh)}else"SPOT"!==d.Cg[a.Pg]&&"POINT"!==d.Cg[a.Pg]||na.Sj(f,!1)}}function pa(a,b){for(var c=a.B,d=fa.qN(b,a),e=0;e<d.length;e++){var f=d[e];if(f.type==R.Db||f.type==R.Re||f.type==R.Vc||f.type==R.tf)if(za.Ts)f.gz.set(c.Me,9*a.Pg);else{var g=ab.get_trans_view(c.Me),h=ab.get_scale(c.Me),l=ab.get_quat_view(c.Me);Qa.set(g[0],
g[1],g[2],h,qb);f.ku.set(qb,4*a.Pg);f.ju.set(l,4*a.Pg)}}}function Y(a,b,c,d,e){for(var f=b.o,g=Ea.oa(b,d).R,h=0;h<g.length;h++){var l=g[h];if("COLOR_ID"==l.type&&(a.type==R.Wd&&"COLOR_ID"==l.sb||a.type==R.dg&&"COLOR_ID_XRAY"==l.sb)){if(!e&&(S(l,a,b,c,"COLOR_ID",d),K.mb(l,"USE_OUTLINE",0),!K.vc(l)))continue;l=R.th(l,f);R.Ec(a,l)}}}function ha(a,b,c,d,e){if(!d&&(e.yc&&(d=fa.dc(c,R.Ph))&&D(e,d,b),!K.vc(e)))if("DEBUG"===Bb.type())K.dr(e,"error.glslv","error.glslf"),K.vc(e);else return;b=R.th(e,b);R.Ec(a,
b);fa.Ck(c,a,e);G(e)}function U(a,b){ga(a,b);for(var c=0;c<a.ve.length;c++)a.ve[c].parent==a&&U(a.ve[c],b)}function ga(a,b){a.o.hide=b;if(Ea.is_lamp(a))for(var c=0;c<a.K.length;c++)for(var d=a.K[c],e=ma(d.pb,xb),f=0;f<e.length;f++){var g=e[f],h=a.o,l=a.nb,k=d.Ap,m=l.Hl&&!h.hide?1:0;g.Bp[4*k+3]=m;m=l.Il&&!h.hide?1:0;g.zp[4*k+3]=m;g.Ba=!0}}function ca(a,b){for(var c=ma(b,xb),d=a.nb,e=a.o,f=Ea.oa(a,b),g=ab.get_trans_view(e.v),e=ab.get_quat_view(e.v),h=0;h<c.length;h++){var l=c[h],k=l,m=a.o,n=a.nb,N=
f.Ap,p=ab.get_trans_view(a.o.v),q=n.Fo;k.cx.set(n.direction,3*N);qb[0]=p[0];qb[1]=p[1];qb[2]=p[2];qb[3]=n.Hl&&!m.hide?1:0;k.Bp.set(qb,4*N);qb[0]=q[0];qb[1]=q[1];qb[2]=q[2];qb[3]=n.Il&&!m.hide?1:0;k.zp.set(qb,4*N);k.Ba=!0;switch(d.type){case "SUN":l.ZE.set(e);l.YE=d.Fo;l.type===R.gg?(l.ft=d.lD,Xa.copy(d.direction,l.Dy),la(b,l)):Xa.copy(d.direction,l.Dy);break;case "HEMI":case "POINT":case "SPOT":break;default:Fa.error("Unknown light type: "+d.type+'".')}l=l.Qa;for(k=0;k<l.length;k++)for(m=l[k].ra,
n=0;n<m.length;n++)N=m[n].qa,N.el&&K.mQ(N,a)}c=W(b,R.Db).B;f=f.qy;d=b.F.Jc;for(h=0;h<f.length;h++)l=f[h],na.ny(l.B,g,e),ba(l,b,c,d,!0),pa(l,b.F.Ja)}function M(a){var b=Ta.Ib(a,"LAMP",Ta.DATA_ID_ALL),b=Ea.ls(b,za.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],e=d.o,f=ab.ec(e.v,Nb),e=ab.Qc(e.v,Hb),g=0;g<d.K.length;g++){var h=d.K[g],l=h.qy;if(h.pb==a)for(h=0;h<l.length;h++)na.ny(l[h].B,f,e)}}function la(a,b){Ka.yt(b);La.lm(b);if(b.ft)for(var c=ma(a,Ua),d=0;d<c.length;d++)for(var e=
c[d].Qa,f=0;f<e.length;f++)for(var g=e[f].ra,h=0;h<g.length;h++){var l=g[h];l.Ub&&(l=l.qa,K.RJ(l)&&La.CR(l))}}function aa(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,e=0;e<d.materials.length;e++){var f=d.materials[e];-1==b.indexOf(f)&&b.push(f)}return b}function P(a,b,c){for(var d=a.F,e=Ea.oa(a.Vi,a).ea,f=0;f<e.length;f++){var g=e[f];na.$P(g,b/c);na.Sj(g,!1);d.Jc&&na.$y(g,d.Jc)}if(d.Jc){d.gt=!0;e=ma(a,[R.Re]);for(f=0;f<e.length;f++)e[f].Ba=!0;e=ma(a,[R.Vc]);for(f=0;f<e.length;f++)e[f].Ba=
!0}var h=d.Ja;fa.sR(h,function(d,e,f){if(d.tq){var g=d.Al*b,l=d.Bl*c;if(e)for(e=0;e<f.Xa.length;e++)f.Xa[e]==d&&Da.resize(d.Ya,g,l);else switch(Da.Em(d.Ya)&&Da.resize(d.Ya,g,l),d=f.B,d.width=g,d.height=l,f.type){case R.Kn:da(a,{dof_power:f.B.dof_power});break;case R.Ln:wa(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case R.Hn:va(a,{bloom_blur:f.$l});break;case R.Vl:f=fa.mc(h,f,R.Zb);g=fa.mc(h,f,R.Zb);l=fa.mc(h,g,R.Zb);d=fa.mc(h,l,R.Zb);fa.od(f,
1/b,1/c);fa.od(g,1/b,1/c);fa.od(l,1/b,1/c);fa.od(d,1/b,1/c);break;default:fa.od(f,1/b,1/c)}}})}function ma(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];a.F.Ja&&ua.ha(a.F.Ja,function(a,b){b.type==e&&c.push(b)})}return c}function W(a,b){return fa.dc(a.F.Ja,b)}function ka(a){var b=d();b&&ua.ha(b.F.Ja,function(b,c){var d=c.B;d&&d.type==na.Yd&&(c.Zr=a)})}function da(a,b){var c=ma(a,[R.Kn]);if(!c.length)return Fa.error("DOF is not enabled on the scene. Check camera settings"),0;for(var d=0;d<c.length;d++){var e=
c[d],f=b,g=a,h=e.B.dof_bokeh,l=h?ma(g,[R.Du]):[],g=g.F.Ja;if("boolean"==typeof f.dof_on&&(e.B.dof_on=f.dof_on,h))for(var k=0;k<l.length;k++)l[k].B.dof_on=f.dof_on;if("number"==typeof f.dof_distance&&(e.B.dof_distance=f.dof_distance,h))for(k=0;k<l.length;k++)l[k].B.dof_distance=f.dof_distance;if("number"==typeof f.dof_front_start&&(e.B.dof_front_start=f.dof_front_start,h))for(k=0;k<l.length;k++)l[k].B.dof_front_start=f.dof_front_start;if("number"==typeof f.dof_front_end&&(e.B.dof_front_end=f.dof_front_end,
h))for(k=0;k<l.length;k++)l[k].B.dof_front_end=f.dof_front_end;if("number"==typeof f.dof_rear_start&&(e.B.dof_rear_start=f.dof_rear_start,h))for(k=0;k<l.length;k++)l[k].B.dof_rear_start=f.dof_rear_start;if("number"==typeof f.dof_rear_end&&(e.B.dof_rear_end=f.dof_rear_end,h))for(k=0;k<l.length;k++)l[k].B.dof_rear_end=f.dof_rear_end;"number"==typeof f.dof_bokeh_intensity&&(e.B.dof_bokeh_intensity=f.dof_bokeh_intensity,h&&(l=fa.ww(g,e,R.Zb),l[0].B.dof_bokeh_intensity=f.dof_bokeh_intensity,l[1].B.dof_bokeh_intensity=
f.dof_bokeh_intensity,l[0]=fa.mc(g,l[0],R.Zb),l[0].B.dof_bokeh_intensity=f.dof_bokeh_intensity));if("number"==typeof f.dof_power)if(h){f=f.dof_power;e.B.dof_power=f;var f=f/2,h=e.B.width,k=e.B.height,m=[1/h,0],n=[1/h*.5,1/k*.866],N=[-1/h*.5,1/k*.866],l=fa.ww(g,e,R.Zb);fa.Ac(l[0],f);fa.od(l[0],N[0],N[1]);fa.Ac(l[1],f);fa.od(l[1],n[0],n[1]);l[0]=fa.mc(g,l[0],R.Zb);fa.Ac(l[0],f);fa.od(l[0],m[0],m[1]);e.B.gd&&(l[0]=fa.mc(g,l[0],R.Du),l[0]=fa.mc(g,l[0],R.Zb),fa.od(l[0],1/h,1/k),l[0]=fa.mc(g,l[0],R.Zb),
fa.od(l[0],1/h,1/k))}else e.B.dof_power=f.dof_power,l=fa.mc(g,e,R.Zb),g=fa.mc(g,l,R.Zb),fa.Ac(l,e.B.dof_power),fa.od(l,1/e.B.width,1/e.B.height),fa.Ac(g,e.B.dof_power),fa.od(g,1/e.B.width,1/e.B.height)}}function va(a,b){var c=ma(a,[R.Pq]),d=ma(a,[R.Hn]);if(!c.length||!d.length)return Fa.error("Bloom is not enabled on the scene"),0;if("number"==typeof b.key)for(var e=0;e<c.length;e++)c[e].mr=b.key,c[e].Ba=!0;if("number"==typeof b.edge_lum)for(e=0;e<c.length;e++)c[e].lr=b.edge_lum,c[e].Ba=!0;if("number"==
typeof b.blur)for(e=0;e<d.length;e++){var f=a.F.Ja,c=fa.mc(f,d[e],R.In),f=fa.mc(f,c,R.In);d[e].$l=b.blur;fa.Ac(c,b.blur);fa.od(c,1/d[e].B.width,1/d[e].B.height);fa.Ac(f,b.blur);fa.od(f,1/d[e].B.width,1/d[e].B.height)}}function wa(a,b){var c=ma(a,[R.Ln]);if(!c.length)return Fa.error("Glow is not enabled on the scene"),null;for(var d=0;d<c.length;d++){for(var e=c[d],f=b,g=a.F.Ja,h=fa.mN(g,e),l=0;l<h.length;++l){var k=h[l];if(k.type==R.Zb&&"GLOW_MASK_LARGE"==k.sb)var m=k;if(k.type==R.Zb&&"GLOW_MASK_SMALL"==
k.sb)var n=k}h=fa.mc(g,m,R.Zb);g=fa.mc(g,n,R.Zb);"number"==typeof f.small_glow_mask_coeff&&(e.small_glow_mask_coeff=f.small_glow_mask_coeff,e.Ba=!0);"number"==typeof f.large_glow_mask_coeff&&(e.large_glow_mask_coeff=f.large_glow_mask_coeff,e.Ba=!0);"number"==typeof f.small_glow_mask_width&&(e.small_glow_mask_width=f.small_glow_mask_width,fa.Ac(n,f.small_glow_mask_width),fa.od(n,1/e.B.width,1/e.B.height),n.Ba=!0,fa.Ac(g,f.small_glow_mask_width),fa.od(g,1/e.B.width,1/e.B.height),g.Ba=!0);"number"==
typeof f.large_glow_mask_width&&(e.large_glow_mask_width=f.large_glow_mask_width,fa.Ac(m,f.large_glow_mask_width),fa.od(m,1/e.B.width,1/e.B.height),m.Ba=!0,fa.Ac(h,f.large_glow_mask_width),fa.od(h,1/e.B.width,1/e.B.height),h.Ba=!0)}}function sa(a,b,c){var d=a.F,e=d.Bc;if(!e.Xo)return e.fk;var f=e.waves_height,g=e.waves_length,h=e.fk,l=Xa.length(d.Ui)||1;a=W(a,R.Db).time;a*=l;l=Mb;l[0]=20/g*(b-.25*a);l[1]=20/g*(c-.25*a);var k=ya.MA(l);l[0]=17/g*(c+.1*a);l[1]=17/g*(b+.1*a);var l=k+ya.MA(l)-1,m=e.dst_noise_scale0,
k=e.dst_noise_scale1,n=e.dst_noise_freq0,N=e.dst_noise_freq1,p=Mb;p[0]=m*(b+n*a);p[1]=m*(c+n*a);m=ya.vy(p);p[0]=k*(c-N*a);p[1]=k*(b-N*a);k=f*m*ya.vy(p);e.Tj?(N=(b-e.bn[0])/e.cn[0],p=(e.bn[1]+c)/e.cn[1],N+=.5,p+=.5,1<N||0>N||1<p||0>p?b=k:(d=ya.ZB(d.ry,e.sy,N,p),N=e.dir_noise_scale,p=e.dir_noise_freq,m=Math.sqrt(d),n=Math.max(m,e.dst_min_fac),b=f*Math.max(d,e.dir_min_shore_fac)*Math.sin(m/(g/e.lx/Math.PI)+e.dir_freq*a)*Math.max(ya.vy([N/g*(b+p*a),N/g*(c+p*a)]),e.dir_min_noise_fac)*(1-n)+k*n,l*=d)):
b=k;return h+(b+.05*l)}function ta(a,b){a.rp&&a.type==R.Zb&&b.Ub!=a.Ub&&(a.Ub=b.Ub);b.Ub||a.type!=R.Vl||(a.cw=0)}function ea(a,b,c,d){var e=ua.Ra(a,b);na.Jt(e.B,c,d);e.cv=!0;ua.Zj(a,b,function(b,e,f){f.active&&f.from==c&&fa.bK(f)&&ra(a,b,f.to,d)});ua.Ih(a,b,function(b,e,f){f.active&&f.from==c&&f.from==f.to&&ea(a,b,c,d)})}function ra(a,b,c,d){a=ua.Ra(a,b).Qa;for(b=0;b<a.length;b++)for(var e=a[b].ra,f=0;f<e.length;f++)K.GP(e[f].qa,d,c)}function O(a){for(var b=ma(a,[R.Ph]),c=0;c<b.length;c++){var d=
b[c],e=d.B,f=a.Vi.o,g=ab.ec(f.v,Nb),h=Wa;h[0]=0;h[1]=0;h[2]=-d.hd[2]/2;d=ab.Qc(f.v,Hb);Xa.transformQuat(h,d,h);h[0]+=g[0];h[1]+=g[1];h[2]=0;Ra.identity(d);na.ny(e,h,d)}}function Ia(a,b){ua.ha(a,function(c,d){if(d.type==R.Ug){d.Xa[0]&&d.Hh[0]||ya.D("Wrong MOTION_BLUR subscene");var e=d.Xa[0],f=d.Hh[0];d.Hh[0]=d.B.lc;ua.Zj(a,c,function(b,c,d){d.active&&ra(a,b,d.to,f)});ea(a,c,e.from,f);ra(a,c,e.to,d.Hh[0]);d.iD=Math.exp(-b/d.mb_factor)}})}function xa(a){return a.F.Ui}function oa(a,b){if(!a.F.Eh)return null;
for(var c=a.F.Eh.bi,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.F.Eh.Pv;for(d=0;d<c.length;d++)if(c[d]==b)return d;return null}var K=r("__batch"),ia=r("__boundings"),na=r("__camera"),Sa=r("__config"),Aa=r("__container"),T=r("__debug"),ua=r("__graph"),Ca=r("__hud"),Ga=r("__input"),N=r("__mat4"),qa=r("__nodemat"),Ta=r("__objects");r("__textures");var Ea=r("__obj_util"),Ba=r("__physics"),Ka=r("__prerender"),kb=r("__primitives"),Fa=r("__print"),Ra=r("__quat"),La=r("__renderer"),fa=r("__scenegraph"),Ha=
r("__sfx"),ja=r("__shaders"),R=r("__subscene"),Da=r("__textures"),ab=r("__tsr"),ya=r("__util"),Xa=r("__vec3"),Qa=r("__vec4"),Bb=r("__version"),Ma=Sa.Jk,za=Sa.H,Oa=Sa.pg,$a=Sa.Ic,db=Sa.$m,wb=[R.Ph,R.Xc,R.Db,R.Vc,R.tf,R.Id,R.qd,R.Wc,R.Qe,R.qe,R.Wd,R.dg,R.Re,R.fg,R.eg];a.XS=wb;var xb=[R.Db,R.Vc,R.tf,R.Id,R.qd,R.Wc,R.Ul,R.Oq,R.gg,R.Qe,R.qe,R.Pq,R.Re,R.Xc,R.Wd,R.dg,R.fg],Ua=[R.Db,R.Tq,R.Vc,R.tf,R.Id,R.qd,R.Wc,R.Qe,R.qe],xc=[R.Xc,R.Db,R.Vc,R.tf,R.Id,R.qd,R.Wc,R.Qe,R.qe,R.Wd,R.dg,R.Re,R.Ul,R.fg,R.eg],eb=
[R.Db,R.Vc,R.tf,R.Id,R.qd,R.Wc,R.Qe,R.qe],lb=null,Ya=null,Va=[],Cb=null,Yc=Math.PI/2,Mb=new Float32Array(2),Nb=new Float32Array(3),Wa=new Float32Array(3),Hb=new Float32Array(4),qb=new Float32Array(4),dc=new Float32Array(16),Rc=new Float32Array(24),kc=new Float32Array(24),Ub=ia.sd(),Yb=ia.sd(),Qb=0,Sc=-Infinity;a.CT=function(){return{}};a.set_active=function(a){Ya=a;Ha.ZP(a)};a.pP=function(a,b){var c=a.F,d=fa.SK(c.Ja);if(a==b){P(a,Aa.oC(),Aa.nC());for(var e=0;e<d.length;e++)a.F.wl.push(d[e])}else for(e=
a.wf[0],P(a,e.Ci,e.Ci),e=0;e<d.length;e++)b.F.wl.push(d[e]);d=ma(a,xc);for(e=0;e<d.length;e++)d[e].Ui.set(c.Ui);for(e=0;e<c.wl.length;e++)c.wl[e].type==R.Xc&&La.lm(c.wl[e])};a.oh=d;a.Ur=c;a.get_active=b;a.xa=function(){return Ya?!0:!1};a.mj=function(a){return a.Vi};a.jp=function(){return Va};a.xw=function(){if(1==Va.length)return Va;for(var a=0;a<Va.length;a++){var b=Va[a].F.Ja;ua.ha(b,function(b,c){for(var d=c.Qa,e=0;e<d.length;e++)for(var f=d[e].ra,g=0;g<f.length;g++){for(var h=f[g],l=h.qa.Sa,k=
null,m=0;m<l.length;m++)if("SCENE"==l[m].source&&l[m].iq==Va[a].name&&c.type!=R.Fu){Fa.error('Texture-scene loop detected. A scene is rendered to texture "'+l[m].name+'" yet this texture belongs to the same scene.');k=h.qa;break}if(k)for(l=k.Sa,k.Sa=[],k.Ie=[],K.BR(k,null),K.vc(k),R.Ec(c,h),m=0;m<l.length;m++);}})}for(var c=[],a=0;a<Va.length;a++)if(b=Va[a],!b.wf.length){b=ua.yh(Cb,b);ua.YL(Cb,b);b=ua.mn(Cb,b,ua.Sl);b=ua.Oy(b);ua.ha(b,function(a,b){c.push(b)});break}return c};a.KI=function(a,b,c,
d,n){a.wf=a.wf||[];a.na=null;var N=a.F,qa=Ea.oa(a.Vi,a),K=a.Vi.o;N.En=[];var y=a.world;N.aO=c.length;N.Ji=x(c);N.Ot=B(y,N.Ji);N.Gn=A(y,N.Ot);N.dG=I(y);if(y=!a.wf.length)a:{if("HMD"==za.stereo){if(qa.ea[0].type!=na.Zc){Fa.warn("Head-mounted display stereo is disabled for the non-perspective camera");za.stereo="NONE";y=!1;break a}if(!Ga.can_use_device(Ga.DEVICE_HMD)){Fa.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");za.stereo="NONE";y=!1;break a}}y="HMD"==za.stereo}N.zs=
y;if(y=!a.wf.length)qa.ea[0].type!=na.Zc&&"ANAGLYPH"==za.stereo?(Fa.warn("Anaglyph stereo is disabled for the non-perspective camera"),za.stereo="NONE",y=!1):y="ANAGLYPH"==za.stereo;N.anaglyph_use=y;N.AI=!N.anaglyph_use&&Q(a,n);N.Eh=m(a,b,d);N.sJ=f(a);N.HO=F(a);N.PJ=t(a);N.yN=q(a);N.XO=E(a);N.oj=J(a);N.dof=za.dof&&(0<K.dof_distance||K.dof_object);N.motion_blur=za.motion_blur&&a.b4w_enable_motion_blur;N.compositing=za.compositing&&a.b4w_enable_color_correction;N.antialiasing=za.antialiasing&&1==za.uc&&
"NONE"!=a.b4w_antialiasing_quality;N.ssao=za.ssao&&a.b4w_enable_ssao;N.god_rays=za.god_rays&&a.b4w_enable_god_rays&&N.Ji;N.HL=za.Lr;N.lp=a.b4w_glow_settings.render_glow_over_blend;N.cR=k(a);n=h(d);N.cD=n;N.refractions=H(a,n);N.Jc=g(a,c,d);N.Bc=w(d);N.Tg=p(d);N.NQ=u(d);N.shore_smoothing=e(d);N.yc=C(a,d);N.rK=v(a,d);N.outline=l(a,d);N.ii=z(a,d);switch(za.reflection_quality?za.reflection_quality:a.b4w_reflection_quality){case "LOW":N.ci=db.oB;N.Lg=db.DD;break;case "MEDIUM":N.ci=db.BL;N.Lg=db.jP;break;
case "HIGH":N.ci=db.AL;N.Lg=db.iP;break;default:N.ci=db.oB,N.Lg=db.DD}Aa.PN()?(Fa.log("%cENABLE HIDPI MODE","color: #00a"),N.Vz="AA_QUALITY_LOW",N.Xm=1,za.uc=1):1<za.uc?(Fa.log("%cENABLE MSAA RENDERING: "+za.uc+"x","color: #00a"),N.Xm=1):(N.Vz="AA_QUALITY_"+a.b4w_antialiasing_quality,N.Xm="MEDIUM"===a.b4w_antialiasing_quality&&za.quality===Sa.P_ULTRA||"HIGH"===a.b4w_antialiasing_quality&&za.quality===Sa.P_HIGH?1.33:"HIGH"===a.b4w_antialiasing_quality&&za.quality===Sa.P_ULTRA||"NONE"===a.b4w_antialiasing_quality&&
za.quality===Sa.P_ULTRA?2:1);c=a.wf.sort(function(a,b){return b.Ci-a.Ci});N.Ja=fa.RK(N,qa,K,c);N.wl=[];N.gt=!1;N.yx=!1;N.zx=!1;N.Ui=new Float32Array(3);Va.push(a);Cb||(Cb=ua.create());ua.O(Cb,a);for(N=0;N<b.length;N++)Ea.iy(b[N],!0,a);a=Aa.get_container();Aa.resize(a.clientWidth,a.clientHeight,!0)};a.LI=function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d].F;e&&e.mi&&(e.Iq=c,a.F.En.push(b[d]))}};a.ks=function(a){return a.F.Ja};a.SB=function(a,b){ua.ha(b,function(c,d){var e=null;switch(d.type){case R.Zb:e=
K.Jv(d.xt);break;case R.Tq:e=K.XK(d);break;case R.Ru:e=K.YK(d);break;case R.wz:e=K.EK();break;case R.Ul:e=K.IK(d.yD,d.Lh,d.ln);break;case R.Oq:e=K.JK();break;case R.Ug:e=K.NK();break;case R.Du:e=K.BK(d.YA);break;case R.Kn:var e=K.FK(d),f=d.B.dof_power;if(d.B.dof_bokeh){var f=f/2,g=fa.ww(b,d,R.Zb);fa.Ac(g[0],f);fa.Ac(g[1],f);g[0]=fa.mc(b,g[0],R.Zb);fa.Ac(g[0],f)}else{var g=fa.mc(b,d,R.Zb),h=fa.mc(b,g,R.Zb);fa.Ac(g,f);fa.Ac(h,f)}break;case R.Vl:var e=K.OK(),f=fa.mc(b,d,R.Zb),g=fa.mc(b,f,R.Zb),h=fa.mc(b,
g,R.Zb),l=fa.mc(b,h,R.Zb);fa.Ac(g,d.hv);fa.Ac(f,d.hv);fa.Ac(l,d.hw*d.Fp);fa.Ac(h,d.hw*d.Fp);break;case R.Ln:e=K.HK();break;case R.Eu:e=K.CK();break;case R.pz:e=K.wK(d);break;case R.Pu:case R.Rq:case R.Qn:case R.Sq:e=K.VK(d.type);break;case R.uf:e=K.ZK(d.sb);break;case R.gg:e=K.DK(a,d);break;case R.LUMINANCE:e=K.KK();break;case R.hG:e=K.xK();break;case R.Pq:e=K.LK();break;case R.In:e=K.zK();break;case R.Hn:e=fa.mc(b,d,R.In);f=fa.mc(b,e,R.In);fa.Ac(e,d.$l);fa.Ac(f,d.$l);e=K.AK();break;case R.kI:e=K.wL();
break;case R.Rl:e=K.vK();break;case R.On:e=K.PK()}e&&(f=R.th(e,Ea.No("NONE")),R.Ec(d,f),fa.Ck(b,d,e),G(e))})};a.append_object=function(a,b,c,d){switch(b.type){case "MESH":case "LINE":case "WORLD":var e=a.F.Ja,f=b.o;!fa.dc(e,R.Xc)&&f.Gd&&(f.Gd=!1);f=ma(a,wb);(c||d)&&Ba.append_object(b,a);for(d=0;d<f.length;d++){var g=f[d],h=b,l=e,k=a,m=c;switch(g.type){case R.Db:Z(g,h,l,"OPAQUE",k,m);break;case R.Vc:Z(g,h,l,"BLEND",k,m);break;case R.tf:Z(g,h,l,"XRAY",k,m);break;case R.Id:Z(g,h,l,"GLOW",k,m);break;
case R.qd:case R.Wc:X(g,h,l,!1,k,m);break;case R.Qe:case R.qe:X(g,h,l,!0,k,m);break;case R.Re:for(var N=Ea.oa(h,k).R,n=0;n<N.length;n++){var p=N[n];if("SHADOW"==p.type&&"RECEIVE"==p.sb&&p.Gd){if(!m&&(S(p,g,h,l,"SHADOW",k),!K.vc(p)))continue;var q=R.th(p,h.o);R.Ec(g,q);fa.Ck(l,g,p);G(p)}}break;case R.Xc:N=!1;n=h.o;h=Ea.oa(h,k).R;p=fa.dc(l,R.Ph);for(q=0;q<h.length;q++){var t=h[q];if("SHADOW"==t.type&&"CAST"==t.sb){N=!0;if(!m){var v=g.jt;K.mb(t,"NUM_LIGHTS",v);K.mb(t,"NUM_LFACTORS",v%2?Math.floor(v/
2)+1:v/2);ja.ia(t.ab,"SHADOW_USAGE","SHADOW_CASTING");t.yc&&p&&D(t,p,n);K.mb(t,"SHADOW_TEX_RES",ja.N(k.F.Jc.csm_resolution));if(!K.vc(t))continue}t.yc&&(k.F.Jc.RL=!0);v=R.th(t,n);R.Ec(g,v);fa.Ck(l,g,t);G(t)}}N&&(h=k.F.Jc,m=fa.dc(l,R.Db),ba(g,k,m.B,h,!0));break;case R.Wd:Y(g,h,l,k,m);break;case R.dg:Y(g,h,l,k,m);break;case R.fg:N=h.o;n=Ea.oa(h,k).R;for(p=0;p<n.length;p++)if(q=n[p],"COLOR_ID"==q.type&&"OUTLINE"==q.sb){if(!m&&(S(q,g,h,l,"COLOR_ID",k),K.mb(q,"USE_OUTLINE",1),!K.vc(q)))continue;q=R.th(q,
N);R.Ec(g,q)}break;case R.Ph:l=h.o;h=Ea.oa(h,k).R;for(k=0;k<h.length;k++)if(N=h[k],"GRASS_MAP"==N.type){if(!m&&!K.vc(N))if("DEBUG"===Bb.type())K.dr(N,"error.glslv","error.glslf"),K.vc(N);else continue;N=R.th(N,l);R.Ec(g,N);N=g.B;t=l.Pa;n=g.hd[0];p=g.hd[1];q=g.hd[2];0==n&&0==p?(n=t.min_z,p=t.max_z):(n=Math.min(n,t.min_z),p=Math.max(p,t.max_z));t=1E-4*(p-n);n-=t;p+=t;g.hd[0]=n;g.hd[1]=p;na.kE(N,q/2,q/2,-p,-n);na.Sj(N,!1)}break;case R.eg:for(N=h.o,h=Ea.oa(h,k).R,k=0;k<h.length;k++)n=h[k],"DEBUG_VIEW"==
n.type&&ha(g,N,l,m,n)}}break;case "LAMP":ca(b,a)}for(d=0;d<b.K.length;d++)for(c=b.K[d].R,e=0;e<c.length;e++)null==c[e].ib&&c.splice(e--,1);Ea.iy(b,!0,a)};a.cz=y;a.jy=function(a){a.F.gt=!0};a.VR=function(a,b){ua.ha(b,function(b,c){c.type===R.Xc&&(ab.copy(a.v,c.B.v),ab.copy(a.Me,c.B.fq))})};a.jV=pa;a.XM=function(a,b){for(var c=a.F.Jc,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=na.zL(c,b,e);return d};a.gT=ha;a.sr=U;a.uo=ga;a.is_hidden=function(a){return a.o.hide};a.SD=function(a,b){for(var c=
0;c<a.K.length;c++)for(var d=ma(a.K[c].pb,wb),e=0;e<d.length;e++)for(var f=d[e].Qa,g=0;g<f.length;g++)for(var h=f[g].ra,l=h.length-1;0<=l;l--){var k=h[l];if(k.Ee==a.o)if(k.qa){if("undefined"==typeof b||-1!=k.qa.Jb.indexOf(b)||0==k.qa.Jb.length)K.XA(k.qa),h.splice(l,1)}else h.splice(l,1)}};a.KR=function(a,b){for(var c=a.nb,d=Ea.oa(a,b).Ap,e=ma(b,xb),f=0;f<e.length;f++){var g=e[f];g.zp.set(c.Fo,4*d);g.Ba=!0}};a.vq=ca;a.YR=function(a){a=a.K;for(var b=0;b<a.length;b++)y(a[b].pb)};a.XR=la;a.cleanup=function(){for(var a=
0;a<Va.length;a++){var b=Va[a];ua.ha(b.F.Ja,function(a,b){if(b.type!=R.Xl){var c=b.B;La.AP(c.ee,c.lc,c.we,c.width,c.height);for(var c=b.Qa,d=0;d<c.length;d++)for(var e=c[d].ra,f=0;f<e.length;f++){var g=e[f].qa;g&&K.XA(g)}}});b.F.Ja=null;b.F.wl=[]}Ya=lb=null;Va.length=0;Cb=null};a.bD=function(a,b,c){a=na.fM(a,a.near,a.far,null,!0);var d=kb.IM(a);a=Ea.No("DYNAMIC");a.Pa=a.U={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.gb=a.va=ia.oJ();var e=a.gb.Wa;a.jb=a.Z=ia.fo([e,0,0],
[0,e,0],[0,0,e],a.gb.M);a.wn=!1;c=K.UK(d,c);c=R.th(c,a);R.Ec(b,c)};a.fU=function(a){return[a.frame_start,a.frame_end]};a.sE=function(a,b,c){Aa.GQ(a,b,c);Ya&&P(Ya,a,b)};a.UU=P;a.Ii=ma;a.Aa=W;a.yP=function(){ka(!1)};a.zP=function(){ka(!0)};a.get_environment_colors=function(a){a=W(a,R.Db);var b=a.Md,c=a.Vd,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.wg,d,e]};a.set_environment_colors=function(a,b,c,d){a=ma(a,xb);for(var e=0;e<a.length;e++){var f=a[e];f.Md.set(c);f.Vd.set(d);
f.wg=b;f.Ba=!0}};a.get_sky_params=function(a){if(a=W(a,R.gg)){var b={};b.color=Array(3);Xa.copy(a.en,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=
a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.eN=function(a){return ma(a,Ua)[0].Ef[0]};a.cN=function(a){return ma(a,Ua)[0].Ef[1]};a.fN=function(a){return ma(a,Ua)[0].Ef[2]};a.dN=function(a){return ma(a,Ua)[0].Ef[3]};a.hE=function(a,b){for(var c=ma(a,Ua),d=0;d<c.length;d++){var e=c[d];e.Ef[0]=b;e.Ba=!0}};a.fE=function(a,b){for(var c=ma(a,Ua),d=0;d<c.length;d++){var e=c[d];e.Ef[1]=b;e.Ba=!0}};a.iE=function(a,b){for(var c=ma(a,Ua),d=0;d<c.length;d++){var e=c[d];
e.Ef[2]=b;e.Ba=!0}};a.gE=function(a,b){for(var c=ma(a,Ua),d=0;d<c.length;d++){var e=c[d];e.Ef[3]=b;e.Ba=!0}};a.get_fog_color_density=function(a,b){var c=b||[],d=ma(a,Ua)[0].ce;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=ma(a,Ua),d=0;d<c.length;d++){var e=c[d];e.ce.set(b);e.Ba=!0}};a.get_ssao_params=function(a){var b=W(a,R.Tq),c=W(a,R.Ru);a=W(a,R.Db);if(!b)return null;var d={};d.quality=b.mq;d.use_hemisphere=b.Xt;d.use_blur_depth=c.Ut;d.blur_discard_value=
c.Vt;d.radius_increase=b.Zt;d.influence=b.Yt;d.dist_factor=b.Wt;d.ssao_only=a.ssao_only;d.ssao_white=b.ssao_white;return d};a.get_dof_params=function(a){a=W(a,R.Kn);if(!a)return null;var b={};b.dof_on=a.B.dof_on;b.dof_distance=a.B.dof_distance;b.dof_front_start=a.B.dof_front_start;b.dof_front_end=a.B.dof_front_end;b.dof_rear_start=a.B.dof_rear_start;b.dof_rear_end=a.B.dof_rear_end;b.dof_power=a.B.dof_power;b.dof_bokeh=a.B.dof_bokeh;b.dof_bokeh_intensity=a.B.dof_bokeh_intensity;b.dof_object=a.B.dof_object;
return b};a.set_dof_params=da;a.get_god_rays_params=function(a){var b=ma(a,[R.Ul]);a=W(a,R.Oq);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].Im;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=K.Kd(b[0].Qa[0].ra[0].qa,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=ma(a,[R.Ul]),d=ma(a,[R.Oq]);if(!c.length||!d.length)return Fa.error("God Rays are not enabled on the scene"),0;if("number"==typeof b.god_rays_intensity)for(var e=0;e<d.length;e++)d[e].god_rays_intensity=
b.god_rays_intensity;if("number"==typeof b.god_rays_max_ray_length)for(var f=b.god_rays_max_ray_length,e=0;e<c.length;e++)c[e].Im=f,c[e].Ct=f/c[e].ln/(e+1),c[e].Ba=!0;if("number"==typeof b.god_rays_steps)for(var g=ja.N(b.god_rays_steps,1),f=c[0].Im,e=0;e<c.length;e++){c[e].ln=g;c[e].Ct=f/g/(e+1);c[e].Ba=!0;var h=c[e].Qa[0].ra[0],l=h.qa;K.mb(l,"STEPS_PER_PASS",g);K.vc(l);R.Ec(c[e],h)}for(e=0;e<d.length;e++)d.Ba=!0};a.get_bloom_params=function(a){var b=W(a,R.Pq);a=W(a,R.Hn);if(!b||!a)return null;var c=
{};c.key=b.mr;c.edge_lum=b.lr;c.blur=a.$l;return c};a.set_bloom_params=va;a.get_glow_material_params=function(a){a=W(a,R.Ln);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=wa;a.get_wind_params=function(a){var b=xa(a);a=Xa.length(b);if(0==a)return null;var b=ya.rad_to_deg(Math.atan2(b[0],-b[1])),
c={};c.wind_dir=b;c.wind_strength=a;return c};a.VP=function(a){a.F.yx=!0};a.get_water_surface_level=sa;a.get_water_mat_params=function(a,b){var c=a.F.Bc,d=W(a,R.Db);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,d.Mh&&(b.water_fog_density=d.Mh[3],c=b.water_fog_color=[],c[0]=d.Mh[0],c[1]=d.Mh[1],c[2]=d.Mh[2]))};a.set_water_params=function(a,b){var c=a.F.Bc;if(!c)return Fa.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=
b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=
b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Xo=b.water_dynamic);for(var d=ma(a,eb),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.ce&&(f.Mh[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.ce&&f.Mh.set(b.water_fog_color);"number"==typeof b.waves_height&&
(f.kz=b.waves_height);"number"==typeof b.waves_length&&(f.lz=b.waves_length);f.Ba=!0}};a.get_shore_dist=function(a,b,c){var d=a.F.Bc;if(!d.Tj)return 100;var e=d.lx;a=d.fk;var f=(b[0]-d.bn[0])/d.cn[0],g=(d.bn[1]+b[1])/d.cn[1],f=f+.5,g=g+.5;if(!(1<f||0>f||1<g||0>g))return d=e*ya.ZB(Ya.F.ry,d.sy,f,g),b=(a-b[2])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,c){for(var d=b().Vi.o,e=0;e<Va.length;e++){var f=Va[e],g=f.F.Ja,h=f.F;if(h.Bc)var l=ab.get_trans_view(d.v),k=l[2]-sa(f,l[0],l[1]);for(l=0;l<h.En.length;l++){var m=
h.En[l].F,N=m.Ta,n=m.ed;if(!(f.b4w_use_nla&&m.ck||!N&&!n)&&Da.YF(m)){var p=Da.VF(m),q=Da.XF(m);N&&za.is_mobile_device&&(q-=5);var t=Da.qS(m);p>=t&&m.Oi||p<q?(Da.reset_video(m),n&&(m.Rj=Da.It(m,a))):p>=t&&!m.Oi?Da.pause_video(m):Da.ZF(m)&&(N?Da.DF(m):(N=Da.It(m,a),N!=m.Rj&&(Da.CF(m),m.Bi++),m.Rj=N))}}ua.ha(g,function(b,c){-1<xc.indexOf(c.type)&&(c.time=a);h.Bc&&(c.tv=k)})}for(e=0;e<Va.length;e++)if(f=Va[e],h=f.F,g=h.Ja,d=h.wl,d.length)for(h.gt&&(V(f),h.gt=!1),h.yx&&(O(f),h.yx=!1),h.zx&&(L(f),h.zx=
!1),h.motion_blur&&Ia(g,c),f=fa.dc(g,R.fg),l=0;l<d.length;l++)g=d[l],Ka.yt(g),f&&ta(g,f),La.lm(g);za.show_hud_debug_info&&Ca.KQ(Va,c)};a.IP=function(a){a.F.zx=!0};a.ow=function(a){var b=[];ua.ha(a.F.Ja,function(a,c){b.push(c)});return b};a.get_cam_water_depth=function(){var a=W(Ya,R.Vc),b=Ya;return a||b.F.Bc?a.tv:null};a.BF=function(a){ua.ha(a.F.Ja,function(a,b){b.Ba=!0})};a.cQ=function(a,c){a.debug_view_mode=c;a.Ub=c!=T.DV_NONE;a.yb=c==T.DV_TRANSPARENT_WIREFRAME;a.Ba=!0;for(var d=b(),e=0;e<eb.length;e++)for(var f=
ma(d,[eb[e]]),g=0;g<f.length;g++)f[g].$v=c==T.DV_RENDER_TIME};a.bQ=function(a,b){a.debug_colors_seed=b;a.Ba=!0};a.wQ=function(a,b){a.sB=b;a.Ba=!0};a.EQ=function(a,b){for(var c=a.Qa,d=0;d<c.length;d++)for(var e=c[d].ra,f=0;f<e.length;f++){var g=e[f].qa;Xa.copy(b,g.wireframe_edge_color);g.ib.Om=!0}};a.yF=function(a,b){var c=b.pm,d=a.F.Ui;if(c&&"WIND"==c.type&&d){var e=ab.get_quat_view(b.o.v);Xa.transformQuat(ya.AXIS_Z,e,d);Xa.normalize(d,d);Xa.scale(d,c.TE,d);c=ma(a,xc);for(e=0;e<c.length;e++)c[e].Ui.set(d);
return!0}return!1};a.dP=function(a,b,c){var d=W(a,R.Wd);if(d){var e=Ma.enabled&&(Ma.oq===R.Wd||Ma.oq===R.dg);if(e)var f=Aa.po(b,c,Mb,d.B);else{var g=Aa.get_canvas();na.aQ(d.B,b,c,g.clientWidth,g.clientHeight)}Ka.yt(d);d.Ub&&La.lm(d);(a=W(a,R.dg))?(N.copy(d.B.lb,a.B.lb),N.copy(d.B.Tc,a.B.Tc),ya.om(a.B.Tc,a.B.mh),Ka.yt(a),a.Ub&&La.lm(a),b=a.B):b=d.B;if(d.Ub||a&&a.Ub)return e?(f[1]=b.height-f[1],La.Dt(b.ee,f[0],f[1])):La.Dt(a?a.B.ee:d.B.ee,0,0)}else Fa.error("Object Selection is not available on the scene");
return null};a.set_outline_color=function(a){for(var c=b(),c=ma(c,[R.Vl]),d=0;d<c.length;d++){var e=c[d];e.wi.set(a);e.Ba=!0}};a.kU=xa;a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.get_custom_prop=function(a){return a.b4w_custom_prop};a.xF=function(a,b){var c=Nb;Xa.negate(b,c);for(var d=0;6>d;d++){var e=a.Hk[d],f=a.Po[d],g=a.B;N.translate(ya.qG[d],c,e);N.multiply(g.lb,e,g.Tc);ya.om(g.Tc,f)}};a.zF=
function(a,b,c){ya.oR(b,c,ya.AXIS_Z,a.B.hc)};a.hA=function(a,b,c){var d=a.F.Eh;if(d&&b)for(var e=0;e<b.length;e++){var f=b[e],g=Ea.oa(f,a);if(-1!=f.o.jd){var h=d.Bh,l=d.wt,f=f.o.jd;l.length&&f<l.length?g.Bh=l[f]:h.length&&f<h.length&&(g.Bh=h[f])}else-1!=f.o.td&&(h=d.bi,l=d.Pv,f=f.o.td,l.length?g.bi=l[f]:h.length&&(g.bi=h[f]))}if(c)for(b=Ea.ls(c,za.ssao&&a.b4w_enable_ssao),c=a.F.Jc,e=0;e<b.length;e++)if(g=Ea.oa(b[e],a),c)for(d=ma(a,[R.Xc]),f=0;f<d.length;f++)e==d[f].Pg&&g.qy.push(d[f])};a.marker_frame=
function(a,b){return a.timeline_markers[b]};a.set_hmd_params=function(a){var c=b();if(c=W(c,R.uf))a.distortion_coefs&&(c.Kk[0]=a.distortion_coefs[0],c.Kk[1]=a.distortion_coefs[1],c.Ba=!0),a.chromatic_aberration_coefs&&(c.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],c.Ba=!0),a.base_line_factor&&
(c.Kk[2]=a.base_line_factor,c.Ba=!0),a.inter_lens_factor&&(c.Kk[3]=a.inter_lens_factor,c.Ba=!0),null!=a.enable_hmd_stereo&&(c.enable_hmd_stereo=a.enable_hmd_stereo,c.Ba=!0)};a.et=function(b,c){for(var d=Va,e=0;e<d.length;e++)fa.NO(a.ks(d[e]),b,c)};a.wR=function(a){for(var b=Ta.Ib(a,"LAMP",Ta.DATA_ID_ALL),c=ma(a,wb),d=0;d<c.length;d++)for(var e=c[d],f=e.Qa,g=0;g<f.length;g++)for(var h=f[g].ra,l=0;l<h.length;l++){var k=h[l],m=k.qa;"MAIN"==m.type&&(K.AR(m,b,a),K.vc(m),R.Ec(e,k))}};a.PD=function(a){for(var b=
0;b<Va.length;b++)ua.ha(Va[b].F.Ja,function(b,c){for(var d=c.Qa,e=0;e<d.length;e++)for(var f=d[e].ra,g=0;g<f.length;g++){var h=f[g];h.qa==a&&R.Ec(c,h)}})}};b4w.module.__physics=function(a,r){function d(a,b){for(var c=a.ve,e=0;e<c.length;e++)c[e].Kg.yq&&b.push(c[e]),d(c[e],b)}function c(a,b,c){for(var d=a.jc.ra,e=0;e<d.length;e++)for(var f=d[e].J,g=0;g<f.ue.length;g++){var h=f.ue[g];"ANY"!=h.Tb&&c!=h.Tb||J(h,a,b)}}function b(a,b,c){if(G.Es(a))switch(b){case G.xG:var d=g(a);d.jc.cG=!0;G.ga(a,G.NH,Date.now()-performance.now(),M.max_fps,M.pv?la.LB:0);break;case G.yG:X.dd("URANIUM:",c.slice(1));break;case G.tG:X.error(c);break;case G.uG:S.fbmsg.apply(this,
c.slice(1));break;case G.Ez:var e=n(c.ba);if(e){a=c.trans;d=c.quat;b=c.uh;var f=c.Wg,e=e.J;e.Gr=c.time;Y.set_sep(a,1,d,e.Rv);U.copy(b,e.uh);U.copy(f,e.Wg)}break;case G.Cz:(a=n(c.uv))&&Y.set_sep(c.trans,1,c.quat,a.I.Qp[c.Rx]);break;case G.vG:if(d=n(c[1]))a=c[4],d=d.Df.nr[c[2]],pa.set_translation(d,c[3]),pa.set_rotation(d,a),pa.L(d);break;case G.BG:if(e=n(c[1]))e.I.speed=c[2];break;case G.Az:d=g(a);x(d,c.tk,c.uk,c.result,null,null,0);break;case G.Bz:d=g(a);x(d,c.tk,c.uk,c.result,c.Bk,c.dh,c.bm);break;
case G.rG:if(e=n(c[1]))a=e.J,a.Ak&&a.Ak(c[2]);break;case G.Nu:case G.Dz:d=g(a);if(a=d.jc.Nj[c.id])if(d=n(c.am),b==G.Nu)b=a.callback,b(a.id,c.If,d,c.li);else{b=c.If;var f=c.li,e=c.sh,h=a.callback;e?h(a.id,b,d,f,e,c.ki):h(a.id,b,d,f)}break;case G.AG:C(c.id);break;case G.zG:a=ma.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case G.wG:P=c[1];break;case G.sG:a=ma.indexOf(a);
console.log("Worker: #"+String(a));console.log(c[1]);break;default:X.error("Wrong message: "+b)}}function g(a){for(var b=0;b<ma.length;b++)if(ma[b]==a)return W[b]}function n(a){return ka[a]||null}function x(a,b,c,d,f,g,h){a=a.jc.ra;for(var l=0;l<a.length;l++)for(var k=a[l].J,m=0;m<k.ue.length;m++){for(var p=k.ue[m],q=p.Kj,t=!1,N=0;N<q.length;N++){var v=q[N];if(v[0]===b&&v[1]===c){p.Gp[N]=d;t=!0;break}}t&&(q=e(p),f&&p.jv!=b&&(t=f,N=g,v=h,t[0]+=N[0]*v,t[1]+=N[1]*v,t[2]+=N[2]*v,N[0]*=-1,N[1]*=-1,N[2]*=
-1),p.callback(q,q?p.jv==b?n(c):n(b):null,f,g,h))}}function e(a){a=a.Gp;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function u(){wa.body++;return wa.body}function w(a){var b=va.indexOf(a);return-1==b?(va.push(a),va.length-1):b}function h(a,b){return{ba:a,type:b,wh:0,Is:!1,Uj:!0,Ce:!1,is_character:!1,NN:!1,xr:null,Tb:"",Co:0,xT:{},ue:[],Ak:null,Gr:0,Rv:new Float32Array([0,0,0,1,0,0,0,1]),uh:new Float32Array(3),Wg:new Float32Array(3),qr:new Float32Array(3),oo:new Float32Array(4),Cp:null}}function m(a,
b){switch(a){case "BOX":var c=b.U;break;case "CYLINDER":c=b.eo;break;case "CONE":c=b.co;break;case "SPHERE":c=b.va;break;case "CAPSULE":c=b.bo}return c}function B(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.M&&(b.center=a.M);
"number"===typeof a.Wa&&(b.radius=a.Wa);"number"===typeof a.height&&(b.height=a.height);return b}function k(a,b,c,d,e){var f=Y.get_trans_view(a.o.v),g=Y.invert(b.o.v,ea),h=new Float32Array(3);Y.transform_vec3(f,g,h);switch(b.I.type){case 10:b=b.Le;a=a.o.U;G.ga(e,G.qH,c,h,b.jR,b.cy,(a.max_z-a.min_z)/2,d);break;case 20:G.ga(e,G.pH,c,h,a.iv)}}function f(a){return a.J&&a.J.xr}function F(a,b,c,d,e,f,g,h,l,k){var m;wa.cc++;m=wa.cc.toString(16);var n=b.J.ba;G.ga(t(n),G.xH,m,a,h,n,c,d,e.J.ba,f,g,l,k);b.J.xr=
m}function t(a){for(var b=0;b<W.length;b++)for(var c=W[b].jc.ra,d=0;d<c.length;d++)if(c[d].J.ba==a)return ma[b];return null}function q(a){var b=a.J;if(b=b?0===b.wh?!0:!0===b.Is?!0:!1===b.Uj?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=Y.ec(a.o.v,sa),c=Y.Qc(a.o.v,ta),b=b[0]!=a.J.qr[0]||b[1]!=a.J.qr[1]||b[2]!=a.J.qr[2]||c[0]!=a.J.oo[0]||c[1]!=a.J.oo[1]||c[2]!=a.J.oo[2]||c[3]!=a.J.oo[3];if(b){var b=a.J,d=a.o,c=G.gC(G.Nn);c.ba=b.ba;var e=Y.ec(d.v,c.trans),d=Y.Qc(d.v,c.quat);U.copy(e,b.qr);
V.copy(d,b.oo);"DYNAMIC"==b.type&&V.identity(c.quat);G.ga(t(b.ba),G.Nn)}a=a.ve;for(b=0;b<a.length;b++)q(a[b])}function E(a,b,c,d,e){e=e||new Float32Array(3);a=Y.get_quat_view(a.o.v);e[0]=b;e[1]=c;e[2]=d;U.transformQuat(e,a,e)}function J(a,b,c){var d=a.Kj,e=a.Gp,f=a.jv,g=[],h=a.Tb;g||ha.D("At least one destination required");for(var l=0;l<b.jc.ra.length;l++){var k=b.jc.ra[l];if("ANY"==h||k.J.Tb==h&&"NAVMESH"!=k.J.type)k=k.J.ba,g&&-1==g.indexOf(k)&&g.push(k)}for(b=0;b<g.length;b++)h=g[b],f<h&&!A(d,
f,h)?(d.push([f,h]),e.push(!1)):f>h&&!A(d,h,f)&&(d.push([h,f]),e.push(!1));G.ga(c,G.oH,f);G.ga(c,G.wH,d,a.ah)}function A(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function I(a){a.J&&a.J.Ak&&(a=a.J,G.ga(t(a.ba),G.JH,a.ba),a.Ak=null)}function C(a){var b=l(a),c=v(a).jc;c.Nj[a]&&(delete c.Nj[a],c.Vx.splice(c.Vx.indexOf,1),G.ga(b,G.SH,a))}function v(a){for(var b=0;b<W.length;b++){var c=W[b];if(c.jc.Nj[a])return c}return null}function l(a){for(var b=0;b<W.length;b++)if(W[b].jc.Nj[a])return ma[b];
return null}function z(a,b,c){if(b.kn){a=a.J.ba;var d=b.nm*b.cp,e=b.mo*b.no,f=-b.hn*b.jn*2*Math.PI/b.nq;b.qp&&(f*=-1);switch(b.type){case 10:G.ga(c,G.eI,a,d,e,f);break;case 20:G.ga(c,G.dI,a,d,e,f)}}}function H(a){return a.Ce&&"CHASSIS"==a.Le.Fe}function p(a){return a.Ce&&"HULL"==a.Le.Fe}function Q(a){return"NAVMESH"==a.Kg.Lp}function y(a){return a.bl&&"MAIN_BODY"==a.rm.Fe}var Z=r("__config"),S=r("__debug"),G=r("__ipc"),D=r("__obj_util"),X=r("__print"),V=r("__quat"),L=r("__scenes"),ba=r("__subscene"),
pa=r("__transform"),Y=r("__tsr"),ha=r("__util"),U=r("__vec3"),ga=r("__version"),ca=r("__navmesh"),M=Z.J,la=Z.H,aa=Z.rd,P=0,ma=[],W=[],ka={},da=[],va=["ANY"],wa={body:0,cc:0,ND:0},sa=new Float32Array(3),ta=new Float32Array(4),ea=Y.create(),ra=Y.create();a.HN=function(a){a.jc={cG:!1,ra:[],Nj:{},Vx:[]};var c=M.xq;aa.prevent_caching&&(c+=ga.timestamp());X.log("%cLOAD PHYSICS","color: #0a0",M.yn?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+M.max_fps);X.log("%cPHYSICS PATH","color: #0a0",
c);var d=G.xL(c,!M.yn);G.hJ(d,b);ma.push(d);W.push(a);M.ping&&setInterval(function(){G.ga(d,G.PH,performance.now())},1E3)};a.cK=function(a){return a.jc?a.jc.cG:!0};a.cleanup=function(){for(var a=0;a<ma.length;a++)G.terminate(ma[a]);ma.length=0;W.length=0;ka={};da.length=0;va=["ANY"];for(var b in wa)wa[b]=0};a.append_object=function(a,b){if(b.jc){var e;a:{for(var g=0;g<W.length;g++)if(W[g]==b){e=ma[g];break a}e=void 0}var l=[];a.Kg.yq&&d(a,l);var n=b.jc.ra;if(H(a)||p(a)||a.is_character||y(a)||a.xn){var q=
Q(a),t;if(q){var v=u(),x=h(v,"NAVMESH"),r=D.oa(a,b).R;x.Cp=null;for(var L=0;L<r.length;L++){var E=r[L];if("PHYSICS"==E.type){x.Cp=ca.PO(E.da);break}}t=x}else{var N=e,qa=a.o,A=a.Kg,C=A.Lp,I=u();if("CAMERA"==a.type)var wa=A.ez?A.vr:"BOX",O=m(wa,qa),ba=.5,J=0;else if("EMPTY"==a.type)wa="EMPTY",O=null,J=ba=0;else{var wa=A.ez?A.vr:"BOX",O=m(wa,qa),M=Y.get_scale(qa.v);if(1!=M){var P=O;switch(wa){case "BOX":P.min_x*=M;P.max_x*=M;P.min_y*=M;P.max_y*=M;P.min_z*=M;P.max_z*=M;break;case "CYLINDER":case "CONE":case "CAPSULE":P.height*=
M;P.Wa*=M;break;case "SPHERE":P.Wa*=M}}ba=qa.um;J=qa.mm}var sa=Y.get_trans_view(qa.v),ja=Y.get_quat_view(qa.v),R=A.Bq,pa=A.NF,aa=A.wh,S=A.RF,Z=A.QF,U=A.rB,Bb=A.YD,la=a.Tb,za=w(la),Oa=A.Do,ga=A.Bo,db=A.Eo,wb=qa.va.Wa,xb=B(O),Ua=a.yr,va;var eb=wa;if(l.length){var Ia=[],Ya={};Ya.quat=new Float32Array([0,0,0,1]);Ya.trans=new Float32Array(3);Ya.worker_bounding=xb;Ya.bounding_type=eb;Ia.push(Ya);var Va=Y.invert(qa.v,ea),Cb=ta,Yc=Y.get_quat_view(qa.v);V.invert(Yc,Cb);for(var Mb=0;Mb<l.length;Mb++){var Nb=
{},Wa=l[Mb],Hb=Wa.Kg.vr,qb=new Float32Array(4),dc=new Float32Array(3),Rc=Y.get_trans_view(Wa.o.v),kc=Y.get_quat_view(Wa.o.v);Y.transform_vec3(Rc,Va,dc);V.multiply(Cb,kc,qb);Nb.trans=dc;Nb.quat=qb;Nb.bounding_type=Hb;Nb.worker_bounding=B(m(Hb,Wa.o));Ia.push(Nb)}va=Ia}else va=[];G.ga(N,G.tH,I,sa,ja,C,R,pa,aa,S,Z,U,Bb,za,Oa,ga,db,wa,xb,wb,ba,J,va,Ua);ka[I]=a;da.push(a);var Ub=h(I,"BOUNDING");Ub.type=C;Ub.wh=aa;Ub.Is=R;Ub.Tb=la;Ub.Co=za;t=Ub}var Yb=t;a.J=Yb;var Qb={qa:null,J:Yb};q||(n.push(Qb),c(b,e,
Yb.Tb))}else for(var Sc=D.oa(a,b).R,Qc=0;Qc<Sc.length;Qc++){var yc=Sc[Qc],Gc;if(Gc="PHYSICS"==yc.type){var hd;a:{for(var Hc=b.jc.ra,qc=0;qc<Hc.length;qc++){var ec=Hc[qc].qa;if(ec&&ec.id==yc.id){hd=!0;break a}}hd=!1}Gc=!hd}if(Gc)if(yc.Hd.Ha)if(yc.Lh&&b.F.Bc){var rb=yc,rc=b,Ib=e,ib=rc.F.Bc;G.ga(Ib,G.CH,ib.fk);if(rb.xS){var bb={};bb.dst_noise_scale0=rb.dst_noise_scale0;bb.dst_noise_scale1=rb.dst_noise_scale1;bb.dst_noise_freq0=rb.dst_noise_freq0;bb.dst_noise_freq1=rb.dst_noise_freq1;bb.dir_min_shore_fac=
rb.dir_min_shore_fac;bb.dir_freq=rb.dir_freq;bb.dir_noise_scale=rb.dir_noise_scale;bb.dir_noise_freq=rb.dir_noise_freq;bb.dir_min_noise_fac=rb.dir_min_noise_fac;bb.dst_min_fac=rb.dst_min_fac;bb.waves_hor_fac=rb.waves_hor_fac;var zc=ib.waves_height,fb=ib.waves_length;ib.Tj?G.ga(Ib,G.Oz,bb,ib.cn[0],ib.cn[1],ib.bn[0],ib.bn[1],ib.lx,zc,fb,ib.sy,rc.F.ry):G.ga(Ib,G.Oz,bb,0,0,0,0,0,zc,fb,0,null)}}else{var Zc;if(yc.Bq){var ld=a,Ob=yc,$c=e,sc=u(),Zb=Ob.Hd,Tc=Zb.aa[0].a_position,Jb=Zb.ma||null,Vb=Ob.Tb,Kb=
w(Vb),lc=Ob.Do,tc=Ob.Bo,id=Ob.Eo,yb=Y.get_trans_view(ld.o.v);G.ga($c,G.zH,sc,Tc,Jb,yb,Kb,lc,tc,id);var Za=h(sc,"STATIC_MESH");Za.Is=!0;Za.Tb=Vb;Za.Co=Kb;Zc=Za}else{var gb=a,cb=yc,fc=e,Ac=u(),Uc=cb.Hd,mc=Uc.aa[0].a_position,Bc=Uc.ma||null,Rb=Y.get_trans_view(gb.o.v),Cc=cb.um,Dc=cb.mm,gc=cb.Tb,Wb=w(gc);G.ga(fc,G.BH,Ac,mc,Bc,Rb,Cc,Dc,Wb,cb.Do,cb.Bo,cb.Eo);var $b=h(Ac,"STATIC_MESH");$b.Tb=gc;$b.Co=Wb;Zc=$b}Yb=Zc;a.J=Yb;Qb={qa:yc,J:Yb};n.push(Qb);c(b,e,Yb.Tb)}else X.error("Object "+a.name+" has collision material with no assigned vertices")}if(H(a)||
p(a)){var sb=e,tb=a.J.ba;H(a)?(a.I.type=10,G.ga(sb,G.uH,tb,a.I.Ey,a.I.Gy,a.I.Fy,a.I.oz,a.I.mx)):p(a)&&(a.I.type=20,G.ga(sb,G.sH,tb,a.I.Ok,a.I.Nl,a.I.Ol));if(a.I.vl){var mb=a.I.vl;switch(a.I.type){case 10:k(mb[0],a,tb,!0,sb);k(mb[1],a,tb,!0,sb);k(mb[2],a,tb,!1,sb);k(mb[3],a,tb,!1,sb);break;case 20:for(var Ic=0;Ic<mb.length;Ic++)k(mb[Ic],a,tb,!1,sb)}}z(a,a.I,e)}else if(a.is_character){var ad=e,ub=a.o,Db=a.J,vb=ub.U.max_z-ub.U.min_z,Jc=Db.ba,Na=a.NA,hb=Na.wS,zb=Na.TP,hc=Na.dR,Ja=Na.ZN,ac=Na.yS,Lb=ha.JL(a);
G.ga(ad,G.vH,Jc,Lb,vb,hb,zb,hc,Ja,ac);Db.is_character=!0}else if(y(a)){var Eb=e,jb=a.J.ba;G.ga(Eb,G.yH,jb,a.Df.Ok,a.Df.Nl,a.Df.Ol);if(a.Df.nr)for(var Pb=a.Df.nr,Ab=0;Ab<Pb.length;Ab++){var Pa=Pb[Ab],Sb=Y.get_trans_view(Pa.o.v),Fb=Y.invert(a.o.v,ea),Ec=new Float32Array(3);Y.transform_vec3(Sb,Fb,Ec);G.ga(Eb,G.rH,jb,Ec,Pa.iv)}a.J.NN=!0}for(Qc=0;Qc<da.length;Qc++){var Kc=da[Qc];if(Kc.J){var Gb=Kc;if(!f(Gb))for(var Lc=0;Lc<Gb.Nx.length;Lc++){var Xb=Gb.Nx[Lc],nc=Xb.target,oc=Xb.eP;if(nc.J){var bd=new Float32Array([Xb.fP,
Xb.gP,Xb.hP]),Vc=ha.euler_to_quat(new Float32Array([Xb.Ea,Xb.Fa,Xb.Ga]),new Float32Array(4)),uc=Y.identity(ea),uc=Y.set_trans(bd,uc),uc=Y.set_quat(Vc,uc),bc=Y.multiply(Gb.o.v,uc,ea),Mc=Y.invert(nc.o.v,ra),Fc=Y.multiply(Mc,bc,Mc),Nc=Y.get_trans_view(Fc),cc=Y.get_quat_view(Fc),nb=Xb,ob={};ob.use_limit_x=nb.jS;ob.use_limit_y=nb.kS;ob.use_limit_z=nb.lS;ob.use_angular_limit_x=nb.fS;ob.use_angular_limit_y=nb.gS;ob.use_angular_limit_z=nb.hS;ob.limit_max_x=nb.jO;ob.limit_min_x=nb.mO;ob.limit_max_y=nb.kO;
ob.limit_min_y=nb.nO;ob.limit_max_z=nb.lO;ob.limit_min_z=nb.oO;ob.limit_angle_max_x=nb.dO;ob.limit_angle_min_x=nb.gO;ob.limit_angle_max_y=nb.eO;ob.limit_angle_min_y=nb.hO;ob.limit_angle_max_z=nb.fO;ob.limit_angle_min_z=nb.iO;F(oc,Gb,bd,Vc,nc,Nc,cc,ob,null,null)}}}}}};a.nM=n;a.update=function(a,b){for(var c=0;c<ma.length;c++){var d=ma[c],e=a;d&&G.JC(d)&&G.ga(d,G.fI,e,b);for(var f=0;f<da.length;f++){var g=da[f],h=g.J;if(h.Uj&&h.Gr){var l=G.JC(d)?e-h.Gr:performance.now()/1E3-h.Gr,l=Math.min(l,10/M.max_fps),
l=l-1/M.max_fps;la.QO&&(l=0);var k=ea;Y.JN(h.Rv,l,h.uh,h.Wg,ea);pa.set_tsr(g,k);pa.L(g);q(g);if(g.I)for(var h=g,l=h.I.vl,k=h.o.v,m=ea,n=0;n<l.length;n++){var p=l[n];Y.multiply(k,h.I.Qp[n],m);pa.set_tsr(p,m);pa.L(p)}g.I&&g.I.kn&&(m=g,l=m.I,h=l.kn)&&(n=m.I.QE,Y.multiply(m.o.v,m.I.RE,h.o.v),k=sa,Y.transform_dir_vec3(n,m.o.v,k),m=ta,V.setAxisAngle(k,-l.hn*l.jn*2*Math.PI,m),l=Y.get_quat_view(h.o.v),V.multiply(m,l,l),pa.L(h));g.I&&g.I.wy&&(m=g,l=m.I,h=l.wy)&&(n=m.I.LE,Y.multiply(m.o.v,m.I.ME,h.o.v),k=sa,
Y.transform_dir_vec3(n,m.o.v,k),m=ta,n=Math.abs(l.speed)*l.kq,n>l.Jm&&(n=l.Jm),V.setAxisAngle(k,-n,m),l=Y.get_quat_view(h.o.v),V.multiply(m,l,l),V.normalize(l,l),pa.L(h));g.I&&g.I.Hy&&(k=g,h=k.I,g=h.Hy)&&(m=k.I.aF,Y.multiply(k.o.v,k.I.bF,g.o.v),l=sa,Y.transform_dir_vec3(m,k.o.v,l),k=ta,V.setAxisAngle(l,-Math.abs(h.nm)*h.So,k),h=Y.get_quat_view(g.o.v),V.multiply(k,h,h),V.normalize(h,h),pa.L(g))}}G.mP(d);d=W[c];(e=d.F.Bc)&&0<e.waves_height&&(d=L.Aa(d,ba.Db),e=U.length(d.Ui)||1,G.ga(ma[c],G.cI,d.time*
e))}};a.OM=function(){return W[0]};a.pause=function(){for(var a=0;a<ma.length;a++)G.ga(ma[a],G.OH)};a.resume=function(){for(var a=0;a<ma.length;a++)G.ga(ma[a],G.TH)};a.enable_simulation=function(a){(a=a.J)||ha.D("No object physics");if(!a.Uj){var b=a.ba,c=t(b);a.Uj=!0;G.ga(c,G.MH,b)}};a.disable_simulation=function(a){(a=a.J)||ha.D("No object physics");if(a.Uj){var b=a.ba,c=t(b);a.Uj=!1;G.ga(c,G.LH,b)}};a.Ft=function(a){return!!a.jc};a.ka=function(a){return!!a.J};a.has_dynamic_physics=function(a){return(a=
a.J)&&a.Uj&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.wh&&0==a.Is?!0:!1};a.has_simulated_physics=function(a){return(a=a.J)&&a.Uj?!0:!1};a.set_gravity=function(a,b){var c=a.J.ba;G.ga(t(c),G.bI,c,b)};a.CN=f;a.apply_constraint=F;a.clear_constraint=function(a){a=a.J;G.ga(t(a.ba),G.RH,a.xr);a.xr=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,g){c=Y.set_sep(c,1,d,ea);f=Y.set_sep(f,1,g,ra);Y.invert(c,c);Y.multiply(f,c,c);pa.get_tsr(e,f);Y.multiply(f,c,c);pa.set_tsr(b,c);pa.L(b);e=Y.get_trans_view(b.o.v);
f=Y.get_quat_view(b.o.v);a.set_transform(b,e,f)};a.set_transform=function(a,b,c){var d=a.J,e=G.gC(G.Nn),f=Y.ec(a.o.v,e.trans);a=Y.Qc(a.o.v,e.quat);Y.set_sep(f,1,a,d.Rv);e.ba=d.ba;U.copy(b,e.trans);V.copy(c,e.quat);G.ga(t(d.ba),G.Nn)};a.sync_transform=q;a.apply_velocity=function(a,b,c,d){var e=sa;E(a,b,c,d,e);a=a.J.ba;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var f=Math.abs(e[0]),g=Math.abs(e[1]),h=Math.abs(e[2]);e[0]=f?e[0]/f*Math.max(f,b):0;e[1]=g?e[1]/g*Math.max(g,c):0;e[2]=h?e[2]/h*Math.max(h,
d):0;G.ga(t(a),G.Qz,a,e[0],e[1],e[2])};a.apply_velocity_world=function(a,b,c,d){a=a.J.ba;G.ga(t(a),G.Qz,a,b,c,d)};a.apply_force=function(a,b,c,d,e){var f=sa;e?(f[0]=b,f[1]=c,f[2]=d):E(a,b,c,d,f);a=a.J.ba;G.ga(t(a),G.DH,a,f[0],f[1],f[2])};a.apply_torque=function(a,b,c,d){var e=sa;E(a,b,c,d,e);a=a.J.ba;G.ga(t(a),G.FH,a,e[0],e[1],e[2])};a.set_character_move_dir=function(a,b,c){a=a.J.ba;G.ga(t(a),G.WH,a,b,c)};a.set_character_move_type=function(a,b){var c=a.J.ba;G.ga(t(c),G.XH,c,b)};a.set_character_walk_velocity=
function(a,b){var c=a.J.ba;G.ga(t(c),G.aI,c,b)};a.set_character_run_velocity=function(a,b){var c=a.J.ba;G.ga(t(c),G.ZH,c,b)};a.set_character_fly_velocity=function(a,b){var c=a.J.ba;G.ga(t(c),G.UH,c,b)};a.character_jump=function(a){a=a.J.ba;G.ga(t(a),G.HH,a)};a.character_rotation_inc=function(a,b,c){a=a.J.ba;G.ga(t(a),G.IH,a,b,c)};a.set_character_rotation=function(a,b,c){a=a.J.ba;G.ga(t(a),G.YH,a,b,c)};a.set_character_rotation_h=function(a,b){var c=a.J.ba;G.ga(t(c),G.VH,c,b)};a.set_character_rotation_v=
function(a,b){var c=a.J.ba;G.ga(t(c),G.$H,c,b)};a.append_collision_test=function(a,b,c,d){var e=a.J;if(!e.Cp){for(var f=e.ba,h=0;h<e.ue.length;h++)if(a=e.ue[h],a.Tb==b&&a.callback==c)return;a={jv:f,ah:d||!1,Tb:b,callback:c,Kj:[],Gp:[]};e.ue.push(a);b=t(f);J(a,g(b),b)}};a.remove_collision_test=function(a,b,c){a=a.J;for(var d=t(a.ba),f=g(d),h=0;h<a.ue.length;h++){var l=a.ue[h];if(l.Tb==b&&l.callback==c){if(e(l)){var k=U.set(0,0,0,sa);l.callback(!1,null,k,k,0)}a.ue.splice(h,1);h--;for(var k=d,l=l.Kj,
m=f.jc.ra,n=0;n<m.length;n++)for(var p=m[n].J,q=0;q<p.ue.length;q++)for(var v=p.ue[q],N=0;N<v.Kj.length;N++)for(var u=v.Kj[N],w=0;w<l.length;w++){var x=l[w];u[0]==x[0]&&u[1]==x[1]&&(l.splice(w,1),w--)}l.length&&G.ga(k,G.Pz,l)}}};a.apply_collision_impulse_test=function(a,b){a.J&&a.J.Ak&&I(a);var c=a.J;G.ga(t(c.ba),G.EH,c.ba);c.Ak=b};a.clear_collision_impulse_test=I;a.append_ray_test=function(a,b,c,d,e,f,h,l,k){var m;wa.ND++;m=wa.ND;a={id:m,ba:a?a.J.ba:0,from:new Float32Array(b),to:new Float32Array(c),
Tb:d,Co:w(d),mA:f,AJ:h,ah:l,As:k,callback:e};b=t(a.ba)||ma[0];c=g(b).jc;c.Nj[m]=a;c.Vx.push(a);G.ga(b,G.AH,a.id,a.ba,a.from,a.to,a.Co,a.mA,a.AJ,a.ah,a.As);return m};a.remove_ray_test=C;a.change_ray_test_from_to=function(a,b,c){var d=l(a),e=v(a).jc.Nj[a];e&&!e.mA&&(e.from.set(b),e.to.set(c),G.ga(d,G.GH,a,b,c))};a.KC=function(a){return v(a).jc.Nj[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.I;c.nm=b;z(a,c,t(a.J.ba))};a.vehicle_steer=function(a,b){var c=a.I;c.hn=b;z(a,c,t(a.J.ba))};a.vehicle_brake=
function(a,b){var c=a.I;c.mo=b;z(a,c,t(a.J.ba))};a.is_vehicle_chassis=H;a.is_vehicle_hull=p;a.yU=Q;a.MN=function(a){if(!a.Ce)return!1;a=a.Le.Fe;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.LN=function(a){return a.Ce?"BOB"==a.Le.Fe?!0:!1:!1};a.ON=function(a){return a.bl?"BOB"==a.rm.Fe?!0:!1:!1};a.MC=function(a){return a.Ce&&"STEERING_WHEEL"==a.Le.Fe?!0:!1};a.LC=function(a){return a.Ce&&"SPEEDOMETER"==a.Le.Fe?!0:!1};a.NC=function(a){return a.Ce&&
"TACHOMETER"==a.Le.Fe?!0:!1};a.get_vehicle_speed=function(a){return a.I.speed};a.AS=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.tC=function(a){return a.J&&a.J.is_character};a.xU=y;a.gN=function(){return P};a.FL=function(){for(var a=0;a<ma.length;a++)G.ga(ma[a],G.KH)};a.remove_object=function(a){var b=a.J.ba;if("BOUNDING"==a.J.type){var c=da.indexOf(a);-1==c&&X.error("Object "+a.name+" doesn't have bounding physics");
delete ka[b];da.splice(c,1)}for(var c=t(b),d=g(c),f=d.jc.ra,h=[],l=0;l<f.length;l++)for(var k=f[l].J,m=0;m<k.ue.length;m++)for(var n=k.ue[m],p=0;p<n.Kj.length;p++){var q=n.Kj[p],v=n.Gp[p];if(q[0]==b||q[1]==b)n.Kj.splice(p,1),n.Gp.splice(p,1),p--,v&&!e(n)&&(v=U.set(0,0,0,sa),n.callback(!1,null,v,v,0)),h.push(q)}h.length&&G.ga(c,G.Pz,h);a.J&&a.J.Ak&&I(a);a=d.jc.ra;for(d=0;d<a.length;d++)a[d].J.ba==b&&(a.splice(d,1),d--);G.ga(c,G.QH,b)}};b4w.module.__data=function(a,r){function d(a,b){Ma[b.id]=null;za[b.id]=null}function c(a,b,c,d){a instanceof ArrayBuffer?(a=O.pC(a,d),d=a.width,a=a.height):(d=a.width,a=a.height);N.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(Oa)&&c&&N.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){(d=b.xg)||ja.D("Nothing requested");sa.enqueue([{id:d,type:sa.AT_JSON,url:d,Bg:b.wj}],function(d,f,g,h){if(d){N.log("%cLOAD METADATA","color: #616",
h);f=ja.SE(d.b4w_format_version);switch(ja.SF(f,ya.jl)){case -1:f[0]<ya.jl[0]?ja.D("JSON version is too old relative to B4W engine: "+ja.dk(f)+", required: "+ja.dk(ya.jl)+". Reexport scene with the latest B4W addon to fix it."):N.warn("JSON version is a bit old relative to B4W engine: "+ja.dk(f)+", required: "+ja.dk(ya.jl)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>ya.jl[0]?ja.D("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
N.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ya.fx=f;for(var l in d)a[l]=d[l];b.Eb&&($a=Ba.Ur(a.scenes));(d=a.binaries[0].binfile)?b.wA=d:(K.Nt(b,"load_binaries"),K.Nt(b,"prepare_bindata"));ya.is_mobile_device||K.Nt(b,"mobile_media_start");ya.antialiasing&&ya.smaa||K.Nt(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)l=a.b4w_export_errors[d],(b.Eb&&"PRIMARY"==l.type||
"ALL"==l.type)&&N.bM(l.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)l=a.b4w_export_warnings[d],(b.Eb&&"PRIMARY"==l.type||"ALL"==l.type)&&N.cM(l.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.wj&&E(a);e(b,c)}else K.Wz(b)},null,function(a){f(b,c,a)})}function g(a,b,c,d,e,f){(d=W(b.xg)+b.wA)||ja.D("Binary data is missing");sa.enqueue([{id:d,
type:sa.AT_ARRAYBUFFER,url:d,Bg:b.wj}],function(d,f,g,h){d?(N.log("%cLOAD BINARY","color: #616",h),a.bin_data=d,f=(new Uint32Array(d,4,1))[0],d=(new Uint32Array(d,8,1))[0],d=[f,d],f=ja.SE(a.b4w_format_version),d[0]!=f[0]&&ja.D("BIN version does not match to JSON version: "+ja.dk(d)+", required: "+ja.dk(ya.jl)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&N.warn("BIN version does not match to JSON version: "+ +ja.dk(d)+", required: "+ja.dk(ya.jl)+". Some compatibility issues can occur. Reexport scene to fix it."),
e(b,c)):K.Wz(b)},null,function(a){f(b,c,a)})}function n(a,b,c,d,e){kb.SA()&&e(b,c)}function x(a,b,c,d,f){d=a.bin_data;var g=a.binaries[0],h=a.objects,l=a.meshes;a=a.actions;for(var k=ja.XJ(),m=["indices"],n=["position","texcoord","texcoord2","shade_tangs"],N=["normal","tangent"],p=["group"],q=["color"],t=0;t<l.length;t++)for(var v=l[t].submeshes,u=0;u<v.length;u++){for(var w in v[u]){var x=v[u][w][1];if(-1!=m.indexOf(w)){var y=v[u][w][0]*ja.zz+g["int"]+12,K=v[u],r=w,L=d;if(k)var z=new Uint32Array(L,
y,x);else for(var z=new Uint32Array(x),L=new DataView(L),D=0;D<x;D++)z[D]=L.getUint32(y+D*ja.zz,!0);K[r]=z}else if(-1!=n.indexOf(w))y=v[u][w][0]*ja.Oh+g["float"]+12,v[u][w]=e(d,y,x,k);else if(-1!=N.indexOf(w)){y=v[u][w][0]*ja.Pn+g["short"]+12;K=v[u];r=w;L=d;z=new Float32Array(x);L=new DataView(L);for(D=0;D<x;D++)z[D]=L.getInt16(y+D*ja.Pn,!0)/32767;K[r]=z}else if(-1!=p.indexOf(w)){y=v[u][w][0]*ja.Pn+g.ushort+12;K=v[u];r=w;L=d;z=new Float32Array(x);L=new DataView(L);for(D=0;D<x;D++)z[D]=L.getUint16(y+
D*ja.Pn,!0)/65535;K[r]=z}else if(-1!=q.indexOf(w)){y=v[u][w][0]*ja.Cu+g.uchar+12;K=v[u];r=w;L=d;z=new Float32Array(x);L=new DataView(L);for(D=0;D<x;D++)z[D]=L.getUint8(y+D*ja.Cu)/255;K[r]=z}}x=v[u];if(l[t].b4w_shape_keys.length)for(y=x.base_length,K=x.normal.length/y/3,x.tbn_quat=ja.gen_tbn_quats(x.normal.subarray(0,3*y),x.tangent.subarray(0,4*y),new Float32Array(x.normal.length/3*4)),r=1;r<K;r++)for(L=r*y,z=0;z<y;z++){var B=x.normal.subarray(3*z,3*(z+1)),D=R.add(x.normal.subarray(3*(L+z),3*(L+z+
1)),B,wb);if(x.tangent.length)var E=x.tangent.subarray(4*z,4*(z+1)),A=Da.add(x.tangent.subarray(4*(L+z),4*(L+z+1)),E,xb),B=ja.lC(B,E,Ua),D=ja.lC(D,A,xc),A=qa.invert(B,Ua),D=qa.multiply(D,A,Ua);else D=qa.rotationTo(B,D,Ua);x.tbn_quat.set(D,4*(L+z))}else x.tbn_quat=ja.gen_tbn_quats(x.normal,x.tangent);"texcoord2"in v[u]&&(x=new Float32Array(v[u].texcoord.length+v[u].texcoord2.length),x.set(v[u].texcoord),x.set(v[u].texcoord2,v[u].texcoord.length),v[u].texcoord=x,delete v[u].texcoord2)}for(w=0;w<h.length;w++)for(l=
h[w].particle_systems,m=0;m<l.length;m++)n=l[m],n.transforms=e(d,n.transforms[0]*ja.Oh+g["float"]+12,n.transforms[1],k);for(h=0;h<a.length;h++){w=a[h];l=w.fcurves;m=w.frame_range;N=m[0];p=m[1];q=wa.SM(N,p);m=null;0>q&&(q=0);var v=t=!1,F;for(F in l)t|=-1<F.indexOf("rotation_euler"),v|=-1<F.indexOf("rotation_quaternion");n=[];for(F in l)if(t&&v&&-1<F.indexOf("rotation_euler"))delete l[F];else{var u=l[F],C;for(C in u)x=u[C],y=e(d,g["float"]+x.bin_data_pos[0]*ja.Oh+12,x.bin_data_pos[1],k),K=new Float32Array(q),
m||(m=new Int8Array(q)),wa.aJ(x,y,K,m,N,p),x.Te=K;-1<F.indexOf("rotation_euler")&&(wa.kM(l[F]),n.push(F))}for(N=0;N<n.length;N++)p=n[N],q=p.replace("euler","quaternion"),l[q]=l[p],delete l[p];w.rI=m}f(b,c)}function e(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+e*ja.Oh,!0)}return d}function u(a,b,c,d,e){var g=a.cameras,n=a.groups,p=a.materials,q=a.meshes,t=a.node_groups,u=a.objects,qa=a.particles,w=a.scenes,x=a.speakers,
y=a.lamps,K=a.textures,z=a.worlds;t||(N.warn('"node_groups" datablock undefined. reexport main scene.'),t=a.node_groups=[]);for(var r="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),D={},B=0;B<r.length;B++)for(var R=a[r[B]],A=0;A<R.length;A++){var F=R[A];D[F.uuid]=F}for(var C=0;C<w.length;C++){for(var na=w[C],I=na.objects,ia=0;ia<I.length;ia++)l(I,ia,D);na.camera&&l(na,"camera",D);na.world&&l(na,
"world",D)}for(C=0;C<n.length;C++)for(var G=n[C].objects,ia=0;ia<G.length;ia++)l(G,ia,D);for(C=0;C<u.length;C++){var Q=u[C];Q.dupli_group&&l(Q,"dupli_group",D);Q.parent&&l(Q,"parent",D);Q.dg_parent&&l(Q,"dg_parent",D);if(Q.animation_data){var H=Q.animation_data;H.action&&l(H,"action",D);if(H.nla_tracks)for(ia=0;ia<H.nla_tracks.length;ia++)for(var ba=H.nla_tracks[ia],J=0;J<ba.strips.length;J++)ba.strips[J].action&&l(ba.strips[J],"action",D)}switch(Q.type){case "MESH":Q.data||ja.D("mesh not found for object "+
Q.name);l(Q,"data",D);for(var Ca=!1,T=Q.modifiers,ia=0;ia<T.length;ia++){var X=T[ia];"ARMATURE"==X.type?(Ca&&N.warn('Object "'+Q.name+'" has more than one armature modifiers. Only the first one will be used.'),Ca=!0,l(X,"object",D)):"CURVE"==X.type&&l(X,"object",D)}var M=Q.particle_systems;if(M)for(ia=0;ia<M.length;ia++)l(M[ia],"settings",D);break;case "ARMATURE":l(Q,"data",D);for(var P=Q.pose.bones,Y=Q.data.bones,ia=0;ia<P.length;ia++){var ta=P[ia];ta.bone=Y[ta.bone];var sa=ta.constraints;if(sa)for(J=
0;J<sa.length;J++){var Sa=sa[J];Sa.target&&l(Sa,"target",D)}for(var Ea=ta.parent_recursive,J=0;J<Ea.length;J++)Ea[J]=P[Ea[J]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":l(Q,"data",D)}if(sa=Q.constraints)for(ia=0;ia<sa.length;ia++)Sa=sa[ia],Sa.target&&l(Sa,"target",D);var pa=Q.lod_levels;if(pa)for(ia=0;ia<pa.length;ia++){var aa=pa[ia];aa.object&&l(aa,"object",D)}}for(C=0;C<q.length;C++)for(var Da=q[C].materials,ia=0;ia<Da.length;ia++)l(Da,ia,D);for(C=0;C<p.length;C++){for(var S=p[C],
Oa=S.texture_slots,ia=0;ia<Oa.length;ia++)l(Oa[ia],"texture",D);var O=S.node_tree;O&&v(O,D)}for(C=0;C<t.length;C++)(O=t[C].node_tree)&&v(O,D);for(C=0;C<K.length;C++){var ya=K[C],Aa=ya.type;"IMAGE"!=Aa&&"ENVIRONMENT_MAP"!=Aa||l(ya,"image",D)}for(C=0;C<g.length;C++){var ab=g[C];ab.dof_object&&l(ab,"dof_object",D)}for(C=0;C<x.length;C++){var Z=x[C];Z.sound&&l(Z,"sound",D);if(Z.animation_data&&(H=Z.animation_data,H.action&&l(H,"action",D),H.nla_tracks))for(ia=0;ia<H.nla_tracks.length;ia++)for(ba=H.nla_tracks[ia],
J=0;J<ba.strips.length;J++)ba.strips[J].action&&l(ba.strips[J],"action",D)}for(C=0;C<qa.length;C++){for(var Ua=qa[C],Oa=Ua.texture_slots,ia=0;ia<Oa.length;ia++)l(Oa[ia],"texture",D);Ua.dupli_group&&l(Ua,"dupli_group",D);Ua.dupli_object&&l(Ua,"dupli_object",D)}for(C=0;C<y.length;C++){var Bb=y[C];if(Bb.animation_data&&(H=Bb.animation_data,H.action&&l(H,"action",D),H.nla_tracks))for(ia=0;ia<H.nla_tracks.length;ia++)for(ba=H.nla_tracks[ia],J=0;J<ba.strips.length;J++)ba.strips[J].action&&l(ba.strips[J],
"action",D)}for(C=0;C<z.length;C++){var Xa=z[C];if(Oa=Xa.texture_slots)for(ia=0;ia<Oa.length;ia++)l(Oa[ia],"texture",D);if(Xa.animation_data&&(H=Xa.animation_data,H.action&&l(H,"action",D),H.nla_tracks))for(ia=0;ia<H.nla_tracks.length;ia++)for(ba=H.nla_tracks[ia],J=0;J<ba.strips.length;J++)ba.strips[J].action&&l(ba.strips[J],"action",D)}Ta.TJ(a);E(a);for(var U=W(b.xg),ea=a.textures,Hb=b.Eb?a.scenes[0].b4w_anisotropic_filtering:$a.b4w_anisotropic_filtering,la=0;la<ea.length;la++){var Ma=ea[la];b.Eb||
"SCENE"!=Ma.b4w_source_type||(Ma.b4w_source_id="");var ma=Ra.vL(Ma,Hb,a.scenes,b.id,U);Ma.F=ma}for(var fa={},ha=a.objects,wb=0;wb<ha.length;wb++){var xb=ha[wb];if("MESH"===xb.type&&!xb.particle_systems.length)for(var qb=xb.data,ga=qb.name,ca=qb.submeshes,da=qb.materials,kb=0;kb<ca.length;kb++)0!==ca[kb].base_length||fa[ga]||(da[kb]&&N.warn('material "'+da[kb].name+'" is not assigned to any face (object "'+xb.name+'").'),fa[ga]=!0)}var Fa=a.materials,ka=Ta.MK();Fa.push(ka);for(var Rc=a.meshes,db=ja.keysearch("name",
"DEFAULT",a.materials),Ha=0;Ha<Rc.length;Ha++){var eb=Rc[Ha];0==eb.materials.length&&eb.materials.push(db)}for(var dc=a.actions,va=b.id,kc=0;kc<dc.length;kc++){var ra=dc[kc];ra.sI=va;wa.CI(ra)}for(var oa=a.scenes,xc=0;xc<oa.length;xc++){for(var Va=oa[xc],lb=[],xa=[],Ia=oa[xc].objects,Ya=0;Ya<Ia.length;Ya++)V(Ia,Ia[Ya],null,lb,xa);for(Ya=0;Ya<xa.length;Ya++)for(var Cb=xa[Ya],Wa=[Va],Mb=0;Mb<Wa.length;Mb++){for(var Nb=Wa[Mb].objects,Wc=0;Wc<Nb.length;Wc++){var Oc=Nb[Wc].dupli_group;Oc&&L(Cb,Oc)}var vc=
Nb.indexOf(Cb);-1<vc&&Nb.splice(vc,1)}for(Ya=0;Ya<lb.length;Ya++)ja.XI(lb[Ya][0],lb[Ya][1])}!b.Eb&&1<a.scenes.length&&(a.scenes=[Ba.Ur(a.scenes)],N.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var md=b.Eb?$a:Ba.Ur(a.scenes);La.iQ($a.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf($a),1),a.scenes.unshift($a));for(var cd=0;cd<a.scenes.length;cd++){var pc=a.scenes[cd];pc.F={};pc.Uz=pc==md;pc.tI=b.Eb;Qa.enabled&&pc.b4w_enable_physics&&(b.Eb||!Ga.Ft($a)&&
pc==Ba.Ur(a))&&Ga.HN(pc)}for(var ic=0;ic<a.scenes.length;ic++){for(var Tb=a.scenes[ic],wc=m(Tb),nd=0;nd<wc.length;nd++){var jc=wc[nd];ua.UJ(jc,Tb,a)&&(jc.Mc||(jc.Mc=[]),jc.Mc.push(b.Eb?Tb:$a))}for(var od=wc,pd=0;pd<od.length;pd++){var dd=od[pd];if(dd.Mc&&"WORLD"!=dd.type)for(var qd=dd.particle_systems,xd=0;xd<qd.length;xd++){var ed=qd[xd].settings;if("HAIR"==ed.type)if("OBJECT"==ed.render_type){var fd=ed.dupli_object;fd.Mc||(fd.Mc=dd.Mc.slice())}else if("GROUP"==ed.render_type)for(var Bd=ed.dupli_group,
td=0;td<Bd.objects.length;td++)fd=Bd.objects[td],fd.Mc||(fd.Mc=dd.Mc.slice())}}}for(var yd=a.scenes,ud=[],pb=0;pb<yd.length;pb++)k(yd[pb].objects,0,b.Eb,ud);za[b.id]=[];for(pb=0;pb<ud.length;pb++)for(var jd=ud[pb],Xc=0;Xc<jd.length;Xc++)for(var kd=jd[Xc],vd=0;vd<kd.length;vd++)za[b.id].push(kd[vd]);for(var rd=a.particles,pb=0;pb<rd.length;pb++){var gd=rd[pb].dupli_object;gd&&(gd.Tz=!0,za[b.id].push(gd));var zd=rd[pb].dupli_group;if(zd)for(var Ld=zd.objects,Xc=0;Xc<Ld.length;Xc++)gd=Ld[Xc],gd.Tz=!0,
za[b.id].push(gd)}for(var Dd=za[b.id],pb=Dd.length-1;0<=pb;pb--)Dd[pb].Mc||Dd.splice(pb,1);for(var Md=za[b.id],ic=0;ic<Md.length;ic++)if(jc=Md[ic],!b.Eb&&jc.parent&&-1<Yc.indexOf(jc.parent.type)&&(jc.parent=""),"MESH"==jc.type){var Ed=Ta.$I(jc);Ed&&(a.meshes.push(Ed),jc.data=Ed)}for(var Pc=0;Pc<a.scenes.length;Pc++){var Nd=a.scenes[Pc],Fd=Nd.world;Fd.Mc||(Fd.Mc=[]);Fd.Mc.push(b.Eb?Nd:$a)}for(var Gd=[],Pc=0;Pc<a.worlds.length;Pc++){var Cd=a.worlds[Pc];Cd.Mc||Gd.push(Cd)}for(Pc=0;Pc<Gd.length;Pc++)Cd=
Gd[Pc],a.worlds.splice(a.worlds.indexOf(Cd),1);for(var Od=a.node_groups,Pd=a.materials,sd=0;sd<Od.length;sd++){var wd=Od[sd].node_tree;if(wd){var Ad=[];h(wd,Ad,!0);wd.Uu=Ad}}for(sd=0;sd<Pd.length;sd++)if(wd=Pd[sd].node_tree)Ad=[],h(wd,Ad,!1),wd.Uu=Ad;for(var Hd=0;Hd<a.scenes.length;Hd++){var Id=a.scenes[Hd];if(Id.b4w_use_logic_editor){var Qd=m(Id);Ta.eJ(Qd,Id)}}for(var Jd=0;Jd<a.scenes.length;Jd++){var Rd=a.scenes[Jd],Kd=b.Eb?Rd:$a;f(b.id,Kd,"SPEAKER").length&&!Kd.Dc&&Ka.iJ(Kd)}e(b,c)}function w(a,
b,c,d,e){d=W(b.xg);for(var f=[],g=[],h=0;h<a.speakers.length;h++){var l=a.speakers[h],k=l.sound.uuid;if(-1==g.indexOf(k)){g.push(k);switch(l.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var m=sa.AT_AUDIOBUFFER;break;case "BACKGROUND_MUSIC":m=sa.AT_AUDIO_ELEMENT}l=ja.zh(d+l.sound.filepath);Z(f,k,m,l,b.wj)}}f.length?sa.enqueue(f,function(){},function(){e(b,c)}):e(b,c)}function h(a,b,c){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d],f=e.type;if("GROUP"==f&&e.node_group){if(e=e.node_group.node_tree)if(c)h(e,
b,!0);else for(e=e.Uu,f=0;f<e.length;f++){var g=e[f];-1==b.indexOf(g)&&b.push(g)}}else-1!=Nb.indexOf(f)&&-1==b.indexOf(f)&&b.push(f)}}function m(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);B(a.objects,"ALL",b);return b}function B(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&b!=e.type||c.push(e);(e=e.dupli_group)&&B(e.objects,b,c)}}function k(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=da(g);e[h]=e[h]||[];(c||-1==Yc.indexOf(g.type))&&
-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&k(g.objects,b+1,c,d)}}function f(a,b,c){var d=[];a=za[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==c||"ALL"==c)for(var g=0;g<f.Mc.length;g++)b==f.Mc[g]&&d.push(f)}return d}function F(a,b,c,d,e){var f=za[b.id],g=a.worlds;d=b.id;for(var h=0;h<f.length;h++){for(var l=f[h],k=Ca.Mo(l.name,l.type,l.origin_name),m=0;m<l.Mc.length;m++)Ca.Xn(k,l.Mc[m]);l.Ua=k;ua.bk(l,k);k.o.ud=d;k.sp=l.Tz||!1}for(d=0;d<g.length;d++){h=g[d];l="%meta_world%"+h.name;
l=Ca.Mo(l,"WORLD",l);for(k=0;k<h.Mc.length;k++)Ca.Xn(l,h.Mc[k]);h.Ua=l;ua.bS(h,l)}d=ua.get_all_objects("ALL",b.id);for(h=0;h<f.length;h++)l=f[h],k=l.Ua,na.bk(l,k);for(h=0;h<g.length;h++)l=g[h],na.bk(l,l.Ua);b.Eb&&t(a,b.id);for(h=0;h<f.length;h++)l=f[h],k=l.Ua,k.sp||(ua.OR(l,k),fa.L(k));for(a=0;a<f.length;a++)if(g=f[a],h=g.Ua,Ca.is_mesh(h)||Ca.is_empty(h))if(l=g.lod_levels.length)for(k=h,h.o.Bm=!0,m=0;m<l;m++){var n=g.lod_levels[m].object;if(n){n=n.Ua;n.o.Bm=!0;n.o.Eg=h.o.Eg;k.o.De=g.lod_levels[m].distance;
n.o.Dg=g.lod_levels[m].distance;if(g.lod_levels[m+1])n.o.De=g.lod_levels[m+1].distance;else{n.o.De=Ca.Mn;break}k=n}else{k.o.De=g.lod_levels[m].distance;break}}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(g=a.er)){var g=g.o,h=a.o.Wh,l=[],p;for(p in h)k=h[p],l.push(4*k.Uv,4*k.Vh);g.Xs.push(l);g.dn.push(a.o)}f=p=-1;a=wa.fC();for(g=0;g<d.length;g++)h=d[g],l=h.o,Ca.is_mesh(h)&&l.xj&&(h=l.Fg,h>p&&(p=h),a>=h&&h>f&&(f=h));for(g=0;g<d.length;g++)h=d[g],l=h.o,Ca.is_mesh(h)&&l.xj&&(l.Qk=!0,p<a?l.Fg=p:l.Fg<=
a?l.Fg=f:(N.warn('too many bones for "'+h.name+'" / '+l.Fg+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),l.Fg=p,l.Qk=!1),l.Qk=l.Qk&&!ab.MB);for(p=0;p<d.length;p++)if(f=d[p],f.Ce)if(a=f.Le,"CHASSIS"==a.Fe){f.I={};f.I.cp=a.cp;f.I.no=a.no;f.I.Ey=a.Ey;f.I.Gy=a.Gy;f.I.Fy=a.Fy;f.I.oz=a.oz;f.I.cy=a.cy;f.I.mx=a.mx;f.I.nm=0;f.I.mo=1;f.I.hn=0;f.I.speed=0;f.I.vl=[];f.I.Qp=[];f.I.kn=null;h=(g=Ca.get_dg_parent(f))?Ca.sw(g,d):d;for(g=0;g<h.length;g++)l=
h[g],l.Ce&&(k=l.Le,Ga.MN(l)&&a.name==k.name?(k=Ga.AS(l.Le.Fe),f.I.vl[k]=l,f.I.Qp[k]=new Float32Array(8)):Ga.MC(l)&&a.name==k.name?(f.I.kn=l,f.I.jn=k.jn,f.I.nq=k.nq,f.I.qp=k.qp,k=Ha.invert(f.o.v,Ha.create()),l=Ha.multiply(k,l.o.v,k),f.I.RE=l,k=new Float32Array([1,0,0]),Ha.transform_dir_vec3(k,l,k),f.I.QE=k):Ga.LC(l)&&a.name==k.name?(f.I.wy=l,f.I.kq=k.kq,f.I.Jm=k.Jm,k=Ha.invert(f.o.v,Ha.create()),l=Ha.multiply(k,l.o.v,k),f.I.ME=l,k=new Float32Array([1,0,0]),Ha.transform_dir_vec3(k,l,k),f.I.LE=k):Ga.NC(l)&&
a.name==k.name&&(f.I.Hy=l,f.I.So=k.So,k=Ha.invert(f.o.v,Ha.create()),l=Ha.multiply(k,l.o.v,k),f.I.bF=l,k=new Float32Array([1,0,0]),Ha.transform_dir_vec3(k,l,k),f.I.aF=k));4!=f.I.vl.length&&ja.D("Not enough wheels for chassis "+f.name)}else if("HULL"==a.Fe)for(f.I={},f.I.vl=[],f.I.Qp=[],f.I.cp=a.cp,f.I.no=a.no,f.I.Ok=a.Ok,f.I.Nl=a.Nl,f.I.Ol=a.Ol,f.I.nm=0,f.I.mo=1,f.I.hn=0,f.I.speed=0,f.I.kn=null,h=(g=Ca.get_dg_parent(f))?Ca.sw(g,d):d,g=0;g<h.length;g++)l=h[g],l.Ce&&(k=l.Le,Ga.LN(l)&&a.name==k.name?
(f.I.vl.push(l),f.I.Qp.push(new Float32Array(8))):Ga.MC(l)&&a.name==k.name?(f.I.kn=l,f.I.jn=k.jn,f.I.nq=k.nq,f.I.qp=k.qp,k=Ha.invert(f.o.v,Ha.create()),l=Ha.multiply(k,l.o.v,k),f.I.RE=l,k=new Float32Array([1,0,0]),Ha.transform_dir_vec3(k,l,k),f.I.QE=k):Ga.LC(l)&&a.name==k.name?(f.I.wy=l,f.I.kq=k.kq,f.I.Jm=k.Jm,k=Ha.invert(f.o.v,Ha.create()),l=Ha.multiply(k,l.o.v,k),f.I.ME=l,k=new Float32Array([1,0,0]),Ha.transform_dir_vec3(k,l,k),f.I.LE=k):Ga.NC(l)&&a.name==k.name&&(f.I.Hy=l,f.I.So=k.So,k=Ha.invert(f.o.v,
Ha.create()),l=Ha.multiply(k,l.o.v,k),f.I.bF=l,k=new Float32Array([1,0,0]),Ha.transform_dir_vec3(k,l,k),f.I.aF=k));for(p=0;p<d.length;p++)if(f=d[p],f.bl&&(a=f.rm,"MAIN_BODY"==a.Fe))for(f.Df={},f.Df.Ok=a.Ok,f.Df.Nl=a.Nl,f.Df.Ol=a.Ol,f.Df.nr=[],g=(g=Ca.get_dg_parent(f))?Ca.sw(g,d):d,h=0;h<g.length;h++)l=g[h],l.bl&&(k=l.rm,Ga.ON(l)&&a.name==k.name&&(f.Df.nr.push(l),l.iv=l.rm.$E));e(b,c)}function t(a,b){for(var c=0;c<a.scenes.length;c++){for(var d=a.scenes[c],e=ua.Ib(d,"LAMP",b),f=Array(e.length),g=0;g<
e.length;g++)f[g]=g;f.sort(function(a,b){var c=e[a].nb,d=e[b].nb;return d.Hl&&d.Il&&(!c.Hl||!c.Il)||!c.Hl&&(d.Hl||!c.Il&&d.Il)?1:0});for(g=0;g<f.length;g++)Ca.oa(e[f[g]],d).Ap=g}}function q(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var g=a.scenes[d];g.Vi=g.camera.Ua}for(d=0;d<a.scenes.length;d++){var g=b.Eb?a.scenes[d]:$a,h=b.Eb?ua.Ib(g,"LAMP",b.id):ua.Ib(g,"LAMP",0),l=ua.Ib(g,"ALL",b.id),k=f(b.id,g,"MESH"),m=f(b.id,g,"EMPTY");b.Eb&&Ba.KI(g,l,h,k,m);for(var l=!1,n=0;n<m.length;n++)for(var p=m[n].Ua,
q=p.K,t=0;t<q.length;t++){var v=q[t].pb,u=Ba.yF(v,p);g.name==v.name&&(l=l||u)}b.Eb&&g.F.Bc&&!l&&N.warn('Scene "'+g.name+'" has water but has no wind. Using default settings.');m=[];Ba.set_active(g);ta.UB(g,k,h,m);n=f(b.id,g,"LINE");ta.MM(g,n);p=Ba.ks(g);if(b.Eb){l=g.F.Ot;n=g.world;if(l.TD||l.procedural_skydome)q=n.Ua,ta.QI(g,l,q),ta.Br(q,p,g);Ba.SB(g,p);(l=g.F.Gn)&&l.Aq&&ta.GI(g,n.Ua)}for(n=0;n<k.length;n++)ta.Br(k[n].Ua,p,g);for(n=0;n<m.length;n++)ta.Br(m[n],p,g),ua.VO(m[n]);l=ua.Ib(g,"ALL",b.id);
Ba.hA(g,l,h);for(n=0;n<l.length;n++)p=l[n],p.o.me&&!p.DC&&ua.update_boundings(p),Ca.$J(p)&&(p.kD=!0)}Ba.LI($a,a.textures,b.id);b.Eb&&$a.F.En.length&&(b.Lw=!0);e(b,c)}function E(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var d=a[c];d.jg="FILE"==d.source&&-1<d.filepath.indexOf(".dds")&&"dds"==ya.Ho?"dds":""}if((Xa.Tv||Xa.At)&&ya.GF)for(a=0;a<b.length;a++){for(var d=b[a],e=d.texture_slots,c=0;c<e.length;c++){var f=e[c],g=f.texture;if("IMAGE"==g.type||"ENVIRONMENT_MAP"==g.type){var h=
g.image;h&&!h.jg&&(f=!g.b4w_disable_compression&&!f.use_map_normal&&"ENVIRONMENT_MAP"!=g.type&&!g.b4w_shore_dist_map&&"MOVIE"!=h.source,J(h,f))}}if(c=d.node_tree)for(d=c.nodes,c=0;c<d.length;c++){e=d[c];f=!1;if("TEXTURE"==e.type){if((g=e.texture)&&(h=g.image)&&!h.jg&&(f=!g.b4w_disable_compression&&"MOVIE"!=g.image.source&&"ENVIRONMENT_MAP"!=g.type)){a:{f=e.outputs;for(e=0;e<f.length;e++)if(g=f[e],g.is_linked&&"Normal"==g.identifier){f=!0;break a}f=!1}f=!f}}else"TEX_IMAGE"==e.type?(h=e.image)&&!h.jg&&
(f="MOVIE"!=h.source):"TEX_ENVIRONMENT"==e.type&&(f=!1);h&&!h.jg&&J(h,f)}}}function J(a,b){-1<a.filepath.indexOf(".dds")?a.jg="dds":b?(a.jg=ya.Ho,a.filepath="dds"==ya.Ho?a.filepath+".dds":sa.gn(a.filepath)[0]+".pvr"):a.jg=""}function A(a,b,c,d,e){d=a.groups;for(var f=a.objects,g={},h={},l={},k={},m=0;m<d.length;m++){var n=d[m];g[n.uuid]=n;l[n.uuid]=n}for(m=0;m<f.length;m++)n=f[m],h[n.uuid]=n,k[n.uuid]=n;a=a.scenes;for(m=0;m<a.length;m++)I(a[m].objects,null,k,l,null);for(var N in l)N in g||d.push(l[N]);
for(N in k)N in h||f.push(k[N]);e(b,c)}function I(a,b,c,d,e){for(var f=[],g=0;g<a.length;g++){var h=a[g],l=c[h.uuid];if(h=l.proxy){b&&-1==f.indexOf(h.uuid)&&f.push(h.uuid);for(var k=c[h.uuid],m=k.constraints,h=0;h<m.length;h++){var n=ja.bh(m[h]);n.name=n.name+"_CLONE";l.constraints.push(n)}"b4w_proxy_inherit_anim"in l&&!l.b4w_proxy_inherit_anim||(l.animation_data&&(k.animation_data=ja.bh(l.animation_data)),k.b4w_use_default_animation=l.b4w_use_default_animation,k.b4w_auto_skel_anim=l.b4w_auto_skel_anim,
k.b4w_anim_behavior=l.b4w_anim_behavior,k.b4w_cyclic_animation=l.b4w_cyclic_animation)}}for(g=0;g<f.length;g++)l=ja.lN(a,f[g]),-1<l&&a.splice(l,1);f={};if(b)for(g=0;g<a.length;g++)h=a[g],l=c[h.uuid],m=ja.bh(l),k="origin_name"in l?l.origin_name:l.name,m.name=Ca.RB(b.name,k),m.origin_name=k,m.dg_parent={uuid:b.uuid},C(m),c[m.uuid]=m,f[h.uuid]=m.uuid,h.uuid=m.uuid,e&&e[l.uuid]&&(m.b4w_cluster_data=e[l.uuid]);for(g=0;g<a.length;g++)h=a[g],l=c[h.uuid],l.dupli_group&&(h=l.dupli_group,e=d[h.uuid],m=ja.bh(e),
m.name=ja.sq(e.name+"_CLONE"),m.uuid=ia.vC("Group"+m.name),d[m.uuid]=m,h.uuid=m.uuid,I(m.objects,l,c,d,l.b4w_cluster_data));if(b)for(g=0;g<a.length;g++){h=a[g];l=c[h.uuid];l.parent&&l.parent.uuid in f?l.parent.uuid=f[l.parent.uuid]:l.parent&&(N.warn("Object's \""+l.name+'" parent is not in dupli group. Disabling parenting.'),l.parent=null);m=l.constraints;for(h=0;h<m.length;h++)b=m[h],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=l.pose)for(d=b.bones,h=0;h<d.length;h++)if(e=
d[h].constraints)for(m=0;m<e.length;m++)b=e[m],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=l.modifiers;for(h=0;h<b.length;h++)d=b[h],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((l=l.lod_levels)&&l.length)for(h=0;h<l.length;h++)b=l[h],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var p in f)db[p]=f[p]}function C(a){a.uuid=ia.vC("Object"+a.name)}function v(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&
l(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in db&&(e.lamp.uuid=db[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&l(e,"node_group",b);"TEX_IMAGE"!=e.type&&"TEX_ENVIRONMENT"!=e.type||!e.image||l(e,"image",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];z(f,"from_node",c);z(f,"to_node",c);H(f,"from_socket",f.from_node.outputs);H(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&l(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=
c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&l(e.strips[f],"action",b)}function l(a,b,c){a[b]&&((c=c[a[b].uuid])||N.error("Dangling link found:",b,a),a[b]=c)}function z(a,b,c){c=ja.keysearch("name",a[b].name,c);a[b]=c}function H(a,b,c){c=ja.keysearch("identifier",a[b].identifier,c);a[b]=c}function p(a,b,d,e,f,g){var h=[],l={};e=a.images;for(var k=Ra.eC(),m=W(b.xg),n=0;n<e.length;n++){var p=e[n],q=p.uuid;if(q){var t=ja.zh(m+p.filepath),v=p.source;if("FILE"===v){var v=p.jg?sa.AT_ARRAYBUFFER:
sa.AT_IMAGE_ELEMENT,u=sa.gn(t),qa=u[1].toLowerCase();if(!sa.ZJ(qa)){N.error('image "'+p.name+'" has unsupported format or broken path.');continue}Xa.qx&&ya.use_min50&&("dds"==u[1]?(t=sa.gn(u[0]),t=t[0]+".min50."+t[1]+".dds"):t=u[0]+".min50."+u[1])}else if("MOVIE"===v)if(ya.bq)u=sa.gn(t),t=u[0]+".altconv.seq",v=sa.Kq;else{u=sa.gn(t);qa=u[1].toLowerCase();v=Ka.detect_video_container(qa);if(""==v){N.error("failed to load video file (unsupported format)",t);continue}t=v!=qa?u[0]+".altconv."+v:u[0]+"."+
u[1];v=sa.Lq}else{N.error('Image "'+p.name+'" has unsupported format "'+v+'".');continue}q in l||(l[q]=[]);for(u=0;u<k.length;u++)qa=k[u],(qa.zm==q&&qa.Vk==p.jg||b.wj)&&l[q].push(qa);l[q].length&&h.push({id:q,type:v,url:t,Bg:b.wj})}}if(h.length){var w=0;sa.enqueue(h,function(e,f,k,m){if(e){var n=k;if(!b.wj){f=l[f];for(n=0;n<f.length;n++){var p=f[n];if(k==sa.Kq)p.$p=e.zg,Ra.wq(p,e.images,b.id);else if(Ra.wq(p,e,b.id),"ENVIRONMENT_MAP"==p.source)for(p=0;p<a.scenes.length;p++)Ba.cz(a.scenes[p])}n=f[0].Vk}k==
sa.Lq||k==sa.Kq?(k==sa.Lq?(k=e.videoWidth,e=e.videoHeight):(k=e.images[0].width,e=e.images[0].height),N.log("%cLOAD VIDEO "+k+"x"+e,"color: #"+(2048<k||2048<e?"a00":1024<k||1024<e?"aa0":"0a0"),m),-1==m.indexOf(Oa)&&N.warn("video",m,"is not from app root.")):c(e,m,!0,n)}m=++w/h.length;g(b,d,m)},function(){N.log("%cLOADED ALL IMAGES","color: #0a0");f(b,d)})}else f(b,d)}function Q(a,b,c,d,e){a=Ba.xw();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var g=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&
(g=!1);na.TR(f,g,b.id)}}e(b,c)}function y(a,b,c,d,e,f){a=W(b.xg);var g=[],h={};d=ua.get_all_objects("ALL",b.id);for(var l=0;l<d.length;l++){var k=d[l];if(S(k)){var m=k.Y.Pi;"BACKGROUND_MUSIC"==Ka.zw(k)?(m=ja.mw(),b.Jw=!0):"NONE"!=Ka.zw(k)&&ya.Pw&&(b.Ow=!0);if(!(m in h)){h[m]=[];var n=ja.zh(a+k.Y.xg);switch(Ka.KE(k)){case Ka.Bu:var p=sa.AT_AUDIOBUFFER;break;case Ka.sz:p=sa.AT_AUDIO_ELEMENT}Z(g,m,p,n,b.wj)}h[m].push(k)}}if(g.length){var q=0;sa.enqueue(g,function(a,d,e,l){if(a)for(N.log("%cLOAD SOUND",
"color: #0aa",l),-1==l.indexOf(Oa)&&N.warn("sound",l,"is not from app root."),d=h[d],e=0;e<d.length;e++)Ka.ZR(d[e],a);a=++q/g.length;f(b,c,a)},function(){N.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)})}else e(b,c)}function Z(a,b,c,d,e){var f=sa.gn(d),g=f[1].toLowerCase(),h=Ka.detect_audio_container(g);""!=h?(d=h!=g?f[0]+".altconv."+h:f[0]+"."+f[1],a.push({id:b,type:c,url:d,Bg:e})):N.error("failed to load audio file (unsupported format)",d)}function S(a){return Ca.is_speaker(a)&&Ka.KE(a)!=Ka.uz}
function G(a,b,c){a=ua.Ib(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];Ca.is_speaker(d)&&(Ka.KN(d)||c)&&Ka.play_def(d)}}function D(a,b){for(var c=a.F.En,d=0;d<c.length;d++){var e=c[d].F;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=e.Iq||(Ra.reset_video(e),Ra.play_video(e))}}function X(a,b,c,d,e){na.start();N.log("%cSTART NLA","color: #0a0");e(b,c)}function V(a,b,c,d,e){for(var f=b.lod_levels.length,g=0;g<f;g++){var h=b.lod_levels[g],l=h.object;if(l){var k=ja.zo(l);k.name=b.name+
"_LOD_"+String(g+1);k.b4w_cluster_data=b.b4w_cluster_data;C(k);k.lod_levels=[];c&&(k.dg_parent=c);d.push([a,k]);e.push(l);h.object=k}}if(a=b.dupli_group)for(a=a.objects,c=0;c<a.length;c++)V(a,a[c],b,d,e)}function L(a,b){var c=b.objects,d=c.indexOf(a);-1<d&&c.splice(d,1);for(d=0;d<c.length;d++)(b=c[d].dupli_group)&&L(a,b)}function ba(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!Ga.cK(a.scenes[f])){d=!1;break}d&&(e(b,c),N.log("%cPHYSICS READY","color: #0a0"))}function pa(a,b,c,d,e){for(d=0;d<
a.scenes.length;d++){var f=a.scenes[d];if(b.Eb)var g=Ga.Ft(f);else g=Ga.Ft($a)||Ga.Ft(f),f=$a;if(Qa.enabled&&g)for(g=0;g<Mb.length;g++)for(var h=ua.Ib(f,Mb[g],b.id),l=0;l<h.length;l++){var k=h[l];k.o.ud==b.id&&(Ga.append_object(k,f),b.ZC&&Ga.ka(k)&&Ga.disable_simulation(k))}}e(b,c)}function Y(a,b,d,e,f){var g={};e=[];for(var h=a.scenes,l=0;l<a.scenes.length;l++){var k=h[l];if(k.F.Bc){var m=k.F.Bc.Tj;if(m&&"FILE"===m.source){var k=m.uuid,n=ja.zh(W(b.xg)+m.filepath);e.push({id:k,type:m.jg?sa.AT_ARRAYBUFFER:
sa.AT_IMAGE_ELEMENT,url:n});g[k]=m}}}e.length?sa.enqueue(e,function(a,d,e,f){if(a){c(a,f,!0);e=[];f=Ra.eC();for(var l=0;l<f.length;l++){var k=f[l];k.uri===d&&e.push(k)}for(d=0;d<e.length;d++)Ra.wq(e[d],a,b.id);for(d=0;d<h.length;d++)if(e=h[d],e.F.Bc&&(f=e.F.Bc.Tj,f===m)){var k=a,n=document.createElement("canvas");f=m.size[0];l=m.size[1];n.width=f;n.height=l;n=n.getContext("2d");n.drawImage(k,0,0);k=n.getImageData(0,0,f,l).data;n=new Float32Array(4);n[0]=1/16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;f*=
l;for(var l=new Float32Array(f),p=0;p<f;p++)l[p]=n[1]*k[4*p+2]+n[2]*k[4*p+3];e.F.ry=l}}else for(a=g[d],d=0;d<h.length;d++)e=h[d],f=e.F.Bc.Tj,f===a&&(e.F.Bc.Tj=null,N.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,d)}):f(b,d)}function ha(a,b,d,e,f){e=a.scenes[0];a=[];for(var g=[Fa.Rq,Fa.Qn,Fa.Sq,Fa.Pu],h=0;h<g.length;h++){var l=Ba.Aa(e,g[h]);l&&a.push(l)}if(a.length){e=[];h=sa.AT_IMAGE_ELEMENT;e.push({id:"SEARCH_TEXTURE",type:h,xg:ea.ge.smaa_search_texture_path});
e.push({id:"AREA_TEXTURE",type:h,url:ea.ge.smaa_area_texture_path});for(h=0;h<a.length;h++)if(g=a[h],g.type==Fa.Qn){a=g.Xa;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.to)var k=g.Ya;else if("u_area_tex"==g.to)var m=g.Ya;break}e.length?sa.enqueue(e,function(a,d,e,f){a&&(c(a,f,!1),d="SEARCH_TEXTURE"==d?k:m,d.source="IMAGE",Ra.wq(d,a,b.id),Ra.ky(d,Ra.P,Ra.P))},function(){f(b,d)}):f(b,d)}else f(b,d)}function U(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];b.Eb||(e=$a);for(var f=ua.Ib(e,
"LAMP",b.id),g=0;g<f.length;g++){var h=f[g];h.o.ud==b.id&&d.Xu.push({pb:e,obj:h})}f=ua.Ib(e,"ALL",b.id);for(g=0;g<f.length;g++)h=f[g],"LAMP"!=h.type&&h.o.ud==b.id&&(b.ZC&&Ca.is_mesh(h)&&Ba.uo(h,!0),d.Xu.push({pb:e,obj:h}))}}function ga(a,b,c,d,e,f){var g=d.Xu;e=d.rD;if(g.length){a=g[e].obj;var h=g[e].pb;e=Ca.oa(a,h);Ba.append_object(h,a);a.anchor&&!h.F.anaglyph_use&&va.append(a);d=++d.rD/g.length;g=e.bi;if(-1!=a.o.td&&g){var l=R.copy(a.o.gb.M,wb);Ba.xF(g,l)}g=a.Wp;if(g.length&&h.F.Eh)for(h=Ha.get_trans_view(a.o.v),
a=Ha.get_quat_view(a.o.v),e=e.Bh,l=0;l<e.length;l++)Ba.zF(e[l],h,a),Ca.AF(g,e[l].B.hc)}else d=1;f(b,c,d)}function ca(a,b,c,d,e){if(b.Eb){a=Ba.oh();Ba.cz(a);d=Ba.xw();for(var f=0;f<d.length;f++){var g=d[f];Ba.cz(g);Ba.pP(g,a)}Ba.set_active(a)}else Ba.BF($a);a=ua.get_all_objects("ALL",b.id);ua.PR(a);e(b,c)}function M(a,b,c,d,e){if(b.Eb)for(a=Ba.xw(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&Sa.FN(f,b.id)}e(b,c)}function la(a,b,c,d,e){if(b.Eb)for(d=0;d<a.scenes.length;d++)D(a.scenes[d],
b.id),G(a.scenes[d],b.id,!1);else D($a,b.id),G($a,b.id,!1);e(b,c)}function aa(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;ya.media_auto_activation&&(b.Lw||b.Jw||b.Ow)?eb||P(a,e,b,c):e(b,c)}function P(a,b,c,d){var e=Wa.parentElement;Ya=e.style.zIndex;e.style.zIndex="999";eb=document.createElement("div");eb.style.position="relative";eb.style.height="88px";eb.style.width="88px";var f=Math.round(Wa.offsetWidth/2-44);eb.style.top=Math.round(Wa.offsetHeight/2-44).toString()+"px";eb.style.left=
f.toString()+"px";eb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
eb.style.backgroundSize="88px";lb=document.createElement("div");lb.style.position="relative";lb.style.height=Wa.offsetHeight.toString()+"px";lb.style.width=Wa.offsetWidth.toString()+"px";lb.style.background="rgba(0, 0, 0, 0.5)";lb.style.zIndex="999";e.appendChild(lb);lb.appendChild(eb);Cb=function(){c.Lw&&(Ra.play(),Ra.pause(),Ra.reset());if(c.Jw){if(c.Eb)for(var e=0;e<a.scenes.length;e++)G(a.scenes[e],c.id,!0);else G($a,c.id,!0);Ka.pause()}c.Ow&&Ka.ED();ma();b(c,d)};oa.add_click_listener(eb,Cb)}
function ma(){if(eb){var a=Wa.parentElement;a.style.zIndex=Ya;oa.remove_click_listener(eb,Cb);lb.removeChild(eb);a.removeChild(lb);eb=lb=null;Ya=0}}function W(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ka(a){wa.is_animated(a)&&wa.remove(a);Aa.xP(a);ua.clear_outline_anim(a);ra.check_sensor_manifold(a)&&ra.remove_sensor_manifold(a);Ga.ka(a)&&Ga.remove_object(a);Ba.SD(a);Ca.is_speaker(a)&&Ka.TQ(a);va.is_anchor(a)&&va.remove(a)}function da(a){var b=wa.$B(a);return(a=b&&b.parent==
a?null:a.parent||b)?1+da(a):0}var va=r("__anchors"),wa=r("__animation"),sa=r("__assets"),ta=r("__batch"),ea=r("__config"),ra=r("__controls"),O=r("__texcomp"),Ia=r("__debug"),xa=r("__extensions"),oa=r("__input"),K=r("__loader"),ia=r("__md5"),na=r("__nla"),Sa=r("__logic_nodes"),Aa=r("__particles"),T=r("__nodemat"),ua=r("__objects"),Ca=r("__obj_util"),Ga=r("__physics"),N=r("__print"),qa=r("__quat"),Ta=r("__reformer"),Ea=r("__renderer"),Ba=r("__scenes"),Ka=r("__sfx"),kb=r("__shaders"),Fa=r("__subscene"),
Ra=r("__textures"),La=r("__time"),fa=r("__transform"),Ha=r("__tsr"),ja=r("__util"),R=r("__vec3"),Da=r("__vec4"),ab=ea.nk,ya=ea.H,Xa=ea.rd,Qa=ea.J,Bb=ea.Y,Ma=null,za=null,Oa="",$a=null,db={},wb=new Float32Array(3),xb=new Float32Array(4),Ua=new Float32Array(4),xc=new Float32Array(4),eb=null,lb=null,Ya=0,Va=!1,Cb=null,Yc=["LAMP","CAMERA"],Mb=["MESH","CAMERA","EMPTY"],Nb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],Wa=null;a.is_primary_loaded=function(a){return K.is_primary_loaded(a)};a.update=function(){K.UR(Ma)};
a.FQ=function(a){Wa=a};a.MR=function(a,b){if(eb){lb.style.height=b.toString()+"px";lb.style.width=a.toString()+"px";var c=Math.round(a/2-44);eb.style.top=Math.round(b/2-44).toString()+"px";eb.style.left=c.toString()+"px"}};a.load=function(a,c,e,f,h){var l={load_main:{Gb:K.cg,Lb:!1,inputs:[],Nb:!1,Pb:500,bc:!1,Sb:b},duplicate_objects:{Gb:K.Xd,Lb:!1,inputs:["load_main"],Nb:!1,Pb:50,bc:!1,Sb:A},load_binaries:{Gb:K.cg,Lb:!1,inputs:["load_main"],Nb:!1,Pb:500,bc:!1,Sb:g},wait_for_shaders:{Gb:K.Xd,Lb:!1,
inputs:[],Nb:!1,Pb:50,bc:!0,$i:n},prepare_bindata:{Gb:K.Xd,Lb:!1,inputs:["duplicate_objects","load_binaries"],Nb:!1,Pb:100,bc:!1,Sb:x},prepare_bpy_data:{Gb:K.Xd,Lb:!1,inputs:["duplicate_objects","prepare_bindata"],Nb:!1,Pb:100,bc:!1,Sb:u},process_objects:{Gb:K.Xd,Lb:!1,inputs:["prepare_bpy_data"],Nb:!1,Pb:150,bc:!1,Sb:F},process_scenes:{Gb:K.Xd,Lb:!1,inputs:["process_objects","wait_for_shaders"],Nb:!1,Pb:300,bc:!1,Sb:q},load_smaa_textures:{Gb:K.cg,Lb:!1,inputs:["process_scenes"],Nb:!1,Pb:30,bc:!0,
Sb:ha},load_shoremap:{Gb:K.cg,Lb:!1,inputs:["process_scenes"],Nb:!1,Pb:30,bc:!0,Sb:Y},load_images:{Gb:K.cg,Lb:!0,inputs:["process_scenes"],Nb:!0,Pb:500,bc:!1,Sb:p},update_scenes_nla:{Gb:K.Xd,Lb:!1,inputs:["process_scenes","load_images"],Nb:!1,Pb:50,bc:!1,Sb:Q},wait_physics_workers:{Gb:K.Xd,Lb:!1,inputs:["load_shoremap"],Nb:!1,Pb:20,bc:!1,$i:ba},add_physics_objects:{Gb:K.Xd,Lb:!1,inputs:["wait_physics_workers"],Nb:!1,Pb:50,bc:!1,Sb:pa},add_objects:{Gb:K.Xd,Lb:!1,inputs:["add_physics_objects"],Nb:!1,
Pb:600,bc:!1,Sb:U,$i:ga,qo:ca,ro:{Xu:[],rD:0}},init_logic_nodes:{Gb:K.Xd,Lb:!1,inputs:["update_scenes_nla","add_objects"],Nb:!1,Pb:50,bc:!1,Sb:M},load_speakers:{Gb:K.cg,Lb:!0,inputs:["add_objects"],Nb:!0,Pb:100,bc:!1,Sb:y},mobile_media_start:{Gb:K.Xd,Lb:!1,inputs:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Nb:!0,Pb:5,bc:!1,Sb:aa,$i:aa},synchronize_media:{Gb:K.Xd,Lb:!0,inputs:["mobile_media_start"],Nb:!0,Pb:50,bc:!1,Sb:la},start_nla:{Gb:K.Xd,Lb:!0,inputs:["mobile_media_start"],
Nb:!1,Pb:5,bc:!0,Sb:X}},k=K.yw();k||(k=K.iB(),Ma={},za={},db={});Ma[k.Qg.length]={};return K.nB(l,a,c,e,d,f||Bb.lA,ya.do_not_load_resources,h,!1)};a.unload=function(a){var b=K.yw();if(b&&b.Qg.length&&K.lR(b.Qg[a])){if(0==a)N.log("%cUNLOAD ALL","color: #00a"),va.cleanup(),wa.cleanup(),Ka.cleanup(),ta.cleanup(),Ba.cleanup(),K.cleanup(),ra.cleanup(),Ga.cleanup(),ua.cleanup(),ja.cleanup(),Ea.cleanup(),T.cleanup(),kb.cleanup(),xa.cleanup(),sa.cleanup(),Ra.cleanup(),Sa.cleanup(),Aa.cleanup(),oa.cleanup(),
Ia.cleanup(),za=null,db={},Ma=$a=null,Va=!1;else{N.log("%cUNLOAD DATA "+a,"color: #00a");wa.vP(a);for(var b=ua.get_all_objects("ALL",ua.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];Ca.get_object_data_id(d)!=a&&ua.kt(d,!1,!1,!1)}b=ua.get_all_objects("ALL",a);for(c=b.length-1;0<=c;c--)d=b[c],ka(d),ua.remove_object(d);b=ua.get_all_objects("ALL",ua.DATA_ID_ALL);for(c=0;c<b.length;c++)ua.kt(b[c],!0,!0,!0)}na.cleanup(a);ma()}else N.error("Unable to unload data!")};a.oP=ka;a.set_debug_resources_root=function(a){Oa=
a};a.activate_media=function(){Va||ya.media_auto_activation||(Ra.play(),Ra.pause(),Ra.reset(),G($a,ua.DATA_ID_ALL,!0),Ka.pause(),ya.Pw&&Ka.ED(),Va=!0)};a.reset=function(){Wa=null};a.prefetch=function(a,c,e){var f={load_main:{Gb:K.cg,Lb:!1,inputs:[],Nb:!1,Pb:500,bc:!1,Sb:b},load_binaries:{Gb:K.cg,Lb:!1,inputs:["load_main"],Nb:!1,Pb:500,bc:!1,Sb:g},load_images:{Gb:K.cg,Lb:!1,inputs:["load_main"],Nb:!1,Pb:500,bc:!1,Sb:p},preload_sounds:{Gb:K.cg,Lb:!1,inputs:["load_main"],Nb:!1,Pb:500,bc:!1,Sb:w}},h=
K.yw();h||(h=K.iB(),Ma={},za={},db={});Ma[h.Qg.length]={};return K.nB(f,a,c,e,d,!1,ya.do_not_load_resources,!1,!0)};a.unfetch=function(){sa.lK()}};b4w.module.__batch=function(a,r){function d(a){a={type:a,sb:"",id:0,ud:0,Ao:-1,Ej:"",Ir:-1,gm:-1,Qo:0,Xe:0,Ik:[],Sa:[],Ie:[],Ve:[],Jb:[],cj:[],Qi:null,Lc:{},ib:null,ab:{bg:null,Ae:null,ei:[],Rf:[],status:da.Su,kA:0,fF:0},Cj:"",ao:[],da:null,ne:ea.ej(),me:!1,di:!1,Jr:!1,num_vertices:0,num_triangles:0,Ms:0,Ns:0,yc:!1,ns:0,ji:0,hd:new Float32Array(3),$d:new Float32Array(16),kg:!1,yb:!1,Va:!1,Tg:!1,Qb:!1,le:!1,be:!1,ie:!1,Qd:!1,Gd:!1,Ed:!1,md:!1,ld:!1,Mr:!1,tg:ta.Tl,Pe:!1,Ff:!1,fj:!1,og:!1,De:M.Mn,Dg:0,
Eg:0,td:-1,jd:-1,ss:!1,ws:0,ts:0,xs:0,ys:0,vs:new Float32Array(3),us:new Float32Array(3),np:!1,lg:0,ug:0,jh:1,reflect_factor:0,Ei:0,Cl:1,parallax_scale:0,ih:0,xf:1,Pm:0,kl:0,Sf:0,Vm:0,$c:new Float32Array(2),Rd:new Float32Array(3),$f:new Float32Array(3),Yf:new Float32Array(3),xd:new Float32Array(4),bf:new Float32Array(4),el:null,Fm:null,xp:null,wp:null,qj:!1,wireframe_edge_color:ra.create(),Lh:!1,water_dynamic:!1,Fn:!1,wu:!1,xu:0,yu:0,vu:0,gk:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,
Yr:new Float32Array(2),Xr:new Float32Array(2),ap:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),vi:null,xi:!1,wa:null,Hm:0,lk:null,Jp:null,Gg:[],jf:[],Bd:[],hf:[],U:null,Pa:null,va:null,gb:null,jb:null,Z:null,Je:!1,Hd:null,Bf:!0,AC:0,Qm:new Float32Array(3)};a.xd[3]=1;a.Va=!0;a.Hm=1;return a}function c(a){var b=d(a.type);b.sb=a.sb;b.id=a.id;b.Ao=a.Ao;b.Ej=a.Ej;b.Ir=a.Ir;b.gm=a.gm;b.Qo=a.Qo;b.Xe=a.Xe;b.Ik=[];b.Sa=a.Sa.slice();b.Ie=a.Ie.slice();b.Ve=a.Ve.slice();
b.Jb=a.Jb.slice();b.cj=a.cj.slice();b.Qi=ea.S(a.Qi);b.Lc=ea.S(a.Lc);b.ib=a.ib;b.ab=ea.S(a.ab);b.Cj=a.Cj;b.ao=W.mK(a.ao);b.da=a.da;b.me=a.me;b.di=a.di;b.Jr=a.Jr;b.num_vertices=a.num_vertices;b.num_triangles=a.num_triangles;b.Ms=a.Ms;b.Ns=a.Ns;b.ns=a.ns;b.ji=a.ji;b.hd=a.hd;b.$d=a.$d;b.kg=a.kg;b.yb=a.yb;b.Va=a.Va;b.Tg=a.Tg;b.Qb=a.Qb;b.le=a.le;b.be=a.be;b.ie=a.ie;b.Qd=a.Qd;b.Gd=a.Gd;b.Ed=a.Ed;b.md=a.md;b.ld=a.ld;b.yc=a.yc;b.Mr=a.Mr;b.tg=a.tg;b.Pe=a.Pe;b.Ff=a.Ff;b.fj=a.fj;b.og=a.og;b.De=a.De;b.Dg=a.Dg;
b.Eg=a.Eg;b.td=a.td;b.jd=a.jd;b.ss=a.ss;b.ws=a.ws;b.ts=a.ts;b.xs=a.xs;b.ys=a.ys;ra.copy(a.vs,b.vs);ra.copy(a.us,b.us);b.np=a.np;b.lg=a.lg;b.ug=a.ug;b.jh=a.jh;b.reflect_factor=a.reflect_factor;b.Ei=a.Ei;b.Cl=a.Cl;b.parallax_scale=a.parallax_scale;b.ih=a.ih;b.xf=a.xf;b.Pm=a.Pm;b.kl=a.kl;b.Sf=a.Sf;b.Vm=a.Vm;b.$c[0]=a.$c[0];b.$c[1]=a.$c[1];ra.copy(a.Rd,b.Rd);ra.copy(a.$f,b.$f);ra.copy(a.Yf,b.Yf);O.copy(a.xd,b.xd);O.copy(a.bf,b.bf);b.el=ea.S(a.el);a.Fm&&(b.Fm=new Float32Array(a.Fm),b.xp=new Float32Array(a.xp),
b.wp=new Float32Array(a.wp));b.qj=a.qj;ra.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.Lh=a.Lh;b.water_dynamic=a.water_dynamic;b.Fn=a.Fn;b.wu=a.wu;b.xu=a.xu;b.yu=a.yu;b.vu=a.vu;b.gk=a.gk;b.shallow_water_col_fac=a.shallow_water_col_fac;b.shore_water_col_fac=a.shore_water_col_fac;b.foam_factor=a.foam_factor;b.Yr.set(a.Yr);b.Xr.set(a.Xr);b.ap.set(a.ap);ra.copy(a.shallow_water_col,b.shallow_water_col);ra.copy(a.shore_water_col,b.shore_water_col);b.vi=ea.S(a.vi);b.xi=a.xi;b.wa=ea.S(a.wa);b.Hm=
a.Hm;a.lk&&(b.lk=new Float32Array(a.lk));b.Jp=ea.S(a.Jp);b.Gg=ea.S(a.Gg);b.jf=ea.S(a.jf);b.Bd=ea.S(a.Bd);b.hf=ea.S(a.hf);b.U=ba.yk(a.U);b.Pa=ba.yk(a.Pa);b.Z=ba.yo(a.Z);b.jb=ba.yo(a.jb);b.va=ba.zk(a.va);b.gb=ba.zk(a.gb);b.Je=a.Je;b.Bf=a.Bf;b.Qm=a.Qm;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.sb=a.yb?a.Tg?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.sb=a.Qd?"CAST":"RECEIVE";break;case "COLOR_ID":a.sb=a.Tg?"COLOR_ID_XRAY":"COLOR_ID"}}function g(a,b,c){var f=[],
g=a.Ua,h=e(c,b,!b.jm,!1),k=a.data,m=k.materials,n=Array(m.length),N=Array(m.length),q=[],t=ka.dc(c,va.Db),v=!1;t&&(v=t.Bp.length?!0:!1);for(var w=0;w<h.length;w++)for(var x=h[w],qa=0;qa<m.length;qa++){var K=m[qa];if(!L(g,qa)&&!ta.uC(k,qa))if("PHYSICS"==x&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)q.push(ta.jw(k,qa,[],b.Wh,{},null));else if(!K.b4w_lens_flares||v){var D=d(x);"MAIN"==x?n[qa]=D:"DEBUG_VIEW"==x&&(N[qa]=D);D.Ao=a.b4w_cluster_data.cluster_id;if(Q(D,K)&&u(D,K)){"SHADOW"==x&&n[qa]&&
(D.le=n[qa].le);D.tg=b.me||b.be?ta.Nq:ta.Tl;I(D,b);for(var r=D,B=a.particle_systems,A=0;A<B.length;A++){var E=B[A].settings.b4w_vcol_from_name,C=B[A].settings.b4w_vcol_to_name;""!==E&&""!==C&&(r.Lc[E]={Sk:!1,src:[{name:E,Mf:7}]})}if("DYNAMIC"==b.type||"COLOR_ID"==D.type)D.Ej=V(D,b,a.uuid);D.fj=a.b4w_do_not_cull;"MAIN"==D.type&&(D.og=a.b4w_caustics);z(D,"DISABLE_FOG",("COLOR_ID"!=x&&"SHADOW"!=x&&a.b4w_disable_fogging)|0);var F=ta.jw(k,qa,D.cj,b.Wh,D.Lc,D.Qi);!K.use_tangent_shading||"a_shade_tangs"in
F.aa[0]||(z(D,"CALC_TBN",1),l(D,"a_tbn_quat"));K.b4w_lens_flares&&(F=la.nP(F));y(D);f.push({qa:D,Ee:b,jr:b,Hd:F,Nf:[K.name],nd:[a]})}}}if(q.length){D=d("PHYSICS");D.sb="NAVMESH";D.Ej=V(D,b,a.uuid);for(var F=ta.VE(q),na=[],w=0;w<m.length;w++)na.push(m[w].name);y(D);f.push({qa:D,Ee:b,jr:b,Hd:F,Nf:na,nd:[a]})}for(w=0;w<N.length;w++)N[w]&&(N[w].gm=n[w].id,y(N[w]));var ia=a.particle_systems;if(0<ia.length&&f.length){for(var G=!1,H=!1,w=0;w<ia.length;w++){var wa=ia[w],ba=wa.settings;ba.use_render_emitter&&
(G=!0);"HAIR"!=ba.type||"OBJECT"!=ba.render_type&&"GROUP"!=ba.render_type&&wa.transforms.length||(H=!0);if(G&&H)break}var J=f[0].qa.Lc,Ta;if(H){var Ca;if(1<m.length){for(var T={},X=0;X<ia.length;X++){var P=ia[X].settings;if("HAIR"==P.type&&("OBJECT"==P.render_type||"GROUP"==P.render_type)){var Ga=P.b4w_vcol_from_name,Sa=P.b4w_vcol_to_name;""!==Ga&&""!==Sa&&(T[Ga]=ea.S(J[Ga]))}}"a_bending_col_main"in J&&(T.a_bending_col_main=ea.S(J.a_bending_col_main));"a_bending_col_detail"in J&&(T.a_bending_col_detail=
ea.S(J.a_bending_col_detail));Ca=ta.HB(k,[],T)}else Ca=f[0].Hd;Ta=Ca}else Ta=null;for(var pa=Ta,aa=a.Ua,S=[],O=a.particle_systems,Aa=a.data,Z=0;Z<O.length;Z++){var W=O[Z],U=W.settings;if(U.count)if("EMITTER"==U.type){if("DYNAMIC"==b.type){var ha=d("PARTICLES");ha.va=b.va;ha.U=b.U;ha.Z=b.Z;ha.gb=b.gb;ha.Pa=b.Pa;ha.jb=b.jb;var ua,ga=W.settings.material-1;ga>=Aa.materials.length&&(Y.warn('Wrong material used for rendering particle system "'+W.name+'"'),ga=0);ua=ga;var ca=Aa.materials[ua];if(!L(aa,ua)&&
("HALO"===W.settings.render_type&&"HALO"===ca.type&&(ha.np=!0),u(ha,ca))){var oa=ha,xa=a,qc=W.settings;switch(qc.b4w_billboard_align){case "VIEW":z(oa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":z(oa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":z(oa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":z(oa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:ea.D("Wrong billboard align value")}z(oa,"BILLBOARD",0);var ec=qc.b4w_enable_soft_particles&&M.QA(xa,qc);z(oa,"SOFT_PARTICLES",
0<qc.b4w_particles_softness&&ec&&Ia.Lr?1:0);z(oa,"SOFT_STRENGTH",da.N(qc.b4w_particles_softness));da.ia(oa.ab,"WORLD_SPACE","WORLD"==qc.b4w_coordinate_system?1:0);ha.be=!0;ha.fj=a.b4w_do_not_cull;ha.Ej=V(ha,b,aa.name+"_"+U.uuid);la.GN(ha,W,ca);var rb=la.HM(ha,Aa,W,aa.o);la.SR(rb,ha,U.count);la.RR(aa);I(ha,aa.o);y(ha);S.push({qa:ha,Ee:b,jr:b,Hd:rb,Nf:[ca.name],nd:[a]})}}}else if("HAIR"==U.type){var rc=ea.Cs(W.seed),Ib=ma.RA(Ia.fx)&&!U.b4w_initial_rand_rotation&&!U.b4w_hair_billboard,ib=4;Ib&&(ib=8);
if(W.transforms.length)var bb=W.transforms;else for(var zc=ta.nw(pa,U.count,!1,rc),bb=new Float32Array(zc.length*ib),fb=0;fb<zc.length;fb++){var Zc=.75+.5*ea.Uf(rc);bb[fb*ib]=zc[fb][0];bb[fb*ib+1]=zc[fb][1];bb[fb*ib+2]=zc[fb][2];bb[fb*ib+3]=Zc;Ib&&(bb[fb*ib+4]=1,bb[fb*ib+5]=0,bb[fb*ib+6]=0,bb[fb*ib+7]=0)}var ld=ka.dc(c,va.Ph)?!0:!1;if("OBJECT"==U.render_type){var Ob=[e(c,U.dupli_object.Ua.o,!b.jm,!0)],$c=p(a,b,J,pa,[U.dupli_object],Ob,[bb],U,W,ld,rc,!1);S.push.apply(S,$c)}else if("GROUP"==U.render_type){for(var sc=
U.dupli_group.objects,Ob=[],fb=0;fb<sc.length;fb++){var Zb=e(c,sc[fb].Ua.o,!b.jm,!0);Ob.push(Zb)}for(var Tc=!1,Jb=[],fb=0;fb<sc.length;fb++)Jb.push(sc[fb].Ua);if(U.use_whole_group){for(var Vb,Kb=bb,lc=Jb,tc=Ib,id=ib,yb={},Za=new Float32Array([0,0,0,1]),gb=0;gb<Kb.length;gb+=id)for(var cb=0;cb<lc.length;cb++){var fc=ra.create(),Ac=sa.get_scale(lc[cb].o.v),Uc=sa.get_trans_view(lc[cb].o.v);ra.scale(Uc,Ac,fc);var mc=ra.clone([Kb[gb],Kb[gb+1],Kb[gb+2]]);yb[cb]||(yb[cb]=new Float32Array(Kb.length));tc&&
(yb[cb][gb+4]=Za[0]=Kb[gb+4],yb[cb][gb+5]=Za[1]=Kb[gb+5],yb[cb][gb+6]=Za[2]=Kb[gb+6],yb[cb][gb+7]=Za[3]=Kb[gb+7],ea.Sx(Za,Za),ea.pR(fc,Za,fc));ra.add(mc,fc,mc);yb[cb][gb]=mc[0];yb[cb][gb+1]=mc[1];yb[cb][gb+2]=mc[2];yb[cb][gb+3]=Kb[gb+3]}Vb=yb;Tc=!0}else{var Bc;if(U.use_group_count){for(var Rb=bb,Cc=Jb,Dc=U.dupli_weights,gc=rc,Wb=Ib,$b=ib,sb={},tb=[],mb=0;mb<Cc.length;mb++)for(var Ic=Cc[mb],ad=Ic.Cd||Ic.name,ub=0;ub<Dc.length;ub++){var Db=Dc[ub];ad==Db.name&&tb.push(Db)}Dc.length!=tb.length&&Y.error("dupli weights match failed");
for(mb=0;mb<Rb.length;mb+=$b){for(var vb,Jc=tb,Na=[0],hb=0;hb<Jc.length;hb++)Na[hb+1]=Na[hb]+Jc[hb].count;for(var zb=Na[Na.length-1]*ea.Uf(gc),hc=0,hb=0;hb<Na.length;hb++)if(zb>=Na[hb]&&zb<Na[hb+1]){hc=hb;break}vb=hc;sb[vb]=sb[vb]||[];sb[vb].push(Rb[mb],Rb[mb+1],Rb[mb+2],Rb[mb+3]);Wb&&sb[vb].push(Rb[mb+4],Rb[mb+5],Rb[mb+6],Rb[mb+7])}for(vb in sb)sb[vb]=new Float32Array(sb[vb]);Bc=sb}else{for(var Ja=bb,ac=rc,Lb=Ib,Eb=ib,jb=Jb.length,Pb={},Ab=0;Ab<Ja.length;Ab+=Eb){var Pa=Math.floor(jb*ea.Uf(ac));Pb[Pa]=
Pb[Pa]||[];Pb[Pa].push(Ja[Ab],Ja[Ab+1],Ja[Ab+2],Ja[Ab+3]);Lb&&Pb[Pa].push(Ja[Ab+4],Ja[Ab+5],Ja[Ab+6],Ja[Ab+7])}for(Pa in Pb)Pb[Pa]=new Float32Array(Pb[Pa]);Bc=Pb}Vb=Bc}$c=p(a,b,J,pa,sc,Ob,Vb,U,W,ld,rc,Tc);S.push.apply(S,$c)}"INSTANCE"==U.b4w_wind_bend_inheritance&&aa.o.Ud&&Y.warn('Emitter object "'+aa.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else ea.D("Unknown particle settings type")}G?
f.push.apply(f,S):f=S}return f}function n(a){for(var b=[],c=[],d={},e=0;e<a.length;e++){var f=a[e].qa,g=null;if(f.id in d){var h=d[f.id],l=c[h].qa;Z(f,function(a){Z(l,function(b){ea.eR(a,b)&&1!=a.AC&&(g=c[h])})});if(!g){do f.id++;while(d[f.id])}}g||(g={qa:f,vD:[],nA:[],XE:[],nd:[],RD:[],Nf:[]},d[f.id]=c.length,c.push(g));if(a[e].Hd&&a[e].Hd.Ha){g.vD.push(a[e].Ee);g.nA.push(a[e].jr);g.XE.push(a[e].Hd);for(var k=0;k<a[e].nd.length;k++)f=a[e].nd[k],-1==g.RD.indexOf(f.uuid)&&(g.nd.push(f),g.RD.push(f.uuid));
for(k=0;k<a[e].Nf.length;k++)f=a[e].Nf[k],-1==g.Nf.indexOf(f)&&g.Nf.push(f)}g.Nf.sort()}for(e=0;e<c.length;e++){var f=c[e].qa,m=c[e].vD,n=c[e].nA,p=c[e].XE;a=M.zv(n[0]);if("STATIC"==a.type)for(k=0;k<m.length;k++){var q=m[k],N=n[k],d=p[k],t=sa.identity(ua);q.ng&&!q.ho?(q=sa.ec(q.v,na),sa.set_trans(q,t)):sa.copy(q.v,t);N.vj?d.ff||(N.ng?ta.gR(d,t):ta.au(d,t)):ta.au(d,t);if(N.vj)z(f,"AU_QUALIFIER","GLSL_IN");else if(1<c[e].nd.length){q={};if(N.Ud||N.ng)q.au_center_pos=[t[0],t[1],t[2]];N.Ud&&(q.au_wind_bending_amp=
[N.Ne],q.au_wind_bending_freq=[N.Oe],q.au_detail_bending_amp=[N.xe],q.au_detail_bending_freq=[N.ye],q.au_branch_bending_amp=[N.te]);ta.fR(d,q);z(f,"AU_QUALIFIER","GLSL_IN")}else a.so.set(t.subarray(0,3)),N.so.set(t.subarray(0,3)),z(f,"AU_QUALIFIER","uniform")}if(0==p.length)d=ta.ef(ea.sq("%empty"));else if(1==p.length)d=p[0];else{d=[];for(k=0;k<p.length;k++)ta.RN(p[k])||d.push(k);if(d.length<p.length)for(k=0;k<d.length;k++)ta.bu(p[d[k]]);d=ta.VE(p)}if("STATIC"==a.type){if(1<c[e].nd.length){p=[];for(k=
0;k<c[e].nd.length;k++)ba.iw(c[e].nd[k].Ua.o.pA,p);ba.oA(p,a.Pa);ba.cm(a.Pa,a.U);a.jb=ba.Ar(ea.f32(p),!0);ba.Fv(a.jb,a.Z);a.gb=ba.Lo(a.jb);ba.Gv(a.gb,a.va)}a.Bm&&(k=c[e].nd[0].b4w_cluster_data,k.cluster_center&&k.cluster_radius?(a.hl.set(k.cluster_center),a.il=k.cluster_radius):(a.hl.set(a.gb.M),a.il=a.gb.Wa),n[0].hl.set(a.hl),n[0].il=a.il);a.Je=ba.Fs(a.Z,a.va)}for(k=0;k<m.length;k++)m[k].Je=ba.Fs(m[k].Z,m[k].va);"PARTICLES"!=f.type&&(k=d.pf,f.U=ba.yk(k.U),f.Z=ba.yo(k.Z),f.va=a.va.Wa<k.va.Wa?"STATIC"==
a.type?ba.zk(a.gb):ba.zk(a.va):ba.zk(k.va),"STATIC"==a.type?(f.jb=f.Z,f.Pa=f.U,f.gb=f.va):(k=a.v,f.jb=ba.ko(f.Z,k),f.gb=ba.lo(f.va,k),f.Pa=ba.wk(f.U,k)),f.Je=ba.Fs(f.Z,f.va));b.push({qa:f,o:a,Hd:d,Nf:c[e].Nf,nd:c[e].nd})}return b}function x(a,b,c,d){a.eo=ba.sA(b,d);a.bo=ba.qA(c,d);a.co=ba.rA(b,d)}function e(a,b,c,d){var e=[];d||(b.Qj&&ka.dc(a,va.Wd)||b.Ic&&ka.dc(a,va.fg))&&e.push("COLOR_ID");c&&(e.push("MAIN"),e.push("NODES_GLOW"),ka.dc(a,va.eg)&&e.push("DEBUG_VIEW"),ka.dc(a,va.Re)&&e.push("SHADOW"),
ka.dc(a,va.Ph)&&e.push("GRASS_MAP"));e.push("PHYSICS");if(b.Qd||b.md)for(a=null,b.Qd&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),b.md&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a?a=ea.bJ(a,b):a=b),b=a,a=0;a<b.length;a++)c=e.indexOf(b[a]),-1!==c&&e.splice(c,1);return e}function u(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes&&"HALO"!=b.type)t(a,b,"MAIN");else{m(a,b);c=b.game_settings.alpha_blend;a.Tg=b.b4w_render_above_all&&"OPAQUE"!=c&&
"CLIP"!=c;a.Sf=b.offset_z;a.$f.set([1,1,1]);var d=b.texture_slots;O.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.xd);if(b.b4w_lens_flares){G(a,"lens_flares.glslv","lens_flares.glslf");l(a,"a_position");l(a,"a_texcoord");var e=wa.Ld(d[0]),g=d[0].texture;D(a,e,"u_sampler",g.name)}else{G(a,"main.glslv","main_stack.glslf");if(!b.use_shadeless){var n=ca.Iv(b.uuid,b.name,{le:b.use_shadeless,To:b.diffuse_shader,jq:b.specular_shader,Jl:b.use_tangent_shading});a.ab.Rf=ca.wr(n)}var p=
B("use_map_color_diffuse",d),q=B("use_map_color_spec",d),N=B("use_map_normal",d),v=B("use_map_mirror",d),u=B("use_stencil",d),n=p[0],q=q[0],N=N[0],v=v[0],p=p[1],d=u[0]&&B("use_rgb_to_intensity",d)[0];if(n){g=n.texture;switch(n.blend_type){case "MIX":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e=wa.Ld(n);D(a,e,"u_colormap0",g.name);a.ih=n.diffuse_color_factor;n.use_map_alpha?a.xf=n.alpha_factor:a.xf=0;a.$f.set(n.scale)}u=
n&&n==q;q&&(u||(g=q.texture,e=wa.Ld(q),D(a,e,"u_specmap0",g.name)),a.Ei=q.specular_color_factor);if(N&&(g=N.texture,l(a,"a_tbn_quat"),e=wa.Ld(N),D(a,e,"u_normalmap0",g.name),a.Pm=N.normal_factor,g.b4w_use_map_parallax&&Ia.qt)){var e=da.N(g.b4w_parallax_steps),x=da.N(g.b4w_parallax_lod_dist);z(a,"PARALLAX",1);z(a,"PARALLAX_STEPS",e);z(a,"PARALLAX_LOD_DIST",x);a.parallax_scale=g.b4w_parallax_scale}v&&(g=v.texture,e=wa.Ld(v),D(a,e,"u_mirrormap",g.name),a.kl=v.mirror_factor);if(v=n&&p&&d?1:0)e=wa.Ld(p),
g=p.texture,D(a,e,"u_colormap1",g.name),e=wa.Ld(d),g=d.texture,D(a,e,"u_stencil0",g.name);(g=n||q||N)&&a.$f.set(g.scale);z(a,"TEXTURE_SPEC",void 0==q?0:1);z(a,"ALPHA_AS_SPEC",u?1:0);z(a,"TEXTURE_STENCIL_ALPHA_MASK",v);l(a,"a_position");l(a,"a_tbn_quat");(n||q||N)&&l(a,"a_texcoord");if(b.b4w_water){a.Lh=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.yb?(Y.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.Fn=!1):a.Fn="REFLECT"!=a.sb?b.b4w_water_shore_smoothing:
!1;G(a,"water.glslv","water.glslf");v=ca.Iv(b.uuid,b.name,{le:!1,To:b.diffuse_shader,jq:b.specular_shader,Jl:b.use_tangent_shading});a.ab.Rf=ca.wr(v);l(a,"a_position");Ia.$F?(l(a,"a_polyindex"),a.Va=!0,ra.set(0,0,0,a.wireframe_edge_color),ha.Aw()?z(a,"DEBUG_WIREFRAME",1):z(a,"DEBUG_WIREFRAME",2)):z(a,"DEBUG_WIREFRAME",0);u=b.texture_slots;v=B("use_map_normal",u);e=B("use_map_mirror",u)[0];v.length&&(g=v[0].texture,D(a,wa.Ld(v[0]),"u_normalmap0",g.name),a.gk=b.b4w_water_norm_uv_velocity);z(a,"NUM_NORMALMAPS",
v.length);a.vi=Array(v.length);for(g=0;g<v.length;g++)a.vi[g]=new Float32Array(2),a.vi[g].set([v[g].scale[0],v[g].scale[1]]);e&&(x=wa.Ld(e),g=e.texture,D(a,x,"u_mirrormap",g.name),a.kl=e.mirror_factor);e=null;if(Ia.sm)for(g=0;g<u.length;g++){var y=u[g];if(!0===y.texture.b4w_water_foam){e=y;break}}e&&(z(a,"FOAM",1),x=wa.Ld(e),g=e.texture,D(a,x,"u_foam",g.name),a.foam_factor=b.b4w_foam_factor,a.Yr.set(g.b4w_foam_uv_freq),a.Xr.set(g.b4w_foam_uv_magnitude),a.ap[0]=e.scale[0],a.ap[1]=e.scale[1]);for(g=
0;g<u.length;g++)if(y=u[g],!0===y.texture.b4w_shore_dist_map){var K=y;break}K&&Ia.br&&(u=wa.Ld(K),g=K.texture,D(a,u,"u_shore_dist_map",g.name),z(a,"SHORE_PARAMS",1),K=y.texture.b4w_shore_boundings,z(a,"MAX_SHORE_DIST",da.N(y.texture.b4w_max_shore_dist)),z(a,"SHORE_MAP_SIZE_X",da.N(K[0]-K[1])),z(a,"SHORE_MAP_SIZE_Y",da.N(K[2]-K[3])),z(a,"SHORE_MAP_CENTER_X",da.N((K[0]+K[1])/2)),z(a,"SHORE_MAP_CENTER_Y",da.N((K[2]+K[3])/2)));b.b4w_generated_mesh?(z(a,"GENERATED_MESH",1),a.wu=!0,a.xu=b.b4w_water_num_cascads,
a.yu=b.b4w_water_subdivs,a.vu=b.b4w_water_detailed_dist):(l(a,"a_tbn_quat"),(e||v.length)&&l(a,"a_texcoord"),z(a,"GENERATED_MESH",0));if(b.b4w_water_dynamic){var y=da.N(b.b4w_water_dst_noise_scale0),K=da.N(b.b4w_water_dst_noise_scale1),v=da.N(b.b4w_water_dst_noise_freq0),u=da.N(b.b4w_water_dst_noise_freq1),g=da.N(b.b4w_water_dir_min_shore_fac),e=da.N(b.b4w_water_dir_freq),x=da.N(b.b4w_water_dir_noise_scale),L=da.N(b.b4w_water_dir_noise_freq),r=da.N(b.b4w_water_dir_min_noise_fac),qa=da.N(b.b4w_water_dst_min_fac),
E=da.N(b.b4w_water_waves_hor_fac);z(a,"DST_NOISE_SCALE_0",y);z(a,"DST_NOISE_SCALE_1",K);z(a,"DST_NOISE_FREQ_0",v);z(a,"DST_NOISE_FREQ_1",u);z(a,"DIR_MIN_SHR_FAC",g);z(a,"DIR_FREQ",e);z(a,"DIR_NOISE_SCALE",x);z(a,"DIR_NOISE_FREQ",L);z(a,"DIR_MIN_NOISE_FAC",r);z(a,"DST_MIN_FAC",qa);z(a,"WAVES_HOR_FAC",E)}f(a,b);F(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;
z(a,"ABSORB",da.N(b.b4w_water_absorb_factor));z(a,"SSS_STRENGTH",da.N(b.b4w_water_sss_strength));z(a,"SSS_WIDTH",da.N(b.b4w_water_sss_width))}"HALO"===b.type&&(G(a,"halo.glslv","halo.glslf"),w(a,b),a.cj=["a_position"]);b.use_tangent_shading&&(z(a,"USE_TBN_SHADING",1),l(a,"a_shade_tangs"));z(a,"TEXCOORD",0);z(a,"NORMAL_TEXCOORD",0);n&&h(a,n,"TEXTURE_COLOR0_CO");p&&h(a,p,"TEXTURE_COLOR1_CO");d&&h(a,d,"TEXTURE_STENCIL_ALPHA_MASK_CO");q&&h(a,q,"TEXTURE_SPEC_CO");N&&h(a,N,"TEXTURE_NORM_CO");z(a,"SHADELESS",
b.use_shadeless?1:0);a.le=b.use_shadeless}z(a,"ALPHA","OPAQUE"===c?0:1);z(a,"ALPHA_CLIP","CLIP"===c?1:0);z(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(z(a,"VERTEX_COLOR",1),l(a,"a_color")):z(a,"VERTEX_COLOR",0);a.lg=b.ambient;a.jh=b.diffuse_intensity;a.ug=b.emit;a.Yf.set(b.specular_color);a.Cl=b.specular_alpha;f(a,b);F(a,b);b.b4w_wettable?z(a,"WETTABLE",1):z(a,"WETTABLE",0);k(a,b);b.b4w_refractive&&!a.yb?(Y.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),
a.xi=!1):a.xi=b.b4w_refractive;a.Vm=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=t(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(m(a,b),a.yb)c=!1;else{n=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==n?t(a,b,"SHADOW"):G(a,"shadow.glslv","shadow.glslf");O.set(0,0,0,b.alpha,a.xd);l(a,"a_position");l(a,"a_tbn_quat");z(a,"ALPHA","OPAQUE"===n?0:1);a.$f.set([1,1,1]);if((c=B("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===
n){switch(c.blend_type){case "MIX":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.$f.set(c.scale);z(a,"TEXTURE_COLOR",1);l(a,"a_texcoord");n=wa.Ld(c);c=c.texture;"IMAGE"!=n.source&&"ENVIRONMENT_MAP"!=n.source&&"CANVAS"!=n.source&&"NONE"!=n.source||D(a,n,"u_colormap0",c.name)}else z(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.Bq=b.b4w_use_ghost,a.Tb=b.b4w_collision_id,a.Do=b.b4w_collision_margin,
a.Bo=b.b4w_collision_group,a.Eo=b.b4w_collision_mask,a.um=b.physics.friction,a.mm=b.physics.elasticity,c=!0):b.b4w_water?(a.Lh=!0,a.xS=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,
a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===b.type)c=!1;else{m(a,b);a.Pe=!1;a.Va=!0;a.yb=!1;n=b.game_settings.alpha_blend;a.Tg=b.b4w_render_above_all&&"OPAQUE"!=n&&"CLIP"!=n;b.use_nodes&&"CLIP"==n?t(a,b,"COLOR_ID"):G(a,"color_id.glslv","color_id.glslf");O.set(0,0,0,b.alpha,a.xd);l(a,"a_position");z(a,"ALPHA","OPAQUE"===n?0:1);a.$f.set([1,1,1]);c=B("use_map_color_diffuse",
b.texture_slots)[0];n="CLIP"===n?1:0;z(a,"ALPHA_CLIP",n);if(c&&n){switch(c.blend_type){case "MIX":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.$f.set(c.scale);z(a,"TEXTURE_COLOR",1);l(a,"a_texcoord");n=wa.Ld(c);c=c.texture;"IMAGE"!=n.source&&"ENVIRONMENT_MAP"!=n.source&&"CANVAS"!=n.source&&"NONE"!=n.source||D(a,n,"u_colormap0",c.name)}else z(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?
c=!1:(m(a,b),a.yb=!1,a.Pe=!1,a.Va=!0,G(a,"grass_map.glslv","grass_map.glslf"),l(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,n=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.Lc.a_grass_size={Sk:!0,src:[]},c?(a.Lc.a_grass_size.src.push({name:c,Mf:4}),z(a,"DYNAMIC_GRASS_SIZE",1)):z(a,"DYNAMIC_GRASS_SIZE",0),a.Lc.a_grass_color={Sk:!0,src:[]},n?(a.Lc.a_grass_color.src.push({name:n,Mf:7}),z(a,"DYNAMIC_GRASS_COLOR",1)):z(a,"DYNAMIC_GRASS_COLOR",0),z(a,"GRASS_TEXTURE_SIZE",
da.N(oa.mp)),c=!0);break;case "DEBUG_VIEW":c=A(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)c=!1;else{c=b.texture_slots;if(a.np)G(a,"particle_system.glslv","particle_system_stack.glslf"),z(a,"HALO_PARTICLES",1),w(a,b);else{n={le:!1,To:b.diffuse_shader,jq:b.specular_shader,Jl:b.use_tangent_shading};if(b.use_nodes){G(a,"particle_system.glslv","particle_system.glslf");t(a,b,"PARTICLES");c=!0;break a}G(a,"particle_system.glslv","particle_system_stack.glslf");n=ca.Iv(b.uuid,b.name,n);a.ab.Rf=ca.wr(n);
if(c=B("use_map_color_diffuse",c)[0]){z(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.ih=c.diffuse_color_factor;c.use_map_alpha?a.xf=c.alpha_factor:a.xf=0;D(a,wa.Ld(c),"default"+String(a.Sa.length),c.texture.name)}}O.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.xd);a.lg=b.ambient;a.jh=b.diffuse_intensity;a.ug=b.emit;a.Yf.set(b.specular_color);
a.Cl=b.specular_alpha;l(a,"a_position");l(a,"a_tbn_quat");c=b.game_settings.alpha_blend;z(a,"ALPHA","OPAQUE"===c?0:1);z(a,"ALPHA_CLIP","CLIP"===c?1:0);z(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);f(a,b);F(a,b);m(a,b);a.Tg=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.Sf=b.offset_z;c=!0}break;default:ea.D("Wrong batch type: "+a.type)}return c}function w(a,b){var c=b.halo;z(a,"NUM_RINGS",c.ring_count);z(a,"NUM_LINES",c.line_count);z(a,"NUM_STARS",c.star_tip_count);z(a,"SKY_STARS",b.b4w_halo_sky_stars?
1:0);a.ws=c.size;a.ts=c.hardness/20;a.vs.set(c.b4w_halo_rings_color);a.us.set(c.b4w_halo_lines_color);a.xs=1/b.b4w_halo_stars_blend_height;a.ys=b.b4w_halo_stars_min_height;a.ss=!0}function h(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":z(a,c,"TEXTURE_COORDS_UV_ORCO");z(a,"TEXCOORD",1);break;case "NORMAL":z(a,c,"TEXTURE_COORDS_NORMAL");z(a,"NORMAL_TEXCOORD",1);break;default:z(a,c,"TEXTURE_COORDS_NONE")}}function m(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.yb=
!0;a.Pe=!0;a.Va=!0;a.kg=!1;break;case "ALPHA":a.yb=!0;a.Pe=!1;a.Va=!0;a.kg=!1;break;case "CLIP":a.yb=!1;a.Pe=!1;a.Va=!0;a.kg=!0;break;case "ADD":a.yb=!0;a.Pe=!1;a.Va=!1;a.kg=!1;break;case "OPAQUE":a.yb=!1;a.Pe=!1;a.Va=!0;a.kg=!1;break;default:ea.D("Unknown alpha blend mode: "+d)}a.Qb=c.use_backface_culling}function B(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.F&&c.push(f)}return c}function k(a,b){var c=b.raytrace_transparency;a.bf[0]=c.fresnel;a.bf[1]=1-c.fresnel_factor/
5;c=b.raytrace_mirror;a.reflect_factor=c.reflect_factor;a.bf[2]=c.fresnel;a.bf[3]=1-c.fresnel_factor/5}function f(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:Y.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Rd[0]=b.specular_intensity;
a.Rd[1]=c;a.Rd[2]=d}function F(a,b){switch(b.diffuse_shader){case "LAMBERT":a.$c[0]=0;a.$c[1]=0;break;case "OREN_NAYAR":a.$c[0]=b.roughness;a.$c[1]=0;break;case "FRESNEL":a.$c[0]=b.diffuse_fresnel;a.$c[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.$c[0]=b.darkness;a.$c[1]=0;break;case "TOON":a.$c[0]=b.diffuse_toon_size;a.$c[1]=b.diffuse_toon_smooth;break;default:Y.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.$c[0]=0,a.$c[1]=0}}function t(a,b,c){if(!b.use_nodes||
b.b4w_do_not_render)return!1;var d;switch(c){case "MAIN":G(a,"main.glslv","main.glslf");d=!1;break;case "GLOW":G(a,"main.glslv","main.glslf");d=!0;break;case "SHADOW":G(a,"shadow.glslv","shadow.glslf");d=!1;break;case "COLOR_ID":G(a,"color_id.glslv","color_id.glslf"),d=!1}var e=b.node_tree;c=ca.sK(e,b.uuid,!1,b.name,c);if(!c.Ja)return Y.error('Failed to create node graph for material "'+b.name+'", disable nodes'),J(a,b),!0;a.Cj=c.id;a.qj=!0;z(a,"NODES",1);z(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?
1:0);l(a,"a_position");b.use_orco_tex_coord&&l(a,"a_orco_tex_coord");m(a,b);a.Sf=b.offset_z;var f=b.game_settings.alpha_blend;d?(z(a,"ALPHA",1),z(a,"ALPHA_CLIP",0)):(z(a,"ALPHA","OPAQUE"===f?0:1),z(a,"ALPHA_CLIP","CLIP"===f?1:0));a.Tg=b.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f;a.ug=b.emit;a.lg=b.ambient;k(a,b);b.b4w_wettable?z(a,"WETTABLE",1):z(a,"WETTABLE",0);var g=null,h=!1;U.ha(c.Ja,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var e=d.data.name,
f=d.data.value;a.Qi||(a.Qi={});a.Qi[f]=e;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":e=d.data.name;a.Lc[e]={Sk:!0,src:[{name:d.data.value}]};f=0;if("GEOMETRY_VC"==d.type)f=7;else for(var k=0;k<d.outputs.length;k++){var m="RGB".indexOf(d.outputs[k].identifier);-1<m&&(f|=1<<2-m)}a.Lc[e].src[0].Mf=f;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":l(a,"a_tbn_quat");break;case "TEX_COORD_OB":z(a,"USE_MODEL_TSR_INVERSE",
1);break;case "TEX_COORD_WI":z(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":d.data.value.Jl&&(z(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&l(a,"a_shade_tangs"));l(a,"a_tbn_quat");h=!0;break;case "BSDF_BEGIN":h=!0;l(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":e=d.data.name;f=d.data.mv;k=d.data.value;D(a,k,e,f);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":z(a,"CALC_TBN_SPACE",1);l(a,"a_tbn_quat");d.data&&(e=d.data.name,f=d.data.mv,k=d.data.value,D(a,k,e,f));break;
case "NORMAL_MAP":l(a,"a_tbn_quat");switch(Number(d.hb[0][1])){case ca.bH:z(a,"CALC_TBN_SPACE",1);break;case ca.aH:case ca.$G:z(a,"USE_MODEL_TSR",1)}break;case "LAMP":d.data&&(a.el=d.data);break;case "B4W_REFRACTION":a.yb?a.xi=!0:(a.xi=!1,Y.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));z(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":g||(g=d.data.Ya);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&d.data&&(a.Jp=d.data);break;case "VECT_TRANSFORM":switch(Number(d.hb[1][1])){case ca.qI:z(a,
"USE_MODEL_TSR_INVERSE",1);break;case ca.pI:z(a,"USE_VIEW_TSR",1);break;case ca.oI:z(a,"USE_MODEL_TSR",1);break;case ca.nI:z(a,"USE_MODEL_TSR",1);z(a,"USE_VIEW_TSR",1);break;case ca.mI:z(a,"USE_VIEW_TSR_INVERSE",1);break;case ca.lI:z(a,"USE_MODEL_TSR_INVERSE",1),z(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":z(a,"USE_MODEL_TSR",1);a.Qm[1]=b.pass_index;a.Qm[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":z(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":z(a,"USE_VIEW_TSR_INVERSE",
1);break;case "BUMP":case "DISPLACEMENT_BUMP":l(a,"a_tbn_quat");ha.Aw()?z(a,"USE_DERIVATIVES_EXT",1):Y.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+b.name+'" material.');break;case "BSDF_TRANSPARENT":a.yb=!0,a.xi=!0}});g&&D(a,g,"u_nodes_texture");h||(a.le=!0);d=a.ab.Rf=ca.wr(c.Ja);q(e,a);e=a.jf;c=a.hf;for(f=0;f<d.length;f++){var n=d[f];switch(n.id){case "VALUE":var p=n.rt[0];if(p)for(var t=0;t<e.length;t+=2)if(e[t]==p){n.hb.push(["VALUE_IND",e[t+1]]);
break}break;case "RGB":if(p=n.rt[0])for(t=0;t<c.length;t+=2)if(c[t]==p){n.hb.push(["RGB_IND",c[t+1]]);break}}}z(a,"NUM_VALUES",a.Gg.length);z(a,"NUM_RGBS",a.Bd.length);return!0}function q(a,b){var c=[],d=[],e=[],f=[];E(a,"",c,d,e,f);b.Gg=c;b.jf=d;b.Bd=e;b.hf=f}function E(a,b,c,d,e,f){for(var g=0;g<a.nodes.length;g++){var h=a.nodes[g];if("VALUE"==h.type){var l=(b?b+"%join%":"")+h.name;c.push(h.outputs[0].default_value);d.push(l,d.length/2)}else"RGB"==h.type?(l=(b?b+"%join%":"")+h.name,h=h.outputs[0].default_value.slice(0,
3),e.push(h[0],h[1],h[2]),f.push(l,f.length/2)):"GROUP"==h.type&&E(h.node_group.node_tree,(b?b+"%join%":"")+h.name,c,d,e,f)}}function J(a,b){switch(a.type){case "SHADOW":G(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":G(a,"color_id.glslv","color_id.glslf");break;default:G(a,"main.glslv","main_stack.glslf")}z(a,"SHADELESS",1);l(a,"a_position");l(a,"a_tbn_quat");O.set(1,0,1,1,a.xd);if(b){var c=b.game_settings.alpha_blend;z(a,"ALPHA","OPAQUE"===c?0:1);z(a,"ALPHA_CLIP","CLIP"===c?1:0);z(a,"VERTEX_COLOR",
0);a.Sf=b.offset_z;m(a,b)}return!0}function A(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;G(a,"debug_view.glslv","debug_view.glslf");l(a,"a_position");l(a,"a_tbn_quat");l(a,"a_polyindex");a.Va=!0;ra.set(0,0,0,a.wireframe_edge_color);return!0}function I(a,b){a.ud=b.ud;if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.vj?z(a,"AU_QUALIFIER","GLSL_IN"):z(a,"AU_QUALIFIER","uniform"),z(a,"STATIC_BATCH",0)):(z(a,"AU_QUALIFIER","GLSL_IN"),z(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(ha.Aw()?z(a,
"WIREFRAME_QUALITY",1):z(a,"WIREFRAME_QUALITY",0),a.di?(z(a,"DEBUG_SPHERE",1),a.Jr?z(a,"DEBUG_SPHERE_DYNAMIC",1):z(a,"DEBUG_SPHERE_DYNAMIC",0)):z(a,"DEBUG_SPHERE",0),z(a,"ALPHA",1));b.me&&"PARTICLES"!=a.type&&!b.vj&&(a.me=b.me);b.Ud?(""!==b.pi?(a.Lc.a_bending_col_main={Sk:!0,src:[{name:b.pi,Mf:4}]},l(a,"a_bending_col_main"),""!==b.ae.$w&&""!==b.ae.Zw&&""!==b.ae.Ix?(a.Lc.a_bending_col_detail={Sk:!0,src:[{name:b.ae.$w,Mf:4},{name:b.ae.Zw,Mf:2},{name:b.ae.Ix,Mf:1}]},l(a,"a_bending_col_detail"),l(a,"a_tbn_quat"),
z(a,"DETAIL_BEND",1)):z(a,"DETAIL_BEND",0),z(a,"MAIN_BEND_COL",1)):z(a,"MAIN_BEND_COL",0),b.rk?z(a,"BEND_CENTER_ONLY",1):z(a,"BEND_CENTER_ONLY",0),z(a,"WIND_BEND",1)):z(a,"WIND_BEND",0);z(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.ho|0);b.ng?z(a,"BILLBOARD",1):z(a,"BILLBOARD",0);b.ng&&b.vj?z(a,"HAIR_BILLBOARD",1):z(a,"HAIR_BILLBOARD",0);b.io?z(a,"BILLBOARD_SPHERICAL",1):z(a,"BILLBOARD_SPHERICAL",0);switch(b.jo){case "RANDOM":z(a,"BILLBOARD_RANDOM",1);z(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":z(a,
"BILLBOARD_RANDOM",0);z(a,"BILLBOARD_JITTERED",1);break;default:z(a,"BILLBOARD_RANDOM",0),z(a,"BILLBOARD_JITTERED",0)}b.yc&&Ia.br?z(a,"DYNAMIC_GRASS",1):z(a,"DYNAMIC_GRASS",0);a.yc=b.yc;"PARTICLES"!=a.type&&(a.be=b.be);a.ie=b.ie;a.Qd=b.Qd;a.Gd=b.Gd&&!a.le&&!(a.yb&&Ia.Yv);a.Ed=b.Ed;a.md=b.md;a.ld=b.ld;a.Qm[0]=b.ut;a.De=b.De;a.Dg=b.Dg;a.Eg=b.Eg;a.td=b.td;a.jd=b.jd;b.xj?(l(a,"a_influence"),z(a,"SKINNED",1),Ia.Mt?(z(a,"DISABLE_TANGENT_SKINNING",1),z(a,"FRAMES_BLENDING",0)):(z(a,"DISABLE_TANGENT_SKINNING",
0),b.Qk?z(a,"FRAMES_BLENDING",1):z(a,"FRAMES_BLENDING",0)),z(a,"MAX_BONES",b.Fg)):(z(a,"SKINNED",0),z(a,"FRAMES_BLENDING",0),z(a,"DISABLE_TANGENT_SKINNING",0));b.Kc?(z(a,"VERTEX_ANIM",1),Ia.TF?z(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):z(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):z(a,"VERTEX_ANIM",0);b.xj&&b.Kc&&ea.D("Skinning and vertex animation are mutually exlusive")}}function C(a,b,c){if(b.length){for(var d=M.ls(b,Ia.ssao&&c.b4w_enable_ssao),e=a.ab,f=a.el,g=0,h=0;h<a.ab.Rf.length;h++){var l=
a.ab.Rf[h];if("LIGHTING_LAMP"==l.id){var k=b[g++%b.length],m=k.nb,n=M.oa(k,c);if("SPOT"==m.type||"POINT"==m.type)var p=Math.cos(m.Dl/2);if("SPOT"==m.type)var q=m.lq*(1-p);k=d.indexOf(k);l.hb=[["LAMP_TYPE",m.type],["LAMP_IND",n.Ap],["LAMP_SPOT_SIZE",da.N(p||.01)],["LAMP_SPOT_BLEND",da.N(q||.01)],["LAMP_LIGHT_DIST",da.N(m.distance)],["LAMP_USE_SPHERE",m.fz?1:0],["LAMP_SHADOW_MAP_IND",k]]}else if("LAMP"==l.id&&f)for(var n=l.hb[0][1],t=0;t<b.length;t++)if(k=b[t],f[k.Pi]==n){m=k.nb;if("SPOT"==m.type||
"POINT"==m.type)p=Math.cos(m.Dl/2);"SPOT"==m.type&&(q=m.lq*(1-p));l.hb.push(["LAMP_TYPE",m.type],["LAMP_SPOT_SIZE",da.N(p||.01)],["LAMP_SPOT_BLEND",da.N(q||.01)],["LAMP_LIGHT_DIST",da.N(m.distance)],["LAMP_USE_SPHERE",m.fz?1:0])}}if(f){c=0;for(var u in f)c++;a.Fm=new Float32Array(3*c);a.xp=new Float32Array(3*c);a.wp=new Float32Array(3*c);da.ia(e,"NUM_LAMP_LIGHTS",c);for(h=0;h<b.length;h++)v(a,b[h])}}}function v(a,b){if(b.Pi in a.el){var c=a.el[b.Pi],d=sa.get_trans_view(b.o.v);a.Fm.set(d,3*c);a.xp.set(b.nb.direction,
3*c);a.wp.set(b.nb.Fo,3*c)}}function l(a,b){var c=a.cj;-1==c.indexOf(b)&&c.push(b);a.cj=c.sort()}function z(a,b,c){da.ia(a.ab,b,c)}function H(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.sb?a.da=ta.WE(b,ta.Tl,[]):(0<b.eb.length&&ta.hR(b,b.aa[0]),a.Hd=b);else{var c=a.tg;a.ss&&"PARTICLES"!=a.type&&(b=ta.gM(b));a.wu&&(b=aa.EM(a.xu,a.yu,a.vu));c=ta.WE(b,c,a.Lc);a.da=c;a.be||a.Pe||a.me||(c.zd=null,c.Kb.length=0);c=b.aa.length;a.num_vertices=b.Ha*c;var d;a:switch(a.tg){case ta.Tl:case ta.Jn:case ta.Nq:d=!0;break a;
default:d=!1}d?ta.QN(b)?a.num_triangles=b.ma.length/3*c:a.num_triangles=b.Ha/3*c:a.num_triangles=0}}function p(a,b,c,e,f,g,h,l,k,m,n,p){var q=a.Ua,t=[],v=l.b4w_dynamic_grass;if(!m&&v)return t;for(var w="INSTANCE"==l.b4w_wind_bend_inheritance,N="INSTANCE"==l.b4w_shadow_inheritance,x="INSTANCE"==l.b4w_reflection_inheritance,K=[],D=[],r=0;r<f.length;r++){var B=f[r].Ua.o,A=M.zv(b);A.ng=l.b4w_hair_billboard;A.jo=l.b4w_hair_billboard_type;A.io="SPHERICAL"==l.b4w_hair_billboard_geometry;A.yc=v;A.vj=!0;w?
(A.Ud=B.Ud,A.Ql=B.Ql,A.Oe=B.Oe,A.ye=B.ye,A.pi=B.pi,A.xe=B.xe,A.te=B.te,A.Ne=B.Ne,A.ae=B.ae,A.rk=!1):(A.Ud=q.o.Ud,A.Ql=q.o.Ql,A.Oe=q.o.Oe,A.ye=q.o.ye,A.pi=q.o.pi,A.xe=q.o.xe,A.te=q.o.te,A.Ne=q.o.Ne,A.ae=q.o.ae,A.rk=!0);N?(A.ie=B.ie,A.Qd=B.Qd,A.Gd=B.Gd):(A.ie=q.o.ie,A.Qd=q.o.Qd,A.Gd=q.o.Gd);x?(A.Ed=B.Ed,A.md=B.md,A.ld=B.ld,A.td=B.td,A.jd=B.jd,A.Mg=B.Mg):(A.Ed=q.o.Ed,A.md=q.o.md,A.ld=q.o.ld,A.td=q.o.td,A.jd=q.o.jd,A.Mg=q.o.Mg);K.push(A);var E=h[r];E||(E=new Float32Array);p&&ea.Cs(k.seed,n);var C=new Float32Array(3),
F=new Float32Array([0,0,0,1]),na=[],qa=ma.RA(Ia.fx)&&!l.b4w_initial_rand_rotation&&!l.b4w_hair_billboard,G=4;qa&&(G=8);for(var H=0;H<E.length;H+=G){C[0]=E[H];C[1]=E[H+1];C[2]=E[H+2];var wa=E[H+3]*sa.get_scale(B.v);if(l.b4w_initial_rand_rotation){switch(l.b4w_rotation_type){case "XYZ":var ba=new Float32Array([ea.Uf(n),ea.Uf(n),ea.Uf(n)]);ra.normalize(ba,ba);break;case "Z":ba=new Float32Array([0,0,1]);break;default:ea.D("Unsupported random rotation type: "+l.b4w_rotation_type)}P.setAxisAngle(ba,l.b4w_rand_rotation_strength*
(2*Math.PI*ea.Uf(n)-Math.PI),F)}else if(qa&&(F.set(E.subarray(H+4,H+8)),ea.Sx(F,F),!l.use_whole_group))if(l.use_rotation_dupli){var J=sa.get_quat_view(B.v);P.multiply(F,J,F)}else P.multiply(F,ia,F);var Ca=sa.set_sep(C,wa,F,sa.create());na.push(Ca)}D.push(na)}for(var T={},X=0,r=0;r<f.length;r++)for(var Ga=f[r].data.materials,H=0;H<Ga.length;H++)Ga[H].name in T?T[Ga[H].name]++:(T[Ga[H].name]=1,X++);for(var X=X?X:1,Sa={},r=0;r<f.length;r++){var aa=f[r],pa=g[r],A=K[r],Ta={};A.Ud&&(Ta.au_wind_bending_amp=
[A.Ne],Ta.au_wind_bending_freq=[A.Oe],Ta.au_detail_bending_freq=[A.ye],Ta.au_detail_bending_amp=[A.xe],Ta.au_branch_bending_amp=[A.te],A.Ne=0,A.Oe=0,A.ye=0,A.xe=0,A.te=0);na=D[r];if(na.length){for(var S=aa.data,Ga=S.materials,O=Array(Ga.length),Aa=Array(Ga.length),H=0;H<Ga.length;H++)if(!L(q,H)&&!ta.uC(S,H))for(var Z=0;Z<pa.length;Z++){var Ea=pa[Z],U=d(Ea),W=Ga[H];"MAIN"==Ea?O[H]=U:"DEBUG_VIEW"==Ea&&(Aa[H]=U);U.Ao=a.b4w_cluster_data.cluster_id;if(Q(U,W)&&u(U,W)){"SHADOW"==Ea&&O[H]&&(U.le=O[H].le);
U.tg=ta.Tl;I(U,A);U.Ej=V(U,A,l.uuid);U.fj=a.b4w_do_not_cull||l.b4w_dynamic_grass;"MAIN"==U.type&&(U.og=a.b4w_caustics);z(U,"DISABLE_FOG",("COLOR_ID"!=Ea&&"SHADOW"!=Ea&&a.b4w_disable_fogging)|0);"JITTERED"==l.b4w_hair_billboard_type&&(U.Ms=l.b4w_hair_billboard_jitter_amp,U.Ns=l.b4w_hair_billboard_jitter_freq);v&&(U.ns=l.b4w_dynamic_grass_scale_threshold);w||(delete U.Lc.a_bending_col_main,delete U.Lc.a_bending_col_detail);var Ba=ta.jw(S,H,U.cj,b.Wh,U.Lc,U.Qi),ha=q.o.v,la=!0;if(1<T[W.name]){var ua=
0,ca;for(ca in Ba.aa)ua++;la=Ba.ma.length*na.length*ua*T[W.name]>2E5*X}var ga=Ia.aA&&la&&"PHYSICS"!=U.type;if(ga){U.AC=l.use_whole_group?2:1;var da=ea.S(Ba);ta.FA(Ba,da,na);da.ff={pq:na,zy:ha,PE:"STATIC"==b.type,cu:Ta,Rm:{},Or:v};if(A.Ud&&A.rk){var Ka=ra.fromValues(0,0,0);sa.transform_vec3(Ka,q.o.v,Ka);for(var ka=[],fa=0;fa<na.length;fa++)ka.push(Ka[0],Ka[1],Ka[2]);da.ff.Rm.a_emitter_center={Vb:3,data:ka}}ta.FA(Ba,Ba,na);"STATIC"==b.type&&ta.uJ(da.pf,ha)}else{var va=da=ta.zO(Ba,Ta,na),Ha=na;va.pa.au_center_pos=
new Float32Array(3*va.Ha);for(var La=Ha.length,kb=va.Ha/La,Fa=0;Fa<La;Fa++)for(var Ra=Ha[Fa],oa=3*kb*Fa,xa=0;xa<kb;xa++)va.pa.au_center_pos[oa+3*xa]=Ra[0],va.pa.au_center_pos[oa+3*xa+1]=Ra[1],va.pa.au_center_pos[oa+3*xa+2]=Ra[2];da=va;if(A.Ud&&A.rk){var Zb=da,Tc=q.o.v;Zb.pa.a_emitter_center=new Float32Array(3*Zb.Ha);var Jb=ra.fromValues(0,0,0);sa.transform_vec3(Jb,Tc,Jb);for(var Vb=0;Vb<Zb.Ha;Vb++)Zb.pa.a_emitter_center[3*Vb]=Jb[0],Zb.pa.a_emitter_center[3*Vb+1]=Jb[1],Zb.pa.a_emitter_center[3*Vb+
2]=Jb[2];da=Zb}}var Kb=l.b4w_vcol_from_name,lc=l.b4w_vcol_to_name,tc=U,id=c,yb=!w,Za=S,gb=[];if(""!==Kb&&""!==lc){var cb,fc=void 0,Ac=lc,Uc=tc.Lc,mc=[];for(fc in Uc)for(var Bc=Uc[fc].src,Rb=0,Cc=0;Cc<Bc.length;Cc++){var Dc=Bc[Cc].Mf;Ac==Bc[Cc].name&&mc.push(fc,Dc,Rb);Rb+=ea.xl(Dc)}cb=mc;if(0<cb.length)for(var gc=0;gc<cb.length;gc+=3)gb.push({Yo:Kb,Qr:7,st:cb[gc],tt:cb[gc+1],Nr:cb[gc+2]});else ta.BN(tc.cj,"a_color")&&lc==Za.active_vcol_name&&gb.push({Yo:Kb,Qr:7,st:"a_color",tt:7,Nr:0})}yb&&("a_bending_col_main"in
id&&gb.push({Yo:"a_bending_col_main",Qr:4,st:"a_bending_col_main",tt:4,Nr:0}),"a_bending_col_detail"in id&&gb.push({Yo:"a_bending_col_detail",Qr:7,st:"a_bending_col_detail",tt:7,Nr:0}));for(var Wb=da,$b=na,sb=e,tb=gb,mb=U.Lc,Ic=ga,ad=!1,ub=0;ub<tb.length;ub++){var Db=tb[ub].Yo,vb=sb.pa[Db];if(vb&&0<vb.length){ad=!0;break}}if(Ic)var Jc=Wb.ff.Rm;if(ad){var Na,hb=q.o.U,zb=sb.aa[0].a_position,hc=$b,Ja=Sa,ac=new Float32Array(3),Lb=new Float32Array(3),Eb=new Uint32Array(hc.length);if(!("verts_indices"in
Ja)){Ja.Zh=new Float32Array(3);Ja.Th=new Float32Array(3);Ja.hz=new Uint32Array(zb.length/3);Ja.Ep=new Uint32Array(zb.length/3);Ja.Zh[0]=(hb.max_x-hb.min_x)/20;Ja.Zh[1]=(hb.max_y-hb.min_y)/20;Ja.Zh[2]=(hb.max_z-hb.min_z)/20;Ja.Th[0]=hb.min_x;Ja.Th[1]=hb.min_y;Ja.Th[2]=hb.min_z;for(var jb=0;jb<zb.length/3;jb++){var Pb=ea.trunc((zb[3*jb]-Ja.Th[0])/Ja.Zh[0]),Ab=ea.trunc((zb[3*jb+1]-Ja.Th[1])/Ja.Zh[1]),Pa=ea.trunc((zb[3*jb+2]-Ja.Th[2])/Ja.Zh[2]),Pb=ea.clamp(Pb,0,19),Ab=ea.clamp(Ab,0,19),Pa=ea.clamp(Pa,
0,19);Ja.hz[jb]=jb;Ja.Ep[jb]=Pa*Math.pow(20,2)+20*Ab+Pb}ta.RQ(Ja.Ep,Ja.hz,ta.Qu,!0);Ja.Ll=new Uint32Array(Math.pow(20,3));for(jb=0;jb<Ja.Ep.length;jb++)Ja.Ll[Ja.Ep[jb]]++;delete Ja.Ep;for(jb=1;jb<Ja.Ll.length;jb++)Ja.Ll[jb]+=Ja.Ll[jb-1]}for(var Sb=0;Sb<hc.length;Sb++){ac[0]=hc[Sb][0];ac[1]=hc[Sb][1];ac[2]=hc[Sb][2];for(var Fb=1E10,Ec=-1,Kc=ea.trunc((ac[0]-Ja.Th[0])/Ja.Zh[0]),Gb=ea.trunc((ac[1]-Ja.Th[1])/Ja.Zh[1]),Lc=ea.trunc((ac[2]-Ja.Th[2])/Ja.Zh[2]),Kc=ea.clamp(Kc,0,19),Gb=ea.clamp(Gb,0,19),Lc=
ea.clamp(Lc,0,19),Xb=Lc*Math.pow(20,2)+20*Gb+Kc,nc=Ja.Ll[Xb],oc=0==Xb?0:Ja.Ll[Xb-1];oc<nc;oc++){var bd=Ja.hz[oc];Lb[0]=zb[3*bd];Lb[1]=zb[3*bd+1];Lb[2]=zb[3*bd+2];ra.sub(Lb,ac,Lb);var Vc=ra.sqrLen(Lb);Vc<=Fb&&(Fb=Vc,Ec=bd)}if(-1==Ec)for(oc=0;oc<zb.length/3;oc++)Lb[0]=zb[3*oc],Lb[1]=zb[3*oc+1],Lb[2]=zb[3*oc+2],ra.sub(Lb,ac,Lb),Vc=ra.sqrLen(Lb),Vc<=Fb&&(Fb=Vc,Ec=oc);Eb[Sb]=Ec}Na=Eb;for(var uc=Wb.Ha/$b.length,ub=0;ub<tb.length;ub++){var bc=tb[ub].st,Mc=tb[ub].tt,Db=tb[ub].Yo,Fc=tb[ub].Qr,vb=sb.pa[Db];
switch(bc){case "a_bending_col_main":var Nc=1;break;case "a_bending_col_detail":Nc=3;break;case "a_color":Nc=3;break;default:for(var cc=Nc=0;cc<mb[bc].src.length;cc++)Nc+=ea.xl(mb[bc].src[cc].Mf)}if(vb&&0<vb.length){var nb=ea.xl(Fc),ob=ea.xl(Mc),Wc=Fc&Mc,Oc=ea.WD(Wc);Wc!=Mc&&Y.error("Wrong color extraction from "+Db+" to "+bc+".");if(Ic)for(Jc[bc]={Vb:Nc,data:[]},cc=0;cc<$b.length;cc++)for(vc=Na[cc],md=vc*nb,Tb=0;Tb<Oc.length;Tb++)Oc[Tb]&&(wc=ea.Ym(Fc,Tb),Jc[bc].data.push(vb[md+wc]));else{if("a_bending_col_main"==
bc||"a_bending_col_detail"==bc)Wb.pa[bc]=new Float32Array(Wb.Ha*ob);for(cc=0;cc<$b.length;cc++){var vc=Na[cc],md=vc*nb,cd=cc*uc*Nc;if(-1!=vc)for(var pc=0;pc<uc;pc++)for(var ic=pc*Nc,Tb=0;Tb<Oc.length;Tb++)if(Oc[Tb]){var wc=ea.Ym(Fc,Tb);Wb.pa[bc][cd+ic+(tb[ub].Nr+ea.Ym(Mc,Tb))]=vb[md+wc]}}}}else Wb.pa[bc]=new Float32Array(0)}}da=Wb;z(U,"USE_INSTANCED_PARTCLS",da.ff?1:0);y(U);t.push({qa:U,Ee:b,jr:A,Hd:da,Nf:[W.name],nd:[a]})}}for(H=0;H<Aa.length;H++)Aa[H]&&(Aa[H].gm=O[H].id,y(Aa[H]))}}return t}function Q(a,
b){var c=!0;"NODES_GLOW"==a.type&&(c=ca.PA(b));return c}function y(a){Z(a,function(a){a.id=0;a.id=ea.HJ(a)})}function Z(a,b){for(var c=null,d=null,e=[],f=0;f<a.Sa.length;f++){var g=a.Sa[f],h=g.Af;h&&(c||(c={}),c[f]=h,g.Af=null);if(h=g.Ta)d||(d={}),d[f]=h,g.Ta=null;e.push(g.qD);g.qD=0}var g=a.U,h=a.Z,l=a.va,k=a.Pa,m=a.jb,n=a.gb;a.U=null;a.Z=null;a.va=null;a.Pa=null;a.jb=null;a.gb=null;var p=a.ne;a.ne=null;var q=a.da;a.da=null;var t=a.Hd;a.Hd=null;b(a);a.da=q;a.Hd=t;a.ne=p;a.U=g;a.Z=h;a.va=l;a.Pa=k;
a.jb=m;a.gb=n;if(c)for(f in c)a.Sa[f].Af=c[f];if(d)for(f in d)a.Sa[f].Ta=d[f];for(f=0;f<a.Sa.length;f++)a.Sa[f].qD=e[f]}function S(a,b,c,e){var f=d("DEBUG_VIEW");G(f,"debug_view.glslv","debug_view.glslf");f.di=!0;f.Va=!0;f.Ej=V(f,a,b);f.Jr=c;I(f,a);y(f);if(e.Je){c?(c=e.Z,sa.set_trans(e.Z.M,ua)):(c=e.jb,sa.set_trans(c.M,ua));var g=ra.create();a=aa.ds(1,g);b=ra.fromValues(ra.length(c.Ea),ra.length(c.Fa),ra.length(c.Ga));ta.bE(a,b,g);var g=ra.normalize(c.Ea,na),h=ra.normalize(c.Fa,Sa);c=ra.normalize(c.Ga,
Aa);!b[0]&&b[1]&&b[2]?ra.cross(h,c,g):!b[1]&&b[0]&&b[2]?ra.cross(c,g,h):!b[2]&&b[0]&&b[1]&&ra.cross(g,h,c);b=ea.UL(g,h,c,Ca);ga.invert(b,b);b=P.fromMat3(b,T);sa.set_quat(b,ua);sa.set_scale(1,ua);ta.au(a,ua)}else c?(b=e.va,a=aa.ds(b.Wa,b.M)):(b=e.gb,a=aa.ds(b.Wa,ra.create()),sa.identity(ua),sa.set_trans(b.M,ua),ta.au(a,ua));f.U=ba.yk(e.U);f.Z=ba.yo(e.Z);f.va=ba.zk(e.va);f.Pa=ba.yk(e.Pa);f.jb=ba.yo(e.jb);f.gb=ba.zk(e.gb);ta.bu(a,1,!0);a.pa.a_polyindex=ta.Tr(a);H(f,a);return f}function G(a,b,c){a.ab.bg=
b;a.ab.Ae=c;da.eQ(a.ab)}function D(a,b,c,d){d=d||"";-1==a.Ie.indexOf(c)&&(a.Sa.push(b),a.Ie.push(c),a.Ve.push(d));a.ib&&W.jA(a)}function X(a){a.ab||ea.D("No shaders info for batch "+a.name);a.ib=da.VM(a.ab);var b=a.ab;if(b.status===da.Su){var c=a.ib.attributes,d=a.da.Fb,e;for(e in c)d[e]||ea.D('missing data for "'+e+'" attribute')}b.status&da.mG&&Y.error("Texture limit exceeded for shader - "+b.Ae+', materials: "'+a.Jb.join(", ")+'". Maximum texture count: '+xa.nx+", actual texture count: "+b.fF);
b.status&da.lG&&Y.error("Fragment uniform limit exceeded for shader - "+b.Ae+', materials: "'+a.Jb.join(", ")+'". ');b.status&da.pG&&Y.error("Vertex uniform limit exceeded for shader - "+b.bg+', materials: "'+a.Jb.join(", ")+'". ');b.status&da.oG&&Y.error("Vertex attribute limit exceeded for shader - "+b.bg+', materials: "'+a.Jb.join(", ")+'". Maximum attribute count: '+xa.ox+", actual attribute count: "+b.kA);b.status&da.nG&&("MAIN"!=a.type||a.qj||Y.error("Varying limit exceeded for shader - "+a.ab.Ae+
', materials: "'+a.Jb.join(", ")+'"'),"MAIN"==a.type&&a.qj||"NODES_GLOW"==a.type)&&(d=c=0,a.Qi&&(c=ea.hi(a.Qi)),a.Lc&&(d=ea.hi(a.Lc)),Y.error("Varying limit exceeded for node shader - "+a.ab.Ae+", uv: "+c+", vc: "+d+', materials: "'+a.Jb.join(", ")+'"'));b.status&da.jG&&Y.error("Shader compilation/linking error: "+b.bg+", "+b.Ae+', materials: "'+a.Jb.join(", ")+'"');return a.ab.status===da.Su?(W.fJ(a.ib),W.bv(a),W.jA(a),!0):!1}function V(a,b,c){return"NAVMESH"==a.sb?c:b.be?"_odd_id_"+ea.uF():c}function L(a,
b){return 0<=b&&b<a.rc.$k.length&&a.rc.$k[b]}var ba=r("__boundings"),pa=r("__config"),Y=r("__print"),ha=r("__extensions"),U=r("__graph"),ga=r("__mat3"),ca=r("__nodemat"),M=r("__obj_util"),la=r("__particles"),aa=r("__primitives"),P=r("__quat"),ma=r("__reformer"),W=r("__renderer"),ka=r("__scenegraph"),da=r("__shaders"),va=r("__subscene"),wa=r("__textures"),sa=r("__tsr"),ta=r("__geometry"),ea=r("__util"),ra=r("__vec3"),O=r("__vec4"),Ia=pa.H,xa=pa.pg,oa=pa.$m,K=pa.wC,ia=new Float32Array([0,0,-Math.sqrt(.5),
Math.sqrt(.5)]),na=new Float32Array(3),Sa=new Float32Array(3),Aa=new Float32Array(3),T=new Float32Array(4),ua=sa.create(),Ca=ga.create(),Ga={};a.kJ=function(a){return Ga[a]||null};a.lJ=function(a,b){Ga[a]=b};a.UB=function(a,c,d,e){var f;f=a.F.Ja;for(var h=[],l=0;l<c.length;l++){var k=c[l],m=k.Ua,p=m.o;if(!m.sp){var q=M.is_dynamic(m),m=m.o,t=k.data.b4w_boundings,v=t.bs_rad,u=t.bs_cen,w=t.bc_rad,N=t.caxis_x,y=t.caxis_y,K=t.caxis_z,D=t.be_ax,r=t.be_cen,L=t.rbb.rbb_c,z=t.rbb.rbb_s,t=ba.yk(m.Uh);m.ng&&
(v=Math.max(Math.abs(t.max_x),Math.abs(t.min_x)),u=Math.max(Math.abs(t.max_y),Math.abs(t.min_y)),z=Math.max(Math.abs(t.max_z),Math.abs(t.min_z)),z=Math.sqrt(v*v+u*u+z*z),w=Math.sqrt(v*v+u*u),t.max_x=t.max_y=t.max_z=z,t.min_x=t.min_y=t.min_z=-z,v=z,u=[0,0,0],N=[1,0,0],y=[0,1,0],K=[0,0,1],D=[z,z,z],r=[0,0,0],L=[0,0,0],z=[z,z,z]);ba.cm(t,m.U);ba.wk(m.U,m.v,m.Pa);m.va=ba.ov(v,ea.f32(u));ba.lo(m.va,m.v,m.gb);m.Z=q?ba.fo(N,y,K,r):ba.fo([1,0,0],[0,1,0],[0,0,1],r);ra.scale(m.Z.Ea,D[0],m.Z.Ea);ra.scale(m.Z.Fa,
D[1],m.Z.Fa);ra.scale(m.Z.Ga,D[2],m.Z.Ga);ba.ko(m.Z,m.v,m.jb);q?x(m,w,w,m.U):(m.fd=ba.OP(L,N,y,K,z),ba.lv(m.fd,m.v,m.pA));h.push.apply(h,g(k,p,f))}}f=n(h);for(h=0;h<f.length;h++)if(l=f[h].qa,l.Jb=f[h].Nf,H(l,f[h].Hd),C(l,d,a),"STATIC"==f[h].o.type&&"COLOR_ID"!=l.type){if(k=ea.sq("%meta%"+l.type+"%"+l.Jb.join("%")+"%"),q=M.Mo(k,"MESH"),M.KO(q,f[h].o),M.Xn(q,a),M.cr(q,a,l),e.push(q),"MAIN"==l.type)for(p=0;p<f[h].nd.length;p++)k=f[h].nd[p].Ua,k.Ys.push(q)}else k=f[h].nd[0].Ua,M.cr(k,a,l);if(Ia.debug_view){for(h=
0;h<f.length;h++)if(d=f[h].o,"DYNAMIC"==d.type&&(k=f[h].nd[0].Ua,l=f[h].qa,"MAIN"==l.type)){p=M.oa(k,a);q=p.R;m=!1;for(p=0;p<q.length;p++)q[p].di&&(m=!0);m||(d=S(d,k.name,!0,l),M.cr(k,a,d))}for(h=0;h<e.length;h++)k=e[h],d=k.o,p=M.oa(k,a),l=p.R[0],"MAIN"==l.type&&(d=S(d,k.name,!1,l),M.cr(k,a,d));for(h=0;h<f.length;h++)l=f[h].qa,"DEBUG_VIEW"==l.type&&(l.Ir=h)}for(h=0;h<c.length;h++)for(p=M.oa(c[h].Ua,a),q=p.R,p=0;p<q.length;p++)b(q[p]);for(h=0;h<e.length;h++)for(p=M.oa(e[h],a),q=p.R,p=0;p<q.length;p++)b(q[p])};
a.QI=function(a,e,f){var g=a.F.Gn,h=d("MAIN");G(h,"sky.glslv","sky.glslf");if(e.procedural_skydome)z(h,"PROCEDURAL_SKYDOME",1),h.Mr=!0;else{var k=g.fn,m=ka.dc(a.F.Ja,va.gg).B.lc;D(h,m,"u_sky");k&&(z(h,"WO_SKYTEX",1),k.invert&&z(h,"MTEX_NEGATIVE",1),k.MF&&z(h,"MTEX_RGBTOINT",1),z(h,"BLENDTYPE",k.zA),k.HF&&z(h,"WOMAP_BLEND",1),k.IF&&z(h,"WOMAP_HORIZ",1),k.KF&&z(h,"WOMAP_ZENUP",1),k.JF&&z(h,"WOMAP_ZENDOWN",1));g.Cq&&z(h,"WO_SKYBLEND",1);g.Dq&&z(h,"WO_SKYPAPER",1);g.Eq&&z(h,"WO_SKYREAL",1)}e.Ed&&(h.Ed=
!0,e.md&&(h.md=!0));h.Sf=99999;l(h,"a_position");e=aa.JM();H(h,e);b(h);f=M.oa(f,a);h.fj=!0;h.Z=ba.qg();h.jb=ba.qg();h.U=ba.sd();h.Pa=ba.sd();h.va=ba.fh();h.gb=ba.fh();y(h);f.R.push(h);ka.dc(a.F.Ja,va.eg)&&(a=c(h),a.type="DEBUG_VIEW",a.sb="",A(a),z(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),e.pa.a_polyindex=ta.Tr(e),H(a,e),a.gm=h.id,y(a),f.R.push(a))};a.Br=function(a,b,d){d=M.oa(a,d).R;var e=[],f=ka.dc(b,va.qd),g=ka.dc(b,va.Wc),h=ka.dc(b,va.fg);b=ka.dc(b,va.Wd);for(var l=0;l<d.length;l++){var k=d[l],m=null;
"SHADOW"==k.type&&"RECEIVE"==k.sb&&k.ie&&(m=c(k),m.sb="CAST");"MAIN"!=k.type&&"PARTICLES"!=k.type||!f&&!g||!k.Ed||(m=c(k),m.sb="REFLECT",m.xi=!1,m.Pe&&(m.Pe=!1,m.Va=!1),m.wa=k.wa);"COLOR_ID"==k.type&&h&&a.o.Ic&&(b&&a.o.Qj?(m=c(k),m.sb="OUTLINE"):k.sb="OUTLINE");m&&(m.Ff=!0,y(m),e.push(m))}d.push.apply(d,e)};a.qQ=x;a.aG=function(a,b,c){b=c*(b.max_z-b.min_z);if(!b)return 0;a=b*Math.tan(ea.deg_to_rad(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.zS=function(a,b,c){b=c*(b.max_z-b.min_z);if(!b)return 0;
a=2*b*a;return ea.rad_to_deg(Math.atan((Math.pow(a+1,4)-Math.pow(a+1,2))/b))};a.mJ=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.BR=J;a.AR=C;a.mQ=v;a.iA=function(a,b){z(a,"CSM_SECTION1",0);z(a,"CSM_SECTION2",0);z(a,"CSM_SECTION3",0);z(a,"NUM_CAST_LAMPS",0);if(b){z(a,"NUM_CAST_LAMPS",b.Cg.length);Ia.Ts&&z(a,"MAC_OS_SHADOW_HACK",1);for(var c=1;c<b.csm_num;c++)z(a,"CSM_SECTION"+String(c),1);z(a,"SHADOW_TEX_RES",da.N(b.csm_resolution));z(a,
"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);z(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else z(a,"SHADOW_TEX_RES",0),z(a,"CSM_FADE_LAST_CASCADE",0),z(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.mb=z;a.Kd=function(a,b){return da.$M(a.ab,b)};a.yR=H;a.zR=y;a.dr=G;a.Xi=D;a.GP=function(a,b,c){c=a.Ie.indexOf(c);-1<c&&(a.Sa[c]=b)};a.UK=function(a,b){var c=d("MAIN");c.yb=!0;O.set(b[0],b[1],b[2],.5,c.xd);c.tg=ta.Jn;H(c,a);G(c,"main.glslv","main_stack.glslf");z(c,"SHADELESS",1);X(c);return c};
a.vc=X;a.MM=function(a,c){for(var e=0;e<c.length;e++){var f=c[e].Ua,g=d("LINE");G(g,"line.glslv","line.glslf");g.yb=!0;g.fj=!0;var h=aa.LM();H(g,h);b(g);g.U=ba.sd();g.Pa=ba.sd();g.Z=ba.qg();g.jb=ba.qg();g.gb=ba.fh();g.va=ba.fh();M.Xn(f,a);M.oa(f,a).R.push(g);X(g)}};a.RJ=function(a){return a.ib.Kp.length?a.ib.Mx.u_cube_fog?!0:!1:!1};a.EK=function(){var a=d("DEPTH_PACK");a.Qb=!0;a.Va=!1;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");X(a);return a};
a.Jv=function(a){var b=d("POSTPROCESSING");G(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":z(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":z(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":z(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":z(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":z(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":z(b,
"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":z(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":z(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:ea.D("Wrong postprocessing effect: "+a)}b.Qb=!0;b.Va=!1;a=aa.Gc();H(b,a);X(b);return b};a.XK=function(a){var b=d("SSAO");b.Va=!1;b.Qb=!0;var c=aa.Gc();H(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");z(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.mq);z(b,"SSAO_HEMISPHERE",a.Xt?
1:0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=wa.Gk(wa.Vg,!1);c.source="NODE_TEX";wa.wq(c,a,0);D(b,c,"u_ssao_special_tex");X(b);return b};a.YK=function(a){var b=d("SSAO_BLUR");b.Va=!1;b.Qb=!0;var c=aa.Gc();H(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");z(b,"SSAO_BLUR_DEPTH",
a.Ut?1:0);X(b);return b};a.BK=function(a){var b=d("COC");b.Va=!1;b.Qb=!0;var c=aa.Gc();H(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");z(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":z(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":z(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":z(b,"COC_TYPE","COC_COMBINE")}X(b);return b};a.FK=function(a){var b=d("DOF");b.Va=!1;b.Qb=!0;var c=aa.Gc();H(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");
a.B.dof_bokeh?z(b,"DOF_TYPE","DOF_BOKEH"):(z(b,"DOF_TYPE","DOF_SIMPLE"),z(b,"DEPTH_RGBA",1));X(b);return b};a.OK=function(){var a=d("OUTLINE");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");X(a);return a};a.HK=function(){var a=d("GLOW_COMBINE");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");X(a);return a};a.IK=function(a,b,c){var e=d("GOD_RAYS");e.Va=!1;e.Qb=!0;var f=aa.DM();
H(e,f);G(e,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");z(e,"DEPTH_RGBA",a?1:0);z(e,"WATER_EFFECTS",b?1:0);z(e,"STEPS_PER_PASS",da.N(c,1));X(e);return e};a.JK=function(){var a=d("GOD_RAYS_COM");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");z(a,"SAFARI_CANVAS_ALPHA_HACK",Ia.$D?1:0);X(a);return a};a.DK=function(a,b){var c=d("SKY");c.Va=!1;c.Qb=!0;var e=aa.FM();H(c,e);b.procedural_skydome?(G(c,"skybox.glslv",
"proc_skybox.glslf"),z(c,"WATER_EFFECTS",1)):(G(c,"skybox.glslv","tex_skybox.glslf"),a&&(e=a.F.Gn,e.St&&D(c,wa.Ld(e.St),"u_sky_texture",e.St.texture.name),e.fn&&z(c,"WO_SKYTEX",1)),b.DE&&z(c,"MTEX_NEGATIVE",1),b.IE&&z(c,"MTEX_RGBTOINT",1),z(c,"BLENDTYPE",b.CE),b.EE&&z(c,"WOMAP_BLEND",1),b.FE&&z(c,"WOMAP_HORIZ",1),b.HE&&z(c,"WOMAP_ZENUP",1),b.GE&&z(c,"WOMAP_ZENDOWN",1),b.Cq&&z(c,"WO_SKYBLEND",1),b.Dq&&z(c,"WO_SKYPAPER",1),b.Eq&&z(c,"WO_SKYREAL",1));c.Z=ba.qg();c.jb=ba.qg();c.U=ba.sd();c.Pa=ba.sd();
c.va=ba.fh();c.gb=ba.fh();X(c);return c};a.GI=function(a,b){var c=ka.dc(a.F.Ja,va.gg);c&&(c=c.Qa[0].ra[0].qa,M.oa(b,a).R.push(c))};a.wK=function(a){var b=d("ANTIALIASING");b.Va=!1;b.Qb=!0;var c=aa.Gc();H(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");Ia.KD?(z(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),z(b,"AA_QUALITY",a.NB)):z(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");X(b);return b};a.VK=function(a){var b=d("SMAA"),c=aa.Gc();H(b,c);G(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");
z(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");z(b,"SMAA_PASS",a);z(b,"SMAA_PREDICATION",0);z(b,"SMAA_REPROJECTION",0);X(b);b.Va=!1;b.Qb=!0;return b};a.CK=function(){var a=d("COMPOSITING");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");X(a);return a};a.NK=function(){var a=d("MOTION_BLUR");a.Qb=!0;a.Va=!1;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");X(a);return a};a.ZK=function(a){var b=
d("STEREO");b.Qb=!0;b.Va=!1;var c=aa.Gc();H(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");z(b,"ANAGLYPH","ANAGLYPH"===a?1:0);z(b,"DISTOR_SCALE",K.nonwebvr.AB);X(b);return b};a.KK=function(){var a=d("LUMINANCE");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");X(a);return a};a.xK=function(){var a=d("LUMINANCE");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");
X(a);return a};a.LK=function(){var a=d("LUMINANCE_X_BLUR");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");X(a);return a};a.zK=function(){var a=d("POSTPROCESSING");a.Qb=!0;a.Va=!1;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");X(a);return a};a.AK=function(){var a=d("BLOOM");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
X(a);return a};a.wL=function(){var a=d("VELOCITY");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");X(a);return a};a.vK=function(){var a=d("ANCHOR_VISIBILITY");a.Va=!0;a.Qb=!0;a.tg=ta.Jn;G(a,"anchors.glslv","anchors.glslf");var b=aa.TB(1);H(a,b);z(a,"ANCHOR_NUM",1);X(a);a.lk=new Float32Array(3);return a};a.PK=function(){var a=d("PERFORMANCE");a.Va=!1;a.Qb=!0;var b=aa.Gc();H(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
X(a);return a};a.xR=function(a,b){var c=b.length/3;if(c!=a.lk.length/3){var d=aa.TB(c);H(a,d);z(a,"ANCHOR_NUM",c);X(a)}a.lk=b};a.vw=function(a){if(!a.K.length)return null;a=a.K[0];return a.R.length?a.R[0]:null};a.Oa=function(a,b,c){a=a.K[0].R;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].Ff&&-1!=a[d].Jb.indexOf(b))return a[d];return null};a.af=function(a,b,c){a=a.K[0].R;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].Ff&&-1!=a[d].Jb.indexOf(b))return a[d];return null};a.Xw=function(a,b,c,d){a=
a.K[0].R;for(var e=0;e<a.length;e++){var f=a[e];if(-1!=f.Jb.indexOf(b)&&(!d||f.type==d)&&c(f))break}};a.qT=function(a,b){for(var c=a.K[0].R,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.XA=function(a){for(var b=a.Sa,c=0;c<b.length;c++);a.da&&a.da.Bf&&ta.hK(a.da);a.Bf&&a.ne.length&&W.kK(a);a.ib&&a.ib.Bf&&da.jK(a.ib);a.Cj&&(b=ca.hC(a.Cj))&&b.WA&&ca.iK(a.Cj)};a.NM=V;a.set_nodemat_value=function(a,b,c,d){for(var e=0;e<a.K.length;e++)for(var f=a.K[e].R,g=0;g<f.length;g++){var h=f[g];-1!=h.Jb.indexOf(b)&&
h.Gg&&(h.Gg[c]=d)}};a.set_nodemat_rgb=function(a,b,c,d,e,f){for(var g=0;g<a.K.length;g++)for(var h=a.K[g].R,l=0;l<h.length;l++){var k=h[l];-1!=k.Jb.indexOf(b)&&k.Bd&&(k.Bd[3*c]=d,k.Bd[3*c+1]=e,k.Bd[3*c+2]=f)}};a.get_nodemat_value=function(a,b){return a.Gg[b]};a.get_nodemat_rgb=function(a,b,c){c[0]=a.Bd[3*b];c[1]=a.Bd[3*b+1];c[2]=a.Bd[3*b+2];return c};a.ph=function(a,b){var c;c=b[1];for(var d=2;d<b.length;d++)c+="%join%"+b[d];for(d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null};a.cleanup=
function(){Ga={}}};b4w.module.__nodemat=function(a,r){function d(a,b,e,g,h){var l=Ta.get_active(),l=m(b,h,l.uuid);if(l in Fa)return Fa[l];var p={Ja:null,id:l,WA:!0};e||(La={},fa=0);if("SHADOW"!=h&&"COLOR_ID"!=h){b=T.create();for(var v=a.nodes,u=0;u<v.length;u++)if(null==V(b,v[u],0,g,h))return Fa[l]=null,p;if(e&&-1==G(a,b,"GROUP_OUTPUT","group"))return p;u=ea(b);v=e?a.links:a.links.slice();if(!ra(b,v,u))return p;if(e)return p.Ja=b,p;for(u=0;u<v.length;u++){e=v[u];for(var w=E(e.from_node,b),x=E(e.to_node,b),K=0;K<w.length;K++)for(var D=
0;D<x.length;D++){var r=w[K],z=x[D],L=T.Ra(b,r),A=T.Ra(b,z);if(!sa(b,r,z,L,A,e))return Fa[l]=null,p}}q(b);u=-1;"GLOW"==h?u=G(a,b,"B4W_GLOW_OUTPUT","material",!0):(u=G(a,b,"OUTPUT","material",!1,!0),-1==u&&(u=G(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==u&&(b=k(),u=0);J(b);a=T.mn(b,u,T.Sl);c(a,g);n(a,g);f(a);I(a);y(a);t(a,g,h);ia(a)}else g=d(a,b,e,g,"MAIN"),g=T.clone(g.Ja,function(a){var b=Ea.zo(a);b.inputs=Ea.S(a.inputs);b.outputs=Ea.S(a.outputs);return b}),u=G(a,g,"OUTPUT","material",!1,!0),-1==
u&&(u=G(a,g,"OUTPUT_MATERIAL","material",!1,!0)),B(g,u),a=T.mn(g,u,T.Sl),f(a);p.Ja=a;return Fa[l]=p}function c(a,c){var d=[];T.ha(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({ol:a,node:b})});for(var e=0;e<d.length;++e){var f=d[e].ol,g=d[e].node,h=T.lj(a);T.Xg(a,h,g.data.CO);var l=T.lj(a);T.Xg(a,l,g.data.DO);T.Nc(a,h,l,[4,2]);for(var k={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},m=T.Yk(a,f),n=[],p=[],q=[],t=
{},v=0;v<m;v++){var u=T.nh(a,f,v);u in t||(t[u]=0);var w=T.yd(a,u,f,t[u]++);n.push([u,f,w]);var x=k[w[1]];if(x)switch(x[0]){case "MATERIAL_END":p.push([u,l,[w[0],x[1]]]);break;case "LIGHTING_APPLY":q.push([u,[w[0],x[1]]])}else p.push([u,h,w])}b(a,g.data.value,h,l,q,c);for(v=0;v<n.length;v++)T.Wm(a,n[v][0],n[v][1],n[v][2]);for(v=0;v<p.length;v++)T.Nc(a,p[v][0],p[v][1],p[v][2]);g=T.Ig(a,f);h=[];k=[];m={};for(v=0;v<g;v++)n=T.qh(a,f,v),n in m||(m[n]=0),w=T.yd(a,f,n,m[n]++),h.push([f,n,w]),k.push([l,n,
w]);for(v=0;v<h.length;v++)T.Wm(a,h[v][0],h[v][1],h[v][2]);for(v=0;v<k.length;v++)T.Nc(a,k[v][0],k[v][1],k[v][2]);T.Vf(a,f)}}function b(a,b,c,d,e,f){var h={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},l=V(a,h,0,f,null),k=l;g(a,c,l,"E");g(a,c,l,"A");g(a,c,l,"D");l=Ta.get_active();l=Ga.Ib(l,"LAMP",Ga.DATA_ID_ALL);if(!b.le)for(var m,n,p,q=0;q<l.length;q++){p=l[q].nb;h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};m=V(a,h,0,f,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=V(a,h,0,f,null);g(a,
k,n,"color");g(a,k,n,"specular");g(a,m,n,"ldir");g(a,c,n,"normal");g(a,c,n,"D");g(a,c,n,"S");g(a,m,n,"lcolorint");g(a,c,m,"shadow_factor");k="SPECULAR_"+b.jq;h={name:k,type:k,use_tangent_shading:b.Jl};k=V(a,h,0,f,null);g(a,m,k,"ldir");g(a,m,k,"lfac");g(a,c,k,"normal");g(a,k,n,"sfactor");g(a,m,k,"norm_fac");g(a,c,k,"sp_params");k="HEMI"==p.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.To;h={name:k,type:k,use_tangent_shading:b.Jl};p=V(a,h,0,f,null);g(a,m,p,"ldir");g(a,m,p,"lfac");g(a,c,p,"normal");g(a,m,p,"norm_fac");
g(a,p,n,"lfactor");"DIFFUSE_LAMBERT"!=k&&g(a,c,p,"dif_params");for(m=0;m<e.length;m++)T.Nc(a,e[m][0],n,e[m][1]);k=n}g(a,k,d,"color");g(a,k,d,"specular")}function g(a,b,c,d){for(var e=T.Ra(a,b),f=-1,g=T.Ra(a,c).inputs,h=0;h<g.length;h++)if(d==g[h].identifier){f=h;break}if(-1!=f){for(var l=-1,e=e.outputs,h=0;h<e.length;h++)if(d==e[h].identifier){l=h;break}-1!=l&&(T.Nc(a,b,c,[l,f]),e[l].Ka=!0,g[f].Ka=!0)}}function n(a,b){var c=[];T.ha(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({ol:a,node:b})});
for(var d=0;d<c.length;++d){var e=c[d].ol,f=c[d].node,g=!1,h=T.lj(a);T.Xg(a,h,f.data.YO);for(var l=T.Yk(a,e),k=[],m=[],n={},p=0;p<l;p++){var q=T.nh(a,e,p);q in n||(n[q]=0);var t=T.yd(a,q,e,n[q]++);k.push([q,e,t]);switch(t[1]){case 0:m.push([q,h,t]);break;case 2:var g=!0,v=T.lj(a);T.Xg(a,v,f.data.KL);m.push([q,v,[t[0],0]])}}for(p=0;p<k.length;p++)T.Wm(a,k[p][0],k[p][1],k[p][2]);for(p=0;p<m.length;p++)T.Nc(a,m[p][0],m[p][1],m[p][2]);T.Vf(a,e);g&&x(a,h,v);w(a,b)}}function x(a,b,c){b=T.mn(a,b,T.Sl);var d=
u(b);if(0<d.length){c=T.mn(a,c,T.Sl);c=T.clone(c,X,wa);T.ha(c,function(a,b){b.name="displacement%join%"+b.name});T.fA(c,b,[],[]);var f=-1;T.ha(b,function(a,b){if("DISPLACEMENT_BUMP"==b.type)return f=a,1});for(c=0;c<d.length;c++){var h=d[c],l=T.Ra(b,h);g(b,f,h,"Normal");e(l)}}a.V=b.V;a.za=b.za}function e(a){a=a.hb;for(var b=0;b<a.length;b++){var c=a[b];"USE_NORMAL_IN"==c[0]&&(c[1]=1)}}function u(a){var b=[];T.ha(a,function(a,c){for(var d=!1,e=c.inputs,f=0;f<e.length;f++)if("Normal"==e[f].identifier){d=
!e[f].Ka;break}d&&b.push(a)});return b}function w(a,b){var c=[];T.ha(a,function(a,b){"OUTPUT_SURFACE"==b.type&&c.push({ol:a,node:b})});var d=[];0<c.length&&T.ha(a,function(a,b){"MIX_SHADER"==b.type&&d.push({ol:a,node:b})});for(var e=0;e<c.length;++e){var f=c[e].ol,g=c[e].node,l=T.lj(a);T.Xg(a,l,g.data.xJ);var k=T.lj(a);T.Xg(a,k,g.data.yJ);T.Nc(a,l,k,[4,2]);for(var m=T.Yk(a,f),n=[],p=[],q={},t=0;t<m;t++){var v=T.nh(a,f,t),u=T.Ra(a,v);v in q||(q[v]=0);var w=T.yd(a,v,f,q[v]++);n.push([v,f,w]);p.push([v,
l,w]);if("BSDF_GLOSSY"==u.type||"BSDF_DIFFUSE"==u.type||"MIX_SHADER"==u.type||"EMISSION"==u.type||"BSDF_TRANSPARENT"==u.type)for(p.push([v,l,[1,1]]),p.push([v,l,[2,2]]),p.push([v,l,[3,3]]),p.push([v,l,[4,4]]),p.push([v,l,[5,5]]),p.push([v,l,[6,6]]),p.push([v,l,[7,7]]),p.push([v,l,[8,8]]),p.push([v,l,[9,9]]),p.push([v,l,[10,10]]),v=0;v<d.length;++v)for(var u=d[v].ol,w=T.Yk(a,u),x=0;x<w;x++){var K=T.nh(a,u,x),y=T.Ra(a,K),D=T.yd(a,K,u,0);0==D[1]||"BSDF_GLOSSY"!=y.type&&"BSDF_DIFFUSE"!=y.type&&"MIX_SHADER"!=
y.type&&"EMISSION"!=y.type&&"BSDF_TRANSPARENT"!=y.type||(y=1==D[1]?3:13,p.push([K,u,[1,y]]),p.push([K,u,[2,y+1]]),p.push([K,u,[3,y+2]]),p.push([K,u,[4,y+3]]),p.push([K,u,[5,y+4]]),p.push([K,u,[6,y+5]]),p.push([K,u,[7,y+6]]),p.push([K,u,[8,y+7]]),p.push([K,u,[9,y+8]]),p.push([K,u,[10,y+9]]))}}h(a,g.data.value,l,k,b);p.push([k,f,[0,0]]);for(t=0;t<n.length;t++)T.Wm(a,n[t][0],n[t][1],n[t][2]);for(t=0;t<p.length;t++)T.Nc(a,p[t][0],p[t][1],p[t][2])}}function h(a,b,c,d,e){var f=[],h={name:"LIGHTING_AMBIENT",
type:"LIGHTING_AMBIENT"},l=V(a,h,0,e,null),k=l;g(a,c,l,"E");g(a,c,l,"A");g(a,c,l,"D");for(var l=Ta.get_active(),l=Ga.Ib(l,"LAMP",Ga.DATA_ID_ALL),m,n,p=0;p<l.length;p++){h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};m=V(a,h,0,e,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=V(a,h,0,e,null);g(a,k,n,"color");g(a,k,n,"specular");g(a,m,n,"ldir");g(a,c,n,"normal");g(a,c,n,"D");g(a,c,n,"S");g(a,m,n,"lcolorint");g(a,c,m,"shadow_factor");k=b.zJ;h={name:k,type:k};k=V(a,h,0,e,null);g(a,m,k,"ldir");
g(a,m,k,"lfac");g(a,c,k,"normal");g(a,m,k,"norm_fac");g(a,c,k,"bsdf_params");g(a,k,n,"lfactor");g(a,k,n,"sfactor");for(k=0;k<f.length;k++)T.Nc(a,f[k][0],n,f[k][1]);k=n}g(a,c,d,"s_color");g(a,c,d,"metalness");g(a,c,d,"e_color");g(a,c,d,"emission");g(a,c,d,"a_color");g(a,c,d,"alpha");g(a,k,d,"color");g(a,k,d,"specular")}function m(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function B(a,b){T.ag(a,function(c,d,e){var f=T.Ra(a,d);
d==b&&"Color"==f.inputs[e[1]].identifier&&T.Wm(a,c,d,e)})}function k(){var a=T.create();T.Xg(a,0,{data:null,hb:[],X:[],inputs:[{ya:new Float32Array([0,0,0]),identifier:"Color",Ka:!1,name:"Color"},{ya:1,identifier:"Alpha",Ka:!1,name:"Alpha"}],outputs:[],type:"OUTPUT",oe:[]});return a}function f(a){T.ha(a,function(b,c){for(var d=c.inputs,e=c.outputs,f=0;f<d.length;f++)F(a,d[f],b,f,1);for(f=0;f<e.length;f++)F(a,e[f],b,f,0)})}function F(a,b,c,d,e){if(b.Ka){var f=!0;T.ag(a,function(a,b,g){if(!e&&a==c&&
g[0]==d||e&&b==c&&g[1]==d)f=!1});f&&(b.Ka=!1)}}function t(a,b,c){var d=[];T.ag(a,function(e,f,g){var h=T.Ra(a,e),l=T.Ra(a,f),h=Ea.is_vector(h.outputs[g[0]].ya),l=Ea.is_vector(l.inputs[g[1]].ya);if(h!=l){var k,m={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!l?k=D("vector_to_scalar","B4W_VECTOSCAL",[m],[n]):!h&&l&&(k=D("scalar_to_vector","B4W_SCALTOVEC",[n],[m]));V(a,k,0,b,c);d.push([e,f,a.V[a.V.length-2],
g])}});for(var e=0;e<d.length;++e)T.Wm(a,d[e][0],d[e][1],d[e][3]),T.Nc(a,d[e][0],d[e][2],[d[e][3][0],0]),T.Nc(a,d[e][2],d[e][1],[0,d[e][3][1]])}function q(a){var b=[];T.ha(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":T.ag(a,function(e,f,g){var h=T.Ra(a,f);e==c&&"MATERIAL_EXT"==h.type&&"Translucency"==d.outputs[g[0]].name&&b.push(e,f,[g[0]+1,g[1]+1])})}});for(var c=0;c<b.length;c+=3)T.Nc(a,b[c],b[c+1],b[c+2])}function E(a,b){var c=[];T.ha(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;
Ea.D("Node not found")}function J(a){var b=[];T.ha(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type)A(a,d,e);else if("REROUTE"==e.type){for(var f=T.nh(a,d,0),g=T.Ig(a,d),h=[],l=[],k=[],m=0;m<g;m++){var n=T.qh(a,d,m),p=l.indexOf(n),q=T.yd(a,d,n,0<=p?k[p]:0);if(q){var q=q[1],t=e.inputs[0].ya,q=T.Ra(a,n).inputs[q];switch(typeof t){case "number":if("object"==typeof q.ya)for(var v=q.ya,q=0;q<v.length;q++)v[q]=
t;else"number"==typeof q.ya&&(q.ya=t);break;case "object":if("object"==typeof q.ya)for(v=q.ya,q=0;q<v.length;q++)v[q]=t[q];else"number"==typeof q.ya&&(q.ya=.35*t[0]+.45*t[1]+.2*t[2])}}t=e.outputs;for(q=0;q<t.length;q++)t[q].ya=e.inputs[0].ya;-1!=p?k[p]+=1:(l.push(n),k.push(1),h.push(d,n))}if(-1!=f)for(e=T.yd(a,f,d,0)[0],m=0;m<l.length;m++)for(q=0;q<k[m];q++)g=T.yd(a,d,l[m],q)[1],T.Nc(a,f,l[m],[e,g]);for(m=0;m<h.length;m+=2)T.Pj(a,h[m],h[m+1],-1)}}}function A(a,b,c){var d;a:{d=a.za;for(var e=0;e<d.length;e+=
3)if(d[e+1]==b&&1==d[e+2][1]){d=d[e];break a}d=-1}-1!=d&&(e=T.Ra(a,d),c.data=e.data,T.Pj(a,d,b,-1),0==T.Ig(a,d)&&(b=T.nh(a,d,0),-1!=b&&T.Pj(a,b,d,-1),T.Vf(a,d)));c.inputs.splice(1,1)}function I(a){l(a);p(a);C(a)}function C(a){var b={};T.ha(a,function(a,c){if("GEOMETRY_UV"==c.type||"UVMAP"==c.type||"TEX_COORD_UV"==c.type){var d=c.data.value;d in b||(b[d]=[]);b[d].push(a,c)}});for(var c in b){var d=b[c];if(2<d.length)for(var e=v(c),e=V(a,e,0,"",void 0),f=T.Ra(a,e),g=0;g<d.length;g+=2){for(var h=d[g],
l=d[g+1],k=[],m={},n=T.Ig(a,h),p=0;p<n;p++){var q=T.qh(a,h,p);q in m||(m[q]=0);var t=T.yd(a,h,q,m[q]);m[q]++;k.push(h,q,t);t=t.splice(0,t.length);switch(l.type){case "GEOMETRY_UV":t[0]=0;f.outputs[0].Ka=!0;break;case "UVMAP":case "TEX_COORD_UV":t[0]=1,f.outputs[1].Ka=!0}T.Nc(a,e,q,t)}for(p=0;p<k.length;p+=3)T.Pj(a,k[p],k[p+1],0);T.Vf(a,h)}}}function v(a){var b=D("merged_uv","UV_MERGED",[],[{default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},{default_value:[0,0,0],identifier:"UV_cycles",
is_linked:!1,name:"UV_cycles"}]);b.uv_layer=a;return b}function l(a){var b=[];T.ha(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],g=!0,h=0;h<c.length;h++){var l=c[h];if(Q(f,l.Ue)){for(var g=[],h=T.Ig(a,e),k=0;k<h;k++){var m=T.qh(a,e,k),n=T.yd(a,e,m,0);g.push(e,
m,n);T.Nc(a,l.id,m,n)}for(k=0;k<g.length;k+=3)T.Pj(a,g[k],g[k+1],0);T.Vf(a,e);g=!1;break}}g&&(l={id:e,Ue:f},c.push(l))}}function z(a){for(var b={},c=0;c<a.V.length;c+=2){var d=a.V[c];b[d]={$n:{},GC:!1}}for(c=0;c<a.za.length;c+=3)b[a.za[c+1]].$n[a.za[c]]=!0;for(d in b)H(d,b);for(d in b)b[d]=Object.keys(b[d].$n).map(function(a){return parseInt(a,10)});return b}function H(a,b){var c=b[a];if(!c.GC){var d=Ea.S(c),e;for(e in c.$n){H(e,b);var c=b[e],f;for(f in c.$n)d.$n[f]=!0}d.GC=!0;b[a]=d}}function p(a){var b=
[];T.ha(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=z(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,l=0;l<d.length;l++){var k=d[l];if(!(3<=k.Km.length||!Q(g,k.Ue)||-1<c[f].indexOf(k.id)||-1<c[k.id].indexOf(f))){for(var m=!1,n=0;n<k.Km.length;n++){var p=k.Km[n].id;if(-1<c[f].indexOf(p)||-1<c[p].indexOf(f)){m=!0;break}}if(!m){for(var l=[],p=T.Yk(a,f),q={},n=0;n<p;n++)m=T.nh(a,f,n),m in q||(q[m]=0),h=T.yd(a,m,f,q[m]++),l.push(m,
f,h);for(var p=[],q=T.Ig(a,f),t={},n=0;n<q;n++)m=T.qh(a,f,n),m in t||(t[m]=0),h=T.yd(a,f,m,t[m]++),p.push(f,m,h);h=l.concat(p);for(n=0;n<h.length;n+=3)T.Pj(a,h[n],h[n+1],0);T.Vf(a,f);n={id:f,Ue:g,SL:l,TL:p};k.Km.push(n);h=!1;break}}}h&&(k={id:f,Ue:g,Km:[]},d.push(k))}for(e=0;e<d.length;e++){k=d[e];c=k.Km.length;for(l=0;l<c;l++){g=k.Km[l];n=g.Ue;f=g.SL;g=g.TL;k.Ue.inputs[l+1].Ka=n.inputs[0].Ka;k.Ue.inputs[l+1].ya=n.inputs[0].ya;k.Ue.outputs[2*(l+1)].Ka=n.outputs[0].Ka;k.Ue.outputs[2*(l+1)].ya=n.outputs[0].ya;
k.Ue.outputs[2*(l+1)+1].Ka=n.outputs[1].Ka;k.Ue.outputs[2*(l+1)+1].ya=n.outputs[1].ya;for(n=0;n<f.length;n+=3)m=f[n],h=f[n+2],h[1]+=l+1,T.Nc(a,m,k.id,h);for(n=0;n<g.length;n+=3)m=g[n+1],h=g[n+2],h[0]+=2*(l+1),T.Nc(a,k.id,m,h);k.Ue.hb.push(["USE_uv"+(l+2),1])}T.Vf(a,k.id);T.Xg(a,k.id,k.Ue)}}}function Q(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":for(var c=a.hb,d=-1,e=0;e<c.length;e++){var f=c[e];if("USE_NORMAL_IN"==f[0]){d=
f[1];break}}c=b.hb;f=-1;for(e=0;e<c.length;e++){var g=c[e];if("USE_NORMAL_IN"==g[0]){f=g[1];break}}return d===f;case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.nv==b.data.nv&&a.data.value.zm==b.data.value.zm;case "VALUE":case "RGB":return a.Cd==b.Cd;default:return!1}}function y(a){var b=[],c=[];T.ha(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);
"GEOMETRY_VW"==d.type&&c.push(a,d)});Z(a,b);S(a,c)}function Z(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,g=[],h=[],l=[[],[],[]],k=T.Ig(a,d),m=0;m<k;m++){var n=T.qh(a,d,m);if("SEPRGB"!=T.Ra(a,n).type){f=!1;break}g.push(d,n);for(var p={},q=T.Ig(a,n),f=0;f<q;f++){var t=T.qh(a,n,f);t in p||(p[t]=0);var v=T.yd(a,n,t,p[t]++);g.push(n,t);l[v[0]].push(d,t,v)}h.push(n);f=!0}if(f){for(m=d=k=0;m<l.length;m++)l[m].length&&(k++,d|=1<<2-m);if(k){e.type+=k;e.outputs=[];for(m=0;m<l.length;m++)if(l[m].length)for(e.outputs.push({ya:0,
identifier:"RGB"[m],Ka:!0,name:"RGB"[m]}),f=0;f<l[m].length;f+=3)l[m][f+2][0]=Ea.Ym(d,m);for(m=0;m<g.length;m+=2)T.Pj(a,g[m],g[m+1],0);for(m=0;m<h.length;m++)T.Vf(a,h[m]);for(m=0;m<l.length;m++)for(f=0;f<l[m].length;f+=3)T.Nc(a,l[m][f],l[m][f+1],l[m][f+2])}}}}function S(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=!0,f=[],g=T.Ig(a,d),h=0;h<g;h++){var l=T.qh(a,d,h);if("B4W_REFLECT"==T.Ra(a,l).type){var k=T.yd(a,d,l,0),m=T.yd(a,d,l,1);k&&1==k[1]||m&&1==m[1]?e=!1:f.push(d,l)}else e=!1}for(h=0;h<
f.length;h+=2)g=a,k=f[h],l=f[h+1],m=T.Ra(g,l),m.type+="_WORLD",T.Pj(g,k,l,0),m.inputs.splice(0,1),k=T.nh(g,l,0),k!=T.Ou&&(T.yd(g,k,l,0)[1]=0);e&&T.Vf(a,d)}}function G(a,b,c,d,e,f){a=a.nodes;for(var g=null,h=0;h<a.length;h++){var l=a[h];e?"GROUP"==l.type&&l.node_tree_name==c&&(g=l):l.type==c&&(g=l)}return g?E(g,b)[0]:(f||N.error('No "'+c+'" node in node '+d),-1)}function D(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function X(a){var b={name:"",Cd:"",type:"",oe:[],inputs:[],outputs:[],X:[],data:null,
hb:[]};b.name=a.name;b.Cd=a.Cd;b.type=a.type;for(var c=b.oe,d=a.oe,e=0;e<d.length;e++)c.push(va(d[e]));c=b.X;d=a.X;for(e=0;e<d.length;e++)c.push(va(d[e]));c=b.inputs;d=a.inputs;for(e=0;e<d.length;e++)c.push(ma(d[e]));c=b.outputs;d=a.outputs;for(e=0;e<d.length;e++)c.push(ma(d[e]));c=b.hb;d=a.hb;for(e=0;e<d.length;e++)c.push(d[e].slice());b.data=a.data;return b}function V(a,b,c,d,e){var f=b.name,g=b.name,h=b.type,l=[],k=[],m=[],n=[],p=null,q=[];switch(h){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":k=
W(b);m=ka(b);N.warn(h+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":k=W(b);m=ka(b);break;case "MIX_SHADER":k.push(M(b,"Fac"));var t=M(b,"Shader"),m=t.Ka;k.push(t);(t=M(b,"Shader_001"))||(t=M(b,"Shader.001"));var v=t.Ka;k.push(t);k.push(P("d_color1","d_color1",[0,0,0],m));k.push(P("d_roughness1","d_roughness1",0,m));k.push(P("s_color1","s_color1",[0,0,0],m));k.push(P("s_roughness1","s_roughness1",0,m));k.push(P("metalness1","metalness1",0,m));k.push(P("normal1","normal1",
[0,0,0],m));k.push(P("e_color1","e_color1",[0,0,0],m));k.push(P("emission1","emission1",0,m));k.push(P("a_color1","a_color1",[0,0,0],m));k.push(P("alpha1","alpha1",1,m));k.push(P("d_color2","d_color2",[0,0,0],v));k.push(P("d_roughness2","d_roughness2",0,v));k.push(P("s_color2","s_color2",[0,0,0],v));k.push(P("s_roughness2","s_roughness2",0,v));k.push(P("metalness2","metalness2",0,v));k.push(P("normal2","normal2",[0,0,0],v));k.push(P("e_color2","e_color2",[0,0,0],v));k.push(P("emission2","emission2",
0,v));k.push(P("a_color2","a_color2",[0,0,0],v));k.push(P("alpha2","alpha2",1,v));m=la(b,"Shader");t=m.Ka;m=[m,P("d_color","d_color",[0,0,0],t),P("d_roughness","d_roughness",0,t),P("s_color","s_color",[0,0,0],t),P("s_roughness","s_roughness",0,t),P("metalness","metalness",0,t),P("normal","normal",[0,0,0],t),P("e_color","e_color",[0,0,0],t),P("emission","emission",0,t),P("a_color","a_color",[0,0,0],t),P("alpha","alpha",1,t)];break;case "OBJECT_INFO":var k=W(b),m=[],t=la(b,"Location"),v=la(b,"Object Index"),
u=la(b,"Material Index"),w=la(b,"Random");m.push(t);m.push(v);m.push(u);m.push(w);q.push(["USE_LOCATION_OUT",t.Ka|0]);q.push(["USE_OBJ_IND_OUT",v.Ka|0]);q.push(["USE_MAT_IND_OUT",u.Ka|0]);q.push(["USE_RANDOM_OUT",w.Ka|0]);break;case "UVMAP":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=Y("param_"+h+"_a"),v=Y("param_"+h+"_v"),l.push(da(p)),l.push(da(v)),n.push(da(v)),p={name:p,value:t});m=ka(b);break;case "UV_MERGED":p=Y("param_UV_MERGED_a");v=Y("param_UV_MERGED_v");l.push(da(p));l.push(da(v));
m.push(la(b,"UV_geom"));m.push(la(b,"UV_cycles"));n.push(da(v));p={name:p,value:b.uv_layer};break;case "CAMERA":k=[];m=ka(b);break;case "COMBRGB":case "COMBHSV":k=W(b);m=ka(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==h?(na(b,0,0)&&q.push(["READ_R",1]),na(b,1,0)&&q.push(["READ_G",1]),na(b,2,0)&&q.push(["READ_B",1]),na(b,3,0)&&q.push(["READ_A",1])):(na(b,0,-1)&&q.push(["READ_R",1]),na(b,1,-1)&&q.push(["READ_G",1]),na(b,2,-1)&&q.push(["READ_B",1]));k=W(b);m=ka(b);p={value:b};break;case "PARTICLE_INFO":k=
W(b);m=ka(b);for(v=0;v<b.outputs.length;v++){var u=b.outputs[v],w=u.identifier,x=da("v_param_PART_INFO_"+w.replace(" ",""));if(u.is_linked)switch(w){case "Size":q.push(["PART_INFO_SIZE",qa.N(1)]);break;case "Age":q.push(["PART_INFO_AGE",qa.N(1)]);break;case "Lifetime":q.push(["PART_INFO_LT",qa.N(1)]);break;case "Location":q.push(["PART_INFO_LOC",qa.N(1)]);break;case "Index":p=t=da("a_param_PART_INFO_"+u.identifier.replace(" ",""));q.push(["PART_INFO_IND",qa.N(1)]);break;case "Velocity":q.push(["PART_INFO_VEL",
qa.N(1)]);break;case "Angular Velocity":q.push(["PART_INFO_A_VEL",qa.N(1)])}"Age"!=w&&"Lifetime"!=w&&"Size"!=w&&(l.push(x),n.push(x))}t&&l.push(t);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!ha(b))return!0;h=U(b,c);if(!h)return N.error("Geometry output is not supported"),null;switch(h){case "GEOMETRY_UV":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=Y("param_GEOMETRY_UV_a"),v=Y("param_GEOMETRY_UV_v"),l.push(da(p)),l.push(da(v)),n.push(da(v)),p={name:p,value:t});m.push(la(b,"UV"));break;case "GEOMETRY_VC":(t=
b.color_layer)||(h="EMPTY_VC");"EMPTY_VC"!=h&&(p=Y("param_GEOMETRY_VC_a"),v=Y("param_GEOMETRY_VC_v"),l.push(da(p)),l.push(da(v)),n.push(da(v)),p={name:p,value:t});m.push(la(b,"Vertex Color"));break;case "GEOMETRY_NO":k.push(P("Normal","Normal",[0,0,0],!1));q.push(["USE_NORMAL_IN",0]);m.push(la(b,"Normal"));break;case "GEOMETRY_TRN":h="GEOMETRY_NO";m.push(la(b,"True Normal"));N.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":m.push(la(b,"Front/Back"));break;case "GEOMETRY_VW":m.push(la(b,
"View"));break;case "GEOMETRY_GL":m.push(la(b,"Global")||la(b,"Position"));break;case "GEOMETRY_LO":m.push(la(b,"Local"));break;case "GEOMETRY_OR":t=Y("param_GEOMETRY_OR_v");l.push(da(t));m.push(la(b,"Orco"));n.push(da(t));break;case "GEOMETRY_IN":m.push(la(b,"Incoming"));break;case "GEOMETRY_BF":m.push(la(b,"Backfacing"))}break;case "TEX_COORD":if(!ha(b))return!0;h=ga(b,c);switch(h){case "TEX_COORD_UV":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=Y("param_TEX_COORD_UV_a"),v=Y("param_TEX_COORD_UV_v"),
l.push(da(p)),l.push(da(v)),n.push(da(v)),p={name:p,value:b.uv_layer});m.push(la(b,"UV"));break;case "TEX_COORD_NO":m.push(la(b,"Normal"));break;case "TEX_COORD_GE":t=Y("param_TEX_COORD_GE_v");l.push(da(t));m.push(la(b,"Generated"));n.push(da(t));break;case "TEX_COORD_OB":m.push(la(b,"Object"));break;case "TEX_COORD_CA":m.push(la(b,"Camera"));break;case "TEX_COORD_WI":m.push(la(b,"Window"));break;case "TEX_COORD_RE":m.push(la(b,"Reflection"))}break;case "GROUP":t=b.node_tree_name;switch(t){case "B4W_LINEAR_TO_SRGB":if(!L(b,
[1],[1])){p=ba(b,d,e);break}h="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!L(b,[1],[1])){p=ba(b,d,e);break}h="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!L(b,[1],[1])){p=ba(b,d,e);break}h="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!L(b,[1,1],[1])){p=ba(b,d,e);break}h="B4W_REFLECT";break;case "B4W_REFRACTION":if(!L(b,[1,0],[1])){p=ba(b,d,e);break}h="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!L(b,[1,1,0,0,0],[1])){p=ba(b,d,e);break}v=Y("param_B4W_PARALLAX_texture");
n.push(da(v));h="B4W_PARALLAX";break;case "B4W_CLAMP":if(!L(b,[1],[1])){p=ba(b,d,e);break}h="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!L(b,[0,0,0,0,0],[0])){p=ba(b,d,e);break}h="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!L(b,[],[0])){p=ba(b,d,e);break}h="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!L(b,[0,0,0],[0])){p=ba(b,d,e);break}h="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":h="B4W_GLOW_OUTPUT";break;default:p=ba(b,d,e)}k=W(b);m=ka(b);"B4W_TRANSLUCENCY"==t&&(t=P("TranslucencyParams","TranslucencyParams",
[0,0,0,0]),t.Ka=m[0].Ka,m.push(t));break;case "LAMP":(t=b.lamp)?(t.uuid in La?q.push(["LAMP_INDEX",String(La[t.uuid])]):(La[t.uuid]=fa,q.push(["LAMP_INDEX",String(fa++)])),p=La):(N.error("There is no lamp in node: "+b.name),q.push(["LAMP_INDEX",-1]));m.push(la(b,"Color"));m.push(la(b,"Light Vector"));m.push(la(b,"Distance"));m.push(la(b,"Visibility Factor"));break;case "LIGHTING_AMBIENT":k=[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0)];m=[P("color","color",[0,0,0],!0),P("specular",
"specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":m=[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("dif_params","dif_params",[0,0],!0),P("sp_params","sp_params",[0,0],!0),P("shadow_factor","shadow_factor",0,!0),P("translucency_color","translucency_color",0,!0),P("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":k=[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0)];break;
case "LIGHTING_LAMP":k=[P("shadow_factor","shadow_factor",0,!0)];m=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("lcolorint","lcolorint",[0,0,0],!0),P("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":k=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0)];m=[P("lfactor","lfactor",0,!0)];q.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":k=
[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("dif_params","dif_params",[0,0],!0)];m=[P("lfactor","lfactor",0,!0)];q.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":k=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("sp_params","sp_params",[0,0],!0)];m=[P("sfactor","sfactor",0,
!0)];q.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":k=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("sp_params","sp_params",[0,0],!0)];m=[P("sfactor","sfactor",0,!0)];q.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":k=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),
P("bsdf_params","bsdf_params",[0,0,0,0],!0)];m=[P("lfactor","lfactor",0,!0),P("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":k=[P("color","color",[0,0,0,0],!0),P("specular","specular",[0,0,0],!0),P("lfactor","lfactor",0,!0),P("sfactor","sfactor",0,!0),P("ldir","ldir",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("translucency_params","translucency_params",[0,0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("lcolorint","lcolorint",[0,0,0],!0),P("translucency_color","translucency_color",
0,!0)];m=[P("color","color",[0,0,0,0],!0),P("specular","specular",[0,0,0],!0)];break;case "NORMAL":k=W(b);m=ka(b);t=la(b,"Normal");n.push(da(Y("param_NORMAL_Normal"),t.ya,3));break;case "MAPPING":t=b.vector_type;h="MAPPING";k.push(M(b,"Vector"));m.push(la(b,"Vector"));var v=Ea.f32(b.rotation),u=Ea.f32(b.scale),w=Ea.f32(b.translation),x=ua.create(),y=Ea.$L(v);"TEXTURE"==t&&(u[0]=u[0]||1,u[1]=u[1]||1,u[2]=u[2]||1);ua.multiply(y,new Float32Array([u[0],0,0,0,u[1],0,0,0,u[2]]),x);x=Ea.BO(x,Ca.create());
switch(t){case "POINT":x[12]=w[0];x[13]=w[1];x[14]=w[2];break;case "TEXTURE":x[12]=w[0];x[13]=w[1];x[14]=w[2];x=Ca.invert(x,x);break;case "NORMAL":Ca.invert(x,x),Ca.transpose(x,x)}switch(t){case "NORMAL":q.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":q.push(["MAPPING_TRS_MATRIX_DEF",1]);q.push(["MAPPING_TRS_MATRIX",qa.N(x,16)]);break;case "POINT":0!==Ba.length(v)?(q.push(["MAPPING_TRS_MATRIX_DEF",1]),q.push(["MAPPING_TRS_MATRIX",qa.N(x,16)])):(0!==Ba.length(u)&&(q.push(["MAPPING_SCALE_DEF",1]),q.push(["MAPPING_SCALE",
qa.N(u,3)])),0!==Ba.length(w)&&(q.push(["MAPPING_TRANS_DEF",1]),q.push(["MAPPING_TRANS",qa.N(w,3)])));break;case "VECTOR":0!==Ba.length(v)?(q.push(["MAPPING_TRS_MATRIX_DEF",1]),q.push(["MAPPING_TRS_MATRIX",qa.N(x,16)])):0!==Ba.length(u)&&(q.push(["MAPPING_SCALE_DEF",1]),q.push(["MAPPING_SCALE",qa.N(u,3)]))}b.use_min&&(q.push(["MAPPING_MIN_CLIP_DEF",1]),q.push(["MAPPING_MIN_CLIP",qa.N(b.min,3)]));b.use_max&&(q.push(["MAPPING_MAX_CLIP_DEF",1]),q.push(["MAPPING_MAX_CLIP",qa.N(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":var p=
[],t=[],v=[],u=[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("dif_params","dif_params",[0,0],!0),P("sp_params","sp_params",[0,0],!0),P("shadow_factor","shadow_factor",0,!0)],w=[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0),P("normal","normal",[0,0,0],!0)],x=[la(b,"Color"),la(b,"Alpha"),la(b,"Normal")],y=[],K=M(b,"Color");K.ya.splice(3);v.push(K);k.push(K);K=M(b,"Spec");K.ya.splice(3);v.push(K);k.push(K);
(K=M(b,"DiffuseIntensity"))||(K=M(b,"Refl"));K.ya=b.diffuse_intensity;v.push(K);k.push(K);var D=M(b,"Normal");D.ya.splice(3);v.push(D);k.push(D);"MATERIAL_EXT"==h?((K=M(b,"Emit"))||(K=P("Emit","Emit",0)),v.push(K),k.push(K),(K=M(b,"Translucency"))?(K.ya=0,K.name="Translucency",K.identifier="Translucency"):K=P("Translucency","Translucency",0),k.push(K),(K=M(b,"Translucency"))?(K.ya=[0,0,0,0],K.name="TranslucencyParams",K.identifier="TranslucencyParams"):K=P("TranslucencyParams","TranslucencyParams",
[0,0,0,0]),k.push(K),m=M(b,"Reflectivity"),K=M(b,"Ray Mirror"),m?(K=m,m="Reflectivity"):K?m="Ray Mirror":(K=m,m="Reflectivity"),K||(K=P(m,m,0)),k.push(K),w.push(K),(K=M(b,"SpecTra"))||(K=P("SpecTra","SpecTra",0)),k.push(K),w.push(K),(K=M(b,"Alpha"))||(K=P("Alpha","Alpha",b.alpha)),k.push(K),w.push(K),x.push(la(b,"Diffuse")),x.push(la(b,"Spec")),p.push(["MATERIAL_EXT",1]),t.push(["MATERIAL_EXT",1])):(v.push(P("emit_intensity","emit_intensity",0)),w.push(P("reflect_factor","reflect_factor",0)),w.push(P("specular_alpha",
"specular_alpha",0)),w.push(P("alpha_in","alpha_in",0)),x.push(P("diffuse_out","diffuse_out",0)),x.push(P("spec_out","spec_out",0)),p.push(["MATERIAL_EXT",0]),t.push(["MATERIAL_EXT",0]));y.push(da(Y("param_MATERIAL_alpha"),b.alpha));y.push(da(Y("param_MATERIAL_spec_alpha"),b.specular_alpha));m=x;p.push(["USE_MATERIAL_NORMAL",D.Ka|0]);b.use_diffuse&&(p.push(["USE_MATERIAL_DIFFUSE",1]),t.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&t.push(["USE_MATERIAL_SPECULAR",1]);var K=[],r=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":D=
b.specular_hardness;break;case "WARDISO":D=b.specular_slope;break;case "TOON":D=b.specular_toon_size;r=b.specular_toon_smooth;break;case "BLINN":D=b.specular_ior;r=b.specular_hardness;break;default:N.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),D=b.specular_hardness}var z,B;switch(b.diffuse_shader){case "LAMBERT":B=z=0;break;case "OREN_NAYAR":z=b.roughness;B=0;break;case "FRESNEL":z=b.diffuse_fresnel;B=b.diffuse_fresnel_factor;break;case "MINNAERT":z=
b.darkness;B=0;break;case "TOON":z=b.diffuse_toon_size;B=b.diffuse_toon_smooth;break;default:N.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),B=z=0}K.push(da(Y("param_MATERIAL_diffuse"),[z,B],2));K.push(da(Y("param_MATERIAL_spec"),[b.specular_intensity,D,r],3));p.push(["SHADELESS_MAT",b.use_shadeless?1:0]);D={name:b.name,value:{jq:b.specular_shader,To:b.diffuse_shader,le:b.use_shadeless,Jl:b.use_tangent_shading}};p={name:b.name,value:{jq:b.specular_shader,
To:b.diffuse_shader,le:b.use_shadeless,Jl:b.use_tangent_shading},CO:{name:"material_begin",type:"MATERIAL_BEGIN",inputs:v,outputs:u,X:K,data:D,hb:p,oe:[]},DO:{name:"material_end",type:"MATERIAL_END",inputs:w,outputs:x,X:y,data:D,hb:t,oe:[]}};break;case "BSDF_DIFFUSE":k=W(b);q.push(["USE_NORMAL_IN",k[2].Ka|0]);m=la(b,"BSDF");v=m.Ka;m=[m,P("d_color","d_color",[0,0,0],v),P("d_roughness","d_roughness",0,v),P("s_color","s_color",[0,0,0],v),P("s_roughness","s_roughness",0,v),P("metalness","metalness",0,
v),P("normal","normal",[0,0,0],v),P("e_color","e_color",[0,0,0],v),P("emisson","emisson",0,v),P("a_color","a_color",[0,0,0],v),P("alpha","alpha",1,v)];break;case "BSDF_GLOSSY":k=W(b);q.push(["USE_NORMAL_IN",k[2].Ka|0]);m=la(b,"BSDF");v=m.Ka;m=[m,P("d_color","d_color",[0,0,0],v),P("d_roughness","d_roughness",0,v),P("s_color","s_color",[0,0,0],v),P("s_roughness","s_roughness",0,v),P("metalness","metalness",1,v),P("normal","normal",[0,0,0],v),P("e_color","e_color",[0,0,0],v),P("emisson","emisson",0,
v),P("a_color","a_color",[0,0,0],v),P("alpha","alpha",1,v)];break;case "BSDF_TRANSPARENT":k=W(b);m=la(b,"BSDF");v=m.Ka;m=[m,P("d_color","d_color",[0,0,0],v),P("d_roughness","d_roughness",0,v),P("s_color","s_color",[0,0,0],v),P("s_roughness","s_roughness",0,v),P("metalness","metalness",0,v),P("normal","normal",[0,0,0],v),P("e_color","e_color",[0,0,0],v),P("emisson","emisson",0,v),P("a_color","a_color",[0,0,0],v),P("alpha","alpha",1,v)];break;case "EMISSION":k=W(b);m=la(b,"Emission");t=m.Ka;m=[m,P("d_color",
"d_color",[0,0,0],t),P("d_roughness","d_roughness",0,t),P("s_color","s_color",[0,0,0],t),P("s_roughness","s_roughness",0,t),P("metalness","metalness",1,t),P("normal","normal",[0,0,0],t),P("e_color","e_color",[0,0,0],t),P("emisson","emisson",1,t),P("a_color","a_color",[0,0,0],v),P("alpha","alpha",1,v)];break;case "MATH":switch(b.operation){case "ADD":h="MATH_ADD";break;case "SUBTRACT":h="MATH_SUBTRACT";break;case "MULTIPLY":h="MATH_MULTIPLY";break;case "DIVIDE":h="MATH_DIVIDE";break;case "SINE":h=
"MATH_SINE";break;case "COSINE":h="MATH_COSINE";break;case "TANGENT":h="MATH_TANGENT";break;case "ARCSINE":h="MATH_ARCSINE";break;case "ARCCOSINE":h="MATH_ARCCOSINE";break;case "ARCTANGENT":h="MATH_ARCTANGENT";break;case "POWER":h="MATH_POWER";break;case "LOGARITHM":h="MATH_LOGARITHM";break;case "MINIMUM":h="MATH_MINIMUM";break;case "MAXIMUM":h="MATH_MAXIMUM";break;case "ROUND":h="MATH_ROUND";break;case "LESS_THAN":h="MATH_LESS_THAN";break;case "GREATER_THAN":h="MATH_GREATER_THAN";break;case "MODULO":h=
"MATH_MODULO";break;case "ABSOLUTE":h="MATH_ABSOLUTE";break;default:return N.error("Unsupported MATH operation: "+b.operation),null}q.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);k=W(b);m=ka(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":h="MIX_RGB_MIX";break;case "ADD":h="MIX_RGB_ADD";break;case "MULTIPLY":h="MIX_RGB_MULTIPLY";break;case "SUBTRACT":h="MIX_RGB_SUBTRACT";break;case "SCREEN":h="MIX_RGB_SCREEN";break;case "DIVIDE":h="MIX_RGB_DIVIDE";break;case "DIFFERENCE":h="MIX_RGB_DIFFERENCE";
break;case "DARKEN":h="MIX_RGB_DARKEN";break;case "LIGHTEN":h="MIX_RGB_LIGHTEN";break;case "OVERLAY":h="MIX_RGB_OVERLAY";break;case "DODGE":h="MIX_RGB_DODGE";break;case "BURN":h="MIX_RGB_BURN";break;case "HUE":h="MIX_RGB_HUE";break;case "SATURATION":h="MIX_RGB_SATURATION";break;case "VALUE":h="MIX_RGB_VALUE";break;case "COLOR":h="MIX_RGB_COLOR";break;case "SOFT_LIGHT":h="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":h="MIX_RGB_LINEAR_LIGHT";break;default:return N.error("Unsupported MIX_RGB blend type: "+
b.blend_type),null}q.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);k=W(b);m=ka(b);break;case "OUTPUT":k=W(b);m=[];break;case "OUTPUT_MATERIAL":k=W(b);m=[];p=M(b,"Surface");t=p.Ka;p={name:b.name,YO:{name:"output_surface",type:"OUTPUT_SURFACE",inputs:[p],outputs:[],X:[],data:{value:{zJ:"BSDF_COMPUTE"},xJ:{name:"bsdf_begin",type:"BSDF_BEGIN",inputs:[p,P("d_color","d_color",[0,0,0],t),P("d_roughness","d_roughness",0,t),P("s_color","s_color",[0,0,0],t),P("s_roughness","s_roughness",0,t),P("metalness",
"metalness",0,t),P("normal","normal",[0,0,0],t),P("e_color","e_color",[0,0,0],t),P("emission","emission",0,t),P("a_color","a_color",[0,0,0],t),P("alpha","alpha",0,t)],outputs:[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("bsdf_params","bsdf_params",[0,0,0,0],!0),P("shadow_factor","shadow_factor",0,!0),P("s_color","s_color",[0,0,0],!0),P("metalness","metalness",0,!0),P("e_color","e_color",[0,0,0],!0),P("emission","emission",
0,!0),P("a_color","a_color",[0,0,0],!0),P("alpha","alpha",0,!0)],X:[],data:null,hb:[],oe:[]},yJ:{name:"bsdf_end",type:"BSDF_END",inputs:[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("s_color","s_color",[0,0,0],!0),P("metalness","metalness",0,!0),P("e_color","e_color",[0,0,0],!0),P("emission","emission",0,!0),P("a_color","a_color",[0,0,0],!0),P("alpha","alpha",0,!0)],outputs:[P("color","color",[0,0,0],t)],X:[],data:null,hb:[],oe:[]}},hb:[],oe:[]},
KL:{name:"displacement_bump",type:"DISPLACEMENT_BUMP",inputs:[P("Height","Height",0,!0)],outputs:[P("Normal","Normal",[0,0,0],!1)],X:[],data:null,hb:[],oe:[]}};break;case "RGB":t=b.name;t={name:"-1",value:t};n.push(t);m.push(la(b,"Color"));break;case "SEPRGB":case "SEPHSV":k=W(b);m=ka(b);break;case "TEX_ENVIRONMENT":(t=b.image)?(h="TEXTURE_ENVIRONMENT","NONE"==b.color_space?q.push(["NON_COLOR",1]):q.push(["NON_COLOR",0]),k.push(M(b,"Vector")),m.push(la(b,"Color")),v=Y("param_TEXTURE_texture"),n.push(da(v)),
p=Ka.hB(128),p.source="ENVIRONMENT_MAP",Ka.dA(p,t),p={name:v,value:p}):h="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(t=b.image){h="TEXTURE_COLOR";"NONE"==b.color_space?q.push(["NON_COLOR",1]):q.push(["NON_COLOR",0]);q.push(["CONVERT_UV",0]);for(v=0;4>v;++v)v?(K=P("Vector"+v,"Vector"+v,[0,0,0],!1),u=P("Color"+v,"Color"+v,[0,0,0],!1),w=P("Alpha"+v,"Alpha"+v,0,!1)):(K=M(b,"Vector"),u=la(b,"Color"),w=la(b,"Alpha")),k.push(K),m.push(u),m.push(w);v=Y("param_TEXTURE_texture");n.push(da(v));p=Ka.Gk(Ka.Vg,!1);
p.repeat="REPEAT"==b.extension;p.source="IMAGE";Ka.dA(p,t);p={mv:b.name,nv:"",name:v,value:p}}else h="TEXTURE_EMPTY";break;case "TEXTURE":h=ca(b);if("TEXTURE_EMPTY"==h)m.push(la(b,"Color")),m.push(la(b,"Normal")),m.push(la(b,"Value"));else if("TEXTURE_ENVIRONMENT"==h)k.push(M(b,"Vector")),m.push(la(b,"Color")),m.push(la(b,"Value"));else{if("TEXTURE_NORMAL"==h&&"ENVIRONMENT_MAP"==b.texture.type)return N.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==h&&(t=!1,(v=b.texture.image)&&
"Non-Color"==v.colorspace_settings_name&&(t=!0),q.push(["NON_COLOR",Number(t)]),q.push(["CONVERT_UV",1]));for(v=0;4>v;++v)t="TEXTURE_COLOR"==h?"Color":"Normal",v?(K=P("Vector"+v,"Vector"+v,[0,0,0],!1),u=P(t+v,t+v,[0,0,0],!1),w=P("Value"+v,"Value"+v,0,!1)):(K=M(b,"Vector"),u=la(b,t),w=la(b,"Value")),k.push(K),m.push(u),m.push(w)}"TEXTURE_EMPTY"!=h&&(v=Y("param_TEXTURE_texture"),n.push(da(v)),p=b.texture.F,p={mv:b.texture.name,nv:b.texture.uuid,name:v,value:p});break;case "VALTORGB":k=W(b);m=ka(b);
p={value:b};t=b.color_ramp.interpolation;"CONSTANT"!=t&&"LINEAR"!=t&&N.warn("Color Ramp node is not fully supported.");break;case "VALUE":h="VALUE";t=b.name;t={name:"-1",value:t};n.push(t);m.push(la(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":h="VECT_MATH_ADD";break;case "SUBTRACT":h="VECT_MATH_SUBTRACT";break;case "AVERAGE":h="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":h="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":h="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":h=
"VECT_MATH_NORMALIZE";break;default:return N.error("Unsupported VECT_MATH operation: "+b.operation),null}k=W(b);m=ka(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":q.push(["VECTOR_TYPE",qa.N(0)]);break;case "VECTOR":q.push(["VECTOR_TYPE",qa.N(1)]);break;case "NORMAL":q.push(["VECTOR_TYPE",qa.N(2)]);break;default:return N.error("Unsupported VECT_TRANSFORM vector_type: "+b.vector_type),null}k=b.convert_from;m=b.convert_to;if("WORLD"==k)if("WORLD"==m)k=0;else if("OBJECT"==m)k=1;else if("CAMERA"==
m)k=2;else return N.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==k)if("WORLD"==m)k=3;else if("OBJECT"==m)k=4;else if("CAMERA"==m)k=5;else return N.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==k)if("WORLD"==m)k=6;else if("OBJECT"==m)k=7;else if("CAMERA"==m)k=8;else return N.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else return N.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),
null;q.push(["CONVERT_TYPE",qa.N(k)]);k=W(b);m=ka(b);break;case "NORMAL_MAP":switch(b.space){case "TANGENT":t=0;break;case "OBJECT":t=1;break;case "WORLD":t=2;break;case "BLENDER_OBJECT":t=3;break;case "BLENDER_WORLD":t=4;break;default:return N.error("Unsupported NORMAL_MAP space: "+b.space),null}q.push(["SPACE",qa.N(t)]);k.push(M(b,"Strength"));k.push(M(b,"Color"));k.push(P("Normal","Normal",[0,0,0],!1));q.push(["USE_NORMAL_IN",0]);m.push(la(b,"Normal"));break;case "FRESNEL":D=M(b,"Normal");k.push(M(b,
"IOR"));k.push(D);m.push(la(b,"Fac"));q.push(["USE_FRESNEL_NORMAL",D.Ka|0]);break;case "LAYER_WEIGHT":D=M(b,"Normal");k.push(M(b,"Blend"));k.push(D);m=ka(b);q.push(["USE_NORMAL_IN",D.Ka|0]);break;case "BUMP":D=M(b,"Normal");q.push(["INVERT",b.invert?1:0]);q.push(["USE_NORMAL_IN",D.Ka|0]);k=W(b);m=ka(b);break;default:k=W(b),m=ka(b)}g={name:f,Cd:g,type:h,oe:l,inputs:k,outputs:m,X:n,data:p,hb:q};f=T.lj(a);T.Xg(a,f,g);if(!(g="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=b.type)){a:{g=b.outputs;
for(l=h=0;l<g.length;l++)if(g[l].is_linked&&h++>c){g=!0;break a}g=!1}g=!g}return g||null!=V(a,b,++c,d,e)?f:null}function L(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],l=b[g];if(!h||h.default_value instanceof Array!=l)return N.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<c.length;g++)if(b=e[g],d=c[g],!b||b.default_value instanceof Array!=d)return N.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function ba(a,b,c){var e=a.node_group.node_tree,f={},g;for(g in e)if("links"==g||"nodes"==g){f[g]=[];for(var h=0;h<e[g].length;h++){f[g][h]={};for(var l in e[g][h])if("links"==g){f[g][h][l]={};for(var k in e[g][h][l])f[g][h][l][k]=pa(e[g][h][l][k])}else f[g][h][l]=pa(e[g][h][l])}}else f[g]=pa(e[g]);h=a.node_tree_name;if("B4W_REPLACE"==h||"B4W_LEVELS_OF_QUALITY"==h)e=D("Group input","GROUP_INPUT",[],a.inputs),g=D("Group output",
"GROUP_OUTPUT",a.outputs,[]),h="B4W_REPLACE"==h||"B4W_LEVELS_OF_QUALITY"==h&&(Ha.quality==Sa.P_LOW||Ha.KB)?{from_node:e,from_socket:e.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:e,from_socket:e.outputs[0],to_node:g,to_socket:g.inputs[0]},f.nodes=[e,g],f.links=[h];e=a.name;g=f.nodes;h=f.links;for(l=0;l<g.length;l++)g[l].name=ta(g[l].type,e,g[l].name);for(l=0;l<h.length;l++)h[l].from_node.name=ta(h[l].from_node.type,e,h[l].from_node.name),h[l].to_node.name=ta(h[l].to_node.type,e,h[l].to_node.name);
return{RO:d(f,a.node_group.uuid,!0,b,c).Ja,SO:f.links}}function pa(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Ea.zo(a):a}function Y(a){kb[a]||(kb[a]=0);var b=a+"_"+kb[a],b=b.replace(/ /g,"_").replace(/\//g,"_");kb[a]++;return b}function ha(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function U(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function ga(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function ca(a){if(!a.texture||!a.texture.F)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:Ea.D("Unknown texture output")}}if(c)return d&&
N.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function M(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return aa(e)}return null}function la(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return aa(e)}return null}function aa(a){var b=
a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=Ea.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,Ka:d,ya:a}}function P(a,b,c,d){return{name:a,identifier:b,Ka:d,ya:c}}function ma(a){return P(a.name,a.identifier,a.ya,a.Ka)}function W(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=aa(a.inputs[c]);d.ya.length&&d.ya.splice(3);b.push(d)}return b}function ka(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=aa(a.outputs[c]);b.push(d)}return b}function da(a,b,c){b=null===b||void 0===b?null:
qa.N(b,c);return{name:a,value:b}}function va(a){return{name:a.name,value:a.value}}function wa(a){return a.slice()}function sa(a,b,c,d,e,f){var g=[],h=f.from_socket.identifier;f=f.to_socket.identifier;var l=d.outputs;for(d=0;d<l.length;d++)if(l[d].identifier==h){g.push(d);break}e=e.inputs;for(d=0;d<e.length;d++)if(e[d].identifier==f){g.push(d);break}2==g.length&&T.Nc(a,b,c,g);return!0}function ta(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function ea(a){var b=
[];T.ha(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function ra(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.RO,f=c[d].data.SO;if(!e)return!1;T.ha(e,function(b,c){T.Xg(a,T.lj(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);K(c[d],b,a)}return!0}function O(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function Ia(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=
c[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function xa(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function oa(a,b,c,d){for(var e=0;e<d.length;e++){for(var f=d[e],g,h=0;h<c.inputs.length;h++)if(f.from_socket.identifier==c.inputs[h].identifier){g=c.inputs[h].ya;
break}for(var h=f,l=b,k=g,m=E(h.to_node,l),n=0;n<m.length;n++)for(var p=T.Ra(l,m[n]),q=0;q<p.inputs.length;q++){var t=p.inputs[q];if(t.identifier==h.to_socket.identifier){p=t.ya instanceof Object?0:1;if((k instanceof Object?0:1)==p)t.ya=k;else switch(p){case 0:t=t.ya;t[0]=t[1]=t[2]=k;break;case 1:t.ya=(k[0]+k[1]+k[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function K(a,b,c){for(var d=a.name,e=[],f=[],g=[],h=[],l=0;l<b.length;l++){var k=b[l];O(k.from_node,d,k,e,g,h);O(k.to_node,d,k,f,g,h)}f=
Ia(b,f,g);e=Ia(b,h,e);xa(b,f);oa(b,c,a,f);if(e.length){var m;T.ha(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(m=b)});oa(b,c,m,e)}}function ia(a){var b=[],c=[];T.ha(a,function(a,d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,e=a=null,f=b.length+c.length;if(b.length){a=Ka.eM(b,Ka.iG);for(var g=0;g<b.length;g++)b[g].hb.push(["NODE_TEX_ROW",qa.N((d+.5)/f)]),d++}if(c.length)for(e=Ka.iM(c,Ka.vz),g=0;g<c.length;g++)c[g].hb.push(["NODE_TEX_ROW",
qa.N((d+.5)/f)]),d++;g=null;a&&e?(g=new Uint8Array(a.length+e.length),g.set(a),g.set(e,a.length)):a?g=a:g=e;a=g?Ka.gB(g,Ka.vz):null;for(g=0;g<b.length;g++)b[g].data.Ya=a;for(g=0;g<c.length;g++)c[g].data.Ya=a}function na(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var Sa=r("__config"),Aa=r("__debug"),T=r("__graph"),ua=r("__mat3"),Ca=r("__mat4"),Ga=r("__objects"),N=r("__print"),qa=r("__shaders"),Ta=r("__scenes"),Ea=r("__util"),
Ba=r("__vec3"),Ka=r("__textures"),kb={},Fa={},Ra={},La={},fa=0,Ha=Sa.H;a.eT=0;a.qI=1;a.pI=2;a.oI=3;a.dT=4;a.nI=5;a.mI=6;a.lI=7;a.cT=8;a.bH=0;a.aH=1;a.WS=2;a.$G=3;a.VS=4;a.hC=function(a){return Fa[a]};a.iK=function(a){delete Fa[a]};a.sK=d;a.Iv=function(a,c,d){var e=Ta.get_active();a=m(a,"MAIN",e.uuid);if(a in Ra)return Ra[a];var e=T.create(),g={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},h=V(e,g,0,c,null),g={name:"LIGHTING_END",type:"LIGHTING_END"},g=V(e,g,0,c,null);b(e,d,h,g,[[h,[8,10]],[h,[9,6]]],
c);f(e);return Ra[a]=e};a.wr=function(a){var b=[],c={};kb={};var d=T.Oy(a);T.ha(d,function(a,d){var e;e=[];for(var f=[],g=[],h=[],l=[],k=[],m=0;m<d.inputs.length;m++){var n=d.inputs[m];if(n.Ka)e.push(null),f.push(null);else{e.push(Y("in_"+d.type+"_"+n.identifier.replace(/\./g,"")));var p=qa.N(n.ya,0);Ha.oy&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==n.identifier||"Color2"==n.identifier||"Fac"==n.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==n.identifier||"Value_001"==n.identifier||"Value.001"==
n.identifier)||0<=d.type.indexOf("VECT_MATH_")&&("Vector_001"==n.identifier||"Vector.001"==n.identifier)||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(n=p,n=n.replace(/(,)/g,"$1 "),n=n.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),n=n.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),p=n=n.replace(/\s+/g,""));f.push(p)}}for(m=0;m<d.outputs.length;m++)n=d.outputs[m],n.Ka?g.push(null):g.push(Y("out_"+d.type+"_"+n.identifier.replace(/\./g,
"")));for(m=0;m<d.X.length;m++)n=d.X[m],h.push(n.name),l.push(n.value);for(m=0;m<d.oe.length;m++)k.push(d.oe[m].name);e={id:d.type,inputs:e,Qw:f,outputs:g,X:h,rt:l,oe:k,hb:JSON.parse(JSON.stringify(d.hb))};b.push(e);c[a]=e});T.ag(d,function(a,b,e){var f=T.Ra(d,a),g=f.outputs[e[0]];a=c[a].outputs;b=c[b].inputs;f=a[e[0]]||Y("out_"+f.type+"_"+g.identifier.replace(/\./g,""));a[e[0]]=f;b[e[1]]=f});return b};a.PA=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];
if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.LU=function(a,b){N.log("\n================ MATERIAL: "+b+" ================\n"+Aa.TO(a)+"\n============================================================")};a.cleanup=function(){for(var a in Fa)delete Fa[a];for(a in Ra)delete Ra[a];for(var b in La)delete La[b];fa=0}};b4w.module.__animation=function(a,r){function d(a,b){var c=a.fa[b];c&&c.Vr&&c.Zo&&(c.Zo=!1,c.Vr(a,b))}function c(a,b,c){c=a.fa[c];c.type=30;var d=b.sa,e=b.Za-d+1;c.start=d;c.length=e;c.We=d;c.Sh=b.name;for(e=d=0;e<a.Kc.length;e++){var f=a.Kc[e];if(f==b)break;else d+=f.Za-f.sa+1}c.OF=d}function b(a,b){a.type=50;a.Sh=b.name;a.start=b.sa;a.length=b.Za-a.start;b.cyclic||(a.length+=b.bx)}function g(a){return a.replace(/_B4W_BAKED$/,"")}function n(a,b){return{Nm:a,action:b}}function x(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.F.type&&b.push(n(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var e=a[d];if(e.node_group){var f=e.node_group.node_tree;if(f){var g=c.slice();g.push(e.name);x(f,b,g)}}}}function e(a){return Y.is_mesh(a)&&a.o.Kc?!0:!1}function u(a,b,c){var d=a.fa;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.We=b,h(a,0,c,!0))}else if(e=d[c])e.We=b,h(a,0,c,!0)}function w(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function h(a,b,c,e){q(a,b,c,e);d(a,c);a.o.Rh&&(I(a,
b),J(a,b))}function m(a,b,c,d){var e=c.frame_range;if(e[0]>e[1])return ga.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;var g=c.F,h=a.fa[d];h.Sh=c.name;h.Wu=e;h.Zz=g.CD;h.Xz=g.uA;h.$h.set(g.$h);h.start=e[0];h.length=e[1]-e[0];h.We=e[0];switch(g.type){case 10:if(Y.is_armature(a)){h.type=10;var l=B(a,b,c);if(!l){for(var l=a.o.zf,e=[],m=[],n=[],p=[],q=c.F.Cx,u=0;u<q;u++){for(var w in l){var x=l[w],K=x.qq,y=c.F.kv[w];y?ka.copy(y.subarray(8*u,8*u+8),K):ka.identity(K);
x.gu=!1}x=C(l);e.push(x.trans);m.push(x.wb);n.push(x.Yh);p.push(x.Xh)}l={trans:e,wb:m,Yh:n,Xh:p};k(a,b,c,l)}h.trans=l.trans;h.wb=l.wb;h.Xh=l.Xh;h.Yh=l.Yh;b=l;h=a.o;l=h.dn;e=a.fa[d];w=e.ty;a:{m=h.Lt;for(n=0;n<m.length;n+=2)if(c==m[n]){m=m[n+1];break a}m=null}if(m)e.ty=m;else{for(e=0;e<l.length;e++){m=l[e].Wh;n=[];p=[];q=b.trans;u=b.wb;for(x=0;x<q.length;x++)K=v(q[x],u[x],m),n.push(K.trans),p.push(K.wb);w.push({trans:n,wb:p})}h.Lt.push(c,w)}h.Rh&&(c=h.tn,d>c[1]?(b=c[1],c[1]=d,c[0]=b):d>c[0]&&d<c[1]&&
(c[0]=d),f(a))}break;case 40:Y.is_speaker(a)&&(h.volume=g.X.volume||null,h.pitch=g.X.pitch||null,h.type=40);break;case 70:Y.is_lamp(a)&&(h.color=g.X.color||null,h.Ye=g.X.energy||null,h.type=70);break;case 60:if("MESH"==a.type){h.type=60;w=B(a,b,c);if(!w){w=[];e=[];m=[];n=[];p=[];q=c.F;u=b?b[0]:null;for(l in q.X){x=b;K=l.match(/"(.*?)"/)[1];if(x&&1<x.length){for(var y=x[1],D=2;D<x.length;D++)y=y+"%join%"+x[D];y+="%join%"+K}else y=K;x=y;for(K=0;K<a.K.length;K++)for(y=a.K[K].R,D=0;D<y.length;D++){var r=
y[D];if(!u||-1!=r.Jb.indexOf(u)){var z=r.hf,L=t(l,x,q,e,w,r.jf),z=t(l,x,q,n,m,z);(L||z)&&p.push(r)}}}w={mS:w,values:e,LP:m,MP:n,Dj:p};k(a,b,c,w)}h.jf=w.mS;h.nD=w.values;h.hf=w.LP;h.mD=w.MP;h.Dj=w.Dj}break;case 20:if(l=g.X.tsr){h.type=20;w=B(a,b,c);if(!w){w=c.F.Cx;e=[];m=[];for(n=0;n<w;n++)e.push(l.subarray(8*n,8*n+4)),m.push(l.subarray(8*n+4,8*n+8));w={trans:e,wb:m};k(a,b,c,w)}h.trans=w.trans;h.wb=w.wb;ha.Dx(a)&&ha.$R(a,h.trans[0],h.wb[0])}else return ga.warn('Incompatible action "'+c.name+'" has been applied to object "'+
a.name+'"'),!1;break;case 80:Y.is_world(a)&&(h.Ye=g.X["light_settings.environment_energy"]||null,h.Md=g.X.horizon_color||null,h.Vd=g.X.zenith_color||null,h.bp=g.X["mist_settings.intensity"]||null,h.fog_depth=g.X["mist_settings.depth"]||null,h.fog_start=g.X["mist_settings.start"]||null,h.fog_height=g.X["mist_settings.height"]||null,h.JB=g.X.b4w_fog_color||null,h.type=80)}Y.is_armature(a)&&10!=g.type&&F(a,d);return!0}function B(a,b,c){a=a.$q;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==
a[d]&&b==a[d+1])return a[d+2];return null}function k(a,b,c,d){a.$q.push(c,b?b.join("%join%"):null,d)}function f(a){var b=a.o.tn;if(-1!=b[0]&&-1!=b[1]){var c=a.fa;a=c[b[1]].We;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.We;d=Math.floor(a);b.We=d+e}}function F(a,b){var c=a.o.tn,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.fa;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function t(a,b,c,d,e,f){if(!f)return!1;for(var g=!1,h=0;h<f.length;h+=2)b==f[h]&&(e.push(f[h+1]),
d.push(new Float32Array(c.X[a])),g=!0);return g}function q(a,b,c,d){if((c=a.fa[c])&&null!=c.type&&(c.play||d)){var e=a.o,f=c.We,g=c.start,h=c.length,f=f+c.speed*b*ma.ad(),l=c.type,k=c.speed;if(0<=k&&f>=g+h||0>k&&f<g)switch(d||(c.Zo=!0),c.behavior){case 10:0<=k?f=(f-g)%h+g:f=g+h-1E-6;break;case 20:0<=k?f=g:f=g+h-1E-6;c.play=!1;break;case 30:0<=k?f=g+h-1E-6:f=g,c.play=!1}c.We=f;switch(l){case 10:if(!e.Rh){d=E(c);b=d[0];var m=d[1];d=d[2];e.Pd=c.wb[b];e.he=c.wb[m];e.Td=c.trans[b];e.ke=c.trans[m];e.Be=
d;d=e.dn;c=c.ty;for(var n=0;n<d.length;n++){var p=d[n],q=c[n];p.Pd=q.wb[b];p.he=q.wb[m];p.Td=q.trans[b];p.ke=q.trans[m];p.Be=e.Be}W.L(a)}break;case 20:d=E(c);var e=ea,m=d[0],n=d[1],p=d[2],q=c.trans,t=q[m][1],f=q[m][2],g=q[n][1],h=q[n][2];e[0]=(1-p)*q[m][0]+p*q[n][0];e[1]=(1-p)*t+p*g;e[2]=(1-p)*f+p*h;m=K;f=d[0];n=d[1];p=d[2];q=c.wb;t=ia;t[0]=q[f][0];t[1]=q[f][1];t[2]=q[f][2];t[3]=q[f][3];f=na;f[0]=q[n][0];f[1]=q[n][1];f[2]=q[n][2];f[3]=q[n][3];ca.slerp(t,f,p,m);n=d[2];p=c.trans;d=(1-n)*p[d[0]][3]+
n*p[d[1]][3];a.parent&&a.vt&&(n=Aa,ka.set_sep(e,d,m,n),ka.multiply(a.vt,n,n),ka.ec(n,e),ka.Qc(n,m),d=ka.get_scale(n));c.Wy&&(n=ra,W.get_translation(a,n),da.smooth_v(e,n,b,c.Wy,e));c.Tx&&(n=ia,W.get_rotation(a,n),da.JE(m,n,b,c.Tx,m));f=c.$h;f[0]&&W.set_translation_rel(a,e);f[1]&&W.set_rotation_rel(a,m);f[2]&&W.set_scale_rel(a,d);W.L(a);U.sync_transform(a);break;case 30:d=c.We-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.OF;ta[0]=
a+c;ta[1]=b+c;ta[2]=d;d=ta;e.lu=d[0];e.mu=d[2];break;case 40:d=E(c);b=d[0];e=d[1];d=d[2];c.volume&&aa.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&aa.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:b=10==c.behavior?(f-g)/ma.ad():f/ma.ad();ha.AQ(a,c.Sh,b);break;case 60:d=E(c);b=d[0];e=d[1];d=d[2];q=c.nD;t=c.jf;a=c.mD;m=c.hf;n=c.Dj;for(c=0;c<t.length;c++)for(f=q[c],p=t[c],g=(1-d)*f[b]+d*f[e],f=0;f<n.length;f++)n[f].Gg[p]=g;for(c=0;c<m.length;c++)for(q=a[c],p=m[c],q=va.lerp(q.subarray(3*
b,3*b+3),q.subarray(3*e,3*e+3),d,ea),f=0;f<n.length;f++)n[f].Bd[3*p]=q[0],n[f].Bd[3*p+1]=q[1],n[f].Bd[3*p+2]=q[2];break;case 70:d=E(c);b=d[0];e=d[1];d=d[2];f=c.$h;(h=c.Ye)&&f[0]&&pa.set_light_energy(a.nb,(1-d)*h[b]+d*h[e]);(c=c.color)&&f[1]&&(ea[0]=(1-d)*c[3*b]+d*c[3*e],ea[1]=(1-d)*c[3*b+1]+d*c[3*e+1],ea[2]=(1-d)*c[3*b+2]+d*c[3*e+2],pa.set_light_color(a.nb,ea));g=a.K;for(c=0;c<g.length;c++)la.KR(a,g[c].pb);break;case 80:d=E(c);b=d[0];e=d[1];d=d[2];f=c.$h;g=a.K;k=la.Aa(g[0].pb,P.Db);h=c.Ye;h=f[0]?
(1-d)*h[b]+d*h[e]:k.Ye;l=c.Md;f[1]?(ea[0]=(1-d)*l[3*b]+d*l[3*e],ea[1]=(1-d)*l[3*b+1]+d*l[3*e+1],ea[2]=(1-d)*l[3*b+2]+d*l[3*e+2],l=ea):l=k.Md;var v=c.Vd;f[2]?(ra[0]=(1-d)*v[3*b]+d*v[3*e],ra[1]=(1-d)*v[3*b+1]+d*v[3*e+1],ra[2]=(1-d)*v[3*b+2]+d*v[3*e+2],k=ra):k=k.Vd;v=c.bp;f[3]&&(m=(1-d)*v[b]+d*v[e]);v=c.fog_depth;f[4]&&(n=(1-d)*v[b]+d*v[e]);v=c.fog_start;f[5]&&(p=(1-d)*v[b]+d*v[e]);v=c.fog_height;f[6]&&(q=(1-d)*v[b]+d*v[e]);c=c.JB;f[7]&&(K[0]=(1-d)*c[3*b]+d*c[3*e],K[1]=(1-d)*c[3*b+1]+d*c[3*e+1],K[2]=
(1-d)*c[3*b+2]+d*c[3*e+2],t=K);for(c=0;c<g.length;c++)b=a.K[c].pb,(f[0]||f[1]||f[2])&&la.set_environment_colors(b,h,l,k),f[3]&&la.hE(b,m),f[4]&&la.fE(b,n),f[5]&&la.iE(b,p),f[6]&&la.gE(b,q),f[7]&&la.set_fog_color_density(b,t);break;default:da.D("Unknown animation type:"+l)}}}function E(a){var b=a.Wu[0],c=a.Wu[1]-b,b=a.We-b;0>b&&(b=0);b>=c&&(b=c);b/=a.Zz;c=Math.floor(b);a=a.Xz[c]?b-c:0;b=Math.ceil(c+a);ta[0]=c;ta[1]=b;ta[2]=a;return ta}function J(a,b){var c=a.o,d=c.mg,e=c.tn,f=e[0],e=e[1];if(-1!=e){if(-1!=
f){var g=a.fa[f];if(g.play||0==b){var h=E(g),l=h[0],k=h[1];c.Be=h[2];var h=g.wb[l],m=g.wb[k],n=g.trans[l],p=g.trans[k]}else d=1}else d=1;e=a.fa[e];if(e.play||0==b){var f=E(e),q=f[0],t=f[1];c.Be=f[2]}else if(-1!=f&&g.play)d=0;else return;var f=e.wb[q],v=e.wb[t],u=e.trans[q],w=e.trans[t];if(1==d)c.Pd.set(f),c.he.set(v),c.Td.set(u),c.ke.set(w);else if(0==d)c.Pd.set(h),c.he.set(m),c.Td.set(n),c.ke.set(p);else{var d=c.zf,x;for(x in d)h=d[x],h.Ip||A(c,h,g,e,l,k,q,t)}W.L(a);L.WR(a)}}function A(a,b,c,d,e,
f,g,h){for(var l=b.Ip,k=a.mg,m=K,n=ia,p=O,q=Ia,t=na,v=Sa,u=xa,w=oa,x=4*b.Vh,y=c.Xh[e],D=d.Xh[g],r=c.Yh[e],z=d.Yh[g],L=c.Xh[f],B=d.Xh[h],E=c.Yh[f],C=d.Yh[h],F=0;4>F;F++)m[F]=y[x+F],n[F]=D[x+F],p[F]=r[x+F],q[F]=z[x+F],t[F]=L[x+F],v[F]=B[x+F],u[F]=E[x+F],w[F]=C[x+F];ca.slerp(m,n,k,m);da.xA(p,q,k,p);ka.set_transcale(p,Aa);ka.set_quat(m,Aa);l&&ka.multiply(l.tF,Aa,Aa);ka.copy(Aa,b.tF);ka.multiply(Aa,b.Zy,Aa);ka.Cw(Aa,p);ka.Qc(Aa,m);ca.slerp(t,v,k,t);da.xA(u,w,k,u);ka.set_transcale(u,Aa);ka.set_quat(t,Aa);
l&&ka.multiply(l.sF,Aa,Aa);ka.copy(Aa,b.sF);ka.multiply(Aa,b.Zy,Aa);ka.Cw(Aa,u);ka.Qc(Aa,t);for(F=0;4>F;F++)a.Pd[x+F]=m[F],a.Td[x+F]=p[F],a.he[x+F]=t[F],a.ke[x+F]=u[F];b=b.Wv;for(F=0;F<b.length;F++)A(a,b[F],c,d,e,f,g,h)}function I(a,b){var c=a.o,d=c.Vn;if(0!=d){var e=c.Un-c.mg,f=d*b;da.sign(e)==da.sign(d)&&Math.abs(f)<Math.abs(e)?c.mg+=f:(c.mg=c.Un,c.Vn=0)}}function C(a){var b=[],c=[],d=[],e=[],f=new Float32Array(4),g=new Float32Array(4),h;for(h in a){var l=a[h],k=f,m=g,n=l.rr,p=n[n.length-1],q=p.Yy;
p.gu||ka.identity(q);for(p=n.length-1;0<=p;p--){var t=n[p],v=t.Yy;if(t.gu)q=v;else{var u=t.Ni,w=t.qq;ka.invert(u,Aa);ka.multiply(w,Aa,Aa);ka.multiply(u,Aa,Aa);ka.multiply(q,Aa,v);q=v;t.gu=!0}}n=t.Yy;k[0]=n[0];k[1]=n[1];k[2]=n[2];k[3]=n[3];m[0]=n[4];m[1]=n[5];m[2]=n[6];m[3]=n[7];ca.normalize(m,m);k=l.Vh;ka.multiply(l.sn,l.qq,Aa);for(l=0;4>l;l++)m=4*k+l,b[m]=f[l],c[m]=g[l],d[m]=Aa[l],e[m]=Aa[l+4]}return{trans:b,wb:c,Yh:d,Xh:e}}function v(a,b,c){var d=[],e=[],f;for(f in c)for(var g=c[f],h=g.Vh,g=g.Uv,
l=0;4>l;l++){var k=4*g+l,m=4*h+l;d[k]=a[m];e[k]=b[m]}d=new Float32Array(d);e=new Float32Array(e);return{trans:d,wb:e}}function l(a){var b=a.F,c;if(b.kv)c=10;else if(b.X)if("volume"in b.X||"pitch"in b.X)c=40;else{var d;a:{if(d=a.F.X)for(var e in d)if(-1!=e.indexOf("nodes")){d=!0;break a}d=!1}if(d)c=60;else{var f;a:{if(a.F.X){d=a.fcurves;for(f in d)if("color"==f&&!d[f][3]){f=!0;break a}if("energy"==f){f=!0;break a}}f=!1}if(f)c=70;else if(f=a.F.X,"light_settings.environment_energy"in f||"horizon_color"in
f||"zenith_color"in f||"mist_settings.intensity"in f||"mist_settings.depth"in f||"mist_settings.start"in f||"mist_settings.height"in f||"b4w_fog_color"in f)c=80;else{a:{if(a.F.X)for(c in a=a.fcurves,a)if("location"==c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}}else c=0;b.type=c}function z(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function H(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=
1)}function p(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function Q(a,b,c,d,e,f,g){var h=a+(b-a)/2,l=y(h,d,e,f,g)-c;return.02>Math.abs(l)?h:0<l?Q(a,h,c,d,e,f,g):Q(h,b,c,d,e,f,g)}function y(a,b,c,d,e){var f=1-a;return b*
f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function Z(a,b){var c={type:null,Sh:null,Wu:null,Zz:0,Xz:null,$h:new Int8Array(8),wb:null,trans:null,Xh:null,Yh:null,ty:[],play:!1,behavior:20,We:0,start:0,length:0,Wy:0,Tx:0,Zo:!1,OF:null,speed:1,volume:null,pitch:null,color:null,Ye:null,Vd:null,Md:null,bp:null,fog_depth:null,fog_start:null,fog_height:null,JB:null,nD:[],jf:[],mD:[],hf:[],Dj:null};if(!a.fa.length)for(var d=0;8>d;d++)a.fa.push(null);a.fa[b]=c;-1==T.indexOf(a)&&T.push(a)}function S(a,b){W.L(a);U.sync_transform(a);
h(a,0,b,!0)}function G(a,d,e,f){f=f||0;if(Y.is_mesh(a)){var g=D(a,e);if(g)return Z(a,f),c(a,g,f),S(a,f),!0;if((g=X(a,e))&&"EMITTER"==g.pt){Z(a,f);d=g.name;e=f;for(var g=a.K,h=0;h<g.length;h++)for(var l=g[h].R,k=0;k<l.length;k++){var n=l[k].wa;n&&n.name==d&&b(a.fa[e],n)}S(a,f);return!0}}if(g=da.keysearch("name",e,ua)||da.keysearch("name",e+"_B4W_BAKED",ua)){Z(a,f);if(m(a,d,g,f))return S(a,f),!0;a.fa[f]=null}ga.error('Unsupported object: "'+a.name+'" or animation name: "'+e+'"');return!1}function D(a,
b){for(var c=0;c<a.Kc.length;c++){var d=a.Kc[c];if(d.name===b)return d}return null}function X(a,b){for(var c=a.K,d=0;d<c.length;d++)for(var e=c[d].R,f=0;f<e.length;f++){var g=e[f].wa;if(g&&g.name===b)return g}return null}function V(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var L=r("__armature"),ba=r("__config"),pa=r("__lights"),Y=r("__obj_util"),ha=r("__particles"),U=r("__physics"),ga=r("__print"),ca=r("__quat"),M=r("__reformer"),la=
r("__scenes"),aa=r("__sfx"),P=r("__subscene"),ma=r("__time"),W=r("__transform"),ka=r("__tsr"),da=r("__util"),va=r("__vec3"),wa=ba.nk,sa=ba.pg;a.CG=1E-6;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.nH=70;a.mH=80;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=
30;var ta=Array(3),ea=new Float32Array(3),ra=new Float32Array(3),O=new Float32Array(4),Ia=new Float32Array(4),xa=new Float32Array(4),oa=new Float32Array(4),K=new Float32Array(4),ia=new Float32Array(4),na=new Float32Array(4),Sa=new Float32Array(4),Aa=ka.create(),T=[],ua=[];a.fC=function(){return da.trunc((sa.Ws-50)/4)};a.frame_to_sec=function(a){return a/ma.ad()};a.update=function(a){for(var b=0;b<T.length;b++){for(var c=T[b],e=0;8>e;e++)q(c,a,e);c.o.Rh&&(I(c,a),J(c,a))}for(b=0;b<T.length;b++)for(c=
T[b],e=0;8>e&&c.fa.length;e++)d(c,e)};a.PM=function(){return ua};a.get_anim_names=function(a){var b=[];if(e(a))for(var c=0;c<a.Kc.length;c++)b.push(a.Kc[c].name);for(var d=[],c=0;c<ua.length;c++){var f=ua[c],h=f.F;20==h.type?d.push(f):60==f.F.type&&"MESH"==a.type?d.push(f):10==h.type&&"ARMATURE"==a.type?d.push(f):40==h.type&&"SPEAKER"==a.type?d.push(f):80==h.type&&"WORLD"==a.type&&d.push(f)}for(c=0;c<d.length;c++)b.push(g(d[c].name));if(ha.Dx(a)&&ha.sD(a))for(a=a.K,c=0;c<a.length;c++)for(d=a[c].R,
f=0;f<d.length;f++)(h=d[f].wa)&&b.push(h.name);return b};a.UE=g;a.get_anim_type=function(a,b){var c=a.fa[b];return c?c.type:0};a.apply_def=function(a){for(var d=0,f=a.K,g=0;g<f.length;g++)for(var h=f[g].R,l=0;l<h.length;l++){var k=h[l].wa;k&&"EMITTER"==k.pt&&!h[l].Ff&&(Z(a,d),b(a.fa[d],k),S(a,d),k.cyclic?a.fa[d].behavior=10:a.fa[d].behavior=a.mk,d++)}f=a.sg.slice();for(g=0;g<f.length;g++)l=f[g],h=l.Nm,l=l.action,Z(a,d),m(a,h,l,d)?(S(a,d),a.fa[d].behavior=a.mk,d++):a.fa[d]=null;e(a)&&(Z(a,d),c(a,a.Kc[0],
d),S(a,d),a.fa[d].behavior=a.mk)};a.$u=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:da.D("Wrong animation behavior")}};a.TM=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],e=d.node_tree;e&&x(e,b,[d.name])}return b};a.zC=n;a.play=function(a,b,c){w(a.fa,c,function(a){a.play=!0;b?a.Vr=b:a.Vr=null;a.Zo=!1});a.o.Rh&&f(a)};a.stop=function(a,b){w(a.fa,b,function(a){a.play=!1;a.Vr=null;a.Zo=!1})};a.is_play=
function(a,b){var c=a.fa;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.set_frame=u;a.set_first_frame=function(a,b){b=b||0;w(a.fa,b,function(c){u(a,c.start,b)})};a.rw=function(a,b){var c=a.fa[b];return c&&c.We?c.We:0};a.is_cyclic=function(a,b){var c=a.fa[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){w(a.fa,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.fa[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,
d){w(a.fa,d,function(a){a.Wy=b||0;a.Tx=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.fa[c]=null;else a.fa[b]=null;a.o.Rh&&F(a,b)};a.NR=h;a.uD=function(a){if("ARMATURE"==a.type||a.er||"WORLD"==a.type)return!0;for(var b=0;b<a.sg.length;b++){var c=a.sg[b].action.F.type;if(20==c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return ha.Dx(a)&&ha.sD(a)||"MESH"==a.type&&a.Kc.length?!0:!1};a.CA=function(a,b){if("ARMATURE"==b.type||V(a)||
"WORLD"==b.type)return!0;for(var c=0;c<b.sg.length;c++){var d=b.sg[c].action.F.type;if(20==d||10==d||40==d&&"SPEAKER"==b.type||60==d&&"MESH"==b.type)return!0}return ha.wJ(a)&&ha.vJ(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.is_animated=function(a){return!!a.fa.length};a.FJ=C;a.hM=v;a.CI=function(a){function b(a,b){for(var c=0;c<b;c++){var d=a.subarray(8*c+4,8*c+8);ca.normalize(d,d)}}function c(a,b){if(-1<a.indexOf("location"))var c=0,d=b;else-1<a.indexOf("rotation_quaternion")?(c=
4,d=0==b?3:b-1):-1<a.indexOf("scale")?(c=3,d=0):(c=0,d=b);return c+d}function d(a,b,c,d,g){if(-1<c.search(e)){a=b;c=c.split('"')[1];var h=f}else 8==g?(c="tsr",h=f):1<g?h=new Float32Array(g):h=0;if(!a[c]){g=a;b=c;if("object"==typeof h&&h.length)for(var l=h.length,k=new Float32Array(d*l),m=0;m<d;m++)for(var n=0;n<l;n++)k[m*l+n]=h[n];else if("number"==typeof h)for(k=new Float32Array(d),m=0;m<d;m++)k[m]=h;else da.D("Wrong storage default value");g[b]=k}return a[c]}var e=new RegExp(/pose.bones\[\".+\"\]/g),
f=ka.create(),g=a.F={type:0,Cx:0,CD:0,X:null,kv:null,uA:null,$h:new Int8Array(8)};g.CD=1/wa.Pk;var h=a.fcurves,k={},m={},n=0,q;for(q in h){var t=h[q],v;for(v in t){var u=t[v],w=u.Te;M.QJ(u,a);u=u.num_channels;n||(n=w.length);for(var u=d(k,m,q,n,u),x=u.length/n,K=c(q,v|0),y=0;y<n;y++)u[y*x+K]=w[y]}}if(da.hi(k)){for(var D in k)"tsr"==D&&b(k[D],n);g.X=k}if(da.hi(m)){for(var r in m)b(m[r],n);g.kv=m}g.Cx=n;g.uA=a.rI;"tsr"in k&&z(h,g.$h);("color"in k||"energy"in k)&&H(h,g.$h);("light_settings.environment_energy"in
k||"horizon_color"in k||"zenith_color"in k||"mist_settings.intensity"in k||"mist_settings.depth"in k||"mist_settings.start"in k||"mist_settings.height"in k||"b4w_fog_color"in k)&&p(h,g.$h);l(a);ua.push(a)};a.SM=function(a,b){return(b-a)*wa.Pk+1};a.aJ=function(a,b,c,d,e,f){var g=new Float32Array(2),h=new Float32Array(2),l=new Float32Array(2),k=new Float32Array(2),m=b[1],n=b[2],p=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var q=0,t=0,v=null;e<=f;e++)if(e<m)for(var u=0;u<wa.Pk;u++)c[q++]=
n;else if(e>p)for(u=0;u<wa.Pk;u++)c[q++]=a;else{var w=b[t],x=3;0===w&&(x+=2);0===v&&(x+=2);var K=2===w?0:1;if(b[t+1]==b[t+x+1])v=w,t+=x;else{u=0;e==b[t+1]&&(K&&(d[q]=1),c[q]=b[t+2],q++,u++);if(e==p)for(;u<wa.Pk;u++)c[q++]=a;else for(g[0]=b[t+1],g[1]=b[t+2],0!==w?(h[0]=0,h[1]=0):0===v?(h[0]=b[t+5],h[1]=b[t+6]):(h[0]=b[t+3],h[1]=b[t+4]),0!==w?(l[0]=0,l[1]=0):(l[0]=b[t+x+3],l[1]=b[t+x+4]),k[0]=b[t+x+1],k[1]=b[t+x+2];u<wa.Pk;u++){var D=e+u/wa.Pk;switch(w){case 0:var r,z,L,B=g,A=h,E=l,F=k,C=[],na=[];C[0]=
B[0]-A[0];C[1]=B[1]-A[1];na[0]=F[0]-E[0];na[1]=F[1]-E[1];r=F[0]-B[0];L=Math.abs(C[0]);z=Math.abs(na[0]);L+z&&L+z>r&&(r/=L+z,A[0]=B[0]-r*C[0],A[1]=B[1]-r*C[1],E[0]=F[0]-r*na[0],E[1]=F[1]-r*na[1]);K&&(d[q]=1);c[q]=y(Q(0,1,D,g[0],h[0],l[0],k[0]),g[1],h[1],l[1],k[1]);q++;break;case 1:K&&(d[q]=1);B=g[0];A=g[1];E=(k[1]-A)/(k[0]-B);c[q]=E*D+(A-E*B);q++;break;case 2:K&&(d[q]=1);c[q]=b[t+2];q++;break;default:da.D("Unknown keyframe interpolation mode: "+w)}}e+1==b[t+x+1]&&(v=w,t+=x)}}};a.apply=G;a.YI=function(a,
b,c,d){d=d||0;var e=da.keysearch("uuid",c,ua);if(e){Z(a,d);if(m(a,b,e,d)){S(a,d);return}a.fa[d]=null}ga.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.PF=function(a,b){var c=da.keysearch("name",b,ua)||da.keysearch("name",b+"_B4W_BAKED",ua);if(c){if(0==c.F.type)return!1}else if(!(X(a,b)||Y.is_mesh(a)&&D(a,b)))return!1;return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.fa,d=0;d<c.length;d++){var e=c[d];if(e&&g(e.Sh)==g(b))return d}return-1};a.RM=function(a,b){var c=
a.fa[b];return c&&c.Sh?g(c.Sh):null};a.remove=function(a){a.fa.length=0;a=T.indexOf(a);-1!=a&&T.splice(a,1)};a.vP=function(a){for(var b=ua.length-1;0<=b;b--)ua[b].sI==a&&ua.splice(b,1)};a.apply_to_first_empty_slot=function(a,b){if(!a.fa.length)return G(a,null,b,0)?0:-1;for(var c=0;c<a.fa.length;c++)if(!a.fa[c])return G(a,null,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.o.Vn=(b-a.o.mg)/c;a.o.Un=b};a.set_speed=function(a,b,c){w(a.fa,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.fa[b].speed};
a.get_anim_start_frame=function(a,b){return a.fa[b].start};a.get_anim_length=function(a,b){return a.fa[b].length};a.cleanup=function(){T.length=0;ua.length=0};a.kM=function(a){var b=(a[0]||a[1]||a[2]).Te.length,c=K,d=ea,e=!!a[0];e||(a[0]={Te:new Float32Array(b),num_channels:8});var f=!!a[1];f||(a[1]={Te:new Float32Array(b),num_channels:8});var g=!!a[2];g||(a[2]={Te:new Float32Array(b),num_channels:8});a[3]={Te:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=e?a[0].Te[h]:0,d[1]=f?a[1].Te[h]:
0,d[2]=g?a[2].Te[h]:0,da.euler_to_quat(d,c),a[0].Te[h]=c[3],a[1].Te[h]=c[0],a[2].Te[h]=c[1],a[3].Te[h]=c[2]};a.$B=V;a.MQ=function(a,b){for(var c=7,d=0,e=0;e<ua.length;e++){var f=ua[e];if(f.name==b){d=f.F.type;break}}0==d&&(D(a,b)?d=30:(e=X(a,b))&&"EMITTER"==e.pt&&(d=50));for(e=0;8>e;e++)if(f=a.fa[e]){if(f.type==d)return e}else e<c&&(c=e);return c}};b4w.module.__time=function(a,r){function d(){return-1!==c.nk.as?c.nk.as:w}var c=r("__config"),b=0,g=0,n=[],x=0,e=0,u=[],w=-1;a.qE=function(a){b=a;g=performance.now();for(a=0;a<n.length;a++){var c=n[a];b>c.gw&&(n.splice(a,1),a--,c.callback())}for(a=0;a<u.length;a++){var c=u[a],d=1-(c.gw-b)/c.duration,d=Math.min(d,1);c.callback(c.from+d*(c.to-c.from));1==d&&(u.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,c){var d;x++;d=x;n.push({id:d,callback:a,gw:b+(performance.now()-
g+c)/1E3});return d};a.clear_timeout=function(a){for(var b=0;b<n.length;b++)if(n[b].id==a){n.splice(b,1);break}};a.clear_animation=function(a){for(var b=u.length;b--;)if(u[b].id==a){u.splice(b,1);break}};a.animate=function(a,c,d,g){d/=1E3;var f;e++;f=e;u.push({id:f,callback:g,from:a,to:c,gw:b+d,duration:d});g(a);return f};a.reset=function(){g=b=0;n.length=0;e=x=u.length=0};a.ad=d;a.iQ=function(a){w=a};a.get_frame=function(a){return a*d()}};b4w.module.__transform=function(a,r){function d(a,b){m.Hf(a)?q.set_trans(b,m.Gf(a)):q.set_trans(b,a.o.v)}function c(a,b){var c=a.o;if(m.Hf(a)){q.set_quat(b,c.v);var d=m.fs(a),d=q.invert(d,v);q.multiply(d,c.v,m.Gf(a))}else q.set_quat(b,c.v)}function b(a,b){m.Hf(a)?q.set_quat(b,m.Gf(a)):q.set_quat(b,a.o.v)}function g(a,b){q.Qc(a.o.v,b);return b}function n(a,b){m.Hf(a)?q.Qc(m.Gf(a),b):q.Qc(a.o.v,b);return b}function x(a,b){m.Hf(a)?q.copy(b,m.Gf(a)):q.copy(b,a.o.v)}function e(a,b){m.Hf(a)?q.copy(m.Gf(a),
b):q.copy(a.o.v,b);return b}function u(a){var b=a.o,c=a.K,d=a.type;"CAMERA"==d&&h.az(a);m.IR(a,z);"CAMERA"==d&&h.GR(a);var e=q.ec(b.v,A),g=q.Qc(b.v,C);w.wk(b.U,b.v,b.Pa);w.lo(b.va,b.v,b.gb);if(b.wn)for(var l=0;l<c.length;l++)for(var n=c[l].R,p=0;p<n.length;p++){var x=n[p];w.wk(x.U,b.v,x.Pa);w.lo(x.va,b.v,x.gb);x.Je&&w.ko(x.Z,b.v,x.jb)}else b.Je&&w.ko(b.Z,b.v,b.jb);switch(d){case "MESH":a.kD&&q.invert(a.o.v,a.o.Au);if(n=a.er)q.invert(n.o.v,v),q.multiply(v,b.v,v),q.Cw(v,b.Zn),q.Qc(v,b.Yn);b.ep=!0;break;
case "CAMERA":for(l=0;l<c.length;l++)h.HR(a,c[l]);break;case "SPEAKER":t.VQ(a,z,H);break;case "LAMP":B.LR(a)}for(l=0;l<c.length;l++)if(p=c[l],p.Es){n=p.pb;x=n.F;switch(d){case "MESH":b.ie&&F.jy(n);x=p.bi;null!=b.td&&x&&F.xF(x,e);break;case "EMPTY":k.JR(a);break;case "CAMERA":F.VP(n);if(x.Jc){(x.Jc.enable_csm||x.Jc.RL)&&F.jy(n);var r=f.oa(a,n).ea[0];F.VR(r,x.Ja)}F.get_active()==n&&F.mj(n)==a&&t.qO(n,e,g,z,H);break;case "LAMP":F.vq(a,n)}x=p.Bh;r=a.Wp;if(r.length)for(p=0;p<x.length;p++){var I=x[p].B;
F.zF(x[p],e,g);f.AF(r,I.hc);h.DQ(I,F.mj(n));E.om(I.Tc,I.mh)}}b=a.ve;for(l=0;l<b.length;l++)u(b[l]);a=a.Ev;for(l=0;l<a.length;l++)b=a[l],n=b[0],m.DR(n,b[1])}var w=r("__boundings"),h=r("__camera"),m=r("__constraints"),B=r("__lights"),k=r("__objects"),f=r("__obj_util"),F=r("__scenes"),t=r("__sfx"),q=r("__tsr"),E=r("__util"),J=r("__vec3"),A=new Float32Array(3),I=new Float32Array(3),C=new Float32Array(4),v=q.create(),l=q.create(),z=0,H=0;a.update=function(a){z=a;H++};a.set_translation=function(a,b){var c=
a.o;if(m.Hf(a)){q.set_trans(b,c.v);var d=m.fs(a),d=q.invert(d,v);q.multiply(d,c.v,m.Gf(a))}else q.set_trans(b,c.v)};a.set_translation_rel=d;a.get_translation=function(a,b){q.ec(a.o.v,b);return b};a.get_translation_rel=function(a,b){m.Hf(a)?q.ec(m.Gf(a),b):q.ec(a.o.v,b);return b};a.set_rotation=c;a.set_rotation_rel=b;a.get_rotation=g;a.get_rotation_rel=n;a.set_rotation_euler=function(a,b){var d=E.euler_to_quat(b,C);c(a,d)};a.set_rotation_euler_rel=function(a,c){var d=E.euler_to_quat(c,C);b(a,d)};a.get_rotation_euler=
function(a,b){var c=g(a,C);return b=E.quat_to_euler(c,b)};a.get_rotation_euler_rel=function(a,b){var c=n(a,C);return b=E.quat_to_euler(c,b)};a.set_scale=function(a,b){var c=a.o;if(m.Hf(a)){var c=m.Gf(a),d=q.get_scale(m.fs(a));q.set_scale(b/d,c)}else q.set_scale(b,c.v)};a.set_scale_rel=function(a,b){var c=a.o;m.Hf(a)?q.set_scale(b,m.Gf(a)):q.set_scale(b,c.v)};a.get_scale=function(a){return q.get_scale(a.o.v)};a.get_scale_rel=function(a){return m.Hf(a)?q.get_scale(m.Gf(a)):q.get_scale(a.o.v)};a.set_tsr=
function(a,b){q.copy(b,a.o.v);if(m.Hf(a)){var c=m.fs(a),c=q.invert(c,v);q.multiply(c,a.o.v,m.Gf(a))}};a.set_tsr_rel=x;a.get_tsr=function(a,b){return q.copy(a.o.v,b)};a.get_tsr_rel=e;a.get_object_size=function(a){var b=a.o;a=b.Uh;var c=q.get_scale(b.v),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.get_object_center=function(a,b,c){b?(a=a.o,J.copy(a.gb.M,c)):(a=a.o,b=a.Uh,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/
2,q.transform_vec3(c,a.v,c));return c};a.move_local=function(a,b,c,f){var g=e(a,v),h=A;h[0]=b;h[1]=c;h[2]=f;q.transform_vec3(h,g,h);d(a,h)};a.fy=function(a,b){var c=e(a,v),d=q.set_quat(b,q.identity(l));q.multiply(c,d,d);x(a,d)};a.L=u;a.distance=function(a,b){var c=q.ec(a.o.v,A),d=q.ec(b.o.v,I);return J.dist(c,d)};a.Dp=function(a,b){var c=q.ec(a.o.v,A);return J.dist(c,b)};a.get_object_bounding_box=function(a){return{max_x:a.o.Pa.max_x,min_x:a.o.Pa.min_x,max_y:a.o.Pa.max_y,min_y:a.o.Pa.min_y,max_z:a.o.Pa.max_z,
min_z:a.o.Pa.min_z}}};b4w.module.__tsr=function(a,r){function d(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function c(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function g(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3];return d}function n(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function x(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],l=b[5],k=b[6];
b=b[7];var m=a[0]*g,n=a[1]*g,q=a[2]*g;a=b*m+l*q-k*n;var g=b*n+k*m-h*q,t=b*q+h*n-l*m,m=-h*m-l*n-k*q;c[0]=a*b+m*-h+g*-k-t*-l;c[1]=g*b+m*-l+t*-h-a*-k;c[2]=t*b+m*-k+a*-l-g*-h;c[0]+=d;c[1]+=e;c[2]+=f;return c}var e=r("__mat4"),u=r("__quat"),w=r("__util"),h=r("__vec3"),m=Math.sin(-Math.PI/4),B=-m,k=new Float32Array(3),f=new Float32Array(4),F=new Float32Array(16);a.create=d;a.clone=function(a){var c=d();b(a,c);return c};a.from_values=function(a,b,c,e,f,g,h,k){var l=d();l[0]=a;l[1]=b;l[2]=c;l[3]=e;l[4]=f;
l[5]=g;l[6]=h;l[7]=k;return l};a.Ek=c;a.vT=function(a){var d=c();b(a,d);return d};a.ST=function(a,b,d,e,f,g,h,k){var l=c();l[0]=a;l[1]=b;l[2]=d;l[3]=e;l[4]=f;l[5]=g;l[6]=h;l[7]=k;return l};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.set_sep=g;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set_scale=function(a,b){b[3]=a;return b};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set_quat=function(a,
b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.get_trans_view=function(a){return a.subarray(0,3)};a.ec=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.get_scale=function(a){return a[3]};a.Cw=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.get_quat_view=function(a){return a.subarray(4,8)};a.Qc=n;a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],g=a[2];f[0]=a[4];f[1]=a[5];f[2]=a[6];f[3]=a[7];u.invert(f,f);var h=f[0],k=f[1],l=f[2],m=f[3],d=d*c,e=e*c,n=g*
c,g=m*d+k*n-l*e,p=m*e+l*d-h*n,q=m*n+h*e-k*d,d=-h*d-k*e-l*n;b[0]=-(g*m+d*-h+p*-l-q*-k);b[1]=-(p*m+d*-k+q*-h-g*-l);b[2]=-(q*m+d*-l+g*-k-p*-h);b[3]=c;b[4]=h;b[5]=k;b[6]=l;b[7]=m;return b};a.to_mat4=function(a,b){var c=a[3];e.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,b){var c=w.ix(a,k),d=w.dD(a),e=w.matrix_to_quat(a,f);g(c,d,e,b);return b};a.multiply=function(a,b,c){x(b,a,c);c[3]=a[3]*b[3];var d=a[4],e=a[5],f=a[6];a=a[7];var g=
b[4],h=b[5],l=b[6];b=b[7];c[4]=d*b+a*g+e*l-f*h;c[5]=e*b+a*h+f*g-d*l;c[6]=f*b+a*l+d*h-e*g;c[7]=a*b-d*g-e*h-f*l;return c};a.qR=function(a,b,c){var d=b[3];b=e.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),F);for(var f=0;12>f;f++)b[f]*=d;e.multiply(b,a,c);return c};a.transform_vec3=x;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],f=a[1]-b[1],g=a[2]-b[2];a=b[4];var h=b[5],l=b[6];b=b[7];var k=a*a+h*h+l*l+b*b,k=k?1/k:0;a=-a*k;h=-h*k;l=-l*k;b*=k;var k=b*e+h*g-l*f,m=b*f+l*e-a*g,n=b*
g+a*f-h*e,e=-a*e-h*f-l*g;c[0]=k*b+e*-a+m*-l-n*-h;c[1]=m*b+e*-h+n*-a-k*-l;c[2]=n*b+e*-l+k*-h-m*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[0],g=b[1],h=b[2],l=b[3],k=b[4],m=b[5],n=b[6];b=b[7];for(var q=0;q<e;q+=3){var t=a[q]*l,u=a[q+1]*l,w=a[q+2]*l,x=b*t+m*w-n*u,D=b*u+n*t-k*w,r=b*w+k*u-m*t,t=-k*t-m*u-n*w;c[d+q]=x*b+t*-k+D*-n-r*-m;c[d+q+1]=D*b+t*-m+r*-k-x*-n;c[d+q+2]=r*b+t*-n+x*-m-D*-k;c[d+q]+=f;c[d+q+1]+=g;c[d+q+2]+=h}return c};a.transform_dir_vectors=
function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],l=b[6];b=b[7];for(var k=0;k<e;k+=3){var m=a[k]*f,n=a[k+1]*f,q=a[k+2]*f,t=b*m+h*q-l*n,u=b*n+l*m-g*q,w=b*q+g*n-h*m,m=-g*m-h*n-l*q;c[d+k]=t*b+m*-g+u*-l-w*-h;c[d+k+1]=u*b+m*-h+w*-g-t*-l;c[d+k+2]=w*b+m*-l+t*-h-u*-g}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],f=b[5],g=b[6];b=b[7];var h=a[0]*d,l=a[1]*d,k=a[2]*d;a=b*h+f*k-g*l;var d=b*l+g*h-e*k,m=b*k+e*l-f*h,h=-e*h-f*l-g*k;c[0]=a*b+h*-e+d*-g-m*-f;c[1]=d*b+h*-f+m*-e-a*-g;c[2]=
m*b+h*-g+a*-f-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],l=b[6];b=b[7];for(var k=0;k<e;k+=4){var m=a[k]*f,n=a[k+1]*f,q=a[k+2]*f,t=b*m+h*q-l*n,u=b*n+l*m-g*q,w=b*q+g*n-h*m,m=-g*m-h*n-l*q;c[d+k]=t*b+m*-g+u*-l-w*-h;c[d+k+1]=u*b+m*-h+w*-g-t*-l;c[d+k+2]=w*b+m*-l+t*-h-u*-g;c[d+k+3]=a[k+3]}return c};a.rR=function(a,b,c){b=n(b,f);u.multiply(b,a,c)};a.pF=function(a,b,c,d){d=d||0;b=n(b,f);w.MD(a,b,c,d)};a.translate=function(a,b,c){var d=a[3],e=a[4],f=a[5],
g=a[6],h=a[7],l=b[0]*d,k=b[1]*d,m=b[2]*d;b=h*l+f*m-g*k;var d=h*k+g*l-e*m,n=h*m+e*k-f*l,l=-e*l-f*k-g*m;c[0]=a[0]+b*h+l*-e+d*-g-n*-f;c[1]=a[1]+d*h+l*-f+n*-e-b*-g;c[2]=a[2]+n*h+l*-g+b*-f-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=function(a,b,c,d){h.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var e=a[3];d[3]=e+c*(b[3]-e);u.slerp(a.subarray(4,8),b.subarray(4,8),c,d.subarray(4,8));return d};a.KT=function(a,b,c,d){var e=a.subarray(0,3),f=b.subarray(0,3),g=
d.subarray(0,3);g[0]=f[0]*(c+1)-e[0]*c;g[1]=f[1]*(c+1)-e[1]*c;g[2]=f[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);e=d.subarray(4,8);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+1)-a[2]*c;e[3]=b[3]*(c+1)-a[3]*c;u.normalize(e,e);return d};a.JN=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var f=d[1];d=d[2];var g=a[4],h=a[5],l=a[6],k=a[7];e[4]=.5*(c*k+f*l-d*h);e[5]=.5*(f*k+d*g-c*l);e[6]=.5*(d*k+c*h-f*g);e[7]=.5*(-c*
g-f*h-d*l);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];f=e[7];a=a*a+b*b+c*c+f*f;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)};a.dV=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var c=a[4],d=a[5],e=a[6],f=a[7];b[4]=c*B+f*m;b[5]=d*B+e*m;b[6]=e*B-d*m;b[7]=f*B-c*m};a.cV=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__util=function(a,r){function d(a){return 0<a?1:0>a?-1:0}function c(a,b,c){var d=a[0],e=a[1];a=a[2];var f=Math.cos(d/2),g=Math.cos(e/2),h=Math.cos(a/2),l=Math.sin(d/2),e=Math.sin(e/2),k=Math.sin(a/2);if(-1<O.indexOf(b))var m=Math.cos((d+a)/2),n=Math.sin((d+a)/2),p=Math.cos((d-a)/2),q=Math.sin((d-a)/2),t=Math.cos((a-d)/2),v=Math.sin((a-d)/2);switch(b){case 0:c[0]=g*n;c[1]=e*p;c[2]=e*q;c[3]=g*m;break;case 1:c[0]=e*q;c[1]=g*n;c[2]=e*p;c[3]=g*m;break;case 2:c[0]=e*p;c[1]=e*q;c[2]=g*n;c[3]=
g*m;break;case 3:c[0]=g*n;c[1]=e*v;c[2]=e*t;c[3]=g*m;break;case 4:c[0]=e*t;c[1]=g*n;c[2]=e*v;c[3]=g*m;break;case 5:c[0]=e*v;c[1]=e*t;c[2]=g*n;c[3]=g*m;break;case 6:c[0]=l*g*h+f*e*k;c[1]=f*e*h-l*g*k;c[2]=f*g*k+l*e*h;c[3]=f*g*h-l*e*k;break;case 7:c[0]=f*g*k+l*e*h;c[1]=l*g*h+f*e*k;c[2]=f*e*h-l*g*k;c[3]=f*g*h-l*e*k;break;case 8:c[0]=f*e*h-l*g*k;c[1]=f*g*k+l*e*h;c[2]=l*g*h+f*e*k;c[3]=f*g*h-l*e*k;break;case 9:c[0]=l*g*h-f*e*k;c[1]=f*g*k-l*e*h;c[2]=f*e*h+l*g*k;c[3]=f*g*h+l*e*k;break;case 10:c[0]=f*e*h+l*
g*k;c[1]=l*g*h-f*e*k;c[2]=f*g*k-l*e*h;c[3]=f*g*h+l*e*k;break;case 11:c[0]=f*g*k-l*e*h,c[1]=f*e*h+l*g*k,c[2]=l*g*h-f*e*k,c[3]=f*g*h+l*e*k}return c}function b(a,b,c){var d=a[0],e=a[1],f=a[2];a=a[3];switch(b){case 0:c[0]=Math.atan2(d*e+f*a,e*a-d*f);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*e-f*a,d*f+e*a);break;case 1:c[0]=Math.atan2(d*a+e*f,f*a-d*e);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(e*f-d*a,d*e+f*a);break;case 2:c[0]=Math.atan2(d*f+e*a,d*a-e*f);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*
f-e*a,d*a+e*f);break;case 3:c[0]=Math.atan2(d*f-e*a,d*e+f*a);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*f+e*a,f*a-d*e);break;case 4:c[0]=Math.atan2(d*e-f*a,d*a+e*f);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(d*e+f*a,d*a-e*f);break;case 5:c[0]=Math.atan2(e*f-d*a,d*f+e*a);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*a+e*f,e*a-d*f);break;case 6:c[0]=Math.atan2(2*(d*a-e*f),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*f+e*a));c[2]=Math.atan2(2*(f*a-d*e),1-2*(e*e+f*f));break;case 7:b=d*e+f*a;.499999<b?
(c[0]=0,c[1]=Math.PI/2,c[2]=2*Math.atan2(d,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=-2*Math.atan2(d,a)):(c[0]=Math.atan2(2*(e*a-d*f),1-2*(e*e+f*f)),c[1]=Math.asin(2*(d*e+f*a)),c[2]=Math.atan2(2*(d*a-e*f),1-2*(d*d+f*f)));break;case 8:c[0]=Math.atan2(2*(f*a-d*e),1-2*(d*d+f*f));c[1]=Math.asin(2*(d*a+e*f));c[2]=Math.atan2(2*(e*a-d*f),1-2*(d*d+e*e));break;case 9:c[0]=Math.atan2(2*(d*a+e*f),1-2*(d*d+f*f));c[1]=Math.asin(2*(f*a-d*e));c[2]=Math.atan2(2*(d*f+e*a),1-2*(e*e+f*f));break;case 10:c[0]=Math.atan2(2*
(d*f+e*a),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*a-e*f));c[2]=Math.atan2(2*(d*e+f*a),1-2*(d*d+f*f));break;case 11:b=e*a-d*f,.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=-2*Math.atan2(f,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=2*Math.atan2(f,a)):(c[0]=Math.atan2(2*(d*e+f*a),1-2*(e*e+f*f)),c[1]=Math.asin(2*(e*a-d*f)),c[2]=Math.atan2(2*(d*a+e*f),1-2*(d*d+e*e)))}return c}function g(a,b,c){var d=b.length,e=D;e[0]=a[0];e[1]=a[1];e[2]=a[2];y.normalize(e,e);d?(a=ga,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],b=y.cross(a,
e,L),y.normalize(b,b),y.cross(e,b,a),d=ca,d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=e[0],d[4]=e[1],d[5]=e[2],d[6]=b[0],d[7]=b[1],d[8]=b[2],Q.fromMat3(d,c),c[3]=0<c[3]?c[3]+3.1E-5:c[3]-3.1E-5,(0<c[3]&&0>a[3]||0>c[3]&&0<a[3])&&Q.scale(c,-1,c),Q.normalize(c,c)):Q.rotationTo(wa,e,c);return c}function n(a,b){b||(b=new Float32Array(4));v.fromMat4(a,ca);var c=ca[0],d=ca[3],e=ca[6],f=ca[1],g=ca[4],h=ca[7],l=ca[2],k=ca[5],m=ca[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+g*g+h*h)||1,l=Math.sqrt(l*l+k*k+m*m)||1;
ca[0]/=c;ca[3]/=c;ca[6]/=c;ca[1]/=f;ca[4]/=f;ca[7]/=f;ca[2]/=l;ca[5]/=l;ca[8]/=l;Q.fromMat3(ca,b);Q.normalize(b,b);return b}function x(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function e(a,b){var c=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var d in a)c=e(a[d],c);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(d=
0;d<a.length;d++)c=u(a[d],c);break;case Array:for(d=0;d<a.length;d++)c=e(a[d],c);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:c=u(0,c);break;default:t("Wrong object constructor")}else c=u(0,c);return c;case "number":return u(a,c);case "boolean":return u(a|0,c);case "string":return w(a,c);case "function":case "undefined":return u(0,c)}}function u(a,b){var c=b;P[0]=a;c=(c<<5)-c+ma[0];c&=c;c=(c<<5)-c+ma[1];return c&c}function w(a,
b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function h(a){return(34*a+1)*a%289}function m(a){return a-Math.floor(a)}function B(a){return k((34*a+5)*a)}function k(a){return a-289*Math.floor(a/289)}function f(a){return a-7*Math.floor(a/7)}function F(a,b,c){a<b&&(a=b);a>c&&(a=c);return a}function t(a){a&&H.error.apply(H,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function q(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function E(a){return q(a,0,2*Math.PI)}function J(a,b){if(a&&b){var c=a instanceof Array;if(c!=b instanceof Array)return!1;var d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(d!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!A(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var e in a)if(!A(a[e],b[e]))return!1;for(e in b)if(!(e in a))return!1}return!0}return!(a||b)}function A(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return J(a,b);default:return!0}}function I(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?
c.push(e):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function C(){var a=[{}];a.length=0;return a}var v=r("__mat3"),l=r("__mat4"),z=r("__math"),H=r("__print"),p=r("__tsr"),Q=r("__quat"),y=r("__vec3"),Z=r("__vec4"),S=0,G={},D=new Float32Array(3),X=new Float32Array(3),V=new Float32Array(3),L=new Float32Array(3),ba=new Float32Array(3),pa=new Float32Array(3),Y=new Float32Array(3),ha=new Float32Array(3),U=new Float32Array(4),ga=new Float32Array(4),ca=new Float32Array(9),M=new Float32Array(16),
la=new Float32Array(16),aa=Q.create(),P=new Float64Array(1),ma=new Uint32Array(P.buffer),W=new Float32Array([0,0,0,1]),ka=new Float32Array([0,0,0,1,0,0,0,1]),da=new Float32Array([1,1,1]),va=new Float32Array([1,0,0]),wa=new Float32Array([0,1,0]),sa=new Float32Array([0,0,1]),ta=new Float32Array([-1,0,0]),ea=new Float32Array([0,-1,0]),ra=new Float32Array([0,0,-1]),O=[0,1,2,4,5],Ia=Math.floor(44488.07041494893),xa=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,
0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.Sz=new Float32Array([0,0,0]);a.Wl=W;a.ZS=ka;a.Tu=da;a.AXIS_X=va;a.AXIS_Y=wa;a.AXIS_Z=sa;a.AXIS_MX=ta;a.AXIS_MY=ea;a.AXIS_MZ=ra;a.XYX=0;a.YZY=1;a.ZXZ=2;a.XZX=3;a.YXY=4;a.ZYZ=5;a.XYZ=6;a.YZX=7;a.ZXY=8;a.XZY=9;a.YXZ=10;a.ZYX=11;a.qG=xa;a.Cu=1;a.Pn=2;a.Oh=4;a.zz=4;a.Lf=
function(a){return"undefined"!=typeof a};a.keyfind=function(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var g=c[f];g[a]==b&&d.push(g)}return d};a.f32=function(a){return new Float32Array(a)};a.qM=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.uR=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.XJ=function(){return 255==(new DataView((new Uint16Array([255])).buffer)).getUint16(0,!0)};a.bJ=function(a,b){var c=[],d=
{},e=b.length,f,g;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)g=a[f],g in d&&c.push(g);return c};a.sign=d;a.BU=function(a,b,c){for(var d=c.length,e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.zU=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g[a]==b&&g[c]==d)return g}return null};a.lN=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==b)return c;return-1};a.XI=function(a,
b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.tT=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.nR=function(a,b,c,d){d||(d=new Float32Array(16));l.identity(d);d[12]=a;d[13]=b;d[14]=c};var oa=1;a.sP=function(){oa=(69069*oa+5)%Math.pow(2,32);return Math.round(oa/65536)%32768/32767};a.bR=function(a){oa=a};a.Uf=function(a){var b=a[0]%Ia*48271-3399*Math.floor(a[0]/Ia);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.Cs=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){var d=D;d[0]=a[2];d[1]=a[1];d[2]=a[0];c(d,11,b);return b};a.ordered_angles_to_quat=c;a.quat_to_ordered_angles=b;a.$L=function(a){var b=v.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),g=Math.sin(a[1]);a=Math.sin(a[2]);var h=c*e,l=c*a,k=f*e,m=f*a;b[0]=d*e;b[1]=d*a;b[2]=-g;b[3]=g*k-l;b[4]=g*m+h;b[5]=d*f;b[6]=g*h+m;b[7]=g*l-k;b[8]=d*c;return b};a.quat_to_euler=function(a,c){var d=b(a,11,D);c[0]=
d[2];c[1]=d[1];c[2]=d[0];return c};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));y.transformQuat(b,a,c);return c};a.dir_to_quat=function(a,b,c){c||(c=new Float32Array(4));a=y.normalize(a,D);var d=y.dot(b,a);a=y.cross(b,a,V);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.oR=function(a,b,c,d){d||(d=new Float32Array(4));y.transformQuat(c,b,d);d[3]=-y.dot(a,d)};a.JL=function(a){var b=p.get_quat_view(a.o.v),c=D;switch(a.type){case "CAMERA":c[0]=
0;c[1]=-1;c[2]=0;y.transformQuat(c,b,c);V[0]=0;V[1]=0;V[2]=-1;break;case "MESH":c[0]=0;c[1]=0;c[2]=1;y.transformQuat(c,b,c);V[0]=0;V[1]=0;V[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,y.transformQuat(c,b,c),V[0]=0,V[1]=1,V[2]=0}c[1]=0;y.normalize(c,c);a=y.dot(c,V);return Math.acos(a)*(0<-c[0]*V[2]?-1:1)};a.xA=function(a,b,c,d){if(0!=c){d=d||[];for(var e=0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.uF=function(){S++;return S.toString(10)};a.sq=function(a){G[a]||(G[a]=0);var b=a+G[a];G[a]++;return b};
a.rg=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};a.gen_tbn_quats=function(a,b,c){b=b||C();var d=b.length,e=a.length/3;c=c||new Float32Array(4*e);for(var f=0;f<e;++f){var h=D;h[0]=a[3*f];h[1]=a[3*f+1];h[2]=a[3*f+2];var l;d?(l=ga,l[0]=b[4*f],l[1]=b[4*f+1],l[2]=b[4*f+2],l[3]=b[4*f+3]):l=b;g(h,l,c.subarray(4*f,4*(f+1)))}return c};a.lC=g;a.bh=function(a){return JSON.parse(JSON.stringify(a))};a.S=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;
switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c=new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.S(b[d]);break;default:for(d in c=new c,b)c[d]=a.S(b[d])}return c};a.zo=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[c]=
new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.matrix_to_quat=n;a.ix=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.dD=function(a){U[0]=.577350269189626;U[1]=.577350269189626;U[2]=.577350269189626;U[3]=0;Z.transformMat4(U,a,U);return Z.length(U)};a.om=function(a,b){var c=b.left,d=b.right,e=b.top,f=b.bottom,g=b.near,h=b.far;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=a[7]-
a[4];d[2]=a[11]-a[8];d[3]=a[15]-a[12];e[0]=a[3]-a[1];e[1]=a[7]-a[5];e[2]=a[11]-a[9];e[3]=a[15]-a[13];f[0]=a[3]+a[1];f[1]=a[7]+a[5];f[2]=a[11]+a[9];f[3]=a[15]+a[13];g[0]=a[3]+a[2];g[1]=a[7]+a[6];g[2]=a[11]+a[10];g[3]=a[15]+a[14];h[0]=a[3]-a[2];h[1]=a[7]-a[6];h[2]=a[11]-a[10];h[3]=a[15]-a[14];x(c);x(d);x(e);x(f);x(g);x(h)};a.XQ=function(a,b,c){return c<-z.point_plane_dist(a,b.near)||c<-z.point_plane_dist(a,b.left)||c<-z.point_plane_dist(a,b.right)||c<-z.point_plane_dist(a,b.top)||c<-z.point_plane_dist(a,
b.bottom)||c<-z.point_plane_dist(a,b.far)?!0:!1};a.VL=function(a,b,c,d,e){var f=y.dot(c,b.far),g=y.dot(d,b.far),h=y.dot(e,b.far),f=Math.sqrt(f*f+g*g+h*h);if(f<-z.point_plane_dist(a,b.near)||f<-z.point_plane_dist(a,b.far))return!0;f=y.dot(c,b.left);g=y.dot(d,b.left);h=y.dot(e,b.left);if(Math.sqrt(f*f+g*g+h*h)<-z.point_plane_dist(a,b.left))return!0;f=y.dot(c,b.right);g=y.dot(d,b.right);h=y.dot(e,b.right);if(Math.sqrt(f*f+g*g+h*h)<-z.point_plane_dist(a,b.right))return!0;f=y.dot(c,b.top);g=y.dot(d,b.top);
h=y.dot(e,b.top);if(Math.sqrt(f*f+g*g+h*h)<-z.point_plane_dist(a,b.top))return!0;f=y.dot(c,b.bottom);g=y.dot(d,b.bottom);h=y.dot(e,b.bottom);return Math.sqrt(f*f+g*g+h*h)<-z.point_plane_dist(a,b.bottom)?!0:!1};a.Um=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],l=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*l+b[12];c[d+f+1]=b[1]*g+b[5]*h+b[9]*l+b[13];c[d+f+2]=b[2]*g+b[6]*h+b[10]*l+b[14]}};a.kV=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],l=a[f+
2];c[d+f]=b[0]*g+b[4]*h+b[8]*l;c[d+f+1]=b[1]*g+b[5]*h+b[9]*l;c[d+f+2]=b[2]*g+b[6]*h+b[10]*l}return c};a.MD=function(a,b,c,d){d=d||0;for(var e=a.length,f=0;f<e;f+=4){aa[0]=a[f];aa[1]=a[f+1];aa[2]=a[f+2];aa[3]=a[f+3];var g=0<aa[3];Q.multiply(b,aa,aa);(g&&0>aa[3]||!g&&0<aa[3])&&Z.scale(aa,-1,aa);c[d+f]=aa[0];c[d+f+1]=aa[1];c[d+f+2]=aa[2];c[d+f+3]=aa[3]}};a.nS=function(a,b,c){c||(c=new Float32Array(3));U[0]=a[0];U[1]=a[1];U[2]=a[2];U[3]=0;Z.transformMat4(U,b,U);c[0]=U[0];c[1]=U[1];c[2]=U[2]};a.MT=function(a,
b){var c=a.length;c||t("flatten(): Wrong or empty array");var d=a[0].length;d||t("flatten(): Wrong or empty subarray");b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.oS=function(a){for(var b=[],c=0;c<a.length;c+=3)b[c/3]=new Float32Array([a[c],a[c+1],a[c+2]]);return b};a.kr=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.kr(b,c,d,f-1):b[f]<c?a.kr(b,c,f+1,e):f};a.aj=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;
return!0};a.wT=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.PU=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.qR=function(a,b,c,d,e){e||(e=new Float32Array(16));b=l.fromRotationTranslation(c,d,M);l.multiply(b,a,e);return e};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=l.fromRotationTranslation(c,d,M);1!==b&&(d=l.identity(la),b=y.set(b,b,b,D),l.scale(d,
b,d),l.multiply(c,d,c));y.transformMat4(a,c,e);return e};a.fV=function(a,b,c,d,e){e||(e=new Float32Array(4));b=l.fromRotationTranslation(c,d,M);Z.transformMat4(a,b,e);return e};a.tU=function(a,b,c,d,e){e||(e=new Float32Array(3));b=l.fromRotationTranslation(c,d,M);l.invert(b,b);y.transformMat4(a,b,e);return e};a.eV=function(a,b,c){c||(c=new Float32Array(16));l.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.GU=function(b,c,d){a.ix(b,c);c[3]=a.dD(b);n(b,d)};a.hT=function(a){for(var b=
[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.PP=function(a,b,c,d){d||(d=new Float32Array(3));var e=D;y.subtract(b,a,e);y.transformQuat(e,c,e);y.subtract(b,e,d)};a.GM=function(){var a=D;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),g=new Float32Array(16);l.lookAt(a,[-1,0,0],[0,-1,0],b);l.scale(b,[-1,1,1],b);l.scale(b,[-1,1,-1],c);l.lookAt(a,[0,-1,0],[0,0,-1],d);l.scale(d,[1,1,-1],d);l.scale(d,
[1,-1,-1],e);l.lookAt(a,[0,0,-1],[0,-1,0],f);l.scale(f,[-1,1,1],f);l.scale(f,[-1,1,-1],g);return[b,c,d,e,f,g]};a.KM=function(){var a=D;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),g=new Float32Array(16);l.lookAt(a,[1,0,0],[0,-1,0],b);l.scale(b,[-1,1,-1],c);l.lookAt(a,[0,1,0],[0,0,1],d);l.scale(d,[1,-1,-1],e);l.lookAt(a,[0,0,1],[0,-1,0],f);l.scale(f,[-1,1,-1],g);return[b,c,d,e,f,g]};a.HJ=function(a){return e(a,
0)};a.hash_code=e;a.oU=w;a.BO=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.deg_to_rad=function(a){return a*
Math.PI/180};a.rad_to_deg=function(a){return 180*a/Math.PI};a.vy=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),e=.211324865405187*c+.211324865405187*d,b=a[0]-c+e;a=a[1]-d+e;var f=b>a?1:0,g=1-f,e=b+.211324865405187-f,l=a+.211324865405187-g,k=b+-.577350269189626,n=a+-.577350269189626,c=c%289,d=d%289,p=Math.max(.5-(b*b+a*a),0),q=Math.max(.5-(e*e+l*l),0),t=Math.max(.5-(k*k+n*n),0),v=2*m(.024390243902439*h(h(d)+c))-1,f=2*m(.024390243902439*h(h(d+
g)+c+f))-1,u=2*m(.024390243902439*h(h(d+1)+c+1))-1,c=Math.abs(v)-.5,d=Math.abs(f)-.5,g=Math.abs(u)-.5,v=v-Math.floor(v+.5),f=f-Math.floor(f+.5),u=u-Math.floor(u+.5);return 130*(p*p*p*p*(1.79284291400159-.85373472095314*(v*v+c*c))*(v*b+c*a)+q*q*q*q*(1.79284291400159-.85373472095314*(f*f+d*d))*(f*e+d*l)+t*t*t*t*(1.79284291400159-.85373472095314*(u*u+g*g))*(u*k+g*n))};a.MA=function(a){var b=1/7,c=b/2,d=k(Math.floor(a[0])),e=k(Math.floor(a[1])),g=m(a[0]);a=m(a[1]);var h=g-.5,l=g-1.5,g=a-.5;a-=1.5;var n=
B(d),p=B(d+1),q=n,d=p,n=B(n+e),p=B(p+e),q=B(q+e+1),d=B(d+e+1),e=h+.7*(f(n)*b+c),t=l+.7*(f(p)*b+c),h=h+.7*(f(q)*b+c),l=l+.7*(f(d)*b+c),n=g+.7*(f(Math.floor(n*b))*b+c),g=g+.7*(f(Math.floor(p*b))*b+c),q=a+.7*(f(Math.floor(q*b))*b+c),b=a+.7*(f(Math.floor(d*b))*b+c);return Math.min(e*e+n*n,t*t+g*g,h*h+q*q,l*l+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=y.transformQuat(b,a,D);b=c[0];var f=c[1];c=c[2];var g=ca;g[0]=f*f+c*c;g[1]=-f*b;g[2]=-c*b;g[3]=-b*f;g[4]=b*b+c*c;g[5]=-c*f;g[6]=
-b*c;g[7]=-f*c;g[8]=b*b+f*f;y.transformMat3(a,g,a);y.normalize(a,a);Q.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c,d;c=Q.setAxisAngle([0,0,1],Math.PI,Q.create());d=Q.setAxisAngle([1,0,0],Math.PI/2,Q.create());Q.multiply(c,d,c);Q.multiply(a,c,b);return b};a.cleanup=function(){S=0;G={}};a.clamp=F;a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,b,c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=
0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.JE=function(a,b,c,d,e){e||(e=new Float32Array(a.length));Q.slerp(a,b,Math.exp(-c/d),e)};a.Uw=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=v.fromQuat(a,ca),d=D;d[0]=c[6];d[1]=c[7];d[2]=c[8];d=y.cross(sa,d,d);y.normalize(d,d);var e=c[4];
!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);V[0]=c[0];V[1]=c[1];V[2]=c[2];y.normalize(V,V);c=ga;Q.rotationTo(V,d,c);Q.multiply(c,a,a)};a.ZB=function(a,b,c,d){c=c*b-.5;d=d*b-.5;var e=c-Math.floor(c),f=d-Math.floor(d);c=Math.floor(c);d=Math.floor(d);var g=b-1;return(a[d*b+c]*(1-e)+a[d*b+Math.min(c+1,g)]*e)*(1-f)+(a[Math.min(d+1,g)*b+c]*(1-e)+a[Math.min(d+1,g)*b+Math.min(c+1,g)]*e)*f};a.xl=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.WD=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<
c)&&(b[2-c]=1);return b};a.Ym=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.mw=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.hi=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){return a.length?a[Math.floor(Math.random()*a.length)]:null};a.horizontal_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-
b[0];c[1]=a[1]-b[1];c[2]=0;y.normalize(c,c)};a.pR=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1],h=b[2];b=b[3];var l=g*a-h*e,k=h*d-f*a,m=f*e-g*d;c[0]=d+2*l*b+2*(g*m-h*k);c[1]=e+2*k*b+2*(h*l-f*m);c[2]=a+2*m*b+2*(f*k-g*l)};a.assert=function(a){a||t("Assertion failed")};a.D=t;a.angle_wrap_periodic=q;a.angle_wrap_0_2pi=E;a.uw=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.eR=function(a,b){for(var c in a){var d=!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=
e==f;break;case "object":d=J(e,f)}if(!d)return!1}return!0};a.Sx=function(a,b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.QB=function(a){a++;132651<a&&H.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;return new Float32Array([b/51,Math.floor(a/51)/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d){U.set(a);U[3]=b;a=ga;D[0]=c[3];D[1]=c[4];D[2]=c[5];a.set(D);a[3]=0;a=Z.dot(U,a);if(0==a)return null;b=ga;y.copy(c,D);b.set(D);b[3]=1;a=-Z.dot(U,b)/a;d[0]=c[0]+a*c[3];
d[1]=c[1]+a*c[4];d[2]=c[2]+a*c[5];return d};a.rN=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=f*b-e*a;d[2]=e*h-g*f;return d};a.yT=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.hy=function(a,b,c){var d=D,e=y.dot(a,b);-.9999999>e?(y.cross(va,a,d),1E-6>y.length(d)&&y.cross(wa,a,d),y.normalize(d,d),Q.setAxisAngle(d,Math.PI,c)):(y.cross(a,b,d),c.set(d),c[3]=1+e,Q.normalize(c,c));return c};a.xk=function(a,b,c){if(b==c)return c-
a;a=E(a);b=E(b);c=E(c);b=2*Math.PI-b;c=E(c+b);a=E(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=F(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.cJ=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.ET=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.SF=function(a,b){for(var c=Math.max(a.length,b.length),e=0;e<c;e++){var f=d((e>=a.length?0:a[e])-(e>=
b.length?0:b[e]));if(f)return f}return 0};a.dk=function(a){return a.join(".")};a.SE=function(a){return a.split(".").map(function(a){return a|0})};a.OE=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.dx=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.zh=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=I(b[1]),b.join("://")):I(a)};a.vo=function(a){return!!parseInt(a.toString(2).substr(1),2)};a.UL=
function(a,b,c,d){d[0]=a[0];d[1]=b[0];d[2]=c[0];d[3]=a[1];d[4]=b[1];d[5]=c[1];d[6]=a[2];d[7]=b[2];d[8]=c[2];return d};a.ej=C;a.$o=function(a){a=Math.round(32767.5*(a+1)-32768);return F(a?a:0,-32768,32767)};a.WU=function(a){return F((a+32768)/32767.5-1,-1,1)};a.tR=function(a){return F(Math.round(255*a),0,255)};a.hV=function(a){return F(a/255,0,1)};a.ML=function(a,b,c,d){var e=y.subtract(c,b,D),f=y.subtract(d,c,X),g=y.subtract(b,d,V);b=y.subtract(a,b,L);c=y.subtract(a,c,ba);a=y.subtract(a,d,pa);d=y.cross(e,
f,Y);if(0<=y.dot(y.cross(d,e,ha),b)&&0<=y.dot(y.cross(d,f,ha),c)&&0<=y.dot(y.cross(d,g,ha),a))return g=y.length(d),f=y.dot(d,b),Math.abs(f/g);e=y.scale(e,F(y.dot(e,b)/y.length(e),0,1),ha);b=y.length(y.subtract(b,e,ha));f=y.scale(f,F(y.dot(f,c)/y.length(f),0,1),ha);f=y.length(y.subtract(c,f,ha));g=y.scale(g,F(y.dot(g,a)/y.length(g),0,1),ha);g=y.length(y.subtract(a,g,ha));return Math.min(Math.min(b,f),g)}};b4w.module.__sfx=function(a,r){function d(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(pa){return E.error('Unable to initialize AudioContext: "'+pa+'". The audio is disabled.'),null}if(b.createGain)return b;E.warn("deprecated WebAudio implementation");return null}E.warn("WebAudio is not supported");return null}function c(a,c,d){var f=a.Y;if("NONE"!=f.behavior){var g=f.loop,h=f.pitch;if(f.src&&(g||0<=d)){f.ev=Math.floor(5E4*Math.random());var l=S.currentTime+c,
l=Math.max(0,l);f.Ge=l;f.state=20;var k=G.Dc;"POSITIONAL"==f.behavior&&"none"==k.Vo&&(f.behavior="BACKGROUND_SOUND");b(a,G.Dc);if("POSITIONAL"==f.behavior||"BACKGROUND_SOUND"==f.behavior){c=S.createBufferSource();c.buffer=f.src;c.playbackRate.value=h;if(g){f.Wb&&f.Wb.disconnect();f.pd&&f.pd.disconnect();c.loop=!0;c.loopStart=f.aD;if(c.loopEnd=f.Ss)d=S.createBufferSource(),d.buffer=f.src,d.playbackRate.value=h,f.pd=d,d.connect(f.kd);c.start(l);f.duration=0}else g=c.buffer?c.buffer.duration:0,d>g?(g=
l+d+f.$e,c.loop=!0,c.start(l),c.stop(g),f.duration=d):(c.loop=!1,c.start(l),f.duration=g);c.connect(f.kd);f.Wb=c;n(f);x(f);e(f)}else"BACKGROUND_MUSIC"==f.behavior&&(A.clear_timeout(f.fv),A.clear_timeout(f.gv),d=function(){var b=a.Y,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.Wb=b.Wb||S.createMediaElementSource(c),b.Wb.connect(b.kd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():f.fv=A.set_timeout(d,1E3*c),g?f.duration=0:f.duration=t(a));u(f,l)}}}function b(a,b){var c=a.Y;if(!c.kd){var d=
I.get_trans_view(a.o.v),e=I.get_quat_view(a.o.v);if(z.$s){var f=S.createBiquadFilter();f.type="peaking"}else f=null;var g=S.createGain();switch(c.behavior){case "POSITIONAL":var h=S.createPanner();"string"!=typeof h.panningModel?(h.panningModel=h.EQUALPOWER,h.distanceModel=h.INVERSE_DISTANCE):(h.panningModel="equalpower",h.distanceModel=b.Vo);h.setPosition(d[0],d[1],d[2]);v.copy(d,c.Yw);d=H;C.quat_to_dir(e,C.AXIS_MZ,d);h.setOrientation(d[0],d[1],d[2]);h.refDistance=c.dist_ref;h.maxDistance=c.dist_max;
h.rolloffFactor=c.attenuation;h.coneInnerAngle=c.bB;h.coneOuterAngle=c.cB;h.coneOuterGain=c.dB;var l=S.createGain();l.gain.value=F(c);f?(h.connect(f),f.connect(l)):h.connect(l);l.connect(g);c.kd=h;if(c.Ml){var k=S.createGain();g.connect(k);k.connect(b.kd)}else k=null,g.connect(b.kd);break;case "BACKGROUND_SOUND":h=null;l=S.createGain();l.gain.value=F(c);f?(c.kd=f,f.connect(l)):c.kd=l;l.connect(g);c.Ml?(k=S.createGain(),g.connect(k),k.connect(b.kd)):(k=null,g.connect(b.kd));break;case "BACKGROUND_MUSIC":k=
h=null,l=S.createGain(),l.gain.value=F(c),f?(c.kd=f,f.connect(l)):c.kd=l,l.connect(g),g.connect(b.kd)}c.Jx=h;c.yg=f;c.wm=l;c.ij=g;c.Ux=k}}function g(a){var b=a.Y;c(a,b.delay+b.wB*Math.random(),b.duration)}function n(a){var b=a.pd||a.Wb;C.Lf(b.onended)&&(b.onended=function(){a.state=50})}function x(a){a.Ml&&a.Ux.gain.cancelScheduledValues(a.Ge);a.Tm&&(a.Wb.playbackRate.cancelScheduledValues(a.Ge),a.pd&&a.pd.playbackRate.cancelScheduledValues(a.Ge));a.Hq=a.Ge}function e(a){if(a.Ml||a.Tm){var b=a.Ux,
c=a.Wb,d=c.buffer?c.buffer.duration:0;if(d){var e=a.Ge;X[0]=a.ev;for(var f=0;5>f;){var g=a.pitch+a.Tm*C.Uf(X);if(e>=a.Hq){if(a.Ml){var h=1-C.clamp(a.Ml,0,1)*Math.random();b.gain.setValueAtTime(h,e)}a.Tm&&(c.playbackRate.setValueAtTime(g,e),a.pd&&a.pd.playbackRate.setValueAtTime(g,e));f++}e+=d/g}a.Hq=e-.001}}}function u(a,b){if(a.Nk||a.$e){var c=a.ij;c.gain.cancelScheduledValues(b);a.Nk?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.Nk)):c.gain.setValueAtTime(1,b);a.$e&&!a.loop&&
(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.$e))}}function w(a){"SPEAKER"!=a.type&&C.D("Wrong object type");var b=a.Y;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.ij,d=S.currentTime;b.$e&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.$e));"BACKGROUND_MUSIC"==b.behavior?b.src&&(A.clear_timeout(b.fv),A.clear_timeout(b.gv),b.gv=A.set_timeout(function(){var b=a.Y.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},
1E3*b.$e)):(c=b.Wb,b.duration<c.buffer.duration?b.$e&&20==b.state?c.stop(d+b.$e):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.Ge=0,b.Kx=0,b.or=0);b.state=30}}function h(a){a=a.Y;if(20==a.state){var b=S.currentTime;a.Kx=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(b>a.Ge?a.or=m(a,b):a.or=0,a.Wb.onended=function(){},a.Wb.stop(0),a.Wb.disconnect(),x(a));a.state=40}}function m(a,b){X[0]=a.ev;for(var c=a.Wb.buffer.duration,d=a.Ge,e;d<b;)e=a.pitch+a.Tm*C.Uf(X),d+=c/e;return(c/e-(d-
b))*e}function B(a){var b=a.Y;if(40==b.state){var c=S.currentTime;b.Ge+=c-b.Kx;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.Y;var d=S.createBufferSource();d.loop=a.Wb.loop;d.loopStart=a.Wb.loopStart;d.loopEnd=a.Wb.loopEnd;d.buffer=a.Wb.buffer;d.playbackRate.value=a.Wb.playbackRate.value;d.connect(a.kd);a.Wb=d;a.pd&&(d=S.createBufferSource(),d.loop=a.pd.loop,d.buffer=a.pd.buffer,d.playbackRate.value=a.pd.playbackRate.value,d.connect(a.kd),a.pd=d);b.Hq=c;c=b.Wb;n(b);c.start(b.Ge,b.or);e(b)}u(b,
b.Ge);b.state=20}}function k(a,b,c){var d;d=b.NL;if(0<d){var e=b.WQ;if(0!=v.dot(a.ou,a.ou)||0!=v.dot(b.fl,b.fl)){var f=v.subtract(a.Yw,b.vh,H),g=v.length(f);b=v.dot(f,b.fl)/g;f=v.dot(f,a.ou)/g;g=e/d;b=Math.min(-b,g);f=Math.min(-f,g);d=(e-d*b)/(e-d*f);isFinite(d)||(d=0);d=Math.min(d,16);d=Math.max(d,.125);d=C.smooth(d,a.TC,c,.3);a.Wb.playbackRate.value=d;a.TC=d}}}function f(a){a=a.Y;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function F(a){return a.muted?0:a.volume}function t(a){a=
a.Y;return(a=a.src)?a.duration:0}var q=r("__config"),E=r("__print"),J=r("__quat"),A=r("__time"),I=r("__tsr"),C=r("__util"),v=r("__vec3"),l=q.H,z=q.Y,H=new Float32Array(3),p=new Float32Array(3),Q=J.create(),y=[],Z=[],S=null,G=null,D=[],X=[1],V=null;a.uz=10;a.Bu=20;a.sz=30;a.TK=function(){return{Pi:-1,xg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,bB:360,cB:360,dB:1,autoplay:!1,cyclic:!1,loop:!1,aD:0,Ss:0,delay:0,wB:0,Ml:0,Tm:0,Nk:0,$e:0,Ge:0,Kx:0,or:0,duration:0,
Hq:0,ev:1,src:null,state:10,Yw:new Float32Array(3),ou:new Float32Array(3),Rr:!1,TC:1,fv:-1,gv:-1,Mk:0,kd:null,Wb:null,pd:null,Jx:null,yg:null,wm:null,ij:null,Ux:null,ak:0}};a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(y.push("ogg"),y.push("ogv"),y.push("oga")),""!=a.canPlayType("audio/mpeg")&&y.push("mp3"),""!=a.canPlayType("audio/mp4")&&(y.push("mp4"),y.push("m4v"),y.push("m4a")),""!=a.canPlayType("audio/webm")&&
y.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(Z.push("ogv"),Z.push("ogg"),Z.push("oga")),""!=b.canPlayType("video/mp4")&&(Z.push("m4v"),Z.push("mp4")),""!=b.canPlayType("video/webm")&&Z.push("webm"),""!=b.canPlayType("video/mpeg")&&Z.push("mp3"))};a.iJ=function(a){z.mz&&!S&&(S=d())&&E.log("%cINIT WEBAUDIO: "+S.sampleRate+"Hz","color: #00a");if(S){var b={vh:new Float32Array(3),fl:new Float32Array(3),ak:0},c=S.createGain(),e=S.createGain();b.wm=c;b.ij=e;c.connect(e);e.connect(S.destination);
if(a.b4w_enable_dynamic_compressor){var e=S.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;e.threshold.value=f.threshold;e.knee.value=f.knee;e.ratio.value=f.ratio;e.attack.value=f.attack;e.release.value=f.release;e.connect(c);b.Jo=e;b.kd=e}else b.Jo=null,b.kd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Vo="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Vo="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Vo="exponential";break;case "NONE":b.Vo=
"none";break;default:C.D("Wrong audio distance model")}b.NL=a.audio_doppler_factor;b.WQ=a.audio_doppler_speed;b.muted=!1;b.volume=a.audio_volume;c.gain.value=F(b);b.Mk=0}else b=null;a.Dc=b};a.ZP=function(a){G=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<y.indexOf(a)?a:-1<y.indexOf("m4a")?"m4a":-1<y.indexOf("oga")?"oga":""};a.detect_video_container=function(a){a||(a="webm");return-1<Z.indexOf(a)?a:-1<Z.indexOf("m4v")?"m4v":-1<Z.indexOf("webm")?"webm":""};a.bk=function(a,b){var c=a.data,
d=b.Y;if(a.data.sound){d.Pi=a.data.sound.uuid;d.xg=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=S?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var e;S?(window.MediaElementAudioSourceNode?e=!0:(E.warn("MediaElementAudioSourceNode not found"),e=!1),e=e&&!l.UA?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:C.D("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.Rr=c.b4w_enable_doppler;d.muted=c.muted;d.volume=
c.volume;d.pitch=c.pitch;d.attenuation=c.attenuation;d.dist_ref=c.distance_reference;d.dist_max=c.distance_max||1E4;d.bB=c.cone_angle_inner;d.cB=c.cone_angle_outer;d.dB=c.cone_volume_outer;d.autoplay=c.b4w_auto_play;d.cyclic=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.aD=c.b4w_loop_start;d.Ss=c.b4w_loop_end;d.delay=c.b4w_delay;d.wB=c.b4w_delay_random;d.Ml=c.b4w_volume_random;d.Tm=c.b4w_pitch_random;d.Nk=c.b4w_fade_in;d.$e=c.b4w_fade_out;D.push(b)}};a.KE=function(b){"SPEAKER"!=b.type&&C.D("Wrong object type");
switch(b.Y.behavior){case "POSITIONAL":return a.Bu;case "BACKGROUND_SOUND":return a.Bu;case "BACKGROUND_MUSIC":return a.sz;case "NONE":return a.uz;default:C.D("Wrong speaker behavior")}};a.ZR=function(a,b){var c=a.Y;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:C.D("Wrong speaker behavior")}};a.ED=function(){var a=S.createBufferSource();a.buffer=S.createBuffer(1,22050,22050);a.connect(S.destination);a.start(0)};a.GL=function(a,
b,c){S?S.decodeAudioData(a,b,c):c()};a.TQ=function(a){w(a);a.Y=null;D.splice(D.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<D.length;a++){var b=D[a].Y;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():(b.Wb&&b.Wb.disconnect(),b.pd&&b.pd.disconnect())}G&&G.Dc&&(a=G.Dc,a.vh[0]=0,a.vh[1]=0,a.vh[2]=0,a.fl[0]=0,a.fl[1]=0,a.fl[2]=0);G=null;D.splice(0);V=null};a.update=function(a){if(S&&D.length){for(var b=0;b<D.length;b++){var c=D[b],d=c.Y,f=d.Wb,h=S.currentTime;!d.loop&&20==d.state&&d.duration&&
d.Ge+d.duration<h&&("BACKGROUND_MUSIC"==d.behavior||f&&!C.Lf(f.onended))&&(d.state=50);d.cyclic&&50==d.state&&g(c);20==d.state&&3>d.Hq-h&&e(d)}V&&V.Di.length&&(-1==V.active||a>V.$z+V.BB[V.active])&&(b=V,-1<b.active&&w(b.Di[b.active]),c=-1==b.active&&b.random?Math.round(Math.random()*(b.Di.length-1)):b.random?(b.active+(1+Math.round(Math.random()*(b.Di.length-2))))%b.Di.length:(b.active+1)%b.Di.length,g(b.Di[c]),b.active=c,b.$z=a)}};a.play=c;a.play_def=g;a.stop=w;a.is_playing=function(a){return 20==
a.Y.state};a.SQ=h;a.UQ=B;a.loop_stop=function(a,b){var c=a.Y,d=c.pd;if(f(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&d){var e=S.currentTime+b;c.Wb.stop(e);d.start(e,c.Ss)}};a.playrate=function(a,b){var c=a.Y;c.pitch=b;!f(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.Wb.playbackRate.value=b,c.pd&&(c.pd.playbackRate.value=b),x(c),e(c))};a.get_playrate=function(a){return a.Y.pitch};a.cyclic=function(a,b){a.Y.cyclic=!!b};a.KN=function(a){return a.Y.autoplay};a.is_cyclic=
function(a){return a.Y.cyclic};a.qO=function(a,b,c,d,e){if(a=a.Dc){var g=H;g[0]=0;g[1]=0;g[2]=-1;v.transformQuat(g,c,g);p[0]=0;p[1]=1;p[2]=0;v.transformQuat(p,c,p);c=S.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(g[0],g[1],g[2],p[0],p[1],p[2]);if(d&&a.ak!=e){if(a.listener_stride)a.listener_stride=!1,v.copy(b,a.vh);else for(c=a.fl,c[0]=(b[0]-a.vh[0])/d,c[1]=(b[1]-a.vh[1])/d,c[2]=(b[2]-a.vh[2])/d,v.copy(b,a.vh),b=0;b<D.length;b++)c=D[b],g=c.Y,f(c)&&"POSITIONAL"==g.behavior&&g.Rr&&k(g,a,d);
a.ak=e}else v.copy(b,a.vh)}};a.listener_stride=function(){var a=G.Dc;a&&(a.listener_stride=!0)};a.VQ=function(a,b,c){var d=a.Y;if(f(a)&&"POSITIONAL"==d.behavior){var e=I.ec(a.o.v,H);a=I.Qc(a.o.v,Q);var g=d.Jx;g.setPosition(e[0],e[1],e[2]);C.quat_to_dir(a,C.AXIS_MZ,p);g.setOrientation(p[0],p[1],p[2]);d.Rr&&(a=d.Yw,b&&d.ak!=c?(d.Gi?(v.copy(e,a),d.Gi=!1):(g=d.ou,g[0]=(e[0]-a[0])/b,g[1]=(e[1]-a[1])/b,g[2]=(e[2]-a[2])/b,v.copy(e,a),k(d,G.Dc,b)),d.ak=c):v.copy(e,a))}};a.speaker_stride=function(a){var b=
a.Y;f(a)&&"POSITIONAL"==b.behavior&&b.Rr&&(b.Gi=!0)};a.zw=function(a){return a.Y.behavior};a.check_active_speakers=function(){for(var a=0;a<D.length;a++)if(f(D[a]))return!0;return!1};a.sQ=function(a){var b=G.Dc;b&&(b.volume=a,S&&(b.wm.gain.value=F(b)))};a.oN=function(){var a=G.Dc;return a?a.volume:0};a.set_volume=function(a,b){var c=a.Y;c.volume=b;f(a)&&(c.wm.gain.value=F(c))};a.get_volume=function(a){return a.Y.volume};a.mute=function(a,b){a.Y.muted=!!b;f(a)&&(a.Y.wm.gain.value=F(a.Y))};a.is_muted=
function(a){return a.Y.muted};a.OO=function(a){var b=G.Dc;b&&(b.muted=!!a,S&&(b.wm.gain.value=F(b)))};a.SN=function(){var a=G.Dc;return a?a.muted:!1};a.get_speaker_objects=function(){return D};a.pause=function(){for(var a=0;a<D.length;a++)h(D[a])};a.resume=function(){for(var a=0;a<D.length;a++)B(D[a])};a.set_compressor_params=function(a,b){if(a.Dc&&a.Dc.Jo){var c=a.Dc.Jo;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=
function(a){if(!a.Dc||!a.Dc.Jo)return null;a=a.Dc.Jo;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(f(a)){a=a.Y;var d=a.ij,e=S.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.Mk=c}};a.unduck=function(a){if(f(a)){a=a.Y;var b=a.ij,c=S.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Mk);a.Mk=0}};a.QL=function(a,b){if(S){var c=
G.Dc,d=c.ij,e=S.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,e+b);c.Mk=b}};a.vR=function(){if(S){var a=G.Dc,b=a.ij,c=S.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Mk);a.Mk=0}};a.apply_playlist=function(a,b,c){V={active:-1,$z:0,random:c,Di:[],BB:[]};for(c=0;c<a.length;c++){var d=a[c],e=t(d);0==e?E.warn("Ignoring speaker with zero duration: "+d.name):(w(d),d.Y.cyclic=!1,V.Di.push(d),V.BB.push(e+b))}};a.get_duration=t;a.clear_playlist=
function(){if(V)for(var a=V.Di,b=0;b<a.length;b++)w(a[b]);V=null};a.get_positional_params=function(a){return(a=a.Y)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.Y;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.Jx;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=
a.Y;c&&c.yg&&(c.yg.frequency.value=b.freq,c.yg.Q.value=b.Q,c.yg.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.Y)&&a.yg?{freq:a.yg.frequency.value,Q:a.yg.Q.value,gain:a.yg.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.Y;if(!a||!a.yg)return null;a.yg.getFrequencyResponse(b,c,d)};a.reset=function(){y.length=0;Z.length=0;S=null}};b4w.module.__input=function(a,r){function d(a){var b=X.detect_mobile();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b&&D())&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function c(a,b){if(!d(a))return null;var c={type:a,lf:!1,Tf:[],Hg:[],si:[],Ad:[],ti:[],ui:[],vp:[],QC:[],ni:[],Mi:[],Li:[],Ki:[],element:b,Ch:!0,Ob:[],dt:new Float32Array(2),MO:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Xp:null,Pl:null,Nh:null,Uc:null,orientation:Y.create(),
position:U.create(),lh:window.VRFrameData?new VRFrameData:null,fi:new Float32Array(4),gi:new Float32Array(4),Kf:0,Yg:0,Zp:0,hk:0,rh:0,Zg:0,Rk:[],kj:[0,0,0,0,0,0,0,0,0,0,0,0],OB:[0,0,0,0,0,0,0,0,0,0,0,0],cs:[]};c.fi[0]=c.fi[1]=c.fi[2]=c.fi[3]=Math.PI/4;c.gi[0]=c.gi[1]=c.gi[2]=c.gi[3]=Math.PI/4;30==a||40==a||50==a?(c.lf=!!b,50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.Ch=!1)):10==a?c.lf=!0:20==a&&g(c);return c}function b(b,d){10==b||20==b?d=window:d||(40==b?d=document:d=V.get_container());
for(var e=0;e<va.length;e++)if(va[e].type==b&&va[e].element==d)return va[e];e=c(b,d);60!=b&&70!=b&&80!=b&&90!=b||e.cs.push(a.GMPD_BUTTON_0,a.GMPD_BUTTON_1,a.GMPD_BUTTON_2,a.GMPD_BUTTON_3,a.GMPD_BUTTON_4,a.GMPD_BUTTON_5,a.GMPD_BUTTON_6,a.GMPD_BUTTON_7,a.GMPD_BUTTON_8,a.GMPD_BUTTON_9,a.GMPD_BUTTON_10,a.GMPD_BUTTON_11,a.GMPD_BUTTON_12,a.GMPD_BUTTON_13,a.GMPD_BUTTON_14,a.GMPD_BUTTON_15,a.GMPD_BUTTON_16,a.GMPD_BUTTON_17,a.GMPD_BUTTON_18,a.GMPD_BUTTON_19,a.GMPD_BUTTON_20,a.GMPD_BUTTON_21,a.GMPD_BUTTON_22,
a.GMPD_BUTTON_23,a.GMPD_BUTTON_24,a.GMPD_BUTTON_25,a.GMPD_AXIS_0,a.GMPD_AXIS_1,a.GMPD_AXIS_2,a.GMPD_AXIS_3,a.GMPD_AXIS_4,a.GMPD_AXIS_5,a.GMPD_AXIS_6,a.GMPD_AXIS_7,a.GMPD_AXIS_8,a.GMPD_AXIS_9,a.GMPD_AXIS_10,a.GMPD_AXIS_11);e&&va.push(e);return e}function g(a){20==a.type&&(navigator.getVRDisplays?navigator.getVRDisplays().then(function(b){0<b.length&&(a.Uc=b[0],a.lf=!0,a.Uc.getFrameData(a.lh),a.Xp&&a.Xp())},function(){pa.ja("WebVR displays are not found.");a.lf=!1}):navigator.getVRDevices?(navigator.getVRDevices().then(function(b){u(a,
b);b.length&&(a.lf=!0);a.Xp&&a.Xp()},function(){pa.ja("WebVR devices are not found.");a.lf=!1}),x(a,M.webvr)):(n(a),a.lf=!0))}function n(a){var b=M.nonwebvr;a.hk=b.hk;a.rh=b.rh;a.Zg=b.Zg;x(a,b);a.Kf=b.Kf;a.Yg=b.Yg;a.Zp=b.Zp;e(a)}function x(a,b){a.distortion_coefs[0]=b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];
a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function e(a){var b=Math.atan(a.Kf/2/a.Zp*M.nonwebvr.AB);b&&(a.fi[0]=a.gi[0]=Math.min(b,Math.PI/3));b&&(a.fi[1]=a.gi[3]=Math.min(b,Math.PI/3));b&&(a.fi[2]=a.gi[2]=Math.min(b,Math.PI/3));b&&(a.fi[3]=a.gi[1]=Math.min(b,Math.PI/3))}function u(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==
d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.Pl=d;a.Nh=c}function w(a,b,c){switch(a.type){case 20:if(m(a,0)&1)b="left"==b?a.fi:a.gi,ga.copy(b,c);else{if(a=a.Uc||a.Pl)var d=a.getEyeParameters(b);b=d.fieldOfView||d.currentFieldOfView;c[0]=ha.deg_to_rad(b.upDegrees);c[1]=ha.deg_to_rad(b.rightDegrees);c[2]=ha.deg_to_rad(b.downDegrees);c[3]=ha.deg_to_rad(b.leftDegrees)}break;default:pa.error("fov is undefined for device: ",a.type)}return c}function h(a,b,c){switch(a.type){case 20:a.Uc&&("left"==
b?ba.copy(a.lh.leftProjectionMatrix,c):"right"==b?ba.copy(a.lh.rightProjectionMatrix,c):pa.error("Unknown type of eye: ",b));break;default:pa.error("Projection matrix is undefined for device: ",a.type)}return c}function m(a,b){switch(b){case 0:var c=0;navigator.getVRDisplays&&(c|=8,a.lh&&(c|=16));navigator.getVRDevices&&(c=ca.is_mobile_device?c|4:c|2);return c||1;case 23:var d=a.Uc||a.Pl;return d?(c=d.getEyeParameters("left"),d=d.getEyeParameters("right"),a.Uc?a.lh?a.Kf:d.offset[0]-c.offset[0]:d.eyeTranslation.x-
c.eyeTranslation.x):a.Kf}}function B(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.Rk[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.kj[c]=a.axes[c]}}function k(a){for(var b=0;b<a.Rk;b++)a.Rk[b]=0;for(b=0;b<a.kj.length;b++)a.OB[b]=a.kj[b],a.kj[b]=0}function f(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function F(a){return null===a}function t(a,b,c,d){switch(b){case 130:c&&f(a.Tf,c);if(d||a.Hg.every(F)&&a.Tf.every(F))a.Tf.length=0,a.Hg.length=0,b=a.Ob.indexOf(141),0<=b&&(a.Ob.splice(b,
1),a.element.removeEventListener("deviceorientation",E,!1));break;case 140:c&&f(a.Hg,c);if(d||a.Hg.every(F)&&a.Tf.every(F))a.Tf.length=0,a.Hg.length=0,b=a.Ob.indexOf(141),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("deviceorientation",E,!1));break;case 50:c&&f(a.si,c);if(d||a.si.every(F))a.si.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("mousedown",C,!1));break;case 40:c&&f(a.Ad,c);if(d||a.Ad.every(F))a.Ad.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,
1),a.element.removeEventListener("mousemove",A,!1));break;case 41:c&&f(a.Ad,c);if(d||a.Ad.every(F))a.Ad.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("mousemove",I,!1));break;case 60:c&&f(a.ti,c);if(d||a.ti.every(F))a.ti.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("mouseout",v,!1),a.element.removeEventListener("mouseup",l,!1));break;case 70:c&&f(a.ui,c);if(d||a.ui.every(F))a.ui.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,
1),a.element.removeEventListener("wheel",z,!1));break;case 90:c&&f(a.vp,c);if(d||a.vp.every(F))a.vp.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("keydown",H,!1));break;case 80:c&&f(a.ni,c);if(d||a.ni.every(F))a.ni.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("keyup",p,!1));break;case 100:c&&f(a.Mi,c);if(d||a.Mi.every(F))a.Mi.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("touchstart",Q,!1));break;
case 110:c&&f(a.Li,c);if(d||a.Li.every(F))a.Li.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("touchmove",y,!1));break;case 120:if(c&&f(a.Ki,c),d||a.Ki.every(F))a.Ki.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("touchend",Z,!1))}}function q(a,b){ha.ordered_angles_to_quat(a,ha.ZXY,b);if("orientation"in window)var c=ha.deg_to_rad(window.orientation);else"orientation"in window.screen?c=ha.deg_to_rad(window.screen.orientation.angle):
c=0;c=Y.setAxisAngle(ha.AXIS_MZ,c,aa);Y.multiply(b,c,b);return b}function E(a){var c=P;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=ha.deg_to_rad(a.alpha),c[1]=ha.deg_to_rad(a.beta),c[2]=ha.deg_to_rad(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.Hg.length;d++){var e=a.Hg[d];e&&(U.copy(c,W),e(W))}if(a.Tf.length)for(c=q(c,la),d=0;d<a.Tf.length;d++)if(e=a.Tf[d])Y.copy(c,ka),e(ka);for(d=0;d<a.Tf.length;d++)a.Tf[d]||a.Tf.splice(d,1);for(d=0;d<a.Hg.length;d++)a.Hg[d]||a.Hg.splice(d,
1)}function J(a,b){switch(a.type){case 30:a.dt[0]=b.clientX,a.dt[1]=b.clientY,a.MO=b.which}}function A(a){if(!da||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);J(c,a);for(var d=0;d<c.Ad.length;d++){var e=c.Ad[d];e&&(ma[0]=a.clientX,ma[1]=a.clientY,e(ma))}c.Ch&&a.preventDefault();for(d=0;d<c.Ad.length;d++)c.Ad[d]||c.Ad.splice(d,1)}}function I(a){if(!da||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=
b(30,a.currentTarget);J(c,a);for(var d=0;d<c.Ad.length;d++){var e=c.Ad[d];if(e){if("number"==typeof a.movementX)var f=a.movementX,g=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,g=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,g=a.mozMovementY):g=f=0;ma[0]=f;ma[1]=g;e(ma)}}c.Ch&&a.preventDefault();for(d=0;d<c.Ad.length;d++)c.Ad[d]||c.Ad.splice(d,1)}}function C(a){if(!da||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=
b(30,a.currentTarget);J(c,a);for(var d=0;d<c.si.length;d++){var e=c.si[d];e&&e(a.which)}c.Ch&&a.preventDefault();for(d=0;d<c.si.length;d++)c.si[d]||c.si.splice(d,1)}}function v(a){!V.FC(a.relatedTarget)&&a.which&&l(a)}function l(a){if(!da||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);J(c,a);for(var d=0;d<c.ti.length;d++){var e=c.ti[d];e&&e(a.which)}c.Ch&&a.preventDefault();for(d=0;d<c.ti.length;d++)c.ti[d]||c.ti.splice(d,1)}}function z(a){for(var c=
b(30,a.currentTarget),d=0;d<c.ui.length;d++){var e=c.ui[d];e&&e(-a.deltaY)}c.Ch&&a.preventDefault();for(d=0;d<c.ui.length;d++)c.ui[d]||c.ui.splice(d,1)}function H(a){for(var c=b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.QC:c.vp,e=0;e<d.length;e++){var f=d[e];f?f(a.keyCode):d.splice(e--,1)}c.Ch&&a.preventDefault()}function p(a){for(var c=b(40,a.currentTarget),d=0;d<c.ni.length;d++){var e=c.ni[d];e&&e(a.keyCode)}c.Ch&&a.preventDefault();for(d=0;d<c.ni.length;d++)c.ni[d]||c.ni.splice(d,
1)}function Q(a){for(var c=b(50,a.currentTarget),d=0;d<c.Mi.length;d++){var e=c.Mi[d];e&&e(a.targetTouches)}for(d=0;d<c.Mi.length;d++)c.Mi[d]||c.Mi.splice(d,1)}function y(a){for(var c=b(50,a.currentTarget),d=0;d<c.Li.length;d++){var e=c.Li[d];e&&e(a.targetTouches)}c.Ch&&a.preventDefault();for(d=0;d<c.Li.length;d++)c.Li[d]||c.Li.splice(d,1)}function Z(a){for(var c=b(50,a.currentTarget),d=0;d<c.Ki.length;d++){var e=c.Ki[d];e&&e(a.targetTouches)}for(d=0;d<c.Ki.length;d++)c.Ki[d]||c.Ki.splice(d,1)}function S(a){switch(a){case 0:a=
60;break;case 1:a=70;break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function G(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var d=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof d&&d.apply(c)}function D(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1}var X=r("__compat"),V=r("__container"),L=r("__config"),ba=r("__mat4"),pa=r("__print"),Y=r("__quat"),ha=r("__util"),U=r("__vec3"),ga=r("__vec4"),ca=L.H,
M=L.wC;a.DEVICE_GYRO=10;a.DEVICE_HMD=20;a.DEVICE_MOUSE=30;a.DEVICE_KEYBOARD=40;a.DEVICE_TOUCH=50;a.Mq=60;a.Iu=70;a.Ju=80;a.Ku=90;a.HMD_WEBVR_DESKTOP=2;a.HMD_WEBVR_MOBILE=4;a.HMD_NON_WEBVR=1;a.HMD_WEBVR1=8;a.HMD_WEBVR1_1=16;a.HMD_WEBVR_TYPE=0;a.HMD_ORIENTATION_QUAT=10;a.HMD_POSITION=20;a.xz=21;a.yz=22;a.HMD_EYE_DISTANCE=23;a.HMD_DISTORTION=24;a.HMD_BASELINE_DIST=25;a.HMD_SCREEN_LENSE_DIST=26;a.HMD_SCREEN_WIDTH=27;a.HMD_SCREEN_HEIGHT=28;a.HMD_BEVEL_SIZE=29;a.TS=30;a.US=31;a.MOUSE_LOCATION=40;a.Gz=41;
a.MOUSE_DOWN_WHICH=50;a.MOUSE_UP_WHICH=60;a.MOUSE_WHEEL=70;a.KEYBOARD_UP=80;a.KEYBOARD_DOWN=90;a.Fz=91;a.TOUCH_START=100;a.TOUCH_MOVE=110;a.TOUCH_END=120;a.GYRO_ORIENTATION_QUAT=130;a.GYRO_ORIENTATION_ANGLES=140;a.GMPD_BUTTON_0=300;a.GMPD_BUTTON_1=301;a.GMPD_BUTTON_2=302;a.GMPD_BUTTON_3=303;a.GMPD_BUTTON_4=304;a.GMPD_BUTTON_5=305;a.GMPD_BUTTON_6=306;a.GMPD_BUTTON_7=307;a.GMPD_BUTTON_8=308;a.GMPD_BUTTON_9=309;a.GMPD_BUTTON_10=310;a.GMPD_BUTTON_11=311;a.GMPD_BUTTON_12=312;a.GMPD_BUTTON_13=313;a.GMPD_BUTTON_14=
314;a.GMPD_BUTTON_15=315;a.GMPD_BUTTON_16=316;a.GMPD_BUTTON_17=317;a.GMPD_BUTTON_18=318;a.GMPD_BUTTON_19=319;a.GMPD_BUTTON_20=320;a.GMPD_BUTTON_21=321;a.GMPD_BUTTON_22=322;a.GMPD_BUTTON_23=323;a.GMPD_BUTTON_24=324;a.GMPD_BUTTON_25=325;a.GMPD_AXIS_0=326;a.GMPD_AXIS_1=327;a.GMPD_AXIS_2=328;a.GMPD_AXIS_3=329;a.GMPD_AXIS_4=330;a.GMPD_AXIS_5=331;a.GMPD_AXIS_6=332;a.GMPD_AXIS_7=333;a.GMPD_AXIS_8=334;a.GMPD_AXIS_9=335;a.GMPD_AXIS_10=336;a.GMPD_AXIS_11=337;var la=Y.create(),aa=Y.create();ba.create();var P=
U.create(),ma=new Float32Array(2),W=U.create(),ka=Y.create(),da="ontouchstart"in document.documentElement,va=[];a.can_use_device=d;a.init=function(){if("HMD"==ca.stereo||"NONE"==ca.stereo&&ca.is_mobile_device){var a=b(20);a&&document.addEventListener("onvrdisplayconnect",function(b){a.Uc=b.display;a.lf=!0;a.Uc.getFrameData(a.lh)})}};a.get_device_by_type_element=b;a.JP=g;a.switch_prevent_default=function(a,b){a.Ch=b};a.reset_device=function(a){switch(a.type){case 20:if(a.lf)if(a.Uc)a.Uc.resetPose();
else if(a.Nh)for(var b=0;b<a.Nh.length;b++)a.Nh[b].resetSensor();break;default:pa.error("reset_device() is undefined for device: ",a.type)}};a.get_vector_param=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:U.copy(ha.Wl,c);if(a.Uc)c[0]=a.orientation[0],c[1]=a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.Nh)for(b=0;b<a.Nh.length;b++){var d=a.Nh[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,
c[2]=d.orientation.z,c[3]=d.orientation.w)}Y.normalize(c,c);a=Y.setAxisAngle(ha.AXIS_X,Math.PI/2,aa);Y.multiply(a,c,c);break a;default:pa.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:U.copy(ha.Tu,c);if(a.Uc)c[0]=a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.Nh)for(b=0;b<a.Nh.length;b++)d=a.Nh[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=-d.position.z,c[2]=d.position.y);
break a;default:pa.error("position is undefined for device: ",a.type)}return c;case 21:return w(a,"left",c);case 22:return w(a,"right",c);case 30:return h(a,"left",c);case 31:return h(a,"right",c);case 40:case 41:return c[0]=a.dt[0],c[1]=a.dt[1],c}};a.get_value_param=m;a.set_config=function(a,b,c){switch(a.type){case 20:if(m(a,0)&8)break;switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.Kf=c;e(a);break;case 25:a.Yg=c;e(a);break;case 26:a.Zp=c;e(a);break;case 27:a.hk=
c;e(a);break;case 28:a.rh=c;e(a);break;case 29:a.Zg=c,e(a)}break;case 60:case 70:case 80:case 90:a.cs[b]=c}};a.jN=function(a,b){var c=b-300;return c<a.Rk.length?a.Rk[a.cs[c]-300]:!1};a.iN=function(a,b){return b-326<a.kj.length?a.kj[a.cs[b-300]-326]:0};a.update=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<va.length;b++){var c=va[b];switch(c.type){case 60:k(c);B(a[0],c);break;case 70:k(c);B(a[1],c);break;case 80:k(c);
B(a[2],c);break;case 90:k(c);B(a[3],c);break;case 20:if(c.Uc){var d=c.Uc,e=d.capabilities;if(c.lh&&d.getFrameData(c.lh)){var d=c.lh.pose,f=ha.ix(c.lh.leftViewMatrix,P);c.Kf=2*U.length(f)}else d=d.getPose();d&&(e.hasOrientation&&d.orientation&&(c.orientation[0]=d.orientation[0],c.orientation[1]=d.orientation[1],c.orientation[2]=d.orientation[2],c.orientation[3]=d.orientation[3]),e.hasPosition&&d.position&&(c.position[0]=d.position[0],c.position[1]=-d.position[2],c.position[2]=d.position[1]))}}}};a.attach_param_cb=
function(a,b,c){switch(b){case 130:a.Tf.push(c);b=141;break;case 140:a.Hg.push(c);b=141;break;case 50:a.si.push(c);break;case 40:case 41:a.Ad.push(c);break;case 60:a.ti.push(c);break;case 70:a.ui.push(c);break;case 90:a.vp.push(c);break;case 91:a.QC.push(c);b=90;break;case 80:a.ni.push(c);break;case 100:a.Mi.push(c);break;case 110:a.Li.push(c);break;case 120:a.Ki.push(c)}if(-1==a.Ob.indexOf(b)&&(a.Ob.push(b),a.lf))switch(b){case 50:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",
C,!1);break;case 40:a.element.addEventListener("mousemove",A,!1);break;case 41:a.element.addEventListener("mousemove",I,!1);break;case 60:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",v,!1),a.element.addEventListener("mouseup",l,!1));break;case 70:a.element.addEventListener("wheel",z,!1);break;case 90:a.element.addEventListener("keydown",H,!1);break;case 80:a.element.addEventListener("keyup",p,!1);break;case 100:a.element.addEventListener("touchstart",
Q,!1);break;case 110:a.element.addEventListener("touchmove",y,!1);break;case 120:a.element.addEventListener("touchend",Z,!1);break;case 141:a.element.addEventListener("deviceorientation",E,!1)}};a.detach_param_cb=function(a,b,c){t(a,b,c,!1)};a.AN=q;a.cleanup=function(){for(var a=0;a<va.length;a++)for(var b=va[a],c=0;c<b.Ob.length;c++)t(b,b.Ob[c],null,!0);va.length=0};a.get_pressed_gmpd_btn=function(a){a=b(S(a));for(var c=0;c<a.Rk.length;c++)if(a.Rk[c])return c+300;return-1};a.get_moved_gmpd_axis=
function(a){a=b(S(a));for(var c=0;c<a.kj.length;c++)if(a.OB[c]-a.kj[c])return c+326;return-1};a.dC=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.xN=function(){var a=b(20);return a&&a.Uc};a.xI=function(a){a.element.addEventListener("mousedown",function(){a.value||G(a)},!1)};a.add_click_listener=function(a,b){ca.is_mobile_device?a.addEventListener("touchend",b):a.addEventListener("mouseup",
b)};a.remove_click_listener=function(a,b){ca.is_mobile_device?a.removeEventListener("touchend",b):a.removeEventListener("mouseup",b)};a.check_fullscreen=D};b4w.module.__vec3=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array,d=Math.random;a.create=function(){var a=new r(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new r(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,d){var c=new r(3);c[0]=a;c[1]=b;c[2]=d;return c};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,d,n){n[0]=a;n[1]=b;n[2]=d;return n};a.add=function(a,b,d){d[0]=a[0]+b[0];d[1]=a[1]+b[1];d[2]=a[2]+b[2];
return d};a.subtract=function(a,b,d){d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=a[2]-b[2];return d};a.sub=a.subtract;a.multiply=function(a,b,d){d[0]=a[0]*b[0];d[1]=a[1]*b[1];d[2]=a[2]*b[2];return d};a.mul=a.multiply;a.divide=function(a,b,d){d[0]=a[0]/b[0];d[1]=a[1]/b[1];d[2]=a[2]/b[2];return d};a.div=a.divide;a.min=function(a,b,d){d[0]=Math.min(a[0],b[0]);d[1]=Math.min(a[1],b[1]);d[2]=Math.min(a[2],b[2]);return d};a.max=function(a,b,d){d[0]=Math.max(a[0],b[0]);d[1]=Math.max(a[1],b[1]);d[2]=Math.max(a[2],
b[2]);return d};a.scale=function(a,b,d){d[0]=a[0]*b;d[1]=a[1]*b;d[2]=a[2]*b;return d};a.scaleAndAdd=function(a,b,d,n){n[0]=a[0]+b[0]*d;n[1]=a[1]+b[1]*d;n[2]=a[2]+b[2]*d;return n};a.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],x=b[2]-a[2];return Math.sqrt(c*c+d*d+x*x)};a.dist=a.distance;a.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],x=b[2]-a[2];return c*c+d*d+x*x};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var c=a[0],d=a[1],x=a[2],c=c*c+d*d+x*x;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,d){var c=a[0],g=a[1];a=a[2];var e=b[0],u=b[1];b=b[2];
d[0]=g*b-a*u;d[1]=a*e-c*b;d[2]=c*u-g*e;return d};a.lerp=function(a,b,d,n){var c=a[0],e=a[1];a=a[2];n[0]=c+d*(b[0]-c);n[1]=e+d*(b[1]-e);n[2]=a+d*(b[2]-a);return n};a.pU=function(a,b,d,n,x,e){var c=x*x,g=c*(2*x-3)+1,h=c*(x-2)+x,m=c*(x-1);x=c*(3-2*x);e[0]=a[0]*g+b[0]*h+d[0]*m+n[0]*x;e[1]=a[1]*g+b[1]*h+d[1]*m+n[1]*x;e[2]=a[2]*g+b[2]*h+d[2]*m+n[2]*x;return e};a.tA=function(a,b,d,n,x,e){var c=1-x,g=c*c,h=x*x,m=g*c,g=3*x*g,c=3*h*c;x=h*x;e[0]=a[0]*m+b[0]*g+d[0]*c+n[0]*x;e[1]=a[1]*m+b[1]*g+d[1]*c+n[1]*x;e[2]=
a[2]*m+b[2]*g+d[2]*c+n[2]*x;return e};a.random=function(a,b){a=a||1;var c=2*d()*Math.PI,n=2*d()-1,x=Math.sqrt(1-n*n)*a;b[0]=Math.cos(c)*x;b[1]=Math.sin(c)*x;b[2]=n*a;return b};a.transformMat4=function(a,b,d){var c=a[0],g=a[1];a=a[2];var e=b[3]*c+b[7]*g+b[11]*a+b[15],e=e||1;d[0]=(b[0]*c+b[4]*g+b[8]*a+b[12])/e;d[1]=(b[1]*c+b[5]*g+b[9]*a+b[13])/e;d[2]=(b[2]*c+b[6]*g+b[10]*a+b[14])/e;return d};a.transformMat3=function(a,b,d){var c=a[0],g=a[1];a=a[2];d[0]=c*b[0]+g*b[3]+a*b[6];d[1]=c*b[1]+g*b[4]+a*b[7];
d[2]=c*b[2]+g*b[5]+a*b[8];return d};a.transformQuat=function(a,b,d){var c=a[0],g=a[1],e=a[2];a=b[0];var u=b[1],w=b[2];b=b[3];var h=b*c+u*e-w*g,m=b*g+w*c-a*e,r=b*e+a*g-u*c,c=-a*c-u*g-w*e;d[0]=h*b+c*-a+m*-w-r*-u;d[1]=m*b+c*-u+r*-a-h*-w;d[2]=r*b+c*-w+h*-u-m*-a;return d};a.rotateX=function(a,b,d,n){var c=[],e=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];e[0]=c[0];e[1]=c[1]*Math.cos(d)-c[2]*Math.sin(d);e[2]=c[1]*Math.sin(d)+c[2]*Math.cos(d);n[0]=e[0]+b[0];n[1]=e[1]+b[1];n[2]=e[2]+b[2];return n};a.rotateY=
function(a,b,d,n){var c=[],e=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];e[0]=c[2]*Math.sin(d)+c[0]*Math.cos(d);e[1]=c[1];e[2]=c[2]*Math.cos(d)-c[0]*Math.sin(d);n[0]=e[0]+b[0];n[1]=e[1]+b[1];n[2]=e[2]+b[2];return n};a.rotateZ=function(a,b,d,n){var c=[],e=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];e[0]=c[0]*Math.cos(d)-c[1]*Math.sin(d);e[1]=c[0]*Math.sin(d)+c[1]*Math.cos(d);e[2]=c[2];n[0]=e[0]+b[0];n[1]=e[1]+b[1];n[2]=e[2]+b[2];return n};a.forEach=function(){var c=a.create();return function(a,
d,n,x,e,u){var b;d||(d=3);n||(n=0);for(x?b=Math.min(x*d+n,a.length):b=a.length;n<b;n+=d)c[0]=a[n],c[1]=a[n+1],c[2]=a[n+2],e(c,u,c),a[n]=c[0],a[n+1]=c[1],a[n+2]=c[2];return a}}();a.angle=function(c,b){var d=a.fromValues(c[0],c[1],c[2]),n=a.fromValues(b[0],b[1],b[2]);a.normalize(d,d);a.normalize(n,n);d=a.dot(d,n);return 1<d?0:Math.acos(d)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array,d=Math.random;a.create=function(){var a=new r(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new r(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,d,n){var c=new r(4);c[0]=a;c[1]=b;c[2]=d;c[3]=n;return c};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,d,n,x){x[0]=a;x[1]=b;x[2]=d;x[3]=n;return x};a.add=function(a,b,d){d[0]=
a[0]+b[0];d[1]=a[1]+b[1];d[2]=a[2]+b[2];d[3]=a[3]+b[3];return d};a.subtract=function(a,b,d){d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=a[2]-b[2];d[3]=a[3]-b[3];return d};a.sub=a.subtract;a.multiply=function(a,b,d){d[0]=a[0]*b[0];d[1]=a[1]*b[1];d[2]=a[2]*b[2];d[3]=a[3]*b[3];return d};a.mul=a.multiply;a.divide=function(a,b,d){d[0]=a[0]/b[0];d[1]=a[1]/b[1];d[2]=a[2]/b[2];d[3]=a[3]/b[3];return d};a.div=a.divide;a.min=function(a,b,d){d[0]=Math.min(a[0],b[0]);d[1]=Math.min(a[1],b[1]);d[2]=Math.min(a[2],b[2]);d[3]=
Math.min(a[3],b[3]);return d};a.max=function(a,b,d){d[0]=Math.max(a[0],b[0]);d[1]=Math.max(a[1],b[1]);d[2]=Math.max(a[2],b[2]);d[3]=Math.max(a[3],b[3]);return d};a.scale=function(a,b,d){d[0]=a[0]*b;d[1]=a[1]*b;d[2]=a[2]*b;d[3]=a[3]*b;return d};a.scaleAndAdd=function(a,b,d,n){n[0]=a[0]+b[0]*d;n[1]=a[1]+b[1]*d;n[2]=a[2]+b[2]*d;n[3]=a[3]+b[3]*d;return n};a.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],x=b[2]-a[2],e=b[3]-a[3];return Math.sqrt(c*c+d*d+x*x+e*e)};a.dist=a.distance;a.squaredDistance=
function(a,b){var c=b[0]-a[0],d=b[1]-a[1],x=b[2]-a[2],e=b[3]-a[3];return c*c+d*d+x*x+e*e};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var c=a[0],d=a[1],x=a[2],e=a[3],u=c*c+d*d+x*x+e*e;0<u&&(u=1/Math.sqrt(u),b[0]=c*u,b[1]=d*u,b[2]=x*u,b[3]=e*u);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,d,n){var c=a[0],e=a[1],g=a[2];a=a[3];n[0]=c+d*(b[0]-c);n[1]=e+d*(b[1]-e);n[2]=g+d*(b[2]-g);n[3]=a+d*(b[3]-a);return n};a.random=function(c,b){c=c||1;b[0]=d();b[1]=d();b[2]=d();b[3]=d();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,d){var c=a[0],g=a[1],e=
a[2];a=a[3];d[0]=b[0]*c+b[4]*g+b[8]*e+b[12]*a;d[1]=b[1]*c+b[5]*g+b[9]*e+b[13]*a;d[2]=b[2]*c+b[6]*g+b[10]*e+b[14]*a;d[3]=b[3]*c+b[7]*g+b[11]*e+b[15]*a;return d};a.transformQuat=function(a,b,d){var c=a[0],g=a[1],e=a[2],u=b[0],w=b[1],h=b[2];b=b[3];var m=b*c+w*e-h*g,r=b*g+h*c-u*e,k=b*e+u*g-w*c,c=-u*c-w*g-h*e;d[0]=m*b+c*-u+r*-h-k*-w;d[1]=r*b+c*-w+k*-u-m*-h;d[2]=k*b+c*-h+m*-w-r*-u;d[3]=a[3];return d};a.forEach=function(){var c=a.create();return function(a,d,n,x,e,u){var b;d||(d=4);n||(n=0);for(x?b=Math.min(x*
d+n,a.length):b=a.length;n<b;n+=d)c[0]=a[n],c[1]=a[n+1],c[2]=a[n+2],c[3]=a[n+3],e(c,u,c),a[n]=c[0],a[n+1]=c[1],a[n+2]=c[2],a[n+3]=c[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,r){var d=r("__vec3"),c=r("__vec4"),b=r("__mat3"),g="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new g(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=d.create(),c=d.fromValues(1,0,0),e=d.fromValues(0,1,0);return function(g,n,h){var m=d.dot(g,n);if(-.9999999>m)return d.cross(c,g,b),1E-6>d.length(b)&&d.cross(e,g,b),d.normalize(b,b),a.setAxisAngle(b,Math.PI,h),h;if(.9999999<m)return h[0]=0,h[1]=0,h[2]=0,h[3]=1,h;d.cross(g,
n,b);h[0]=b[0];h[1]=b[1];h[2]=b[2];h[3]=1+m;return a.normalize(h,h)}}();a.setAxes=function(){var c=b.create();return function(b,d,g,n){c[0]=d[0];c[3]=d[1];c[6]=d[2];c[1]=g[0];c[4]=g[1];c[7]=g[2];c[2]=-b[0];c[5]=-b[1];c[8]=-b[2];return a.normalize(a.fromMat3(c,n),n)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var d=Math.sin(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];c[3]=Math.cos(b);
return c};a.add=c.add;a.multiply=function(a,b,c){var d=a[0],e=a[1],g=a[2];a=a[3];var m=b[0],n=b[1],k=b[2];b=b[3];c[0]=d*b+a*m+e*k-g*n;c[1]=e*b+a*n+g*m-d*k;c[2]=g*b+a*k+d*n-e*m;c[3]=a*b-d*m-e*n-g*k;return c};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,c){b*=.5;var d=a[0],e=a[1],g=a[2];a=a[3];var m=Math.sin(b);b=Math.cos(b);c[0]=d*b+a*m;c[1]=e*b+g*m;c[2]=g*b-e*m;c[3]=a*b-d*m;return c};a.rotateY=function(a,b,c){b*=.5;var d=a[0],e=a[1],g=a[2];a=a[3];var m=Math.sin(b);b=Math.cos(b);c[0]=d*
b-g*m;c[1]=e*b+a*m;c[2]=g*b+d*m;c[3]=a*b-e*m;return c};a.rotateZ=function(a,b,c){b*=.5;var d=a[0],e=a[1],g=a[2];a=a[3];var m=Math.sin(b);b=Math.cos(b);c[0]=d*b+e*m;c[1]=e*b-d*m;c[2]=g*b+a*m;c[3]=a*b-g*m;return c};a.calculateW=function(a,b){var c=a[0],d=a[1],g=a[2];b[0]=c;b[1]=d;b[2]=g;b[3]=Math.sqrt(Math.abs(1-c*c-d*d-g*g));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,c,d){var e=a[0],g=a[1],m=a[2];a=a[3];var n=b[0],k=b[1],f=b[2];b=b[3];var u,t,q;t=e*n+g*k+m*f+a*b;0>t&&(t=-t,n=-n,k=-k,
f=-f,b=-b);1E-6<1-t?(u=Math.acos(t),q=Math.sin(u),t=Math.sin((1-c)*u)/q,c=Math.sin(c*u)/q):t=1-c;d[0]=t*e+c*n;d[1]=t*g+c*k;d[2]=t*m+c*f;d[3]=t*a+c*b;return d};a.$U=function(){var b=a.create(),c=a.create();return function(d,g,n,h,m,x){a.slerp(d,h,m,b);a.slerp(g,n,m,c);a.slerp(b,c,2*m*(1-m),x);return x}}();a.invert=function(a,b){var c=a[0],d=a[1],g=a[2],h=a[3],m=c*c+d*d+g*g+h*h,m=m?1/m:0;b[0]=-c*m;b[1]=-d*m;b[2]=-g*m;b[3]=h*m;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var g=(d+1)%3,h=(d+2)%3,c=Math.sqrt(a[3*d+d]-a[3*g+g]-a[3*h+h]+1);b[d]=.5*c;c=.5/c;b[3]=(a[3*g+h]-a[3*h+g])*c;b[g]=(a[3*g+d]+a[3*d+g])*c;b[h]=(a[3*h+d]+a[3*d+h])*c}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new r(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new r(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],d=a[2],n=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=d;c[7]=n}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],d=a[1],n=a[2],x=a[3],e=a[4],u=a[5],w=a[6],h=a[7],m=a[8],r=m*e-u*h,k=-m*x+u*w,f=
h*x-e*w,F=b*r+d*k+n*f;if(!F)return null;F=1/F;c[0]=r*F;c[1]=(-m*d+n*h)*F;c[2]=(u*d-n*e)*F;c[3]=k*F;c[4]=(m*b-n*w)*F;c[5]=(-u*b+n*x)*F;c[6]=f*F;c[7]=(-h*b+d*w)*F;c[8]=(e*b-d*x)*F;return c};a.adjoint=function(a,c){var b=a[0],d=a[1],n=a[2],x=a[3],e=a[4],u=a[5],w=a[6],h=a[7],m=a[8];c[0]=e*m-u*h;c[1]=n*h-d*m;c[2]=d*u-n*e;c[3]=u*w-x*m;c[4]=b*m-n*w;c[5]=n*x-b*u;c[6]=x*h-e*w;c[7]=d*w-b*h;c[8]=b*e-d*x;return c};a.determinant=function(a){var c=a[3],b=a[4],d=a[5],n=a[6],x=a[7],e=a[8];return a[0]*(e*b-d*x)+a[1]*
(-e*c+d*n)+a[2]*(x*c-b*n)};a.multiply=function(a,c,b){var d=a[0],n=a[1],x=a[2],e=a[3],u=a[4],w=a[5],h=a[6],m=a[7];a=a[8];var r=c[0],k=c[1],f=c[2],F=c[3],t=c[4],q=c[5],E=c[6],J=c[7];c=c[8];b[0]=r*d+k*e+f*h;b[1]=r*n+k*u+f*m;b[2]=r*x+k*w+f*a;b[3]=F*d+t*e+q*h;b[4]=F*n+t*u+q*m;b[5]=F*x+t*w+q*a;b[6]=E*d+J*e+c*h;b[7]=E*n+J*u+c*m;b[8]=E*x+J*w+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var d=a[0],n=a[1],x=a[2],e=a[3],u=a[4],w=a[5],h=a[6],m=a[7];a=a[8];var r=c[0];c=c[1];b[0]=d;b[1]=n;b[2]=x;
b[3]=e;b[4]=u;b[5]=w;b[6]=r*d+c*e+h;b[7]=r*n+c*u+m;b[8]=r*x+c*w+a;return b};a.rotate=function(a,c,b){var d=a[0],n=a[1],x=a[2],e=a[3],u=a[4],w=a[5],h=a[6],m=a[7];a=a[8];var r=Math.sin(c);c=Math.cos(c);b[0]=c*d+r*e;b[1]=c*n+r*u;b[2]=c*x+r*w;b[3]=c*e-r*d;b[4]=c*u-r*n;b[5]=c*w-r*x;b[6]=h;b[7]=m;b[8]=a;return b};a.scale=function(a,c,b){var d=c[0];c=c[1];b[0]=d*a[0];b[1]=d*a[1];b[2]=d*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.AM=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.yM=function(a,c){var b=Math.sin(a),d=Math.cos(a);c[0]=d;c[1]=b;c[2]=0;c[3]=-b;c[4]=d;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.zM=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],d=a[1],n=a[2],x=a[3],e=b+b,u=d+d,w=n+n,b=b*e,h=d*e,d=d*u,m=n*e,r=
n*u,n=n*w,e=x*e,u=x*u,x=x*w;c[0]=1-d-n;c[3]=h-x;c[6]=m+u;c[1]=h+x;c[4]=1-b-n;c[7]=r-e;c[2]=m-u;c[5]=r+e;c[8]=1-b-d;return c};a.normalFromMat4=function(a,c){var b=a[0],d=a[1],n=a[2],x=a[3],e=a[4],u=a[5],w=a[6],h=a[7],m=a[8],r=a[9],k=a[10],f=a[11],F=a[12],t=a[13],q=a[14],E=a[15],J=b*u-d*e,A=b*w-n*e,I=b*h-x*e,C=d*w-n*u,v=d*h-x*u,l=n*h-x*w,z=m*t-r*F,H=m*q-k*F,m=m*E-f*F,p=r*q-k*t,r=r*E-f*t,k=k*E-f*q,f=J*k-A*r+I*p+C*m-v*H+l*z;if(!f)return null;f=1/f;c[0]=(u*k-w*r+h*p)*f;c[1]=(w*m-e*k-h*H)*f;c[2]=(e*r-u*
m+h*z)*f;c[3]=(n*r-d*k-x*p)*f;c[4]=(b*k-n*m+x*H)*f;c[5]=(d*m-b*r-x*z)*f;c[6]=(t*l-q*v+E*C)*f;c[7]=(q*I-F*l-E*A)*f;c[8]=(F*v-t*I+E*J)*f;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.xM=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new r(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new r(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],d=a[2],n=a[3],x=a[6],e=a[7],u=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=d;c[9]=x;c[11]=a[14];c[12]=n;c[13]=
e;c[14]=u}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],d=a[1],n=a[2],x=a[3],e=a[4],u=a[5],w=a[6],h=a[7],m=a[8],r=a[9],k=a[10],f=a[11],F=a[12],t=a[13],q=a[14],E=a[15],J=b*u-d*e,A=b*w-n*e,I=b*h-x*e,C=d*w-n*u,v=d*h-x*u,l=n*h-x*w,z=m*t-r*F,H=m*q-k*F,p=m*E-f*F,Q=r*q-k*t,y=r*E-f*t,Z=k*E-f*q,S=J*Z-A*y+I*Q+C*p-v*H+l*z;if(!S)return null;
S=1/S;c[0]=(u*Z-w*y+h*Q)*S;c[1]=(n*y-d*Z-x*Q)*S;c[2]=(t*l-q*v+E*C)*S;c[3]=(k*v-r*l-f*C)*S;c[4]=(w*p-e*Z-h*H)*S;c[5]=(b*Z-n*p+x*H)*S;c[6]=(q*I-F*l-E*A)*S;c[7]=(m*l-k*I+f*A)*S;c[8]=(e*y-u*p+h*z)*S;c[9]=(d*p-b*y-x*z)*S;c[10]=(F*v-t*I+E*J)*S;c[11]=(r*I-m*v-f*J)*S;c[12]=(u*H-e*Q-w*z)*S;c[13]=(b*Q-d*H+n*z)*S;c[14]=(t*A-F*C-q*J)*S;c[15]=(m*C-r*A+k*J)*S;return c};a.adjoint=function(a,c){var b=a[0],d=a[1],n=a[2],x=a[3],e=a[4],u=a[5],w=a[6],h=a[7],m=a[8],r=a[9],k=a[10],f=a[11],F=a[12],t=a[13],q=a[14],E=a[15];
c[0]=u*(k*E-f*q)-r*(w*E-h*q)+t*(w*f-h*k);c[1]=-(d*(k*E-f*q)-r*(n*E-x*q)+t*(n*f-x*k));c[2]=d*(w*E-h*q)-u*(n*E-x*q)+t*(n*h-x*w);c[3]=-(d*(w*f-h*k)-u*(n*f-x*k)+r*(n*h-x*w));c[4]=-(e*(k*E-f*q)-m*(w*E-h*q)+F*(w*f-h*k));c[5]=b*(k*E-f*q)-m*(n*E-x*q)+F*(n*f-x*k);c[6]=-(b*(w*E-h*q)-e*(n*E-x*q)+F*(n*h-x*w));c[7]=b*(w*f-h*k)-e*(n*f-x*k)+m*(n*h-x*w);c[8]=e*(r*E-f*t)-m*(u*E-h*t)+F*(u*f-h*r);c[9]=-(b*(r*E-f*t)-m*(d*E-x*t)+F*(d*f-x*r));c[10]=b*(u*E-h*t)-e*(d*E-x*t)+F*(d*h-x*u);c[11]=-(b*(u*f-h*r)-e*(d*f-x*r)+m*
(d*h-x*u));c[12]=-(e*(r*q-k*t)-m*(u*q-w*t)+F*(u*k-w*r));c[13]=b*(r*q-k*t)-m*(d*q-n*t)+F*(d*k-n*r);c[14]=-(b*(u*q-w*t)-e*(d*q-n*t)+F*(d*w-n*u));c[15]=b*(u*k-w*r)-e*(d*k-n*r)+m*(d*w-n*u);return c};a.determinant=function(a){var c=a[0],b=a[1],d=a[2],n=a[3],x=a[4],e=a[5],u=a[6],w=a[7],h=a[8],m=a[9],r=a[10],k=a[11],f=a[12],F=a[13],t=a[14];a=a[15];return(c*e-b*x)*(r*a-k*t)-(c*u-d*x)*(m*a-k*F)+(c*w-n*x)*(m*t-r*F)+(b*u-d*e)*(h*a-k*f)-(b*w-n*e)*(h*t-r*f)+(d*w-n*u)*(h*F-m*f)};a.multiply=function(a,c,b){var d=
a[0],n=a[1],x=a[2],e=a[3],u=a[4],w=a[5],h=a[6],m=a[7],r=a[8],k=a[9],f=a[10],F=a[11],t=a[12],q=a[13],E=a[14];a=a[15];var J=c[0],A=c[1],I=c[2],C=c[3];b[0]=J*d+A*u+I*r+C*t;b[1]=J*n+A*w+I*k+C*q;b[2]=J*x+A*h+I*f+C*E;b[3]=J*e+A*m+I*F+C*a;J=c[4];A=c[5];I=c[6];C=c[7];b[4]=J*d+A*u+I*r+C*t;b[5]=J*n+A*w+I*k+C*q;b[6]=J*x+A*h+I*f+C*E;b[7]=J*e+A*m+I*F+C*a;J=c[8];A=c[9];I=c[10];C=c[11];b[8]=J*d+A*u+I*r+C*t;b[9]=J*n+A*w+I*k+C*q;b[10]=J*x+A*h+I*f+C*E;b[11]=J*e+A*m+I*F+C*a;J=c[12];A=c[13];I=c[14];C=c[15];b[12]=J*d+
A*u+I*r+C*t;b[13]=J*n+A*w+I*k+C*q;b[14]=J*x+A*h+I*f+C*E;b[15]=J*e+A*m+I*F+C*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var d=c[0],n=c[1];c=c[2];var x,e,u,w,h,m,r,k,f,F,t,q;a===b?(b[12]=a[0]*d+a[4]*n+a[8]*c+a[12],b[13]=a[1]*d+a[5]*n+a[9]*c+a[13],b[14]=a[2]*d+a[6]*n+a[10]*c+a[14],b[15]=a[3]*d+a[7]*n+a[11]*c+a[15]):(x=a[0],e=a[1],u=a[2],w=a[3],h=a[4],m=a[5],r=a[6],k=a[7],f=a[8],F=a[9],t=a[10],q=a[11],b[0]=x,b[1]=e,b[2]=u,b[3]=w,b[4]=h,b[5]=m,b[6]=r,b[7]=k,b[8]=f,b[9]=F,b[10]=t,b[11]=q,
b[12]=x*d+h*n+f*c+a[12],b[13]=e*d+m*n+F*c+a[13],b[14]=u*d+r*n+t*c+a[14],b[15]=w*d+k*n+q*c+a[15]);return b};a.scale=function(a,c,b){var d=c[0],n=c[1];c=c[2];b[0]=a[0]*d;b[1]=a[1]*d;b[2]=a[2]*d;b[3]=a[3]*d;b[4]=a[4]*n;b[5]=a[5]*n;b[6]=a[6]*n;b[7]=a[7]*n;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,g){var d=b[0],x=b[1];b=b[2];var e=Math.sqrt(d*d+x*x+b*b),u,w,h,m,r,k,f,F,t,q,E,J,A,I,C,v,l,z,H,p;if(1E-7>Math.abs(e))return null;
e=1/e;d*=e;x*=e;b*=e;u=Math.sin(c);w=Math.cos(c);h=1-w;c=a[0];e=a[1];m=a[2];r=a[3];k=a[4];f=a[5];F=a[6];t=a[7];q=a[8];E=a[9];J=a[10];A=a[11];I=d*d*h+w;C=x*d*h+b*u;v=b*d*h-x*u;l=d*x*h-b*u;z=x*x*h+w;H=b*x*h+d*u;p=d*b*h+x*u;d=x*b*h-d*u;x=b*b*h+w;g[0]=c*I+k*C+q*v;g[1]=e*I+f*C+E*v;g[2]=m*I+F*C+J*v;g[3]=r*I+t*C+A*v;g[4]=c*l+k*z+q*H;g[5]=e*l+f*z+E*H;g[6]=m*l+F*z+J*H;g[7]=r*l+t*z+A*H;g[8]=c*p+k*d+q*x;g[9]=e*p+f*d+E*x;g[10]=m*p+F*d+J*x;g[11]=r*p+t*d+A*x;a!==g&&(g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]);
return g};a.rotateX=function(a,c,b){var d=Math.sin(c);c=Math.cos(c);var n=a[4],x=a[5],e=a[6],u=a[7],w=a[8],h=a[9],m=a[10],r=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=n*c+w*d;b[5]=x*c+h*d;b[6]=e*c+m*d;b[7]=u*c+r*d;b[8]=w*c-n*d;b[9]=h*c-x*d;b[10]=m*c-e*d;b[11]=r*c-u*d;return b};a.rotateY=function(a,c,b){var d=Math.sin(c);c=Math.cos(c);var n=a[0],x=a[1],e=a[2],u=a[3],w=a[8],h=a[9],m=a[10],r=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=n*c-w*d;b[1]=x*c-h*d;b[2]=e*c-m*d;b[3]=u*c-r*d;b[8]=n*d+w*c;b[9]=x*d+h*c;b[10]=e*d+m*c;b[11]=u*d+r*c;return b};a.rotateZ=function(a,c,b){var d=Math.sin(c);c=Math.cos(c);var n=a[0],x=a[1],e=a[2],u=a[3],w=a[4],h=a[5],m=a[6],r=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=n*c+w*d;b[1]=x*c+h*d;b[2]=e*c+m*d;b[3]=u*c+r*d;b[4]=w*c-n*d;b[5]=h*c-x*d;b[6]=m*c-e*d;b[7]=r*c-u*d;return b};
a.AM=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.zM=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.yM=function(a,c,b){var d=c[0],n=c[1];c=c[2];var x=Math.sqrt(d*d+n*n+c*c),e;if(1E-7>Math.abs(x))return null;x=1/x;d*=x;n*=x;c*=x;x=Math.sin(a);a=Math.cos(a);e=1-a;b[0]=d*d*e+a;b[1]=n*d*e+c*
x;b[2]=c*d*e-n*x;b[3]=0;b[4]=d*n*e-c*x;b[5]=n*n*e+a;b[6]=c*n*e+d*x;b[7]=0;b[8]=d*c*e+n*x;b[9]=n*c*e-d*x;b[10]=c*c*e+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.PT=function(a,c){var b=Math.sin(a),d=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=d;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=d;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.QT=function(a,c){var b=Math.sin(a),d=Math.cos(a);c[0]=d;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=d;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.RT=function(a,c){var b=Math.sin(a),d=Math.cos(a);c[0]=d;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=d;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var d=a[0],n=a[1],x=a[2],e=a[3],u=d+d,w=n+n,h=x+x;a=d*u;var m=d*w,d=d*h,r=n*w,n=n*h,x=x*h,u=e*u,w=e*w,e=e*h;b[0]=1-(r+x);b[1]=m+e;b[2]=d-w;b[3]=0;b[4]=m-e;b[5]=1-(a+x);b[6]=n+u;b[7]=0;b[8]=d+w;b[9]=n-u;b[10]=1-(a+r);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.NT=function(a,c,b,g){var d=a[0],x=a[1],e=a[2],u=a[3],w=d+d,h=x+x,m=e+e;a=d*w;var r=d*h,d=d*m,k=x*h,x=x*m,e=e*m,w=u*w,h=u*h,u=u*m,m=b[0],f=b[1];b=b[2];g[0]=(1-(k+e))*m;g[1]=(r+u)*m;g[2]=(d-h)*m;g[3]=0;g[4]=(r-u)*f;g[5]=(1-(a+e))*f;g[6]=(x+w)*f;g[7]=0;g[8]=(d+h)*b;g[9]=(x-w)*b;g[10]=(1-(a+k))*b;g[11]=0;g[12]=c[0];g[13]=c[1];g[14]=c[2];g[15]=1;return g};a.OT=function(a,c,b,g,n){var d=a[0],e=a[1],u=a[2],w=a[3],h=d+d,m=e+e,r=u+u;a=d*h;var k=d*m,d=d*r,f=e*m,e=e*r,u=u*r,h=w*h,m=w*m,w=
w*r,r=b[0],F=b[1];b=b[2];var t=g[0],q=g[1];g=g[2];n[0]=(1-(f+u))*r;n[1]=(k+w)*r;n[2]=(d-m)*r;n[3]=0;n[4]=(k-w)*F;n[5]=(1-(a+u))*F;n[6]=(e+h)*F;n[7]=0;n[8]=(d+m)*b;n[9]=(e-h)*b;n[10]=(1-(a+f))*b;n[11]=0;n[12]=c[0]+t-(n[0]*t+n[4]*q+n[8]*g);n[13]=c[1]+q-(n[1]*t+n[5]*q+n[9]*g);n[14]=c[2]+g-(n[2]*t+n[6]*q+n[10]*g);n[15]=1;return n};a.fromQuat=function(a,c){var b=a[0],d=a[1],n=a[2],r=a[3],e=b+b,u=d+d,w=n+n,b=b*e,h=d*e,d=d*u,m=n*e,B=n*u,n=n*w,e=r*e,u=r*u,r=r*w;c[0]=1-d-n;c[1]=h+r;c[2]=m-u;c[3]=0;c[4]=h-
r;c[5]=1-b-n;c[6]=B+e;c[7]=0;c[8]=m+u;c[9]=B-e;c[10]=1-b-d;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,g,n,r,e){var d=1/(c-a),w=1/(g-b),h=1/(n-r);e[0]=2*n*d;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=2*n*w;e[6]=0;e[7]=0;e[8]=(c+a)*d;e[9]=(g+b)*w;e[10]=(r+n)*h;e[11]=-1;e[12]=0;e[13]=0;e[14]=r*n*2*h;e[15]=0;return e};a.perspective=function(a,c,b,g,n){a=1/Math.tan(a/2);var d=1/(b-g);n[0]=a/c;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=a;n[6]=0;n[7]=0;n[8]=0;n[9]=0;n[10]=(g+b)*d;n[11]=-1;n[12]=
0;n[13]=0;n[14]=2*g*b*d;n[15]=0;return n};a.KU=function(a,c,b,g){var d=Math.tan(a.upDegrees*Math.PI/180),r=Math.tan(a.downDegrees*Math.PI/180),e=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var u=2/(e+a),w=2/(d+r);g[0]=u;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=w;g[6]=0;g[7]=0;g[8]=-((e-a)*u*.5);g[9]=(d-r)*w*.5;g[10]=b/(c-b);g[11]=-1;g[12]=0;g[13]=0;g[14]=b*c/(c-b);g[15]=0;return g};a.ortho=function(a,c,b,g,n,r,e){var d=1/(a-c),w=1/(b-g),h=1/(n-r);e[0]=-2*d;e[1]=0;e[2]=0;e[3]=
0;e[4]=0;e[5]=-2*w;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*h;e[11]=0;e[12]=(a+c)*d;e[13]=(g+b)*w;e[14]=(r+n)*h;e[15]=1;return e};a.lookAt=function(d,c,b,g){var n,r,e,u,w,h,m,B,k=d[0],f=d[1];d=d[2];e=b[0];u=b[1];r=b[2];m=c[0];b=c[1];n=c[2];if(1E-7>Math.abs(k-m)&&1E-7>Math.abs(f-b)&&1E-7>Math.abs(d-n))return a.identity(g);c=k-m;b=f-b;m=d-n;B=1/Math.sqrt(c*c+b*b+m*m);c*=B;b*=B;m*=B;n=u*m-r*b;r=r*c-e*m;e=e*b-u*c;(B=Math.sqrt(n*n+r*r+e*e))?(B=1/B,n*=B,r*=B,e*=B):e=r=n=0;u=b*e-m*r;w=m*n-c*e;h=c*r-b*n;(B=Math.sqrt(u*
u+w*w+h*h))?(B=1/B,u*=B,w*=B,h*=B):h=w=u=0;g[0]=n;g[1]=u;g[2]=c;g[3]=0;g[4]=r;g[5]=w;g[6]=b;g[7]=0;g[8]=e;g[9]=h;g[10]=m;g[11]=0;g[12]=-(n*k+r*f+e*d);g[13]=-(u*k+w*f+h*d);g[14]=-(c*k+b*f+m*d);g[15]=1;return g};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.xM=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function r(a,e){var n=a[0],w=a[1],h=a[2],m=a[3],n=c(n,w,h,m,e[0],7,-680876936),m=c(m,n,w,h,e[1],12,-389564586),h=c(h,m,n,w,e[2],17,606105819),w=c(w,h,m,n,e[3],22,-1044525330),n=c(n,w,h,m,e[4],7,-176418897),m=c(m,n,w,h,e[5],12,1200080426),h=c(h,m,n,w,e[6],17,-1473231341),w=c(w,h,m,n,e[7],22,-45705983),n=c(n,w,h,m,e[8],7,1770035416),m=c(m,n,w,h,e[9],12,-1958414417),h=c(h,m,n,w,e[10],17,-42063),w=c(w,h,m,n,e[11],22,-1990404162),n=c(n,w,h,m,e[12],7,1804603682),m=c(m,n,w,h,
e[13],12,-40341101),h=c(h,m,n,w,e[14],17,-1502002290),w=c(w,h,m,n,e[15],22,1236535329),n=b(n,w,h,m,e[1],5,-165796510),m=b(m,n,w,h,e[6],9,-1069501632),h=b(h,m,n,w,e[11],14,643717713),w=b(w,h,m,n,e[0],20,-373897302),n=b(n,w,h,m,e[5],5,-701558691),m=b(m,n,w,h,e[10],9,38016083),h=b(h,m,n,w,e[15],14,-660478335),w=b(w,h,m,n,e[4],20,-405537848),n=b(n,w,h,m,e[9],5,568446438),m=b(m,n,w,h,e[14],9,-1019803690),h=b(h,m,n,w,e[3],14,-187363961),w=b(w,h,m,n,e[8],20,1163531501),n=b(n,w,h,m,e[13],5,-1444681467),m=
b(m,n,w,h,e[2],9,-51403784),h=b(h,m,n,w,e[7],14,1735328473),w=b(w,h,m,n,e[12],20,-1926607734),n=d(w^h^m,n,w,e[5],4,-378558),m=d(n^w^h,m,n,e[8],11,-2022574463),h=d(m^n^w,h,m,e[11],16,1839030562),w=d(h^m^n,w,h,e[14],23,-35309556),n=d(w^h^m,n,w,e[1],4,-1530992060),m=d(n^w^h,m,n,e[4],11,1272893353),h=d(m^n^w,h,m,e[7],16,-155497632),w=d(h^m^n,w,h,e[10],23,-1094730640),n=d(w^h^m,n,w,e[13],4,681279174),m=d(n^w^h,m,n,e[0],11,-358537222),h=d(m^n^w,h,m,e[3],16,-722521979),w=d(h^m^n,w,h,e[6],23,76029189),n=
d(w^h^m,n,w,e[9],4,-640364487),m=d(n^w^h,m,n,e[12],11,-421815835),h=d(m^n^w,h,m,e[15],16,530742520),w=d(h^m^n,w,h,e[2],23,-995338651),n=g(n,w,h,m,e[0],6,-198630844),m=g(m,n,w,h,e[7],10,1126891415),h=g(h,m,n,w,e[14],15,-1416354905),w=g(w,h,m,n,e[5],21,-57434055),n=g(n,w,h,m,e[12],6,1700485571),m=g(m,n,w,h,e[3],10,-1894986606),h=g(h,m,n,w,e[10],15,-1051523),w=g(w,h,m,n,e[1],21,-2054922799),n=g(n,w,h,m,e[8],6,1873313359),m=g(m,n,w,h,e[15],10,-30611744),h=g(h,m,n,w,e[6],15,-1560198380),w=g(w,h,m,n,e[13],
21,1309151649),n=g(n,w,h,m,e[4],6,-145523070),m=g(m,n,w,h,e[11],10,-1120210379),h=g(h,m,n,w,e[2],15,718787259),w=g(w,h,m,n,e[9],21,-343485551);a[0]=n+a[0]&4294967295;a[1]=w+a[1]&4294967295;a[2]=h+a[2]&4294967295;a[3]=m+a[3]&4294967295}function d(a,b,c,d,g,m){b=(b+a&4294967295)+(d+m&4294967295)&4294967295;return(b<<g|b>>>32-g)+c&4294967295}function c(a,b,c,g,h,m,n){return d(b&c|~b&g,a,b,h,m,n)}function b(a,b,c,g,h,m,n){return d(b&g|c&~g,a,b,h,m,n)}function g(a,b,c,g,h,m,n){return d(c^(b|~g),a,b,h,
m,n)}var n="0123456789abcdef".split("");a.vC=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var d;for(d=64;d<=b.length;d+=64){var g,m=b.substring(d-64,d),x=[];for(g=0;64>g;g+=4)x[g>>2]=m.charCodeAt(g)+(m.charCodeAt(g+1)<<8)+(m.charCodeAt(g+2)<<16)+(m.charCodeAt(g+3)<<24);r(a,x)}b=b.substring(d-64);g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<b.length;d++)g[d>>2]|=b.charCodeAt(d)<<(d%4<<3);g[d>>2]|=128<<(d%4<<3);if(55<d)for(r(a,g),d=0;16>d;d++)g[d]=0;g[14]=8*c;r(a,
g);for(b=0;b<a.length;b++){c=a[b];d="";for(g=0;4>g;g++)d+=n[c>>8*g+4&15]+n[c>>8*g&15];a[b]=d}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_DERIVATIVES_EXT"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],
j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",f:[{a:"if",i:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",
b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",
i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],
j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",
f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",
b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",
b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",
A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",
i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES",
"ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:6},{a:"logical_and_expr",l:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:7}],j:{a:"grp",f:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],
j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",
j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",
j:{a:"grp",f:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:12}],j:{a:"grp",f:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE_DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["WIREFRAME_QUALITY",0,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",i:["WIREFRAME_QUALITY",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GLSL1"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",
A:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",
i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",f:[{a:"if",
i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")},
{a:"cond",f:[{a:"if",i:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",
f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"include",A:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_VIEW_SPECIAL_SKYDOME"],j:{a:"grp",f:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",
f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",f:[{a:"if",
i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",
i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],
j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",A:"color_util.glslf"},{a:"include",A:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",A:"std.glsl"},
{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_DERIVATIVES_EXT"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"include",
A:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP","NUM_LAMP_LIGHTS",0,{a:"non_equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",
f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
l:2},{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",A:"nodes.glslf"},{a:"cond",
f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WETTABLE"],j:{a:"grp",f:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},
{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",l:9}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","NODES",{a:"logic_negative_expr",l:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2},{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],
j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],
j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",A:"dynamic_grass.glslv"},{a:"include",A:"shadow.glslv"},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},
{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",l:3},"NODES",{a:"logic_negative_expr",l:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:14}],j:{a:"grp",f:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"NODES",{a:"logic_negative_expr",l:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",i:["NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",l:10}],j:{a:"grp",f:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
j:{a:"grp",f:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",f:[{a:"if",
i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",i:["VERTEX_COLOR"],j:{a:"grp",f:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",
l:6}],j:{a:"grp",f:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","NODES",{a:"logic_negative_expr",l:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",
l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"include",A:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",i:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},
"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"shadow.glslf"}]}}]},
{a:"include",A:"mirror.glslf"},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"include",A:"refraction.glslf"}]}}]},{a:"include",A:"environment.glslf"},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"lighting_nodes.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",
l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],
j:{a:"grp",f:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK"],j:{a:"grp",f:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADELESS"],j:{a:"grp",
f:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_AS_SPEC"],j:{a:"grp",f:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WETTABLE"],j:{a:"grp",f:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],
j:{a:"grp",f:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_DERIVATIVES_EXT"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],
j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:7}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",
l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"include",A:"math.glslv"},{a:"include",A:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",
f:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",
b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR",
"HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",f:[{a:"if",
i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","j",";"]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["WORLD_SPACE",{a:"logic_negative_expr",l:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_COLOR_RAMP"],
j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"particles.glslv"},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"include",A:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = vec3 ( 0.0 , - 1.0 , 0.0 ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",
l:2},{a:"logical_and_expr",l:2},"USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ; vec3 R = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , P , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",
"USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , aO ( aY , cR ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",
l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",
c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},
{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",
f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",
l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",A:"lighting_nodes.glslf"},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"environment.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"include",A:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",
i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4",
"bZ","=","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",l:1},"SKY_COLOR",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_DERIVATIVES_EXT"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],
j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],
j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",
f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",f:[{a:"if",i:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],
j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"NODES","ALPHA",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"shadow.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1},"TEXTURE_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",
i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],
j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],
j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1},"TEXTURE_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},
{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",A:"dynamic_grass.glslv"},{a:"include",A:"shadow.glslv"},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",f:[{a:"if",
i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",
f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["HAIR_BILLBOARD",{a:"logic_negative_expr",l:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",
{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:12}],j:{a:"grp",f:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",
";","}"]}]};a["sky.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},
{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"include",A:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYPAPER"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",
i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"include",
A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",3,{a:"g_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],
j:{a:"grp",f:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
A:"environment.glslf"},{a:"cond",f:[{a:"if",i:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"refraction.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",A:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC","FOAM",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,
{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NORM_FOAM0"],j:{a:"grp",f:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORM_FOAM1"],j:{a:"grp",f:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORM_FOAM2"],j:{a:"grp",f:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORM_FOAM3"],j:{a:"grp",f:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],
j:{a:"grp",f:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["REFRACTIVE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",i:["SHORE_SMOOTHING",
{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GLSL1"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",i:["DEBUG_WIREFRAME",2,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1},"DYNAMIC",{a:"logic_negative_expr",l:1},"NUM_NORMALMAPS",0,{a:"g_expr",l:2},{a:"logical_or_expr",
l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1},"NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],
j:{a:"grp",f:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",
l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",i:["GENERATED_MESH",{a:"logic_negative_expr",
l:1}],j:{a:"grp",f:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",i:["DYNAMIC",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",A:"precision_statement.glslf"},
{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",i:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",A:"fxaa.glslf"},{a:"cond",f:[{a:"if",i:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",i:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",i:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",
i:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",i:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"include",A:"procedural.glslf"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",f:[{a:"if",i:["DEPTH_RGBA"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",f:[{a:"if",i:["DEPTH_RGBA"],j:{a:"grp",f:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SAFARI_CANVAS_ALPHA_HACK"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",l:2}],
j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",i:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",i:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2},"SMAA_PREDICATION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",j:{a:"grp",
f:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",j:{a:"grp",f:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",j:{a:"grp",
f:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_REPROJECTION",j:{a:"grp",f:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",j:{a:"grp",f:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",j:{a:"grp",f:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",i:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",
b:["highp"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform PRECISION vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",
f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",i:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SSAO_WHITE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"include",A:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"DISTOR_SCALE",b:["0.8"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",
i:["ANAGLYPH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 4.0 * u_texel_size [ 0 ] / u_texel_size [ 1 ] / cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + 0.5 ; vec2 jk = ji + 0.5 ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + 0.5 ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji += 0.5 ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["ANAGLYPH"],j:{a:"grp",f:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( abs ( u_distortion_params [ 0 ] ) > EPSILON || abs ( u_distortion_params [ 1 ] ) > EPSILON ) if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; jn ( bE , ac , cM , u_sampler_right ) ; } else if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , bE ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_right , bE ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"BLENDING_GLSLF",j:{a:"grp",f:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"CAUSTICS_GLSLF",j:{a:"grp",f:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",A:"procedural.glslf"},{a:"include",A:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",j:{a:"grp",f:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",A:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:"if ( aG < 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG * ( 1.0 / 1.055 ) + 0.0521327 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aG = pow ( aG , 1.0 / 2.2 ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( aG < 0.0031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},
{a:"txt",b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",f:[{a:"if",i:["PREMULTIPLY_ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
f:[{a:"cond",f:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",j:{a:"grp",f:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",j:{a:"grp",f:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",f:[{a:"if",i:["GLSL3"],j:{a:"grp",f:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",f:[{a:"if",i:["GLSL3"],j:{a:"grp",f:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",j:{a:"grp",f:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT"],j:{a:"grp",f:[{a:"cond",
f:[{a:"if",i:["SKY_TEXTURE"],j:{a:"grp",f:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",i:["SKY_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",f:[{a:"cond",
f:[{a:"ifndef",c:"FOG_GLSLF",j:{a:"grp",f:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FOG_TYPE","QUADRATIC",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",i:["FOG_TYPE","LINEAR",{a:"equal_expr",l:2}],j:{a:"grp",f:[]}},{a:"elif",i:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],
j:{a:"grp",f:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSLF",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PS3",j:{a:"grp",f:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_360",j:{a:"grp",f:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",f:[{a:"ifndef",c:"FXAA_360_OPT",j:{a:"grp",f:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PC",j:{a:"grp",f:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PC_CONSOLE",j:{a:"grp",f:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSL_120",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSL_130",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_HLSL_3",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_4",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_5",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",j:{a:"grp",f:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_EARLY_EXIT",j:{a:"grp",f:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_DISCARD",j:{a:"grp",f:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",j:{a:"grp",f:[{a:"cond",f:[{a:"ifdef",c:"GL_EXT_gpu_shader4",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_NV_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_ARB_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["FXAA_HLSL_5",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_ARB_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_NV_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:[0],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",f:[{a:"if",i:[0],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
f:[{a:"if",i:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",A:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_BLEND4WEB",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",4,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",5,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",6,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",7,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",8,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",9,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",10,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",11,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",12,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_DISCARD",1,{a:"equal_expr",l:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"HALO_COLOR_GLSLF",j:{a:"grp",f:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",f:[{a:"if",i:["NUM_RINGS","NUM_LINES",{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_STARS"],
j:{a:"grp",f:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",j:{a:"grp",
f:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",A:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",u:[],s:[{a:"node_out",c:"nP",h:["vec3"],g:!1},{a:"node_out",c:"nQ",h:["vec3"],g:!1},{a:"node_out",c:"nR",h:["vec3"],g:!1},{a:"node_out",c:"nS",h:["vec3"],g:!0},{a:"node_out",c:"nT",h:["vec3"],g:!0},{a:"node_out",c:"nU",h:["vec2"],g:!0},{a:"node_out",c:"nV",h:["vec2"],g:!0},{a:"node_out",c:"nW",h:["vec4"],g:!0},{a:"node_out",c:"nX",h:["float"],g:!0},{a:"node_out",c:"nY",h:["vec4"],g:!0}],m:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nS"],m:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nT"],m:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nV"],m:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nU"],m:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nW"],m:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",f:[{a:"node_if",
i:["USE_OUT_nX"],m:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nY"],m:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"nZ",h:["vec3"],g:!1},{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_out",c:"ob",h:["vec4"],g:!1},{a:"node_out",c:"oc",h:["vec3"],g:!1}],m:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],s:[{a:"node_in",c:"od",h:["vec4"],g:!1},{a:"node_out",c:"oe",h:["vec3"],g:!1},{a:"node_out",c:"of",h:["vec2"],g:!1},{a:"node_out",c:"og",h:["vec3"],g:!1},{a:"node_out",c:"oh",h:["float"],g:!1}],m:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",m:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"om",h:["vec3"],g:!1},{a:"node_in",c:"on",h:["vec2"],g:!1},{a:"node_in",c:"oo",h:["vec3"],g:!1},{a:"node_in",c:"op",h:["float"],g:!1},
{a:"node_in",c:"oq",h:["vec2"],g:!1},{a:"node_out",c:"or",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ou",h:["vec3"],g:!1},{a:"node_in",c:"ov",h:["vec2"],g:!1},{a:"node_in",c:"ow",h:["vec3"],g:!1},{a:"node_in",c:"ox",h:["float"],g:!1},{a:"node_out",c:"oy",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oz",h:["vec3"],g:!1},{a:"node_in",c:"oA",h:["vec2"],g:!1},{a:"node_in",c:"oB",h:["vec3"],g:!1},{a:"node_in",c:"oC",h:["float"],g:!1},{a:"node_in",c:"oD",h:["vec2"],g:!1},{a:"node_out",c:"oE",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oO",h:["vec3"],g:!1},{a:"node_in",c:"oP",h:["vec2"],g:!1},{a:"node_in",c:"oQ",h:["vec3"],g:!1},{a:"node_in",c:"oR",h:["float"],g:!1},{a:"node_in",c:"oS",h:["vec2"],g:!1},{a:"node_out",c:"oT",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oU",h:["vec3"],g:!1},{a:"node_in",c:"oV",h:["vec2"],g:!1},{a:"node_in",c:"oW",h:["vec3"],g:!1},
{a:"node_in",c:"oX",h:["float"],g:!1},{a:"node_in",c:"oY",h:["vec2"],g:!1},{a:"node_out",c:"oZ",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pa",h:["vec3"],g:!1},{a:"node_in",c:"pb",h:["vec2"],g:!1},{a:"node_in",c:"pc",h:["vec3"],g:!1},{a:"node_in",c:"pd",h:["float"],g:!1},{a:"node_in",c:"pe",h:["vec2"],g:!1},{a:"node_out",c:"pf",h:["float"],g:!1}],m:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ph",h:["vec3"],g:!1},{a:"node_in",c:"pi",h:["vec2"],g:!1},{a:"node_in",c:"pj",h:["vec3"],g:!1},{a:"node_in",c:"pk",h:["float"],g:!1},{a:"node_in",c:"pl",h:["vec2"],g:!1},{a:"node_out",c:"pm",h:["float"],g:!1}],m:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pn",h:["vec3"],g:!1},{a:"node_in",c:"po",h:["vec2"],g:!1},{a:"node_in",c:"pr",h:["vec3"],g:!1},{a:"node_in",c:"pu",h:["float"],g:!1},{a:"node_in",c:"pv",h:["vec2"],g:!1},{a:"node_out",c:"pw",h:["float"],g:!1}],m:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pz",h:["vec3"],g:!1},{a:"node_in",c:"pA",h:["vec2"],g:!1},{a:"node_in",c:"pB",h:["vec3"],g:!1},{a:"node_in",c:"pC",h:["float"],g:!1},{a:"node_in",c:"pD",h:["vec2"],g:!1},{a:"node_out",c:"pE",h:["float"],
g:!1}],m:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pG",h:["vec3"],g:!1},{a:"node_in",c:"pH",h:["vec2"],g:!1},{a:"node_in",c:"pI",h:["vec3"],g:!1},{a:"node_in",c:"pJ",h:["float"],g:!1},{a:"node_in",c:"pK",h:["vec2"],g:!1},{a:"node_out",c:"pL",h:["float"],g:!1}],m:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pQ",h:["vec4"],g:!1},{a:"node_in",c:"pR",h:["vec3"],g:!1},{a:"node_in",c:"pS",h:["float"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["vec3"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec4"],g:!1},{a:"node_in",c:"pX",h:["vec3"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["float"],g:!1},{a:"node_out",c:"qa",h:["vec4"],g:!1},{a:"node_out",c:"qb",
h:["vec3"],g:!1}],m:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",u:[],s:[{a:"node_in",c:"qc",h:["vec4"],g:!1},{a:"node_in",c:"qd",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"MATH_GLSLV",j:{a:"grp",f:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"MIRROR_GLSLF",j:{a:"grp",f:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"color_util.glslf"},
{a:"include",A:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"NODES_GLSLF",j:{a:"grp",f:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"mirror.glslf"},{a:"include",A:"shadow.glslf"},{a:"include",A:"environment.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",
A:"refraction.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",i:["HAS_REFRACT_TEXTURE"],j:{a:"grp",f:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - _1_0 + da * da ; float qU ; if ( g > _0_0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - _1_0 ) / ( da * ( g - da ) + _1_0 ) ; qU = _0_5 * cg * cg * ( _1_0 + oN * oN ) ; } else { qU = _1_0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
u:[],s:[{a:"node_out",c:"rq",h:["vec3"],g:!0},{a:"node_out",c:"rs",h:["float"],g:!0},{a:"node_out",c:"rt",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rq"],m:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rs"],m:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rt"],m:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",u:[],s:[{a:"node_in",c:"ru",h:["float"],
g:!1},{a:"node_in",c:"rv",h:["float"],g:!1},{a:"node_in",c:"rw",h:["float"],g:!1},{a:"node_out",c:"rx",h:["vec3"],g:!1}],m:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",u:[],s:[{a:"node_in",c:"ry",h:["float"],g:!1},{a:"node_in",c:"rz",h:["float"],g:!1},{a:"node_in",c:"rA",h:["float"],g:!1},{a:"node_out",c:"rB",h:["vec3"],g:!1}],m:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",u:[],s:[{a:"node_out",c:"rC",h:["vec3"],g:!1}],m:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",u:[],s:[{a:"node_out",c:"rD",h:["vec3"],g:!1}],m:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_out",c:"rE",h:["vec3"],g:!1},{a:"node_param",c:"qW",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",u:[],s:[{a:"node_out",c:"rF",h:["vec3"],g:!1}],m:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
u:[],s:[{a:"node_out",c:"rG",h:["vec3"],g:!1},{a:"node_param",c:"qX",h:["GLSL_IN","vec3"],g:!1}],m:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_out",c:"rH",h:["float"],g:!1},{a:"node_param",c:"qY",h:["GLSL_IN","float"],g:!1}],m:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_out",c:"rI",h:["float"],g:!1},{a:"node_out",c:"rJ",h:["float"],g:!1},{a:"node_param",c:"qZ",
h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_out",c:"rK",h:["float"],g:!1},{a:"node_out",c:"rL",h:["float"],g:!1},{a:"node_out",c:"rM",h:["float"],g:!1},{a:"node_param",c:"q_",h:["GLSL_IN","vec3"],g:!1}],m:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"rN",h:["vec3"],g:!1},{a:"node_out",c:"rO",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["rO","=","rN",";"]}]},{a:"node_else",m:[{a:"txt",b:"rO = rl . xyz ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_FB",u:[],s:[{a:"node_out",c:"rP",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",u:[],s:[{a:"node_out",c:"rQ",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"rQ = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"rQ = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",u:[],s:[{a:"node_out",c:"rR",h:["vec3"],g:!1}],m:[{a:"txt",
b:"rR = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",u:[],s:[{a:"node_out",c:"rS",h:["vec3"],g:!1}],m:[{a:"txt",b:"rS = rn . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",u:[],s:[{a:"node_out",c:"rT",h:["vec3"],g:!1}],m:[{a:"txt",b:["rT","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",u:[],s:[{a:"node_out",c:"rU",h:["vec3"],g:!1}],m:[{a:"txt",b:["rU","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",u:[],s:[{a:"node_out",c:"rV",h:["vec3"],g:!1},{a:"node_out",c:"rW",h:["vec3"],g:!1},
{a:"node_out",c:"rX",h:["vec3"],g:!1},{a:"node_out",c:"rY",h:["vec3"],g:!1},{a:"node_out",c:"rZ",h:["vec3"],g:!1},{a:"node_out",c:"r_",h:["vec3"],g:!1},{a:"node_out",c:"sa",h:["float"],g:!1},{a:"node_out",c:"sb",h:["float"],g:!1}],m:[{a:"txt",b:"rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = vec3 ( _0_0 ) ; sa = _0_0 ; sb = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",u:[],s:[{a:"node_in",c:"sc",h:["float"],g:!1},{a:"node_in",c:"sd",h:["float"],
g:!1},{a:"node_in",c:"se",h:["float"],g:!1},{a:"node_in",c:"sf",h:["float"],g:!1},{a:"node_in",c:"sg",h:["vec3"],g:!1},{a:"node_out",c:"sh",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 jz = jy ( sg ) ; jz [ 0 ] += ( sc - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sd , se ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sh = mix ( sg , jA ( jz ) , sf ) ;".split(" ")}]},
{a:"node",c:"INVERT",u:[],s:[{a:"node_in",c:"si",h:["float"],g:!1},{a:"node_in",c:"sj",h:["vec3"],g:!1},{a:"node_out",c:"sk",h:["vec3"],g:!1}],m:[{a:"txt",b:"sk = mix ( sj , vec3 ( _1_0 ) - sj , si ) ;".split(" ")}]},{a:"node",c:"LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],s:[{a:"node_out",
c:"sl",h:["vec3"],g:!0},{a:"node_out",c:"sm",h:["vec3"],g:!1},{a:"node_out",c:"sn",h:["float"],g:!1},{a:"node_out",c:"so",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["LAMP_INDEX",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sl"],m:[{a:"txt",b:"sl = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sr = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 su = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"sm = - h + su ; sn = length ( sm ) ; sm = normalize ( sm ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_so"],m:[{a:"txt",b:"so = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sn * sn ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"float ol = dot ( sm , sr ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; so *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"so *= max ( LAMP_LIGHT_DIST - sn , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sm"],m:[{a:"txt",b:["sm","=","sr",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sn"],m:[{a:"txt",b:"sn = length ( su - h ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_so"],m:[{a:"txt",b:["so","=","_1_0",";"]}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",
i:["USE_OUT_sl"],m:[{a:"txt",b:"sl = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:"sm = vec3 ( _0_0 ) ; sn = 0.0 ;".split(" ")}]}]}]},{a:"node",c:"NORMAL",u:[],s:[{a:"node_in",c:"sv",h:["vec3"],g:!1},{a:"node_out",c:"sw",h:["vec3"],g:!0},{a:"node_out",c:"sx",h:["float"],g:!0},{a:"node_param",c:"rc",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sw"],m:[{a:"txt",b:["sw","=","rc",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sx"],m:[{a:"txt",b:"sx = - dot ( sv , rc ) ;".split(" ")}]}]}]},
{a:"node",c:"B4W_VECTOR_VIEW",u:[],s:[{a:"node_in",c:"sy",h:["vec3"],g:!1},{a:"node_out",c:"sz",h:["vec3"],g:!1}],m:[{a:"txt",b:"sz = - T ( u_view_tsr_frag , sy ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",u:[],s:[{a:"node_in",c:"sA",h:["vec3"],g:!1},{a:"node_in",c:"sB",h:["vec3"],g:!1},{a:"node_in",c:"sC",h:["float"],g:!1},{a:"node_in",c:"sD",h:["vec3"],g:!1},{a:"node_in",c:"sE",h:["float"],g:!1},{a:"node_in",c:"sF",h:["float"],g:!1},{a:"node_in",c:"sG",h:["vec3"],g:!1},{a:"node_in",c:"sH",h:["vec3"],
g:!1},{a:"node_in",c:"sI",h:["float"],g:!1},{a:"node_in",c:"sJ",h:["vec3"],g:!1},{a:"node_in",c:"sK",h:["float"],g:!1},{a:"node_out",c:"sL",h:["vec3"],g:!1},{a:"node_out",c:"sM",h:["vec3"],g:!1},{a:"node_out",c:"sN",h:["vec3"],g:!1},{a:"node_out",c:"sO",h:["vec3"],g:!1},{a:"node_out",c:"sP",h:["vec3"],g:!1},{a:"node_out",c:"sQ",h:["vec4"],g:!1},{a:"node_out",c:"sR",h:["vec4"],g:!1},{a:"node_out",c:"sS",h:["vec3"],g:!1},{a:"node_out",c:"sT",h:["float"],g:!1},{a:"node_out",c:"sU",h:["vec3"],g:!1},{a:"node_out",
c:"sV",h:["float"],g:!1},{a:"node_out",c:"sW",h:["vec3"],g:!1},{a:"node_out",c:"sX",h:["float"],g:!1}],m:[{a:"txt",b:"sN = sB ; sO = sD ; sP = sG ; sS = sD ; sT = sF ; sU = sH ; sV = sI ; sW = sJ ; sX = sK ; sL = ro * sN ; sM = rp * u_environment_energy * ce ( sP ) ; sR = ch ( sN ) ; G = sR ; sQ [ 0 ] = sC ; sQ [ 1 ] = sE ; sQ [ 2 ] = sF ;".split(" ")}]},{a:"node",c:"BSDF_END",u:[],s:[{a:"node_in",c:"sY",h:["vec4"],g:!1},{a:"node_in",c:"sZ",h:["vec3"],g:!1},{a:"node_in",c:"s_",h:["vec3"],g:!1},{a:"node_in",
c:"ta",h:["vec3"],g:!1},{a:"node_in",c:"tb",h:["float"],g:!1},{a:"node_in",c:"tc",h:["vec3"],g:!1},{a:"node_in",c:"td",h:["float"],g:!1},{a:"node_in",c:"te",h:["vec3"],g:!1},{a:"node_in",c:"tf",h:["float"],g:!1},{a:"node_out",c:"tg",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"tg = qK ( sY . rgb , ta , nI , s_ , tb , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",
b:"tg = qK ( sY . rgb , ta , nI , s_ , tb , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"tg = sY . rgb ;".split(" ")}]}]},{a:"txt",b:"tg += sZ ; tg = mix ( tg , tc , td ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_BSDF_TRANSPARENT"],m:[{a:"txt",b:"vec3 th = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( th ) ; te = te * th ; tg += te ;".split(" ")}]}]},{a:"txt",b:["s_",";"]}]},{a:"node",c:"BSDF_COMPUTE",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],
s:[{a:"node_in",c:"ti",h:["vec3"],g:!1},{a:"node_in",c:"tj",h:["vec2"],g:!1},{a:"node_in",c:"tk",h:["vec3"],g:!1},{a:"node_in",c:"tl",h:["float"],g:!1},{a:"node_in",c:"tm",h:["vec4"],g:!1},{a:"node_out",c:"tn",h:["float"],g:!1},{a:"node_out",c:"to",h:["float"],g:!1}],m:[{a:"txt",b:"vec3 qS = tk ; float tr = clamp ( tm [ 0 ] , _0_0 , _1_0 ) ; float tu = clamp ( tm [ 1 ] , _0_0 , _1_0 ) ; float qJ = tm [ 2 ] ; vec3 pg = normalize ( nI + ti ) ; float ot = ( _1_0 - tl ) * dot ( qS , ti ) + tl ; float tv = ( _1_0 - tl ) * max ( dot ( ti , pg ) , _0_0 ) + tl ; float tw = ( _1_0 - tl ) * max ( dot ( tk , pg ) , _0_0 ) + tl ; tn = _0_0 ; if ( tj . r != _0_0 ) { if ( tr > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tr * tr ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = ti - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) tn = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; tn = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else tn = ot ; tn = max ( tn , _0_0 ) ; } float J = tu ; float tx = J * J ; float ty = ( tw * tx - tw ) * tw + _1_0 ; float cd = tx / ( M_PI * ty * ty ) ; float tz ; float tA ; float tB = pow ( _1_0 - tv , 5.0 ) ; tz = _1_0 ; tA = tB ; float jx = J / 2.0 ; float tC = jx * jx ; float tD = _1_0 - tC ; float tE = _1_0 / ( tv * tv * tD + tC ) ; tz *= tE ; tA *= tE ; float tF = mix ( 0.04 , _1_0 , qJ ) ; float tG = mix ( tA , tz , tF ) ; to = max ( ot * cd * tG , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",u:[],s:[{a:"node_in",c:"tH",h:["vec3"],g:!1},{a:"node_in",c:"tI",h:["float"],g:!1},{a:"node_in",c:"tJ",h:["float"],g:!1},{a:"node_in",c:"tK",h:["float"],g:!1},{a:"node_in",c:"tL",h:["vec3"],g:!1},{a:"node_in",c:"tM",h:["vec3"],g:!1},{a:"node_out",c:"tN",h:["vec3"],g:!1}],m:[{a:"txt",b:"tN = tH ; tI ; tJ ; tK ; tL ; tM ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"tO",h:["vec3"],g:!1},{a:"node_in",c:"tP",h:["float"],
g:!1},{a:"node_in",c:"tQ",h:["vec3"],g:!1},{a:"node_out",c:"tR",h:["vec3"],g:!1},{a:"node_out",c:"tS",h:["vec3"],g:!1},{a:"node_out",c:"tT",h:["float"],g:!1},{a:"node_out",c:"tU",h:["vec3"],g:!1},{a:"node_out",c:"tV",h:["float"],g:!1},{a:"node_out",c:"tW",h:["float"],g:!1},{a:"node_out",c:"tX",h:["vec3"],g:!1},{a:"node_out",c:"tY",h:["vec3"],g:!1},{a:"node_out",c:"tZ",h:["float"],g:!1},{a:"node_out",c:"t_",h:["vec3"],g:!1},{a:"node_out",c:"ua",h:["float"],g:!1}],m:[{a:"txt",b:"tS = tO ; tT = tP ; tW = _0_0 ; tZ = _0_0 ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["tX","=","tQ",";"]}]},{a:"node_else",m:[{a:"txt",b:["tX","=","nH",";"]}]}]},{a:"txt",b:"tR ; tU ; tV ; tY ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",u:[],s:[{a:"node_in",c:"ub",h:["vec3"],g:!1},{a:"node_in",c:"uc",h:["float"],g:!1},{a:"node_in",c:"ud",h:["float"],g:!1},{a:"node_in",c:"ue",h:["vec3"],g:!1},{a:"node_out",c:"uf",h:["vec3"],g:!1}],m:[{a:"txt",b:"uf = ub ; uc ; ud ; ue ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",
u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"ug",h:["vec3"],g:!1},{a:"node_in",c:"uh",h:["float"],g:!1},{a:"node_in",c:"ui",h:["vec3"],g:!1},{a:"node_out",c:"uj",h:["vec3"],g:!1},{a:"node_out",c:"uk",h:["vec3"],g:!1},{a:"node_out",c:"ul",h:["float"],g:!1},{a:"node_out",c:"um",h:["vec3"],g:!1},{a:"node_out",c:"un",h:["float"],g:!1},{a:"node_out",c:"uo",h:["float"],g:!1},{a:"node_out",c:"up",h:["vec3"],g:!1},{a:"node_out",c:"uq",h:["vec3"],g:!1},{a:"node_out",c:"ur",h:["float"],g:!1},
{a:"node_out",c:"us",h:["vec3"],g:!1},{a:"node_out",c:"ut",h:["float"],g:!1}],m:[{a:"txt",b:"um = ug ; un = uh ; uo = _1_0 ; ur = _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["up","=","ui",";"]}]},{a:"node_else",m:[{a:"txt",b:["up","=","nH",";"]}]}]},{a:"txt",b:"uj ; uk ; ul ; uq ; us ; ut ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",u:[],s:[{a:"node_in",c:"uu",h:["vec3"],g:!1},{a:"node_in",c:"uv",h:["float"],g:!1},{a:"node_in",c:"uw",h:["float"],g:!1},{a:"node_in",
c:"ux",h:["float"],g:!1},{a:"node_out",c:"uy",h:["vec3"],g:!1}],m:[{a:"txt",b:"uy = uu ; uv ; uw ; ux ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",u:[],s:[{a:"node_in",c:"uz",h:["vec3"],g:!1},{a:"node_out",c:"uA",h:["vec3"],g:!1},{a:"node_out",c:"uB",h:["vec3"],g:!1},{a:"node_out",c:"uC",h:["float"],g:!1},{a:"node_out",c:"uD",h:["vec3"],g:!1},{a:"node_out",c:"uE",h:["float"],g:!1},{a:"node_out",c:"uF",h:["float"],g:!1},{a:"node_out",c:"uG",h:["vec3"],g:!1},{a:"node_out",c:"uH",h:["vec3"],g:!1},
{a:"node_out",c:"uI",h:["float"],g:!1},{a:"node_out",c:"uJ",h:["vec3"],g:!1},{a:"node_out",c:"uK",h:["float"],g:!1}],m:[{a:"txt",b:"uJ = uz ; uF = _0_0 ; uI = _0_0 ; uK = _0_0 ; uG = nH ; uA ; uB ; uC ; uD ; uE ; uH ;".split(" ")}]},{a:"node",c:"BSDF_TRANSLUCENT",u:[],s:[{a:"node_in",c:"uL",h:["vec3"],g:!1},{a:"node_in",c:"uM",h:["vec3"],g:!1},{a:"node_out",c:"uN",h:["vec3"],g:!1}],m:[{a:"txt",b:"uN = uL ; uM ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",u:[],s:[{a:"node_in",c:"uO",h:["vec3"],g:!1},
{a:"node_in",c:"uP",h:["float"],g:!1},{a:"node_in",c:"uQ",h:["float"],g:!1},{a:"node_in",c:"uR",h:["vec3"],g:!1},{a:"node_out",c:"uS",h:["vec3"],g:!1}],m:[{a:"txt",b:"uS [ 0 ] = uS [ 1 ] = uS [ 2 ] = _0_0 ; uO ; uP ; uQ ; uR ;".split(" ")}]},{a:"node",c:"BSDF_TOON",u:[],s:[{a:"node_in",c:"uT",h:["vec3"],g:!1},{a:"node_in",c:"uU",h:["float"],g:!1},{a:"node_in",c:"uV",h:["float"],g:!1},{a:"node_in",c:"uW",h:["vec3"],g:!1},{a:"node_out",c:"uX",h:["vec3"],g:!1}],m:[{a:"txt",b:"uX = uT ; uU ; uV ; uW ;".split(" ")}]},
{a:"node",c:"BSDF_VELVET",u:[],s:[{a:"node_in",c:"uY",h:["vec3"],g:!1},{a:"node_in",c:"uZ",h:["float"],g:!1},{a:"node_in",c:"u_",h:["vec3"],g:!1},{a:"node_out",c:"va",h:["vec3"],g:!1}],m:[{a:"txt",b:"va = uY ; uZ ; u_ ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",u:[],s:[{a:"node_in",c:"vb",h:["vec3"],g:!1},{a:"node_in",c:"vc",h:["float"],g:!1},{a:"node_in",c:"vd",h:["vec3"],g:!1},{a:"node_in",c:"ve",h:["float"],g:!1},{a:"node_in",c:"vf",h:["float"],g:!1},{a:"node_in",c:"vg",h:["vec3"],g:!1},
{a:"node_out",c:"vh",h:["vec3"],g:!1}],m:[{a:"txt",b:"vh [ 0 ] = vh [ 1 ] = vh [ 2 ] = _0_0 ; vb ; vd ; ve ; vf ; vg ; vc ;".split(" ")}]},{a:"node",c:"EMISSION",u:[],s:[{a:"node_in",c:"vi",h:["vec3"],g:!1},{a:"node_in",c:"vj",h:["float"],g:!1},{a:"node_out",c:"vk",h:["vec3"],g:!1},{a:"node_out",c:"vl",h:["vec3"],g:!1},{a:"node_out",c:"vm",h:["float"],g:!1},{a:"node_out",c:"vn",h:["vec3"],g:!1},{a:"node_out",c:"vo",h:["float"],g:!1},{a:"node_out",c:"vp",h:["float"],g:!1},{a:"node_out",c:"vq",h:["vec3"],
g:!1},{a:"node_out",c:"vr",h:["vec3"],g:!1},{a:"node_out",c:"vs",h:["float"],g:!1},{a:"node_out",c:"vt",h:["vec3"],g:!1},{a:"node_out",c:"vu",h:["float"],g:!1}],m:[{a:"txt",b:"vr = vj * vi ; vp = _0_0 ; vs = _1_0 ; vq = nH ; vk ; vl ; vm ; vn ; vo ; vu ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",u:[],s:[{a:"node_in",c:"vv",h:["vec3"],g:!1},{a:"node_out",c:"vw",h:["vec3"],g:!1}],m:[{a:"txt",b:"vw [ 0 ] = vw [ 1 ] = vw [ 2 ] = _0_0 ; vv ;".split(" ")}]},{a:"node",c:"HOLDOUT",u:[],s:[{a:"node_out",
c:"vx",h:["vec3"],g:!1}],m:[{a:"txt",b:"vx [ 0 ] = vx [ 1 ] = vx [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",u:[],s:[{a:"node_in",c:"vy",h:["vec3"],g:!1},{a:"node_in",c:"vz",h:["float"],g:!1},{a:"node_out",c:"vA",h:["vec3"],g:!1}],m:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vy ; vz ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",u:[],s:[{a:"node_in",c:"vB",h:["vec3"],g:!1},{a:"node_in",c:"vC",h:["float"],g:!1},{a:"node_in",c:"vD",h:["float"],g:!1},{a:"node_out",c:"vE",h:["vec3"],
g:!1}],m:[{a:"txt",b:"vE [ 0 ] = vE [ 1 ] = vE [ 2 ] = _0_0 ; vB ; vC ; vD ;".split(" ")}]},{a:"node",c:"BUMP",u:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"vF",h:["float"],g:!1},{a:"node_in",c:"vG",h:["float"],g:!1},{a:"node_in",c:"vH",h:["float"],g:!1},{a:"node_in",c:"vI",h:["vec3"],g:!1},{a:"node_out",c:"vJ",h:["vec3"],g:!1}],m:[{a:"txt",b:"float aC = vG ; float fX = vF ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["INVERT"],m:[{a:"txt",b:["aC",
"=","-","_1_0",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["vec3","P","=","vI",";"]}]},{a:"node_else",m:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_DERIVATIVES_EXT"],m:[{a:"txt",b:"vec3 vK = dFdx ( nG ) ; vec3 vL = dFdy ( nG ) ; vec3 vM = cross ( vL , P ) ; vec3 vN = cross ( P , vK ) ; float db = dot ( vK , vM ) ; float vO = abs ( db ) ; vec3 vP = dFdx ( vH ) * vM + dFdy ( vH ) * vN ; fX = max ( fX , _0_0 ) ; vJ = normalize ( vO * P - aC * sign ( db ) * vP ) ; vJ = normalize ( fX * vJ + ( _1_0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:["vJ","=","P",";"]}]}]}]},{a:"node",c:"DISPLACEMENT_BUMP",u:[],s:[{a:"node_in",c:"vQ",h:["float"],g:!1},{a:"node_out",c:"vR",h:["vec3"],g:!1}],m:[{a:"txt",b:"float aC = 0.1 ; vec3 P = nH ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_DERIVATIVES_EXT"],m:[{a:"txt",b:"vec3 vK = dFdx ( nG ) ; vec3 vL = dFdy ( nG ) ; vec3 vM = cross ( vL , P ) ; vec3 vN = cross ( P , vK ) ; float db = dot ( vK , vM ) ; float vO = abs ( db ) ; vec3 vP = dFdx ( vQ ) * vM + dFdy ( vQ ) * vN ; vR = normalize ( vO * P - aC * sign ( db ) * vP ) ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:["vR","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",u:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"vS",h:["float"],g:!1},{a:"node_in",c:"vT",h:["vec4"],g:!1},{a:"node_in",c:"vU",h:["vec3"],g:!1},{a:"node_out",c:"vV",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:"vec3 vW = normalize ( vU ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","vW","=","nH",";"]}]}]},{a:"node_cond",
f:[{a:"node_if",i:["SPACE","NM_TANGENT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV = rm * vV ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_OBJECT",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV . yz *= - _1_0 ; vV = T ( u_model_tsr , vV ) ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_WORLD",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",l:2},{a:"logical_or_expr",
l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV . yz *= - _1_0 ;".split(" ")}]}]},{a:"txt",b:"vV = normalize ( mix ( vW , vV , vS ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",u:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],s:[{a:"node_in",c:"vX",h:["vec3"],g:!1},{a:"node_out",c:"vY",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",
{a:"equal_expr",l:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],m:[{a:"txt",b:["vY","=","vX",";"]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_frag , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr_inverse , vX ) ;".split(" ")}]},
{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr , vX ) ; vY = ad ( u_view_tsr_frag , vY ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_inverse , vX ) ; vY = ad ( u_model_tsr_inverse , vY ) ;".split(" ")}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_frag , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr , vX ) ; vY = T ( u_view_tsr_frag , vY ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_inverse , vX ) ; vY = T ( u_model_tsr_inverse , vY ) ;".split(" ")}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = normalize ( vY ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",u:[],s:[{a:"node_in",c:"vZ",h:["float"],g:!1},{a:"node_out",c:"v_",h:["vec3"],g:!1}],m:[{a:"txt",b:"v_ [ 0 ] = v_ [ 1 ] = v_ [ 2 ] = _0_0 ; vZ ;".split(" ")}]},{a:"node",c:"WAVELENGTH",u:[],s:[{a:"node_in",c:"wa",h:["float"],g:!1},{a:"node_out",c:"wb",h:["vec3"],g:!1}],m:[{a:"txt",b:"wb [ 0 ] = wb [ 1 ] = wb [ 2 ] = _0_0 ; wa ;".split(" ")}]},
{a:"node",c:"SEPXYZ",u:[],s:[{a:"node_in",c:"wc",h:["vec3"],g:!1},{a:"node_out",c:"wd",h:["float"],g:!1},{a:"node_out",c:"we",h:["float"],g:!1},{a:"node_out",c:"wf",h:["float"],g:!1}],m:[{a:"txt",b:"wd = wc [ 0 ] ; we = wc [ 1 ] ; wf = wc [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",u:[],s:[{a:"node_in",c:"wg",h:["float"],g:!1},{a:"node_in",c:"wh",h:["float"],g:!1},{a:"node_in",c:"wi",h:["float"],g:!1},{a:"node_out",c:"wj",h:["vec3"],g:!1}],m:[{a:"txt",b:"wj [ 0 ] = wg ; wj [ 1 ] = wh ; wj [ 2 ] = wi ;".split(" ")}]},
{a:"node",c:"BRIGHTCONTRAST",u:[],s:[{a:"node_in",c:"wk",h:["vec3"],g:!1},{a:"node_in",c:"wl",h:["float"],g:!1},{a:"node_in",c:"wm",h:["float"],g:!1},{a:"node_out",c:"wn",h:["vec3"],g:!1}],m:[{a:"txt",b:"float b = wl - wm * _0_5 ; wn = max ( ( _1_0 + wm ) * wk + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",u:[],s:[{a:"node_in",c:"wo",h:["float"],g:!1},{a:"node_in",c:"wp",h:["float"],g:!1},{a:"node_out",c:"wq",h:["float"],g:!1},{a:"node_out",c:"wr",h:["float"],g:!1},{a:"node_out",
c:"ws",h:["float"],g:!1}],m:[{a:"txt",b:"wq = wr = ws = _0_0 ; wo ; wp ;".split(" ")}]},{a:"node",c:"TEX_SKY",u:[],s:[{a:"node_in",c:"wt",h:["vec3"],g:!1},{a:"node_out",c:"wu",h:["vec3"],g:!1}],m:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_NOISE",u:[],s:[{a:"node_in",c:"wv",h:["vec3"],g:!1},{a:"node_in",c:"wA",h:["float"],g:!1},{a:"node_in",c:"wB",h:["float"],g:!1},{a:"node_in",c:"wC",h:["float"],g:!1},{a:"node_out",c:"wD",h:["vec3"],g:!1},{a:"node_out",
c:"wE",h:["float"],g:!1}],m:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wv ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_WAVE",u:[],s:[{a:"node_in",c:"wF",h:["vec3"],g:!1},{a:"node_in",c:"wG",h:["float"],g:!1},{a:"node_in",c:"wH",h:["float"],g:!1},{a:"node_in",c:"wI",h:["float"],g:!1},{a:"node_in",c:"wJ",h:["float"],g:!1},{a:"node_out",c:"wK",h:["vec3"],g:!1},{a:"node_out",c:"wL",h:["float"],g:!1}],m:[{a:"txt",b:"wK [ 0 ] = wK [ 1 ] = wK [ 2 ] = _0_0 ; wL = _1_0 ; wF ; wG ; wH ; wI ; wJ ;".split(" ")}]},
{a:"node",c:"TEX_VORONOI",u:[],s:[{a:"node_in",c:"wM",h:["vec3"],g:!1},{a:"node_in",c:"wN",h:["float"],g:!1},{a:"node_out",c:"wO",h:["vec3"],g:!1},{a:"node_out",c:"wP",h:["float"],g:!1}],m:[{a:"txt",b:"wO [ 0 ] = wO [ 1 ] = wO [ 2 ] = _0_0 ; wP = _1_0 ; wM ; wN ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",u:[],s:[{a:"node_in",c:"wQ",h:["vec3"],g:!1},{a:"node_in",c:"wR",h:["float"],g:!1},{a:"node_in",c:"wS",h:["float"],g:!1},{a:"node_in",c:"wT",h:["float"],g:!1},{a:"node_in",c:"wU",h:["float"],g:!1},
{a:"node_in",c:"wV",h:["float"],g:!1},{a:"node_in",c:"wW",h:["float"],g:!1},{a:"node_out",c:"wX",h:["vec3"],g:!1},{a:"node_out",c:"wY",h:["float"],g:!1}],m:[{a:"txt",b:"wX [ 0 ] = wX [ 1 ] = wX [ 2 ] = _0_0 ; wY = _1_0 ; wQ ; wR ; wS ; wT ; wU ; wV ; wW ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",u:[],s:[{a:"node_in",c:"wZ",h:["vec3"],g:!1},{a:"node_out",c:"w_",h:["vec3"],g:!1},{a:"node_out",c:"xa",h:["float"],g:!1}],m:[{a:"txt",b:"w_ [ 0 ] = w_ [ 1 ] = w_ [ 2 ] = _0_0 ; xa = _1_0 ; wZ ;".split(" ")}]},
{a:"node",c:"TEX_MAGIC",u:[],s:[{a:"node_in",c:"xb",h:["vec3"],g:!1},{a:"node_in",c:"xc",h:["float"],g:!1},{a:"node_in",c:"xd",h:["float"],g:!1},{a:"node_out",c:"xe",h:["vec3"],g:!1},{a:"node_out",c:"xf",h:["float"],g:!1}],m:[{a:"txt",b:"xe [ 0 ] = xe [ 1 ] = xe [ 2 ] = _0_0 ; xf = _1_0 ; xb ; xc ; xd ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",u:[],s:[{a:"node_in",c:"xg",h:["vec3"],g:!1},{a:"node_in",c:"xh",h:["vec3"],g:!1},{a:"node_in",c:"xi",h:["vec3"],g:!1},{a:"node_in",c:"xj",h:["float"],g:!1},
{a:"node_out",c:"xk",h:["vec3"],g:!1},{a:"node_out",c:"xl",h:["float"],g:!1}],m:[{a:"txt",b:"xk [ 0 ] = xk [ 1 ] = xk [ 2 ] = _0_0 ; xl = _1_0 ; xg ; xh ; xi ; xj ;".split(" ")}]},{a:"node",c:"TEX_BRICK",u:[],s:[{a:"node_in",c:"xm",h:["vec3"],g:!1},{a:"node_in",c:"xn",h:["vec3"],g:!1},{a:"node_in",c:"xo",h:["vec3"],g:!1},{a:"node_in",c:"xp",h:["vec3"],g:!1},{a:"node_in",c:"xq",h:["float"],g:!1},{a:"node_in",c:"xr",h:["float"],g:!1},{a:"node_in",c:"xs",h:["float"],g:!1},{a:"node_in",c:"xt",h:["float"],
g:!1},{a:"node_in",c:"xu",h:["float"],g:!1},{a:"node_out",c:"xv",h:["vec3"],g:!1},{a:"node_out",c:"xA",h:["float"],g:!1}],m:[{a:"txt",b:"xv [ 0 ] = xv [ 1 ] = xv [ 2 ] = _0_0 ; xA = _1_0 ; xm ; xn ; xo ; xp ; xq ; xr ; xs ; xt ; xu ;".split(" ")}]},{a:"node",c:"ADD_SHADER",u:[],s:[{a:"node_in",c:"xB",h:["vec3"],g:!1},{a:"node_in",c:"xC",h:["vec3"],g:!1},{a:"node_out",c:"xD",h:["vec3"],g:!1}],m:[{a:"txt",b:"xD = clamp ( xB + xC , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",
u:[],s:[{a:"node_in",c:"xE",h:["float"],g:!1},{a:"node_in",c:"xF",h:["vec3"],g:!1},{a:"node_in",c:"xG",h:["vec3"],g:!1},{a:"node_in",c:"xH",h:["vec3"],g:!1},{a:"node_in",c:"xI",h:["float"],g:!1},{a:"node_in",c:"xJ",h:["vec3"],g:!1},{a:"node_in",c:"xK",h:["float"],g:!1},{a:"node_in",c:"xL",h:["float"],g:!1},{a:"node_in",c:"xM",h:["vec3"],g:!1},{a:"node_in",c:"xN",h:["vec3"],g:!1},{a:"node_in",c:"xO",h:["float"],g:!1},{a:"node_in",c:"xP",h:["vec3"],g:!1},{a:"node_in",c:"xQ",h:["float"],g:!1},{a:"node_in",
c:"xR",h:["vec3"],g:!1},{a:"node_in",c:"xS",h:["float"],g:!1},{a:"node_in",c:"xT",h:["vec3"],g:!1},{a:"node_in",c:"xU",h:["float"],g:!1},{a:"node_in",c:"xV",h:["float"],g:!1},{a:"node_in",c:"xW",h:["vec3"],g:!1},{a:"node_in",c:"xX",h:["vec3"],g:!1},{a:"node_in",c:"xY",h:["float"],g:!1},{a:"node_in",c:"xZ",h:["vec3"],g:!1},{a:"node_in",c:"x_",h:["float"],g:!1},{a:"node_out",c:"ya",h:["vec3"],g:!1},{a:"node_out",c:"yb",h:["vec3"],g:!1},{a:"node_out",c:"yc",h:["float"],g:!1},{a:"node_out",c:"yd",h:["vec3"],
g:!1},{a:"node_out",c:"ye",h:["float"],g:!1},{a:"node_out",c:"yf",h:["float"],g:!1},{a:"node_out",c:"yg",h:["vec3"],g:!1},{a:"node_out",c:"yh",h:["vec3"],g:!1},{a:"node_out",c:"yi",h:["float"],g:!1},{a:"node_out",c:"yj",h:["vec3"],g:!1},{a:"node_out",c:"yk",h:["float"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( xE , _0_0 , _1_0 ) ; yb = mix ( xH , xR , yl ) ; yc = mix ( xI , xS , yl ) ; if ( xL > _0_0 ) { if ( xV > _0_0 ) { yd = mix ( xJ , xT , yl ) ; ye = mix ( xK , xU , yl ) ; } else { yd = xJ ; ye = xK ; } } else { yd = xT ; ye = xU ; } if ( xO > _0_0 ) { if ( xY > _0_0 ) { yh = mix ( xN , xX , yl ) ; } else { yh = xN ; } } else { yh = xX ; } yf = mix ( xL , xV , yl ) ; yg = mix ( xM , xW , yl ) ; yi = mix ( xO , xY , yl ) ; yj = mix ( xP , xZ , yl ) ; yk = mix ( xQ , x_ , yl ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_out",c:"ym",h:["vec3"],g:!1},{a:"node_out",c:"yn",h:["vec3"],g:!1},{a:"node_param",c:"rd",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_ym"],m:[{a:"txt",b:"ym = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yn"],m:[{a:"txt",b:"yn = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_out",c:"yo",h:["vec3"],g:!1},{a:"node_param",c:"re",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",
b:"yo = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",u:[],s:[{a:"node_out",c:"yp",h:["vec3"],g:!1}],m:[{a:"txt",b:["yp","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",u:[],s:[{a:"node_out",c:"yq",h:["vec3"],g:!1}],m:[{a:"txt",b:["yq","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",u:[],s:[{a:"node_out",c:"yr",h:["vec3"],g:!1}],m:[{a:"txt",b:"yr = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",u:[],s:[{a:"node_out",c:"ys",h:["vec3"],g:!1}],m:[{a:"txt",b:"ys . xy = rn . xy ; ys . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",u:[],s:[{a:"node_out",c:"yt",h:["vec3"],g:!1}],m:[{a:"txt",b:"yt . xy = l . xy / l . z ; yt . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",u:[],s:[{a:"node_out",c:"yu",h:["vec3"],g:!1}],m:[{a:"txt",b:"yu = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_out",c:"yv",h:["vec3"],g:!1},{a:"node_param",c:"rf",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"yv = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",u:[],s:[{a:"node_out",
c:"yA",h:["float"],g:!1},{a:"node_out",c:"yB",h:["float"],g:!1},{a:"node_out",c:"yC",h:["float"],g:!1},{a:"node_out",c:"yD",h:["vec3"],g:!1},{a:"node_out",c:"yE",h:["float"],g:!1},{a:"node_out",c:"yF",h:["vec3"],g:!1},{a:"node_out",c:"yG",h:["vec3"],g:!1}],m:[{a:"txt",b:"yA = _0_0 ; yB = _0_0 ; yC = _0_0 ; yD = vec3 ( _0_0 ) ; yE = _0_0 ; yF = yD ; yG = yD ;".split(" ")}]},{a:"node",c:"HAIR_INFO",u:[],s:[{a:"node_out",c:"yH",h:["float"],g:!1},{a:"node_out",c:"yI",h:["float"],g:!1},{a:"node_out",c:"yJ",
h:["float"],g:!1},{a:"node_out",c:"yK",h:["vec3"],g:!1}],m:[{a:"txt",b:"yH = _0_0 ; yI = _0_0 ; yJ = _0_0 ; yK = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",u:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],s:[{a:"node_out",c:"yL",h:["vec3"],g:!1},{a:"node_out",c:"yM",h:["float"],g:!1},{a:"node_out",c:"yN",h:["float"],g:!1},{a:"node_out",c:"yO",h:["float"],g:!1}],
m:[{a:"node_cond",f:[{a:"node_if",i:["USE_LOCATION_OUT"],m:[{a:"txt",b:"yL = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OBJ_IND_OUT"],m:[{a:"txt",b:"yM = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MAT_IND_OUT"],m:[{a:"txt",b:"yN = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_RANDOM_OUT"],m:[{a:"txt",b:"yO = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",u:[],s:[{a:"node_in",c:"yP",h:["float"],
g:!1},{a:"node_out",c:"yQ",h:["float"],g:!1}],m:[{a:"txt",b:["yQ","=","yP",";"]}]},{a:"node",c:"TANGENT",u:[],s:[{a:"node_out",c:"yR",h:["vec3"],g:!1}],m:[{a:"txt",b:"yR = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"yS",h:["float"],g:!1},{a:"node_in",c:"yT",h:["vec3"],g:!1},{a:"node_out",c:"yU",h:["float"],g:!1},{a:"node_out",c:"yV",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:"vec3 bW = normalize ( yT ) ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 yW = normalize ( nI ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","yW","=","u_camera_direction",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yU"],m:[{a:"txt",b:"float qT = max ( _1_0 - yS , 0.00001 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",l:2}],m:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yU = qV ( yW , bW , qT ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["yU","=","_0_0",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yV"],m:[{a:"txt",b:"yV = abs ( dot ( yW , bW ) ) ; float dI = yS ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yV = pow ( yV , dI ) ; } yV = _1_0 - yV ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:["yV","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",u:[],s:[{a:"node_out",c:"yX",h:["float"],g:!1},{a:"node_out",c:"yY",h:["float"],g:!1},{a:"node_out",c:"yZ",h:["float"],g:!1},{a:"node_out",c:"y_",h:["float"],g:!1},{a:"node_out",c:"za",h:["float"],g:!1},{a:"node_out",c:"zb",h:["float"],g:!1},{a:"node_out",c:"zc",h:["float"],g:!1},{a:"node_out",c:"zd",h:["float"],g:!1},{a:"node_out",c:"ze",h:["float"],g:!1},{a:"node_out",c:"zf",h:["float"],g:!1},{a:"node_out",c:"zg",
h:["float"],g:!1}],m:[{a:"txt",b:"yX = yY = yZ = _0_0 ; y_ = za = zb = _0_0 ; zc = zg = ze = zf = _0_0 ; zd = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",u:[],s:[{a:"node_out",c:"zh",h:["vec3"],g:!1},{a:"node_out",c:"zi",h:["vec3"],g:!1},{a:"node_out",c:"zj",h:["float"],g:!1}],m:[{a:"txt",b:"zh = zi = vec3 ( _0_0 ) ; zj = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",u:[],s:[],m:[]},{a:"node",c:"CURVE_VEC",u:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zk",h:["float"],g:!1},{a:"node_in",c:"zl",h:["vec3"],g:!1},{a:"node_out",c:"zm",h:["vec3"],g:!1}],m:[{a:"txt",b:["zm","=","zl",";"]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zm . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zm . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zm . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"zm = mix ( zl , zm , zk ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",u:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zn",h:["float"],g:!1},{a:"node_in",
c:"zo",h:["vec3"],g:!1},{a:"node_out",c:"zp",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["READ_A"],m:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float r = zo . r ; float g = zo . g ; float b = zo . b ;".split(" ")}]}]},{a:"node_cond",
f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zp . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . r = r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zp . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . g = g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zp . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"zp . b = b ;".split(" ")}]}]},{a:"txt",b:"zp = mix ( zo , zp , zn ) ;".split(" ")}]},{a:"node",c:"VALTORGB",u:[{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zq",h:["float"],g:!1},{a:"node_out",c:"zr",h:["vec3"],g:!1},{a:"node_out",c:"zs",h:["float"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zq , NODE_TEX_ROW ) ) ; zr = zt . rgb ; zs = zt . a ;".split(" ")}]},{a:"node",c:"MAPPING",u:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","_1_0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","_1_0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],s:[{a:"node_in",c:"zu",h:["vec3"],g:!1},{a:"node_out",c:"zv",h:["vec3"],g:!1}],m:[{a:"txt",b:["zv","=","zu",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_SCALE_DEF"],m:[{a:"txt",b:"zv = zv * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRANS_DEF"],m:[{a:"txt",b:"zv = zv + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRS_MATRIX_DEF"],m:[{a:"txt",b:"zv = ( MAPPING_TRS_MATRIX * vec4 ( zv , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MIN_CLIP_DEF"],m:[{a:"txt",b:"zv = max ( zv , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MAX_CLIP_DEF"],m:[{a:"txt",b:"zv = min ( zv , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_IS_NORMAL"],m:[{a:"txt",b:"zv = normalize ( zv ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zA",h:["float"],g:!1},{a:"node_in",c:"zB",h:["float"],
g:!1},{a:"node_out",c:"zC",h:["float"],g:!1}],m:[{a:"txt",b:"zC = zA + zB ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zC = clamp ( zC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zD",h:["float"],g:!1},{a:"node_in",c:"zE",h:["float"],g:!1},{a:"node_out",c:"zF",h:["float"],g:!1}],m:[{a:"txt",b:"zF = zD - zE ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",
b:"zF = clamp ( zF , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zG",h:["float"],g:!1},{a:"node_in",c:"zH",h:["float"],g:!1},{a:"node_out",c:"zI",h:["float"],g:!1}],m:[{a:"txt",b:"zI = zG * zH ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zI = clamp ( zI , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zJ",
h:["float"],g:!1},{a:"node_in",c:"zK",h:["float"],g:!1},{a:"node_out",c:"zL",h:["float"],g:!1}],m:[{a:"txt",b:"zL = ( zK != _0_0 ) ? zJ / zK : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zL = clamp ( zL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zM",h:["float"],g:!1},{a:"node_in",c:"zN",h:["float"],g:!1},{a:"node_out",c:"zO",h:["float"],g:!1}],m:[{a:"txt",b:"zO = sin ( zM ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zO = clamp ( zO , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zN",";"]}]},{a:"node",c:"MATH_COSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zP",h:["float"],g:!1},{a:"node_in",c:"zQ",h:["float"],g:!1},{a:"node_out",c:"zR",h:["float"],g:!1}],m:[{a:"txt",b:"zR = cos ( zP ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zR = clamp ( zR , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["zQ",";"]}]},{a:"node",c:"MATH_TANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zS",h:["float"],g:!1},{a:"node_in",c:"zT",h:["float"],g:!1},{a:"node_out",c:"zU",h:["float"],g:!1}],m:[{a:"txt",b:"zU = tan ( zS ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zU = clamp ( zU , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zT",";"]}]},{a:"node",c:"MATH_ARCSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zV",h:["float"],
g:!1},{a:"node_in",c:"zW",h:["float"],g:!1},{a:"node_out",c:"zX",h:["float"],g:!1}],m:[{a:"txt",b:"zX = ( zV <= _1_0 && zV >= - _1_0 ) ? asin ( zV ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zX = clamp ( zX , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zW",";"]}]},{a:"node",c:"MATH_ARCCOSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zY",h:["float"],g:!1},{a:"node_in",c:"zZ",h:["float"],g:!1},{a:"node_out",c:"z_",h:["float"],
g:!1}],m:[{a:"txt",b:"z_ = ( zY <= _1_0 && zY >= - _1_0 ) ? acos ( zY ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zZ",";"]}]},{a:"node",c:"MATH_ARCTANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Aa",h:["float"],g:!1},{a:"node_in",c:"Ab",h:["float"],g:!1},{a:"node_out",c:"Ac",h:["float"],g:!1}],m:[{a:"txt",b:"Ac = atan ( Aa ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ac = clamp ( Ac , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ab",";"]}]},{a:"node",c:"MATH_POWER",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ad",h:["float"],g:!1},{a:"node_in",c:"Ae",h:["float"],g:!1},{a:"node_out",c:"Af",h:["float"],g:!1}],m:[{a:"txt",b:"if ( Ad < _0_0 && Ae != floor ( Ae ) ) Af = _0_0 ; else if ( Ae == _0_0 ) Af = _1_0 ; else if ( Ad < _0_0 ) Af = mix ( _1_0 , - _1_0 , sign ( mod ( - Ae , 2.0 ) ) ) * pow ( - Ad , Ae ) ; else if ( Ad == _0_0 ) Af = _0_0 ; else Af = pow ( Ad , Ae ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Af = clamp ( Af , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ag",h:["float"],g:!1},{a:"node_in",c:"Ah",h:["float"],g:!1},{a:"node_out",c:"Ai",h:["float"],g:!1}],m:[{a:"txt",b:"Ai = ( Ag > _0_0 && Ah > _0_0 ) ? log2 ( Ag ) / log2 ( Ah ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ai = clamp ( Ai , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Aj",h:["float"],g:!1},{a:"node_in",c:"Ak",h:["float"],g:!1},{a:"node_out",c:"Al",h:["float"],g:!1}],m:[{a:"txt",b:"Al = min ( Aj , Ak ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Am",h:["float"],g:!1},{a:"node_in",c:"An",h:["float"],
g:!1},{a:"node_out",c:"Ao",h:["float"],g:!1}],m:[{a:"txt",b:"Ao = max ( Am , An ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ao = clamp ( Ao , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ap",h:["float"],g:!1},{a:"node_in",c:"Aq",h:["float"],g:!1},{a:"node_out",c:"Ar",h:["float"],g:!1}],m:[{a:"txt",b:"Ar = floor ( Ap + _0_5 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"Ar = clamp ( Ar , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Aq",";"]}]},{a:"node",c:"MATH_LESS_THAN",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"As",h:["float"],g:!1},{a:"node_in",c:"At",h:["float"],g:!1},{a:"node_out",c:"Au",h:["float"],g:!1}],m:[{a:"txt",b:"Au = ( As < At ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",u:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Av",h:["float"],g:!1},{a:"node_in",c:"Aw",h:["float"],g:!1},{a:"node_out",c:"Ax",h:["float"],g:!1}],m:[{a:"txt",b:"Ax = ( Av > Aw ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ax = clamp ( Ax , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ay",h:["float"],g:!1},{a:"node_in",c:"Az",h:["float"],g:!1},{a:"node_out",c:"AA",
h:["float"],g:!1}],m:[{a:"txt",b:"AA = abs ( Az ) > 0.000001 ? mod ( Ay , Az ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AA = clamp ( AA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AB",h:["float"],g:!1},{a:"node_in",c:"AC",h:["float"],g:!1},{a:"node_out",c:"AD",h:["float"],g:!1}],m:[{a:"txt",b:"AD = abs ( AB ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"AD = clamp ( AD , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AC",";"]}]},{a:"node",c:"MIX_RGB_MIX",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AE",h:["float"],g:!1},{a:"node_in",c:"AF",h:["vec3"],g:!1},{a:"node_in",c:"AG",h:["vec3"],g:!1},{a:"node_out",c:"AH",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AE , _0_0 , _1_0 ) ; AH = mix ( AF , AG , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AH = clamp ( AH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AI",h:["float"],g:!1},{a:"node_in",c:"AJ",h:["vec3"],g:!1},{a:"node_in",c:"AK",h:["vec3"],g:!1},{a:"node_out",c:"AL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AI , _0_0 , _1_0 ) ; AL = mix ( AJ , AJ + AK , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AL = clamp ( AL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",u:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AM",h:["float"],g:!1},{a:"node_in",c:"AN",h:["vec3"],g:!1},{a:"node_in",c:"AO",h:["vec3"],g:!1},{a:"node_out",c:"AP",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AM , _0_0 , _1_0 ) ; AP = mix ( AN , AN * AO , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",
c:"AQ",h:["float"],g:!1},{a:"node_in",c:"AR",h:["vec3"],g:!1},{a:"node_in",c:"AS",h:["vec3"],g:!1},{a:"node_out",c:"AT",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AQ , _0_0 , _1_0 ) ; AT = mix ( AR , AR - AS , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AT = clamp ( AT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AU",h:["float"],g:!1},{a:"node_in",c:"AV",
h:["vec3"],g:!1},{a:"node_in",c:"AW",h:["vec3"],g:!1},{a:"node_out",c:"AX",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AU , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; AX = vec3 ( _1_0 ) - ( vec3 ( AY ) + yl * ( vec3 ( _1_0 ) - AW ) ) * ( vec3 ( _1_0 ) - AV ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AX = clamp ( AX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AZ",
h:["float"],g:!1},{a:"node_in",c:"A_",h:["vec3"],g:!1},{a:"node_in",c:"Ba",h:["vec3"],g:!1},{a:"node_out",c:"Bb",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AZ , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; Ba += step ( Ba , vec3 ( _0_0 ) ) ; Bb = AY * A_ + yl * A_ / Ba ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bb = clamp ( Bb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",
c:"Bc",h:["float"],g:!1},{a:"node_in",c:"Bd",h:["vec3"],g:!1},{a:"node_in",c:"Be",h:["vec3"],g:!1},{a:"node_out",c:"Bf",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bc , _0_0 , _1_0 ) ; Bf = mix ( Bd , abs ( Bd - Be ) , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bf = clamp ( Bf , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bg",h:["float"],g:!1},{a:"node_in",
c:"Bh",h:["vec3"],g:!1},{a:"node_in",c:"Bi",h:["vec3"],g:!1},{a:"node_out",c:"Bj",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bg , _0_0 , _1_0 ) ; Bj = min ( Bh . rgb , Bi . rgb * yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bj = clamp ( Bj , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bk",h:["float"],g:!1},{a:"node_in",c:"Bl",h:["vec3"],g:!1},{a:"node_in",
c:"Bm",h:["vec3"],g:!1},{a:"node_out",c:"Bn",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bk , _0_0 , _1_0 ) ; Bn = max ( Bl . rgb , Bm . rgb * yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bn = clamp ( Bn , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bo",h:["float"],g:!1},{a:"node_in",c:"Bp",h:["vec3"],g:!1},{a:"node_in",c:"Bq",h:["vec3"],g:!1},{a:"node_out",
c:"Br",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bo , _0_0 , _1_0 ) ; vec3 Bs = vec3 ( _1_0 - yl ) ; Br = mix ( Bp * ( Bs + 2.0 * yl * Bq ) , vec3 ( _1_0 ) - ( Bs + 2.0 * yl * ( vec3 ( _1_0 ) - Bq ) ) * ( vec3 ( _1_0 ) - Bp ) , step ( _0_5 , Bp ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Br = clamp ( Br , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bt",h:["float"],
g:!1},{a:"node_in",c:"Bu",h:["vec3"],g:!1},{a:"node_in",c:"Bv",h:["vec3"],g:!1},{a:"node_out",c:"Bw",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bt , _0_0 , _1_0 ) ; vec3 Bx = vec3 ( _1_0 ) - yl * Bv ; vec3 By = clamp ( Bu / Bx , _0_0 , _1_0 ) ; Bw = mix ( mix ( By , vec3 ( _1_0 ) , step ( Bx , vec3 ( _0_0 ) ) ) , Bu , step ( Bu , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bw = clamp ( Bw , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bz",h:["float"],g:!1},{a:"node_in",c:"BA",h:["vec3"],g:!1},{a:"node_in",c:"BB",h:["vec3"],g:!1},{a:"node_out",c:"BC",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bz , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - yl ) ; vec3 Bx = jH + yl * BB ; vec3 By = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - BA ) / Bx , _0_0 , _1_0 ) ; BC = mix ( By , vec3 ( _0_0 ) , step ( Bx , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BC = clamp ( BC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BD",h:["float"],g:!1},{a:"node_in",c:"BE",h:["vec3"],g:!1},{a:"node_in",c:"BF",h:["vec3"],g:!1},{a:"node_out",c:"BG",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BD , _0_0 , _1_0 ) ; vec3 jz , BH , Bx ; BG = BE ; BH = jy ( BF ) ; if ( BH . y != _0_0 ) { jz = jy ( BG ) ; jz . x = BH . x ; Bx = jA ( jz ) ; BG = mix ( BG , Bx , yl ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BG = clamp ( BG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BI",h:["float"],g:!1},{a:"node_in",c:"BJ",h:["vec3"],g:!1},{a:"node_in",c:"BK",h:["vec3"],g:!1},{a:"node_out",c:"BL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BI , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; BL = BJ ; vec3 jz , BH ; jz = jy ( BL ) ; if ( jz . y != _0_0 ) { BH = jy ( BK ) ; jz . y = AY * jz . y + yl * BH . y ; BL = jA ( jz ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BL = clamp ( BL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BM",h:["float"],g:!1},{a:"node_in",c:"BN",h:["vec3"],g:!1},{a:"node_in",c:"BO",h:["vec3"],g:!1},{a:"node_out",c:"BP",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BM , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; vec3 jz , BH ; jz = jy ( BN ) ; BH = jy ( BO ) ; jz . z = AY * jz . z + yl * BH . z ; BP = jA ( jz ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BP = clamp ( BP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BQ",h:["float"],g:!1},{a:"node_in",c:"BR",h:["vec3"],g:!1},{a:"node_in",c:"BS",h:["vec3"],g:!1},{a:"node_out",c:"BT",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BQ , _0_0 , _1_0 ) ; vec3 jz , BH , Bx ; BT = BR ; BH = jy ( BS ) ; if ( BH . y != _0_0 ) { jz = jy ( BT ) ; jz . x = BH . x ; jz . y = BH . y ; Bx = jA ( jz ) ; BT = mix ( BT , Bx , yl ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BT = clamp ( BT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BU",h:["float"],g:!1},{a:"node_in",c:"BV",h:["vec3"],g:!1},{a:"node_in",c:"BW",h:["vec3"],g:!1},{a:"node_out",c:"BX",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BU , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; vec3 BY = BW + BV - BW * BV ; BX = BV * ( vec3 ( AY ) + vec3 ( yl ) * ( ( vec3 ( _1_0 ) - BV ) * BW + BY ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BX = clamp ( BX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BZ",h:["float"],g:!1},{a:"node_in",c:"B_",h:["vec3"],g:!1},{a:"node_in",c:"Ca",h:["vec3"],g:!1},{a:"node_out",c:"Cb",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BZ , _0_0 , _1_0 ) ; Cb = B_ + yl * ( 2.0 * Ca - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cb = clamp ( Cb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",u:[],s:[{a:"node_in",c:"Cc",h:["vec3"],g:!1},{a:"node_in",c:"Cd",h:["float"],g:!1}],m:[{a:"txt",b:"D = Cc ; H = Cd ;".split(" ")}]},{a:"node",c:"OUTPUT_SURFACE",u:[],s:[{a:"node_in",c:"Ce",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = Ce ; H = _1_0 ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",
c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],s:[{a:"node_in",c:"Cf",h:["vec3"],g:!1},{a:"node_in",c:"Cg",h:["vec3"],g:!1},{a:"node_in",c:"Ch",h:["float"],g:!1},{a:"node_in",c:"Ci",h:["vec3"],g:!0},{a:"node_in",c:"Cj",h:["float"],g:!0},{a:"node_out",c:"Ck",h:["vec3"],g:!1},{a:"node_out",c:"Cl",h:["vec3"],g:!1},{a:"node_out",c:"Cm",h:["vec3"],g:!1},{a:"node_out",c:"Cn",h:["vec3"],g:!1},{a:"node_out",c:"Co",h:["vec3"],g:!1},{a:"node_out",c:"Cp",h:["vec2"],g:!1},{a:"node_out",
c:"Cq",h:["vec2"],g:!1},{a:"node_out",c:"Cr",h:["vec4"],g:!1},{a:"node_param",c:"rh",h:["const","vec2"],g:!1},{a:"node_param",c:"ri",h:["const","vec3"],g:!1}],m:[{a:"txt",b:"Cm = clamp ( Cf , _0_0 , _1_0 ) ; Cn = ri [ 0 ] * clamp ( Cg , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_NORMAL"],m:[{a:"txt",b:"Co = normalize ( Ci ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["Co","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SHADELESS_MAT",{a:"logic_negative_expr",
l:1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"txt",b:"Ck = Cj * Cm ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Ck = ro * Cm ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:["Cm","*=","Ch",";"]}]}]},{a:"txt",b:"Cl = rp * u_environment_energy * ce ( Co ) ; Cr = ch ( Cm ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],m:[{a:"txt",b:"Cp = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; Cq = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","Cr",";"]}]},{a:"node_else",m:[{a:"txt",b:"Ck = vec3 ( _0_0 ) ; Cl = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],s:[{a:"node_in",c:"Cs",h:["vec4"],g:!1},{a:"node_in",c:"Ct",h:["vec3"],g:!1},{a:"node_in",c:"Cu",h:["vec3"],g:!1},{a:"node_in",c:"Cv",h:["float"],g:!0},{a:"node_in",c:"Cw",h:["float"],g:!0},{a:"node_in",c:"Cx",
h:["float"],g:!0},{a:"node_out",c:"Cy",h:["vec3"],g:!0},{a:"node_out",c:"Cz",h:["float"],g:!0},{a:"node_out",c:"CA",h:["vec3"],g:!0},{a:"node_out",c:"CB",h:["vec3"],g:!0},{a:"node_out",c:"CC",h:["vec3"],g:!0},{a:"node_param",c:"rj",h:["float"],g:!1},{a:"node_param",c:"rk",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cy"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:"Cy = Cs . rgb ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Cy = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",l:2},{a:"logical_and_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"cq ( Cy , nI , Cu , Cv , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"cq ( Cy , nI , Cu , Cv , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["Cy","+=","Ct",";"]}]}]}]}]},{a:"node_cond",
f:[{a:"node_if",i:["USE_OUT_CA"],m:[{a:"txt",b:["CA","=","Cu",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CB"],m:[{a:"txt",b:"CB = Cs . rgb ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CC"],m:[{a:"txt",b:["CC","=","Ct",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cz"],m:[{a:"txt",b:"Cz = clamp ( Cx , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( Ct . r , Ct . g ) , Ct . b ) * Cw ; Cz = clamp ( Cx * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cz"],m:[{a:"txt",b:"Cz = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( Ct . r , Ct . g ) , Ct . b ) * rk ; Cz = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["E","=","Ct",";"]}]},{a:"node_else",m:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","Cu",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"nZ",h:["vec3"],g:!1},{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_out",c:"ob",h:["vec4"],g:!1},{a:"node_out",c:"oc",h:["vec3"],g:!1}],m:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],s:[{a:"node_in",c:"od",h:["vec4"],g:!1},{a:"node_out",c:"oe",h:["vec3"],g:!1},{a:"node_out",c:"of",h:["vec2"],g:!1},{a:"node_out",c:"og",h:["vec3"],g:!1},{a:"node_out",c:"oh",h:["float"],g:!1}],m:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",
l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",m:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"om",h:["vec3"],g:!1},{a:"node_in",c:"on",h:["vec2"],g:!1},{a:"node_in",c:"oo",h:["vec3"],g:!1},{a:"node_in",c:"op",h:["float"],g:!1},{a:"node_in",c:"oq",h:["vec2"],
g:!1},{a:"node_out",c:"or",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ou",h:["vec3"],g:!1},{a:"node_in",c:"ov",h:["vec2"],g:!1},{a:"node_in",c:"ow",h:["vec3"],g:!1},{a:"node_in",c:"ox",h:["float"],g:!1},{a:"node_out",c:"oy",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oz",h:["vec3"],g:!1},{a:"node_in",c:"oA",h:["vec2"],g:!1},{a:"node_in",c:"oB",h:["vec3"],g:!1},{a:"node_in",c:"oC",h:["float"],g:!1},{a:"node_in",c:"oD",h:["vec2"],g:!1},{a:"node_out",c:"oE",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oO",h:["vec3"],g:!1},{a:"node_in",c:"oP",h:["vec2"],g:!1},{a:"node_in",c:"oQ",h:["vec3"],g:!1},{a:"node_in",c:"oR",h:["float"],g:!1},{a:"node_in",c:"oS",h:["vec2"],g:!1},{a:"node_out",c:"oT",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oU",h:["vec3"],g:!1},{a:"node_in",c:"oV",h:["vec2"],g:!1},{a:"node_in",c:"oW",h:["vec3"],
g:!1},{a:"node_in",c:"oX",h:["float"],g:!1},{a:"node_in",c:"oY",h:["vec2"],g:!1},{a:"node_out",c:"oZ",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pa",h:["vec3"],g:!1},{a:"node_in",c:"pb",h:["vec2"],g:!1},{a:"node_in",c:"pc",h:["vec3"],g:!1},{a:"node_in",c:"pd",h:["float"],g:!1},{a:"node_in",c:"pe",h:["vec2"],g:!1},{a:"node_out",c:"pf",h:["float"],g:!1}],m:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ph",h:["vec3"],g:!1},{a:"node_in",c:"pi",h:["vec2"],g:!1},{a:"node_in",c:"pj",h:["vec3"],g:!1},{a:"node_in",c:"pk",h:["float"],g:!1},{a:"node_in",c:"pl",h:["vec2"],g:!1},{a:"node_out",c:"pm",h:["float"],g:!1}],m:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pn",h:["vec3"],g:!1},{a:"node_in",c:"po",h:["vec2"],g:!1},{a:"node_in",c:"pr",h:["vec3"],g:!1},{a:"node_in",c:"pu",h:["float"],g:!1},{a:"node_in",c:"pv",h:["vec2"],g:!1},{a:"node_out",c:"pw",h:["float"],g:!1}],m:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pz",h:["vec3"],g:!1},{a:"node_in",c:"pA",h:["vec2"],g:!1},{a:"node_in",c:"pB",h:["vec3"],g:!1},{a:"node_in",c:"pC",h:["float"],g:!1},{a:"node_in",c:"pD",h:["vec2"],g:!1},{a:"node_out",c:"pE",h:["float"],
g:!1}],m:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pG",h:["vec3"],g:!1},{a:"node_in",c:"pH",h:["vec2"],g:!1},{a:"node_in",c:"pI",h:["vec3"],g:!1},{a:"node_in",c:"pJ",h:["float"],g:!1},{a:"node_in",c:"pK",h:["vec2"],g:!1},{a:"node_out",c:"pL",h:["float"],g:!1}],m:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < _1_0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( _1_0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pQ",h:["vec4"],g:!1},{a:"node_in",c:"pR",h:["vec3"],g:!1},{a:"node_in",c:"pS",h:["float"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["vec3"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec4"],g:!1},{a:"node_in",c:"pX",h:["vec3"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["float"],g:!1},{a:"node_out",c:"qa",h:["vec4"],g:!1},{a:"node_out",c:"qb",
h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_B4W_TRANSLUCENCY"],m:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float CD = pW . x ; float CE = pW . y ; float CF = pW . z ; float CG = pW . w ; float CH = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float CI = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float CJ = pow ( CI , CE ) ; qa = pQ + p_ * vec4 ( pZ * CH * pow ( pX , vec3 ( CD ) ) , _1_0 ) ; qa += CF * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , CG ) * p_ * vec4 ( pZ * CH * vec3 ( CJ ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",u:[{a:"node_var",c:"RGB_IND",b:["0"]}],s:[{a:"node_out",c:"CK",h:["vec3"],g:!1}],m:[{a:"txt",b:"CK = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",u:[],s:[{a:"node_in",c:"CL",h:["vec3"],g:!1},{a:"node_out",c:"CM",h:["float"],g:!1}],m:[{a:"txt",b:"CM = dot ( CL , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",u:[],s:[{a:"node_in",c:"CN",
h:["vec3"],g:!1},{a:"node_out",c:"CO",h:["float"],g:!0},{a:"node_out",c:"CP",h:["float"],g:!0},{a:"node_out",c:"CQ",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CO"],m:[{a:"txt",b:"CO = CN . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CP"],m:[{a:"txt",b:"CP = CN . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CQ"],m:[{a:"txt",b:"CQ = CN . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",u:[],s:[{a:"node_in",c:"CR",h:["vec3"],g:!1},{a:"node_out",
c:"CS",h:["float"],g:!0},{a:"node_out",c:"CT",h:["float"],g:!0},{a:"node_out",c:"CU",h:["float"],g:!0}],m:[{a:"txt",b:"vec3 CV = jy ( CR ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CS"],m:[{a:"txt",b:"CS = CV . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CT"],m:[{a:"txt",b:"CT = CV . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CU"],m:[{a:"txt",b:"CU = CV . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",u:[],s:[{a:"node_in",c:"CW",h:["float"],g:!1},
{a:"node_in",c:"CX",h:["float"],g:!1},{a:"node_in",c:"CY",h:["float"],g:!1},{a:"node_out",c:"CZ",h:["float"],g:!1}],m:[{a:"txt",b:"CZ = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( CW - CY ) * CX ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",u:[],s:[{a:"node_in",c:"C_",h:["vec3"],g:!1},{a:"node_in",c:"Da",h:["float"],g:!1},{a:"node_out",c:"Db",h:["vec3"],g:!1}],m:[{a:"txt",b:"Db = C_ ; if ( Db . x > _0_0 ) Db . x = pow ( C_ . x , Da ) ; if ( Db . y > _0_0 ) Db . y = pow ( C_ . y , Da ) ; if ( Db . z > _0_0 ) Db . z = pow ( C_ . z , Da ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",u:[],s:[{a:"node_in",c:"Dc",h:["vec3"],g:!1},{a:"node_out",c:"Dd",h:["vec3"],g:!1}],m:[{a:"txt",b:"Dd = max ( vec3 ( _0_0 ) , Dc ) ; Dd = pow ( Dd , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",u:[],s:[{a:"node_in",c:"De",h:["vec3"],g:!1},{a:"node_out",c:"Df",h:["vec3"],g:!1}],m:[{a:"txt",b:"Df = max ( vec3 ( _0_0 ) , De ) ; Df = pow ( Df , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",u:[],s:[{a:"node_out",c:"Dg",h:["vec3"],
g:!1},{a:"node_out",c:"Dh",h:["vec3"],g:!1},{a:"node_out",c:"Di",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dg"],m:[{a:"txt",b:"Dg [ 2 ] = Dg [ 1 ] = Dg [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dh"],m:[{a:"txt",b:"Dh [ 2 ] = Dh [ 1 ] = Dh [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Di"],m:[{a:"txt",b:["Di","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",u:[],s:[{a:"node_in",c:"Dj",h:["vec3"],g:!1},{a:"node_out",
c:"Dk",h:["vec3"],g:!0},{a:"node_out",c:"Dl",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",h:["uniform","samplerCube"],g:!1}],m:[{a:"txt",b:"vec3 Dm = vec3 ( Dj . x , Dj . y , Dj . z ) ; vec4 zt = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , Dm ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dk"],m:[{a:"txt",b:"Dk = zt . xyz ; bY ( Dk ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dl"],m:[{a:"txt",b:"Dl = zt . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",u:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Dn",h:["vec3"],g:!0},{a:"node_in",c:"Do",h:["vec3"],g:!0},{a:"node_in",c:"Dp",h:["vec3"],g:!0},{a:"node_in",c:"Dq",h:["vec3"],g:!0},{a:"node_out",c:"Dr",h:["vec3"],g:!0},{a:"node_out",c:"Ds",h:["float"],g:!0},{a:"node_out",c:"Dt",h:["vec3"],g:!0},{a:"node_out",c:"Du",h:["float"],
g:!0},{a:"node_out",c:"Dv",h:["vec3"],g:!0},{a:"node_out",c:"Dw",h:["float"],g:!0},{a:"node_out",c:"Dx",h:["vec3"],g:!0},{a:"node_out",c:"Dy",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dn ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , Dn . xy ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dr"],m:[{a:"txt",b:"Dr = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dr",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ds"],m:[{a:"txt",b:"Ds = zt . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Do ) ) ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , Do . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dt"],m:[{a:"txt",b:"Dt = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dt",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Du"],m:[{a:"txt",b:"Du = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"node_cond",f:[{a:"node_if",
i:["CONVERT_UV"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dp ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , Dp . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dv"],m:[{a:"txt",b:"Dv = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dv",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dw"],m:[{a:"txt",
b:"Dw = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dq ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , Dq . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dx"],m:[{a:"txt",b:"Dx = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",
l:1}],m:[{a:"txt",b:["bY","(","Dx",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dy"],m:[{a:"txt",b:"Dy = zt . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",u:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Dz",h:["vec3"],g:!0},{a:"node_in",c:"DA",h:["vec3"],g:!0},{a:"node_in",c:"DB",h:["vec3"],g:!0},{a:"node_in",c:"DC",h:["vec3"],g:!0},{a:"node_out",c:"DD",h:["vec3"],g:!0},{a:"node_out",c:"DE",
h:["float"],g:!0},{a:"node_out",c:"DF",h:["vec3"],g:!0},{a:"node_out",c:"DG",h:["float"],g:!0},{a:"node_out",c:"DH",h:["vec3"],g:!0},{a:"node_out",c:"DI",h:["float"],g:!0},{a:"node_out",c:"DJ",h:["vec3"],g:!0},{a:"node_out",c:"DK",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( Dz ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DD"],m:[{a:"txt",b:"DD = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DE"],m:[{a:"txt",b:"DE = zt . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DA ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DF"],m:[{a:"txt",b:"DF = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DG"],m:[{a:"txt",b:"DG = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],
m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DB ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DH"],m:[{a:"txt",b:"DH = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DI"],m:[{a:"txt",b:"DI = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DC ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DJ"],
m:[{a:"txt",b:"DJ = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DK"],m:[{a:"txt",b:"DK = zt . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",u:[{a:"node_var",c:"VALUE_IND",b:["0"]}],s:[{a:"node_out",c:"DL",h:["float"],g:!1}],m:[{a:"txt",b:"DL = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",u:[],s:[{a:"node_in",c:"DM",h:["vec3"],g:!1},{a:"node_in",c:"DN",h:["vec3"],g:!1},{a:"node_out",c:"DO",h:["vec3"],g:!1},{a:"node_out",
c:"DP",h:["float"],g:!0}],m:[{a:"txt",b:"DO = DM + DN ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DP"],m:[{a:"txt",b:"DP = ( abs ( DO [ 0 ] ) + abs ( DO [ 1 ] ) + abs ( DO [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",u:[],s:[{a:"node_in",c:"DQ",h:["vec3"],g:!1},{a:"node_in",c:"DR",h:["vec3"],g:!1},{a:"node_out",c:"DS",h:["vec3"],g:!1},{a:"node_out",c:"DT",h:["float"],g:!0}],m:[{a:"txt",b:"DS = DQ - DR ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DT"],
m:[{a:"txt",b:"DT = ( abs ( DS [ 0 ] ) + abs ( DS [ 1 ] ) + abs ( DS [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",u:[],s:[{a:"node_in",c:"DU",h:["vec3"],g:!1},{a:"node_in",c:"DV",h:["vec3"],g:!1},{a:"node_out",c:"DW",h:["vec3"],g:!1},{a:"node_out",c:"DX",h:["float"],g:!0}],m:[{a:"txt",b:"DW = DU + DV ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DX"],m:[{a:"txt",b:"DX = length ( DW ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DW"],m:[{a:"txt",
b:"DW = normalize ( DW ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",u:[],s:[{a:"node_in",c:"DY",h:["vec3"],g:!1},{a:"node_in",c:"DZ",h:["vec3"],g:!1},{a:"node_out",c:"D_",h:["vec3"],g:!1},{a:"node_out",c:"Ea",h:["float"],g:!0}],m:[{a:"txt",b:"D_ = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ea"],m:[{a:"txt",b:"Ea = dot ( DY , DZ ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",u:[],s:[{a:"node_in",c:"Eb",h:["vec3"],g:!1},{a:"node_in",c:"Ec",h:["vec3"],
g:!1},{a:"node_out",c:"Ed",h:["vec3"],g:!1},{a:"node_out",c:"Ee",h:["float"],g:!0}],m:[{a:"txt",b:"Ed = cross ( Eb , Ec ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ee"],m:[{a:"txt",b:"Ee = length ( Ed ) ; Ed /= Ee ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Ed = normalize ( Ed ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",u:[],s:[{a:"node_in",c:"Ef",h:["vec3"],g:!1},{a:"node_in",c:"Eg",h:["vec3"],g:!1},{a:"node_out",c:"Eh",h:["vec3"],g:!1},{a:"node_out",c:"Ei",h:["float"],
g:!0}],m:[{a:"txt",b:"Eh = normalize ( Ef ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ei"],m:[{a:"txt",b:"Ei = length ( Ef ) ;".split(" ")}]}]},{a:"txt",b:["Eg",";"]}]},{a:"node",c:"FRESNEL",u:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],s:[{a:"node_in",c:"Ej",h:["float"],g:!1},{a:"node_in",c:"Ek",h:["vec3"],g:!1},{a:"node_out",c:"El",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_FRESNEL_NORMAL"],m:[{a:"txt",b:"vec3 bW = normalize ( Ek ) ;".split(" ")}]},{a:"node_else",
m:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 yW = normalize ( nI ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","yW","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( Ej , 0.00001 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
m:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"El = qV ( yW , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",u:[],s:[{a:"node_in",c:"Em",h:["vec3"],g:!1},{a:"node_in",c:"En",h:["vec3"],g:!1},{a:"node_out",c:"Eo",h:["vec3"],g:!1}],m:[{a:"txt",b:"Eo = reflect ( T ( u_view_tsr_inverse , Em ) , En ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",u:[],s:[{a:"node_in",c:"Ep",h:["vec3"],g:!1},{a:"node_out",c:"Eq",h:["vec3"],g:!1}],m:[{a:"txt",b:"Eq = reflect ( - nI . xyz , Ep ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",u:[],s:[{a:"node_in",c:"Er",h:["vec3"],g:!1},{a:"node_in",c:"Es",h:["float"],g:!1},{a:"node_in",c:"Et",h:["const","float"],g:!1},{a:"node_in",c:"Eu",h:["const","float"],g:!1},{a:"node_out",c:"Ev",h:["vec3"],g:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < Eu ) { vec2 bE = qQ ( Er ) ; float bI = clamp ( _0_5 * ( Eu - bp ) , _0_0 , _1_0 ) ; float hk = Es * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / Et ; vec2 bM = bK . xy * hk / ( Et * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = _1_0 ; bQ <= Et ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; Ev = qP ( bE ) ; } else Ev = Er ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",u:[],s:[{a:"node_in",c:"Ew",h:["vec3"],g:!1},{a:"node_out",c:"Ex",h:["vec3"],g:!1}],m:[{a:"txt",b:"Ex = clamp ( Ew , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",u:[],s:[{a:"node_in",c:"Ey",h:["vec3"],g:!1},{a:"node_in",c:"Ez",h:["float"],g:!1},{a:"node_out",c:"EA",h:["vec3"],g:!1}],m:[{a:"txt",b:"EA = qO ( Ey , Ez ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",u:[],s:[{a:"node_in",c:"EB",h:["float"],g:!1},{a:"node_in",c:"EC",h:["float"],g:!1},{a:"node_in",
c:"ED",h:["float"],g:!1},{a:"node_in",c:"EE",h:["float"],g:!1},{a:"node_in",c:"EF",h:["float"],g:!1},{a:"node_out",c:"EG",h:["float"],g:!0},{a:"node_out",c:"EH",h:["vec4"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EG"],m:[{a:"txt",b:["EG","=","EB",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EH"],m:[{a:"txt",b:"EH = vec4 ( EC , ED , EE , EF ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",u:[],s:[{a:"node_out",c:"EI",h:["float"],g:!1}],m:[{a:"txt",b:["EI","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",u:[],s:[{a:"node_in",c:"EJ",h:["float"],g:!1},{a:"node_in",c:"EK",h:["float"],g:!1},{a:"node_in",c:"EL",h:["float"],g:!1},{a:"node_out",c:"EM",h:["float"],g:!1}],m:[{a:"txt",b:"EM = smoothstep ( EK , EL , EJ ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",u:[],s:[{a:"node_in",c:"EN",h:["vec3"],g:!1},{a:"node_in",c:"EO",h:["float"],g:!1}],m:[{a:"txt",b:"D = EN ; H = EO ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",u:[],s:[{a:"node_in",c:"EP",h:["vec3"],g:!1},{a:"node_out",c:"EQ",
h:["float"],g:!1}],m:[{a:"txt",b:"EQ = ( EP . r + EP . g + EP . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",u:[],s:[{a:"node_in",c:"ER",h:["float"],g:!1},{a:"node_out",c:"ES",h:["vec3"],g:!1}],m:[{a:"txt",b:"ES [ 0 ] = ER ; ES [ 1 ] = ER ; ES [ 2 ] = ER ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_NO"],j:{a:"grp",f:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"NODES_GLSLV",j:{a:"grp",f:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2},"PARTICLE_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"re",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rd",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_param",c:"node_UVMAP_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rf",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"qW",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",h:["GLSL_IN","vec3"],g:!1},{a:"node_param",c:"ET",h:["GLSL_OUT","vec3"],g:!1}],m:[{a:"txt",b:["ET","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",h:["GLSL_IN","float"],g:!1},{a:"node_param",
c:"EU",h:["GLSL_OUT","float"],g:!1}],m:[{a:"txt",b:["EU","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"EV",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["EV","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",h:["GLSL_IN","vec3"],g:!1},{a:"node_param",c:"EW",h:["GLSL_OUT",
"vec3"],g:!1}],m:[{a:"txt",b:["EW","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PACK_GLSLF",j:{a:"grp",f:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 EX = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * EX ; return iS ; } float cv ( const in vec4 EY ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( EY , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 EX = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * EX . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 EZ ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( EZ . rg , eG ) ; gJ . g = dot ( EZ . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_GLSLV",j:{a:"grp",f:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",A:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],
j:{a:"grp",f:[{a:"txt",b:"void Fc ( inout vec3 aG , float E_ , vec4 js , vec4 jt ) { float Fa = jt . x - js . x ; float Fb = ( E_ - js . x ) / Fa ; aG = mix ( aG , jt . yzw , clamp ( Fb , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Ff ( float t , float Fd , vec4 Fe [ COLOR_RAMP_LENGTH ] ) { float E_ = t / Fd ; vec3 aG = Fe [ 0 ] . yzw ;".split(" ")},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",1,{a:"g_expr",l:2}],
j:{a:"grp",f:[{a:"txt",b:"Fc ( aG , E_ , Fe [ 0 ] , Fe [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Fc ( aG , E_ , Fe [ 1 ] , Fe [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Fc ( aG , E_ , Fe [ 2 ] , Fe [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float Fl ( float t , float Fd , float Fg , float Fh ) { float Fi = max ( 0.01 , min ( Fd , Fg ) ) ; float Fj = max ( 0.01 , min ( Fd , Fh ) ) ; float Fk = Fd - Fj ; float J = clamp ( t / Fi , 0.0 , 1.0 ) - step ( Fk , t ) * ( t - Fk ) / Fj ; return J ; } cD cE ( ) { cD sp ; float t ; float Fd = a_p_data [ 0 ] ; float Fm = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - Fm ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - Fm ; } if ( t < 0.0 || t >= Fd ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Fd ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WORLD_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Fn = u_p_nfactor * qS ; Fn += a_p_vels . xyz ; Fn . z -= u_p_gravity * t / 2.0 ; float Fo = max ( u_p_mass , EPSILON ) ; Fn += ( u_p_wind_fac * u_wind / Fo ) * t / 2.0 ; sp . cU = t ; sp . cS = Fn ; sp . cT = bz * a_p_vels . w ; sp . N = eD + Fn * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",f:[{a:"if",i:["USE_COLOR_RAMP"],j:{a:"grp",f:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"sp . aG = Ff ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = Fl ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",j:{a:"grp",f:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",l:2}],j:{a:"grp",
f:[{a:"include",A:"environment.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
u:[],s:[{a:"node_out",c:"rq",h:["vec3"],g:!0},{a:"node_out",c:"rs",h:["float"],g:!0},{a:"node_out",c:"rt",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rq"],m:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rs"],m:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rt"],m:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",u:[],s:[{a:"node_in",c:"ru",h:["float"],
g:!1},{a:"node_in",c:"rv",h:["float"],g:!1},{a:"node_in",c:"rw",h:["float"],g:!1},{a:"node_out",c:"rx",h:["vec3"],g:!1}],m:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",u:[],s:[{a:"node_in",c:"ry",h:["float"],g:!1},{a:"node_in",c:"rz",h:["float"],g:!1},{a:"node_in",c:"rA",h:["float"],g:!1},{a:"node_out",c:"rB",h:["vec3"],g:!1}],m:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",u:[],s:[{a:"node_out",c:"rC",h:["vec3"],g:!1}],m:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",u:[],s:[{a:"node_out",c:"rD",h:["vec3"],g:!1}],m:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_out",c:"rE",h:["vec3"],g:!1}],m:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",u:[],s:[{a:"node_out",c:"rF",h:["vec3"],g:!1}],m:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",u:[],s:[{a:"node_out",c:"rG",
h:["vec3"],g:!1}],m:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_out",c:"rH",h:["float"],g:!1}],m:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_out",c:"rI",h:["float"],g:!1},{a:"node_out",c:"rJ",h:["float"],g:!1}],m:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_out",c:"rK",h:["float"],g:!1},{a:"node_out",c:"rL",h:["float"],g:!1},{a:"node_out",c:"rM",h:["float"],g:!1}],
m:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"rN",h:["vec3"],g:!1},{a:"node_out",c:"rO",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["rO","=","rN",";"]}]},{a:"node_else",m:[{a:"txt",b:"rO = rl . xyz ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_FB",u:[],s:[{a:"node_out",c:"rP",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",u:[],s:[{a:"node_out",c:"rR",h:["vec3"],g:!1}],m:[{a:"txt",b:"rR = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",u:[],s:[{a:"node_out",c:"rS",h:["vec3"],g:!1}],m:[{a:"txt",b:"rS [ 0 ] = rn [ 0 ] ; rS [ 1 ] = rn [ 1 ] ; rS [ 2 ] = rn [ 2 ] ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",u:[],s:[{a:"node_out",c:"rT",h:["vec3"],g:!1}],m:[{a:"txt",b:"rT = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",u:[],s:[{a:"node_out",c:"rV",h:["vec3"],g:!1},{a:"node_out",c:"rW",h:["vec3"],g:!1},{a:"node_out",c:"rX",h:["vec3"],g:!1},{a:"node_out",c:"rY",h:["vec3"],g:!1},{a:"node_out",c:"rZ",h:["vec3"],g:!1},{a:"node_out",c:"r_",h:["vec3"],g:!1},{a:"node_out",c:"sa",h:["float"],g:!1},{a:"node_out",c:"sb",h:["float"],g:!1}],m:[{a:"txt",b:"rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = vec3 ( _0_0 ) ; sa = _0_0 ; sb = _0_0 ;".split(" ")}]},
{a:"node",c:"HUE_SAT",u:[],s:[{a:"node_in",c:"sc",h:["float"],g:!1},{a:"node_in",c:"sd",h:["float"],g:!1},{a:"node_in",c:"se",h:["float"],g:!1},{a:"node_in",c:"sf",h:["float"],g:!1},{a:"node_in",c:"sg",h:["vec3"],g:!1},{a:"node_out",c:"sh",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 jz = jy ( sg ) ; jz [ 0 ] += ( sc - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sd , se ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sh = mix ( sg , jA ( jz ) , sf ) ;".split(" ")}]},
{a:"node",c:"INVERT",u:[],s:[{a:"node_in",c:"si",h:["float"],g:!1},{a:"node_in",c:"sj",h:["vec3"],g:!1},{a:"node_out",c:"sk",h:["vec3"],g:!1}],m:[{a:"txt",b:"sk = mix ( sj , vec3 ( _1_0 ) - sj , si ) ;".split(" ")}]},{a:"node",c:"LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],s:[{a:"node_out",
c:"sl",h:["vec3"],g:!0},{a:"node_out",c:"sm",h:["vec3"],g:!1},{a:"node_out",c:"sn",h:["float"],g:!1},{a:"node_out",c:"so",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sl"],m:[{a:"txt",b:"sl = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sr = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 su = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",
l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"sm = - h + su ; sn = length ( sm ) ; sm = normalize ( sm ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_so"],m:[{a:"txt",b:"so = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sn * sn ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"float ol = dot ( sm , sr ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; so *= ol ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",
i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"so *= max ( LAMP_LIGHT_DIST - sn , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sm"],m:[{a:"txt",b:["sm","=","sr",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sn"],m:[{a:"txt",b:"sn = length ( su - h ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_so"],m:[{a:"txt",b:["so","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",u:[],s:[{a:"node_in",c:"sv",h:["vec3"],g:!1},{a:"node_out",
c:"sw",h:["vec3"],g:!0},{a:"node_out",c:"sx",h:["float"],g:!0},{a:"node_param",c:"rc",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sw"],m:[{a:"txt",b:["sw","=","rc",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sx"],m:[{a:"txt",b:"sx = - dot ( sv , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",u:[],s:[{a:"node_in",c:"sy",h:["vec3"],g:!1},{a:"node_out",c:"sz",h:["vec3"],g:!1}],m:[{a:"txt",b:"sz = - T ( u_view_tsr_frag , sy ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
u:[],s:[{a:"node_in",c:"sA",h:["vec3"],g:!1},{a:"node_in",c:"sB",h:["vec3"],g:!1},{a:"node_in",c:"sC",h:["float"],g:!1},{a:"node_in",c:"sD",h:["vec3"],g:!1},{a:"node_in",c:"sE",h:["float"],g:!1},{a:"node_in",c:"sF",h:["float"],g:!1},{a:"node_in",c:"sG",h:["vec3"],g:!1},{a:"node_in",c:"sH",h:["vec3"],g:!1},{a:"node_in",c:"sI",h:["float"],g:!1},{a:"node_in",c:"sJ",h:["vec3"],g:!1},{a:"node_in",c:"sK",h:["float"],g:!1},{a:"node_out",c:"sL",h:["vec3"],g:!1},{a:"node_out",c:"sM",h:["vec3"],g:!1},{a:"node_out",
c:"sN",h:["vec3"],g:!1},{a:"node_out",c:"sO",h:["vec3"],g:!1},{a:"node_out",c:"sP",h:["vec3"],g:!1},{a:"node_out",c:"sQ",h:["vec4"],g:!1},{a:"node_out",c:"sR",h:["vec4"],g:!1},{a:"node_out",c:"sS",h:["vec3"],g:!1},{a:"node_out",c:"sT",h:["float"],g:!1},{a:"node_out",c:"sU",h:["vec3"],g:!1},{a:"node_out",c:"sV",h:["float"],g:!1},{a:"node_out",c:"sW",h:["vec3"],g:!1},{a:"node_out",c:"sX",h:["float"],g:!1}],m:[{a:"txt",b:"sN = sB ; sO = sD ; sP = sG ; sS = sD ; sT = sF ; sU = sH ; sV = sI ; sW = sJ ; sX = sK ; sL = ro * sN ; sM = rp * u_environment_energy * ce ( sP ) ; sR = ch ( sN ) ; G = sR ; sQ [ 0 ] = sC ; sQ [ 1 ] = sE ; sQ [ 2 ] = sF ;".split(" ")}]},
{a:"node",c:"BSDF_END",u:[],s:[{a:"node_in",c:"sY",h:["vec4"],g:!1},{a:"node_in",c:"sZ",h:["vec3"],g:!1},{a:"node_in",c:"s_",h:["vec3"],g:!1},{a:"node_in",c:"ta",h:["vec3"],g:!1},{a:"node_in",c:"tb",h:["float"],g:!1},{a:"node_in",c:"tc",h:["vec3"],g:!1},{a:"node_in",c:"te",h:["vec3"],g:!1},{a:"node_in",c:"td",h:["float"],g:!1},{a:"node_out",c:"tg",h:["vec3"],g:!1}],m:[{a:"txt",b:"tg = sY . rgb + sZ ; tg = mix ( tg , tc , td ) ; H = _1_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_BSDF_TRANSPARENT"],
m:[{a:"txt",b:"vec3 th = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( th ) ; te = te * th ; tg += te ;".split(" ")}]}]},{a:"txt",b:["s_",";"]}]},{a:"node",c:"BSDF_COMPUTE",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ti",h:["vec3"],g:!1},{a:"node_in",c:"tj",h:["vec2"],g:!1},{a:"node_in",c:"tk",h:["vec3"],g:!1},{a:"node_in",c:"tl",h:["float"],g:!1},{a:"node_in",c:"tm",h:["vec4"],g:!1},{a:"node_out",c:"tn",h:["float"],g:!1},{a:"node_out",c:"to",h:["float"],g:!1}],
m:[{a:"txt",b:"vec3 qS = tk ; float tr = clamp ( tm [ 0 ] , _0_0 , _1_0 ) ; float tu = clamp ( tm [ 1 ] , _0_0 , _1_0 ) ; float qJ = tm [ 2 ] ; vec3 pg = normalize ( nI + ti ) ; float ot = ( _1_0 - tl ) * dot ( qS , ti ) + tl ; float tv = ( _1_0 - tl ) * max ( dot ( ti , pg ) , _0_0 ) + tl ; float tw = ( _1_0 - tl ) * max ( dot ( tk , pg ) , _0_0 ) + tl ; tn = _0_0 ; if ( tj . r != _0_0 ) { if ( tr > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tr * tr ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = ti - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) tn = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; tn = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else tn = ot ; tn = max ( tn , _0_0 ) ; } float J = tu ; float tx = J * J ; float ty = ( tw * tx - tw ) * tw + _1_0 ; float cd = tx / ( M_PI * ty * ty ) ; float tz ; float tA ; float tB = pow ( _1_0 - tv , 5.0 ) ; tz = _1_0 ; tA = tB ; float jx = J / 2.0 ; float tC = jx * jx ; float tD = _1_0 - tC ; float tE = _1_0 / ( tv * tv * tD + tC ) ; tz *= tE ; tA *= tE ; float tF = mix ( 0.04 , _1_0 , qJ ) ; float tG = mix ( tA , tz , tF ) ; to = max ( ot * cd * tG , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",u:[],s:[{a:"node_in",c:"tH",h:["vec3"],g:!1},{a:"node_in",c:"tI",h:["float"],g:!1},{a:"node_in",c:"tJ",h:["float"],g:!1},{a:"node_in",c:"tK",h:["float"],g:!1},{a:"node_in",c:"tL",h:["vec3"],g:!1},{a:"node_in",c:"tM",h:["vec3"],g:!1},{a:"node_out",c:"tN",h:["vec3"],g:!1}],m:[{a:"txt",b:"tN = tH ; tI ; tJ ; tK ; tL ; tM ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"tO",h:["vec3"],g:!1},{a:"node_in",c:"tP",h:["float"],
g:!1},{a:"node_in",c:"tQ",h:["vec3"],g:!1},{a:"node_out",c:"tR",h:["vec3"],g:!1},{a:"node_out",c:"tS",h:["vec3"],g:!1},{a:"node_out",c:"tT",h:["float"],g:!1},{a:"node_out",c:"tU",h:["vec3"],g:!1},{a:"node_out",c:"tV",h:["float"],g:!1},{a:"node_out",c:"tW",h:["float"],g:!1},{a:"node_out",c:"tX",h:["vec3"],g:!1},{a:"node_out",c:"tY",h:["vec3"],g:!1},{a:"node_out",c:"tZ",h:["float"],g:!1},{a:"node_out",c:"t_",h:["vec3"],g:!1},{a:"node_out",c:"ua",h:["float"],g:!1}],m:[{a:"txt",b:"tS = tO ; tT = tP ; tW = _0_0 ; tZ = _0_0 ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["tX","=","tQ",";"]}]},{a:"node_else",m:[{a:"txt",b:["tX","=","nH",";"]}]}]},{a:"txt",b:"tR ; tU ; tV ; tY ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",u:[],s:[{a:"node_in",c:"ub",h:["vec3"],g:!1},{a:"node_in",c:"uc",h:["float"],g:!1},{a:"node_in",c:"ud",h:["float"],g:!1},{a:"node_in",c:"ue",h:["vec3"],g:!1},{a:"node_out",c:"uf",h:["vec3"],g:!1}],m:[{a:"txt",b:"uf = ub ; uc ; ud ; ue ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",
u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"ug",h:["vec3"],g:!1},{a:"node_in",c:"uh",h:["float"],g:!1},{a:"node_in",c:"ui",h:["vec3"],g:!1},{a:"node_out",c:"uj",h:["vec3"],g:!1},{a:"node_out",c:"uk",h:["vec3"],g:!1},{a:"node_out",c:"ul",h:["float"],g:!1},{a:"node_out",c:"um",h:["vec3"],g:!1},{a:"node_out",c:"un",h:["float"],g:!1},{a:"node_out",c:"uo",h:["float"],g:!1},{a:"node_out",c:"up",h:["vec3"],g:!1},{a:"node_out",c:"uq",h:["vec3"],g:!1},{a:"node_out",c:"ur",h:["float"],g:!1},
{a:"node_out",c:"us",h:["vec3"],g:!1},{a:"node_out",c:"ut",h:["float"],g:!1}],m:[{a:"txt",b:"um = ug ; un = uh ; uo = _1_0 ; ur = _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["up","=","ui",";"]}]},{a:"node_else",m:[{a:"txt",b:["up","=","nH",";"]}]}]},{a:"txt",b:"uj ; uk ; ul ; uq ; us ; ut ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",u:[],s:[{a:"node_in",c:"uu",h:["vec3"],g:!1},{a:"node_in",c:"uv",h:["float"],g:!1},{a:"node_in",c:"uw",h:["float"],g:!1},{a:"node_in",
c:"ux",h:["float"],g:!1},{a:"node_out",c:"uy",h:["vec3"],g:!1}],m:[{a:"txt",b:"uy = uu ; uv ; uw ; ux ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",u:[],s:[{a:"node_in",c:"uz",h:["vec3"],g:!1},{a:"node_out",c:"uA",h:["vec3"],g:!1},{a:"node_out",c:"uB",h:["vec3"],g:!1},{a:"node_out",c:"uC",h:["float"],g:!1},{a:"node_out",c:"uD",h:["vec3"],g:!1},{a:"node_out",c:"uE",h:["float"],g:!1},{a:"node_out",c:"uF",h:["float"],g:!1},{a:"node_out",c:"uG",h:["vec3"],g:!1},{a:"node_out",c:"uH",h:["vec3"],g:!1},
{a:"node_out",c:"uI",h:["float"],g:!1},{a:"node_out",c:"uJ",h:["vec3"],g:!1},{a:"node_out",c:"uK",h:["float"],g:!1}],m:[{a:"txt",b:"uJ = uz ; uF = _0_0 ; uI = _0_0 ; uK = _0_0 ; uG = nH ; uA ; uB ; uC ; uD ; uE ; uH ;".split(" ")}]},{a:"node",c:"BSDF_TRANSLUCENT",u:[],s:[{a:"node_in",c:"uL",h:["vec3"],g:!1},{a:"node_in",c:"uM",h:["vec3"],g:!1},{a:"node_out",c:"uN",h:["vec3"],g:!1}],m:[{a:"txt",b:"uN = uL ; uM ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",u:[],s:[{a:"node_in",c:"uO",h:["vec3"],g:!1},
{a:"node_in",c:"uP",h:["float"],g:!1},{a:"node_in",c:"uQ",h:["float"],g:!1},{a:"node_in",c:"uR",h:["vec3"],g:!1},{a:"node_out",c:"uS",h:["vec3"],g:!1}],m:[{a:"txt",b:"uS [ 0 ] = uS [ 1 ] = uS [ 2 ] = _0_0 ; uO ; uP ; uQ ; uR ;".split(" ")}]},{a:"node",c:"BSDF_TOON",u:[],s:[{a:"node_in",c:"uT",h:["vec3"],g:!1},{a:"node_in",c:"uU",h:["float"],g:!1},{a:"node_in",c:"uV",h:["float"],g:!1},{a:"node_in",c:"uW",h:["vec3"],g:!1},{a:"node_out",c:"uX",h:["vec3"],g:!1}],m:[{a:"txt",b:"uX = uT ; uU ; uV ; uW ;".split(" ")}]},
{a:"node",c:"BSDF_VELVET",u:[],s:[{a:"node_in",c:"uY",h:["vec3"],g:!1},{a:"node_in",c:"uZ",h:["float"],g:!1},{a:"node_in",c:"u_",h:["vec3"],g:!1},{a:"node_out",c:"va",h:["vec3"],g:!1}],m:[{a:"txt",b:"va = uY ; uZ ; u_ ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",u:[],s:[{a:"node_in",c:"vb",h:["vec3"],g:!1},{a:"node_in",c:"vc",h:["float"],g:!1},{a:"node_in",c:"vd",h:["vec3"],g:!1},{a:"node_in",c:"ve",h:["float"],g:!1},{a:"node_in",c:"vf",h:["float"],g:!1},{a:"node_in",c:"vg",h:["vec3"],g:!1},
{a:"node_out",c:"vh",h:["vec3"],g:!1}],m:[{a:"txt",b:"vh [ 0 ] = vh [ 1 ] = vh [ 2 ] = _0_0 ; vb ; vd ; ve ; vf ; vg ; vc ;".split(" ")}]},{a:"node",c:"EMISSION",u:[],s:[{a:"node_in",c:"vi",h:["vec3"],g:!1},{a:"node_in",c:"vj",h:["float"],g:!1},{a:"node_out",c:"vk",h:["vec3"],g:!1},{a:"node_out",c:"vl",h:["vec3"],g:!1},{a:"node_out",c:"vm",h:["float"],g:!1},{a:"node_out",c:"vn",h:["vec3"],g:!1},{a:"node_out",c:"vo",h:["float"],g:!1},{a:"node_out",c:"vp",h:["float"],g:!1},{a:"node_out",c:"vq",h:["vec3"],
g:!1},{a:"node_out",c:"vr",h:["vec3"],g:!1},{a:"node_out",c:"vs",h:["float"],g:!1},{a:"node_out",c:"vt",h:["vec3"],g:!1},{a:"node_out",c:"vu",h:["float"],g:!1}],m:[{a:"txt",b:"vr = vj * vi ; vp = _0_0 ; vs = _1_0 ; vq = nH ; vk ; vl ; vm ; vn ; vo ; vt ; vu ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",u:[],s:[{a:"node_in",c:"vv",h:["vec3"],g:!1},{a:"node_out",c:"vw",h:["vec3"],g:!1}],m:[{a:"txt",b:"vw [ 0 ] = vw [ 1 ] = vw [ 2 ] = _0_0 ; vv ;".split(" ")}]},{a:"node",c:"HOLDOUT",u:[],s:[{a:"node_out",
c:"vx",h:["vec3"],g:!1}],m:[{a:"txt",b:"vx [ 0 ] = vx [ 1 ] = vx [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",u:[],s:[{a:"node_in",c:"vy",h:["vec3"],g:!1},{a:"node_in",c:"vz",h:["float"],g:!1},{a:"node_out",c:"vA",h:["vec3"],g:!1}],m:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vy ; vz ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",u:[],s:[{a:"node_in",c:"vB",h:["vec3"],g:!1},{a:"node_in",c:"vC",h:["float"],g:!1},{a:"node_in",c:"vD",h:["float"],g:!1},{a:"node_out",c:"vE",h:["vec3"],
g:!1}],m:[{a:"txt",b:"vE [ 0 ] = vE [ 1 ] = vE [ 2 ] = _0_0 ; vB ; vC ; vD ;".split(" ")}]},{a:"node",c:"BUMP",u:[],s:[{a:"node_in",c:"Ft",h:["float"],g:!1},{a:"node_in",c:"Fu",h:["float"],g:!1},{a:"node_in",c:"vH",h:["float"],g:!1},{a:"node_in",c:"Fv",h:["vec3"],g:!1},{a:"node_out",c:"vJ",h:["vec3"],g:!1}],m:[{a:"txt",b:"vJ = Fv ; Ft ; Fu ; vH ;".split(" ")}]},{a:"node",c:"DISPLACEMENT_BUMP",u:[],s:[{a:"node_in",c:"vQ",h:["float"],g:!1},{a:"node_out",c:"vR",h:["vec3"],g:!1}],m:[{a:"txt",b:"vR = nH ; vQ ;".split(" ")}]},
{a:"node",c:"NORMAL_MAP",u:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"vS",h:["float"],g:!1},{a:"node_in",c:"vT",h:["vec4"],g:!1},{a:"node_in",c:"vU",h:["vec3"],g:!1},{a:"node_out",c:"vV",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:"vec3 vW = normalize ( vU ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","vW","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SPACE","NM_TANGENT",{a:"equal_expr",
l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV = rm * vV ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_OBJECT",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV . yz *= - _1_0 ; vV = T ( u_model_tsr , vV ) ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_WORLD",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV . yz *= - _1_0 ;".split(" ")}]}]},
{a:"txt",b:"vV = normalize ( mix ( vW , vV , vS ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",u:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],s:[{a:"node_in",c:"vX",h:["vec3"],g:!1},{a:"node_out",c:"vY",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",l:2},{a:"logical_or_expr",
l:3}],m:[{a:"txt",b:["vY","=","vX",";"]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_frag , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr , vX ) ; vY = ad ( u_view_tsr_frag , vY ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_inverse , vX ) ; vY = ad ( u_model_tsr_inverse , vY ) ;".split(" ")}]}]}]},
{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_frag , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr , vX ) ; vY = T ( u_view_tsr_frag , vY ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_inverse , vX ) ; vY = T ( u_model_tsr_inverse , vY ) ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_NORMAL",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = normalize ( vY ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",u:[],s:[{a:"node_in",c:"vZ",h:["float"],g:!1},{a:"node_out",c:"v_",h:["vec3"],g:!1}],m:[{a:"txt",b:"v_ [ 0 ] = v_ [ 1 ] = v_ [ 2 ] = _0_0 ; vZ ;".split(" ")}]},{a:"node",c:"WAVELENGTH",u:[],s:[{a:"node_in",c:"wa",h:["float"],g:!1},{a:"node_out",c:"wb",h:["vec3"],g:!1}],m:[{a:"txt",b:"wb [ 0 ] = wb [ 1 ] = wb [ 2 ] = _0_0 ; wa ;".split(" ")}]},{a:"node",c:"SEPXYZ",u:[],s:[{a:"node_in",c:"wc",
h:["vec3"],g:!1},{a:"node_out",c:"wd",h:["float"],g:!1},{a:"node_out",c:"we",h:["float"],g:!1},{a:"node_out",c:"wf",h:["float"],g:!1}],m:[{a:"txt",b:"wd = wc [ 0 ] ; we = wc [ 1 ] ; wf = wc [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",u:[],s:[{a:"node_in",c:"wg",h:["float"],g:!1},{a:"node_in",c:"wh",h:["float"],g:!1},{a:"node_in",c:"wi",h:["float"],g:!1},{a:"node_out",c:"wj",h:["vec3"],g:!1}],m:[{a:"txt",b:"wj [ 0 ] = wg ; wj [ 1 ] = wh ; wj [ 2 ] = wi ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",
u:[],s:[{a:"node_in",c:"wk",h:["vec3"],g:!1},{a:"node_in",c:"wl",h:["float"],g:!1},{a:"node_in",c:"wm",h:["float"],g:!1},{a:"node_out",c:"wn",h:["vec3"],g:!1}],m:[{a:"txt",b:"float b = wl - wm * _0_5 ; wn = max ( ( _1_0 + wm ) * wk + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",u:[],s:[{a:"node_in",c:"wo",h:["float"],g:!1},{a:"node_in",c:"wp",h:["float"],g:!1},{a:"node_out",c:"wq",h:["float"],g:!1},{a:"node_out",c:"wr",h:["float"],g:!1},{a:"node_out",c:"ws",h:["float"],g:!1}],
m:[{a:"txt",b:"wq = wr = ws = _0_0 ; wo ; wp ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",u:[],s:[{a:"node_in",c:"Fw",h:["vec3"],g:!1},{a:"node_out",c:"Fx",h:["vec3"],g:!1},{a:"node_out",c:"Fy",h:["float"],g:!1}],m:[{a:"txt",b:"Fx [ 0 ] = Fx [ 1 ] = Fx [ 2 ] = _0_0 ; Fy = _1_0 ; Fw ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",u:[],s:[{a:"node_in",c:"Fz",h:["vec3"],g:!1},{a:"node_out",c:"FA",h:["vec3"],g:!1}],m:[{a:"txt",b:"FA [ 0 ] = FA [ 1 ] = FA [ 2 ] = _0_0 ; Fz ;".split(" ")}]},{a:"node",c:"TEX_SKY",
u:[],s:[{a:"node_in",c:"wt",h:["vec3"],g:!1},{a:"node_out",c:"wu",h:["vec3"],g:!1}],m:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_NOISE",u:[],s:[{a:"node_in",c:"wv",h:["vec3"],g:!1},{a:"node_in",c:"wA",h:["float"],g:!1},{a:"node_in",c:"wB",h:["float"],g:!1},{a:"node_in",c:"wC",h:["float"],g:!1},{a:"node_out",c:"wD",h:["vec3"],g:!1},{a:"node_out",c:"wE",h:["float"],g:!1}],m:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wv ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",u:[],s:[{a:"node_in",c:"wF",h:["vec3"],g:!1},{a:"node_in",c:"wG",h:["float"],g:!1},{a:"node_in",c:"wH",h:["float"],g:!1},{a:"node_in",c:"wI",h:["float"],g:!1},{a:"node_in",c:"wJ",h:["float"],g:!1},{a:"node_out",c:"wK",h:["vec3"],g:!1},{a:"node_out",c:"wL",h:["float"],g:!1}],m:[{a:"txt",b:"wK [ 0 ] = wK [ 1 ] = wK [ 2 ] = _0_0 ; wL = _1_0 ; wF ; wG ; wH ; wI ; wJ ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",u:[],s:[{a:"node_in",c:"wM",h:["vec3"],g:!1},{a:"node_in",c:"wN",h:["float"],
g:!1},{a:"node_out",c:"wO",h:["vec3"],g:!1},{a:"node_out",c:"wP",h:["float"],g:!1}],m:[{a:"txt",b:"wO [ 0 ] = wO [ 1 ] = wO [ 2 ] = _0_0 ; wP = _1_0 ; wM ; wN ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",u:[],s:[{a:"node_in",c:"wQ",h:["vec3"],g:!1},{a:"node_in",c:"wR",h:["float"],g:!1},{a:"node_in",c:"wS",h:["float"],g:!1},{a:"node_in",c:"wT",h:["float"],g:!1},{a:"node_in",c:"wU",h:["float"],g:!1},{a:"node_in",c:"wV",h:["float"],g:!1},{a:"node_in",c:"wW",h:["float"],g:!1},{a:"node_out",c:"wX",h:["vec3"],
g:!1},{a:"node_out",c:"wY",h:["float"],g:!1}],m:[{a:"txt",b:"wX [ 0 ] = wX [ 1 ] = wX [ 2 ] = _0_0 ; wY = _1_0 ; wQ ; wR ; wS ; wT ; wU ; wV ; wW ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",u:[],s:[{a:"node_in",c:"wZ",h:["vec3"],g:!1},{a:"node_out",c:"w_",h:["vec3"],g:!1},{a:"node_out",c:"xa",h:["float"],g:!1}],m:[{a:"txt",b:"w_ [ 0 ] = w_ [ 1 ] = w_ [ 2 ] = _0_0 ; xa = _1_0 ; wZ ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",u:[],s:[{a:"node_in",c:"xb",h:["vec3"],g:!1},{a:"node_in",c:"xc",h:["float"],
g:!1},{a:"node_in",c:"xd",h:["float"],g:!1},{a:"node_out",c:"xe",h:["vec3"],g:!1},{a:"node_out",c:"xf",h:["float"],g:!1}],m:[{a:"txt",b:"xe [ 0 ] = xe [ 1 ] = xe [ 2 ] = _0_0 ; xf = _1_0 ; xb ; xc ; xd ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",u:[],s:[{a:"node_in",c:"xg",h:["vec3"],g:!1},{a:"node_in",c:"xh",h:["vec3"],g:!1},{a:"node_in",c:"xi",h:["vec3"],g:!1},{a:"node_in",c:"xj",h:["float"],g:!1},{a:"node_out",c:"xk",h:["vec3"],g:!1},{a:"node_out",c:"xl",h:["float"],g:!1}],m:[{a:"txt",b:"xk [ 0 ] = xk [ 1 ] = xk [ 2 ] = _0_0 ; xl = _1_0 ; xg ; xh ; xi ; xj ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",u:[],s:[{a:"node_in",c:"xm",h:["vec3"],g:!1},{a:"node_in",c:"xn",h:["vec3"],g:!1},{a:"node_in",c:"xo",h:["vec3"],g:!1},{a:"node_in",c:"xp",h:["vec3"],g:!1},{a:"node_in",c:"xq",h:["float"],g:!1},{a:"node_in",c:"xr",h:["float"],g:!1},{a:"node_in",c:"xs",h:["float"],g:!1},{a:"node_in",c:"xt",h:["float"],g:!1},{a:"node_in",c:"xu",h:["float"],g:!1},{a:"node_out",c:"xv",h:["vec3"],g:!1},{a:"node_out",c:"xA",h:["float"],g:!1}],m:[{a:"txt",b:"xv [ 0 ] = xv [ 1 ] = xv [ 2 ] = _0_0 ; xA = _1_0 ; xm ; xn ; xo ; xp ; xq ; xr ; xs ; xt ; xu ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",u:[],s:[{a:"node_in",c:"xB",h:["vec3"],g:!1},{a:"node_in",c:"xC",h:["vec3"],g:!1},{a:"node_out",c:"xD",h:["vec3"],g:!1}],m:[{a:"txt",b:"xD = clamp ( xB + xC , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",u:[],s:[{a:"node_in",c:"xE",h:["float"],g:!1},{a:"node_in",c:"xF",h:["vec3"],g:!1},{a:"node_in",c:"xG",h:["vec3"],g:!1},{a:"node_in",c:"xH",h:["vec3"],g:!1},{a:"node_in",c:"xI",h:["float"],g:!1},{a:"node_in",c:"xJ",h:["vec3"],g:!1},{a:"node_in",
c:"xK",h:["float"],g:!1},{a:"node_in",c:"xL",h:["float"],g:!1},{a:"node_in",c:"xM",h:["vec3"],g:!1},{a:"node_in",c:"xN",h:["vec3"],g:!1},{a:"node_in",c:"xO",h:["float"],g:!1},{a:"node_in",c:"xP",h:["vec3"],g:!1},{a:"node_in",c:"xQ",h:["float"],g:!1},{a:"node_in",c:"xR",h:["vec3"],g:!1},{a:"node_in",c:"xS",h:["float"],g:!1},{a:"node_in",c:"xT",h:["vec3"],g:!1},{a:"node_in",c:"xU",h:["float"],g:!1},{a:"node_in",c:"xV",h:["float"],g:!1},{a:"node_in",c:"xW",h:["vec3"],g:!1},{a:"node_in",c:"xX",h:["vec3"],
g:!1},{a:"node_in",c:"xY",h:["float"],g:!1},{a:"node_in",c:"xZ",h:["vec3"],g:!1},{a:"node_in",c:"x_",h:["float"],g:!1},{a:"node_out",c:"ya",h:["vec3"],g:!1},{a:"node_out",c:"yb",h:["vec3"],g:!1},{a:"node_out",c:"yc",h:["float"],g:!1},{a:"node_out",c:"yd",h:["vec3"],g:!1},{a:"node_out",c:"ye",h:["float"],g:!1},{a:"node_out",c:"yf",h:["float"],g:!1},{a:"node_out",c:"yg",h:["vec3"],g:!1},{a:"node_out",c:"yh",h:["vec3"],g:!1},{a:"node_out",c:"yi",h:["float"],g:!1},{a:"node_out",c:"yj",h:["vec3"],g:!1},
{a:"node_out",c:"yk",h:["float"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( xE , _0_0 , _1_0 ) ; yb = mix ( xH , xR , yl ) ; yc = mix ( xI , xS , yl ) ; if ( xL > _0_0 ) { if ( xV > _0_0 ) { yd = mix ( xJ , xT , yl ) ; ye = mix ( xK , xU , yl ) ; } else { yd = xJ ; ye = xK ; } } else { yd = xT ; ye = xU ; } if ( xO > _0_0 ) { if ( xY > _0_0 ) { yh = mix ( xN , xX , yl ) ; } else { yh = xN ; } } else { yh = xX ; } yf = mix ( xL , xV , yl ) ; yg = mix ( xM , xW , yl ) ; yi = mix ( xO , xY , yl ) ; yj = mix ( xP , xZ , yl ) ; yk = mix ( xQ , x_ , yl ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_out",c:"ym",h:["vec3"],g:!1},{a:"node_out",c:"yn",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_ym"],m:[{a:"txt",b:"ym = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yn"],m:[{a:"txt",b:"yn = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_out",c:"yo",h:["vec3"],g:!1}],m:[{a:"txt",b:"yo = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",u:[],s:[{a:"node_out",c:"yp",h:["vec3"],
g:!1}],m:[{a:"txt",b:["yp","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",u:[],s:[{a:"node_out",c:"yq",h:["vec3"],g:!1}],m:[{a:"txt",b:"yq = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",u:[],s:[{a:"node_out",c:"yr",h:["vec3"],g:!1}],m:[{a:"txt",b:"yr [ 0 ] = yr [ 1 ] = yr [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",u:[],s:[{a:"node_out",c:"ys",h:["vec3"],g:!1}],m:[{a:"txt",b:"ys [ 0 ] = rn [ 0 ] ; ys [ 1 ] = rn [ 1 ] ; ys [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
u:[],s:[{a:"node_out",c:"yt",h:["vec3"],g:!1}],m:[{a:"txt",b:"yt [ 0 ] = yt [ 1 ] = yt [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",u:[],s:[{a:"node_out",c:"yu",h:["vec3"],g:!1}],m:[{a:"txt",b:"yu [ 0 ] = yu [ 1 ] = yu [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_out",c:"yv",h:["vec3"],g:!1}],m:[{a:"txt",b:"yv = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",u:[],s:[{a:"node_out",c:"yA",h:["float"],g:!1},{a:"node_out",c:"yB",h:["float"],g:!1},{a:"node_out",
c:"yC",h:["float"],g:!1},{a:"node_out",c:"yD",h:["vec3"],g:!1},{a:"node_out",c:"yE",h:["float"],g:!1},{a:"node_out",c:"yF",h:["vec3"],g:!1},{a:"node_out",c:"yG",h:["vec3"],g:!1},{a:"node_param",c:"Fp",h:["GLSL_IN","vec4"],g:!0},{a:"node_param",c:"Fq",h:["GLSL_IN","vec3"],g:!0},{a:"node_param",c:"Fr",h:["GLSL_IN","vec3"],g:!0},{a:"node_param",c:"Fs",h:["GLSL_IN","vec3"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["PARTICLE_BATCH"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yA"],m:[{a:"txt",b:"yA = Fp [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yB"],m:[{a:"txt",b:"yB = Fp [ 1 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yC"],m:[{a:"txt",b:"yC = Fp [ 2 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yD"],m:[{a:"txt",b:["yD","=","Fq",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yE"],m:[{a:"txt",b:"yE = Fp [ 3 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yF"],m:[{a:"txt",b:["yF","=","Fr",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yG"],
m:[{a:"txt",b:["yG","=","Fs",";"]}]}]}]},{a:"node_else",m:[{a:"txt",b:"yA = _0_0 ; yB = _0_0 ; yC = _0_0 ; yD = vec3 ( _0_0 ) ; yE = _0_0 ; yF = yD ; yG = yD ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",u:[],s:[{a:"node_out",c:"yH",h:["float"],g:!1},{a:"node_out",c:"yI",h:["float"],g:!1},{a:"node_out",c:"yJ",h:["float"],g:!1},{a:"node_out",c:"yK",h:["vec3"],g:!1}],m:[{a:"txt",b:"yH = _0_0 ; yI = _0_0 ; yJ = _0_0 ; yK = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",u:[],s:[{a:"node_out",
c:"yL",h:["vec3"],g:!1},{a:"node_out",c:"yM",h:["float"],g:!1},{a:"node_out",c:"yN",h:["float"],g:!1},{a:"node_out",c:"yO",h:["float"],g:!1}],m:[{a:"txt",b:"yM = _0_0 ; yN = _0_0 ; yO = _0_0 ; yL = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",u:[],s:[{a:"node_in",c:"yP",h:["float"],g:!1},{a:"node_out",c:"yQ",h:["float"],g:!1}],m:[{a:"txt",b:["yQ","=","yP",";"]}]},{a:"node",c:"TANGENT",u:[],s:[{a:"node_out",c:"yR",h:["vec3"],g:!1}],m:[{a:"txt",b:"yR = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",u:[],s:[{a:"node_in",c:"FB",h:["float"],g:!1},{a:"node_in",c:"FC",h:["vec3"],g:!1},{a:"node_out",c:"yU",h:["float"],g:!1},{a:"node_out",c:"yV",h:["float"],g:!1}],m:[{a:"txt",b:"yU = yV = _0_0 ; FC ; FB ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",u:[],s:[{a:"node_out",c:"yX",h:["float"],g:!1},{a:"node_out",c:"yY",h:["float"],g:!1},{a:"node_out",c:"yZ",h:["float"],g:!1},{a:"node_out",c:"y_",h:["float"],g:!1},{a:"node_out",c:"za",h:["float"],g:!1},{a:"node_out",c:"zb",h:["float"],g:!1},
{a:"node_out",c:"zc",h:["float"],g:!1},{a:"node_out",c:"zd",h:["float"],g:!1},{a:"node_out",c:"ze",h:["float"],g:!1},{a:"node_out",c:"zf",h:["float"],g:!1}],m:[{a:"txt",b:"yX = yY = yZ = _0_0 ; y_ = za = zb = _0_0 ; zc = zc = ze = zf = _0_0 ; zd = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",u:[],s:[{a:"node_out",c:"zh",h:["vec3"],g:!1},{a:"node_out",c:"zi",h:["vec3"],g:!1},{a:"node_out",c:"zj",h:["float"],g:!1}],m:[{a:"txt",b:"zh = zi = vec3 ( _0_0 ) ; zj = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
u:[],s:[],m:[]},{a:"node",c:"CURVE_VEC",u:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],s:[{a:"node_in",c:"zk",h:["float"],g:!1},{a:"node_in",c:"zl",h:["vec3"],g:!1},{a:"node_out",c:"zm",h:["vec3"],g:!1}],m:[{a:"txt",b:["zm","=","zl",";"]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zm . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zm . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zm . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"zm = mix ( zl , zm , zk ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",u:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",
c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zn",h:["float"],g:!1},{a:"node_in",c:"zo",h:["vec3"],g:!1},{a:"node_out",c:"zp",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["READ_A"],m:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"float r = zo . r ; float g = zo . g ; float b = zo . b ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zp . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . r = r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zp . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . g = g ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zp . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . b = b ;".split(" ")}]}]},{a:"txt",b:"zp = mix ( zo , zp , zn ) ;".split(" ")}]},{a:"node",c:"VALTORGB",u:[{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zq",h:["float"],g:!1},{a:"node_out",c:"zr",h:["vec3"],g:!1},{a:"node_out",c:"zs",h:["float"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zq , NODE_TEX_ROW ) ) ; zr = zt . rgb ; zs = zt . a ;".split(" ")}]},
{a:"node",c:"MAPPING",u:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","_1_0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],s:[{a:"node_in",c:"zu",h:["vec3"],g:!1},{a:"node_out",c:"zv",h:["vec3"],g:!1}],m:[{a:"txt",b:["zv","=","zu",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_SCALE_DEF"],m:[{a:"txt",b:"zv = zv * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRANS_DEF"],m:[{a:"txt",b:"zv = zv + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRS_MATRIX_DEF"],
m:[{a:"txt",b:"zv = ( MAPPING_TRS_MATRIX * vec4 ( zv , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MIN_CLIP_DEF"],m:[{a:"txt",b:"zv = max ( zv , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MAX_CLIP_DEF"],m:[{a:"txt",b:"zv = min ( zv , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_IS_NORMAL"],m:[{a:"txt",b:"zv = normalize ( zv ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",u:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],s:[{a:"node_in",c:"zA",h:["float"],g:!1},{a:"node_in",c:"zB",h:["float"],g:!1},{a:"node_out",c:"zC",h:["float"],g:!1}],m:[{a:"txt",b:"zC = zA + zB ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zC = clamp ( zC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zD",h:["float"],g:!1},{a:"node_in",c:"zE",h:["float"],g:!1},{a:"node_out",c:"zF",h:["float"],g:!1}],m:[{a:"txt",b:"zF = zD - zE ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zF = clamp ( zF , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zG",h:["float"],g:!1},{a:"node_in",c:"zH",h:["float"],g:!1},{a:"node_out",c:"zI",h:["float"],g:!1}],m:[{a:"txt",b:"zI = zG * zH ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zI = clamp ( zI , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zJ",h:["float"],g:!1},{a:"node_in",c:"zK",h:["float"],g:!1},{a:"node_out",c:"zL",h:["float"],g:!1}],m:[{a:"txt",b:"zL = ( zK != _0_0 ) ? zJ / zK : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zL = clamp ( zL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zM",h:["float"],g:!1},{a:"node_in",c:"zN",h:["float"],g:!1},
{a:"node_out",c:"zO",h:["float"],g:!1}],m:[{a:"txt",b:"zO = sin ( zM ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zO = clamp ( zO , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zN",";"]}]},{a:"node",c:"MATH_COSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zP",h:["float"],g:!1},{a:"node_in",c:"zQ",h:["float"],g:!1},{a:"node_out",c:"zR",h:["float"],g:!1}],m:[{a:"txt",b:"zR = cos ( zP ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"zR = clamp ( zR , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zQ",";"]}]},{a:"node",c:"MATH_TANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zS",h:["float"],g:!1},{a:"node_in",c:"zT",h:["float"],g:!1},{a:"node_out",c:"zU",h:["float"],g:!1}],m:[{a:"txt",b:"zU = tan ( zS ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zU = clamp ( zU , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zT",";"]}]},{a:"node",c:"MATH_ARCSINE",u:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zV",h:["float"],g:!1},{a:"node_in",c:"zW",h:["float"],g:!1},{a:"node_out",c:"zX",h:["float"],g:!1}],m:[{a:"txt",b:"zX = ( zV <= _1_0 && zV >= - _1_0 ) ? asin ( zV ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zX = clamp ( zX , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zW",";"]}]},{a:"node",c:"MATH_ARCCOSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zY",h:["float"],g:!1},{a:"node_in",
c:"zZ",h:["float"],g:!1},{a:"node_out",c:"z_",h:["float"],g:!1}],m:[{a:"txt",b:"z_ = ( zY <= _1_0 && zY >= - _1_0 ) ? acos ( zY ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zZ",";"]}]},{a:"node",c:"MATH_ARCTANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Aa",h:["float"],g:!1},{a:"node_in",c:"Ab",h:["float"],g:!1},{a:"node_out",c:"Ac",h:["float"],g:!1}],m:[{a:"txt",
b:"Ac = atan ( Aa ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ac = clamp ( Ac , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ab",";"]}]},{a:"node",c:"MATH_POWER",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ad",h:["float"],g:!1},{a:"node_in",c:"Ae",h:["float"],g:!1},{a:"node_out",c:"Af",h:["float"],g:!1}],m:[{a:"txt",b:"if ( Ad < _0_0 && Ae != floor ( Ae ) ) Af = _0_0 ; else if ( Ae == _0_0 ) Af = _1_0 ; else if ( Ad < _0_0 ) Af = mix ( _1_0 , - _1_0 , sign ( mod ( - Ae , 2.0 ) ) ) * pow ( - Ad , Ae ) ; else if ( Ad == _0_0 ) Af = _0_0 ; else Af = pow ( Ad , Ae ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Af = clamp ( Af , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ag",h:["float"],g:!1},{a:"node_in",c:"Ah",h:["float"],g:!1},{a:"node_out",c:"Ai",h:["float"],g:!1}],m:[{a:"txt",b:"Ai = ( Ag > _0_0 && Ah > _0_0 ) ? log2 ( Ag ) / log2 ( Ah ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ai = clamp ( Ai , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Aj",h:["float"],g:!1},{a:"node_in",c:"Ak",h:["float"],g:!1},{a:"node_out",c:"Al",h:["float"],g:!1}],m:[{a:"txt",b:"Al = min ( Aj , Ak ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Am",h:["float"],g:!1},{a:"node_in",c:"An",h:["float"],
g:!1},{a:"node_out",c:"Ao",h:["float"],g:!1}],m:[{a:"txt",b:"Ao = max ( Am , An ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ao = clamp ( Ao , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ap",h:["float"],g:!1},{a:"node_in",c:"Aq",h:["float"],g:!1},{a:"node_out",c:"Ar",h:["float"],g:!1}],m:[{a:"txt",b:"Ar = floor ( Ap + _0_5 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"Ar = clamp ( Ar , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Aq",";"]}]},{a:"node",c:"MATH_LESS_THAN",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"As",h:["float"],g:!1},{a:"node_in",c:"At",h:["float"],g:!1},{a:"node_out",c:"Au",h:["float"],g:!1}],m:[{a:"txt",b:"Au = ( As < At ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",u:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Av",h:["float"],g:!1},{a:"node_in",c:"Aw",h:["float"],g:!1},{a:"node_out",c:"Ax",h:["float"],g:!1}],m:[{a:"txt",b:"Ax = ( Av > Aw ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ax = clamp ( Ax , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ay",h:["float"],g:!1},{a:"node_in",c:"Az",h:["float"],g:!1},{a:"node_out",c:"AA",
h:["float"],g:!1}],m:[{a:"txt",b:"AA = abs ( Az ) > 0.000001 ? mod ( Ay , Az ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AA = clamp ( AA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AB",h:["float"],g:!1},{a:"node_in",c:"AC",h:["float"],g:!1},{a:"node_out",c:"AD",h:["float"],g:!1}],m:[{a:"txt",b:"AD = abs ( AB ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"AD = clamp ( AD , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AC",";"]}]},{a:"node",c:"MIX_RGB_MIX",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AE",h:["float"],g:!1},{a:"node_in",c:"AF",h:["vec3"],g:!1},{a:"node_in",c:"AG",h:["vec3"],g:!1},{a:"node_out",c:"AH",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AE , _0_0 , _1_0 ) ; AH = mix ( AF , AG , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AH = clamp ( AH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AI",h:["float"],g:!1},{a:"node_in",c:"AJ",h:["vec3"],g:!1},{a:"node_in",c:"AK",h:["vec3"],g:!1},{a:"node_out",c:"AL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AI , _0_0 , _1_0 ) ; AL = mix ( AJ , AJ + AK , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AL = clamp ( AL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",u:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AM",h:["float"],g:!1},{a:"node_in",c:"AN",h:["vec3"],g:!1},{a:"node_in",c:"AO",h:["vec3"],g:!1},{a:"node_out",c:"AP",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AM , _0_0 , _1_0 ) ; AP = mix ( AN , AN * AO , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",
c:"AQ",h:["float"],g:!1},{a:"node_in",c:"AR",h:["vec3"],g:!1},{a:"node_in",c:"AS",h:["vec3"],g:!1},{a:"node_out",c:"AT",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AQ , _0_0 , _1_0 ) ; AT = mix ( AR , AR - AS , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AT = clamp ( AT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AU",h:["float"],g:!1},{a:"node_in",c:"AV",
h:["vec3"],g:!1},{a:"node_in",c:"AW",h:["vec3"],g:!1},{a:"node_out",c:"AX",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AU , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; AX = vec3 ( _1_0 ) - ( vec3 ( AY ) + yl * ( vec3 ( _1_0 ) - AW ) ) * ( vec3 ( _1_0 ) - AV ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AX = clamp ( AX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AZ",
h:["float"],g:!1},{a:"node_in",c:"A_",h:["vec3"],g:!1},{a:"node_in",c:"Ba",h:["vec3"],g:!1},{a:"node_out",c:"Bb",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AZ , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; Ba += step ( Ba , vec3 ( _0_0 ) ) ; Bb = AY * A_ + yl * A_ / Ba ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bb = clamp ( Bb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",
c:"Bc",h:["float"],g:!1},{a:"node_in",c:"Bd",h:["vec3"],g:!1},{a:"node_in",c:"Be",h:["vec3"],g:!1},{a:"node_out",c:"Bf",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bc , _0_0 , _1_0 ) ; Bf = mix ( Bd , abs ( Bd - Be ) , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bf = clamp ( Bf , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bg",h:["float"],g:!1},{a:"node_in",
c:"Bh",h:["vec3"],g:!1},{a:"node_in",c:"Bi",h:["vec3"],g:!1},{a:"node_out",c:"Bj",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bg , _0_0 , _1_0 ) ; Bj = min ( Bh . rgb , Bi . rgb * yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bj = clamp ( Bj , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bk",h:["float"],g:!1},{a:"node_in",c:"Bl",h:["vec3"],g:!1},{a:"node_in",
c:"Bm",h:["vec3"],g:!1},{a:"node_out",c:"Bn",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bk , _0_0 , _1_0 ) ; Bn = max ( Bl . rgb , Bm . rgb * yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bn = clamp ( Bn , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bo",h:["float"],g:!1},{a:"node_in",c:"Bp",h:["vec3"],g:!1},{a:"node_in",c:"Bq",h:["vec3"],g:!1},{a:"node_out",
c:"Br",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bo , _0_0 , _1_0 ) ; vec3 Bs = vec3 ( _1_0 - yl ) ; Br = mix ( Bp * ( Bs + 2.0 * yl * Bq ) , vec3 ( _1_0 ) - ( Bs + 2.0 * yl * ( vec3 ( _1_0 ) - Bq ) ) * ( vec3 ( _1_0 ) - Bp ) , step ( _0_5 , Bp ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Br = clamp ( Br , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bt",h:["float"],
g:!1},{a:"node_in",c:"Bu",h:["vec3"],g:!1},{a:"node_in",c:"Bv",h:["vec3"],g:!1},{a:"node_out",c:"Bw",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bt , _0_0 , _1_0 ) ; vec3 Bx = vec3 ( _1_0 ) - yl * Bv ; vec3 By = clamp ( Bu / Bx , _0_0 , _1_0 ) ; Bw = mix ( mix ( By , vec3 ( _1_0 ) , step ( Bx , vec3 ( _0_0 ) ) ) , Bu , step ( Bu , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bw = clamp ( Bw , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bz",h:["float"],g:!1},{a:"node_in",c:"BA",h:["vec3"],g:!1},{a:"node_in",c:"BB",h:["vec3"],g:!1},{a:"node_out",c:"BC",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bz , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - yl ) ; vec3 Bx = jH + yl * BB ; vec3 By = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - BA ) / Bx , _0_0 , _1_0 ) ; BC = mix ( By , vec3 ( _0_0 ) , step ( Bx , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BC = clamp ( BC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BD",h:["float"],g:!1},{a:"node_in",c:"BE",h:["vec3"],g:!1},{a:"node_in",c:"BF",h:["vec3"],g:!1},{a:"node_out",c:"BG",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BD , _0_0 , _1_0 ) ; vec3 jz , BH , Bx ; BG = BE ; BH = jy ( BF ) ; if ( BH . y != _0_0 ) { jz = jy ( BG ) ; jz . x = BH . x ; Bx = jA ( jz ) ; BG = mix ( BG , Bx , yl ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BG = clamp ( BG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BI",h:["float"],g:!1},{a:"node_in",c:"BJ",h:["vec3"],g:!1},{a:"node_in",c:"BK",h:["vec3"],g:!1},{a:"node_out",c:"BL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BI , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; BL = BJ ; vec3 jz , BH ; jz = jy ( BL ) ; if ( jz . y != _0_0 ) { BH = jy ( BK ) ; jz . y = AY * jz . y + yl * BH . y ; BL = jA ( jz ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BL = clamp ( BL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BM",h:["float"],g:!1},{a:"node_in",c:"BN",h:["vec3"],g:!1},{a:"node_in",c:"BO",h:["vec3"],g:!1},{a:"node_out",c:"BP",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BM , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; vec3 jz , BH ; jz = jy ( BN ) ; BH = jy ( BO ) ; jz . z = AY * jz . z + yl * BH . z ; BP = jA ( jz ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BP = clamp ( BP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BQ",h:["float"],g:!1},{a:"node_in",c:"BR",h:["vec3"],g:!1},{a:"node_in",c:"BS",h:["vec3"],g:!1},{a:"node_out",c:"BT",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BQ , _0_0 , _1_0 ) ; vec3 jz , BH , Bx ; BT = BR ; BH = jy ( BS ) ; if ( BH . y != _0_0 ) { jz = jy ( BT ) ; jz . x = BH . x ; jz . y = BH . y ; Bx = jA ( jz ) ; BT = mix ( BT , Bx , yl ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BT = clamp ( BT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BU",h:["float"],g:!1},{a:"node_in",c:"BV",h:["vec3"],g:!1},{a:"node_in",c:"BW",h:["vec3"],g:!1},{a:"node_out",c:"BX",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BU , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; vec3 BY = BW + BV - BW * BV ; BX = BV * ( vec3 ( AY ) + vec3 ( yl ) * ( ( vec3 ( _1_0 ) - BV ) * BW + BY ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BX = clamp ( BX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BZ",h:["float"],g:!1},{a:"node_in",c:"B_",h:["vec3"],g:!1},{a:"node_in",c:"Ca",h:["vec3"],g:!1},{a:"node_out",c:"Cb",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BZ , _0_0 , _1_0 ) ; Cb = B_ + yl * ( 2.0 * Ca - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cb = clamp ( Cb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",u:[],s:[{a:"node_in",c:"Cc",h:["vec3"],g:!1},{a:"node_in",c:"Cd",h:["float"],g:!1}],m:[{a:"txt",b:"D = Cc ; H = Cd ;".split(" ")}]},{a:"node",c:"OUTPUT_SURFACE",u:[],s:[{a:"node_in",c:"Ce",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = Ce ; H = _1_0 ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",
c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],s:[{a:"node_in",c:"Cf",h:["vec3"],g:!1},{a:"node_in",c:"Cg",h:["vec3"],g:!1},{a:"node_in",c:"Ch",h:["float"],g:!1},{a:"node_in",c:"Ci",h:["vec3"],g:!0},{a:"node_in",c:"Cj",h:["float"],g:!0},{a:"node_out",c:"Ck",h:["vec3"],g:!1},{a:"node_out",c:"Cl",h:["vec3"],g:!1},{a:"node_out",c:"Cm",h:["vec3"],g:!1},{a:"node_out",c:"Cn",h:["vec3"],g:!1},{a:"node_out",c:"Co",h:["vec3"],g:!1},{a:"node_out",c:"Cp",h:["vec2"],g:!1},{a:"node_out",
c:"Cq",h:["vec2"],g:!1},{a:"node_out",c:"Cr",h:["vec4"],g:!1},{a:"node_param",c:"rh",h:["const","vec2"],g:!0},{a:"node_param",c:"ri",h:["const","vec3"],g:!1}],m:[{a:"txt",b:"Cm = clamp ( Cf , _0_0 , _1_0 ) ; Cn = ri [ 0 ] * clamp ( Cg , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_NORMAL"],m:[{a:"txt",b:"Co = normalize ( Ci ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["Co","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SHADELESS_MAT",{a:"logic_negative_expr",
l:1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"txt",b:"Ck = Cj * Cm ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Ck = ro * Cm ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:["Cm","*=","Ch",";"]}]}]},{a:"txt",b:"Cl = rp * u_environment_energy * ce ( Co ) ; Cr = vec4 ( _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],m:[{a:"txt",b:"Cp = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; Cq = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","Cr",";"]}]},{a:"node_else",m:[{a:"txt",b:"Ck = vec3 ( _0_0 ) ; Cl = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],s:[{a:"node_in",c:"Cs",h:["vec4"],g:!1},{a:"node_in",c:"Ct",h:["vec3"],g:!1},{a:"node_in",c:"Cu",h:["vec3"],g:!1},{a:"node_in",c:"Cv",h:["float"],g:!0},{a:"node_in",c:"Cw",h:["float"],g:!0},{a:"node_in",c:"Cx",
h:["float"],g:!0},{a:"node_out",c:"Cy",h:["vec3"],g:!0},{a:"node_out",c:"Cz",h:["float"],g:!0},{a:"node_out",c:"CA",h:["vec3"],g:!0},{a:"node_out",c:"CB",h:["vec3"],g:!0},{a:"node_out",c:"CC",h:["vec3"],g:!0},{a:"node_param",c:"rj",h:["float"],g:!1},{a:"node_param",c:"rk",h:["float"],g:!1}],m:[{a:"txt",b:["Cv",";"]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cy"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:"Cy = Cs . rgb ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Cy = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["Cy","+=","Ct",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CA"],m:[{a:"txt",b:["CA","=","Cu",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CB"],m:[{a:"txt",b:"CB = Cs . rgb ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CC"],m:[{a:"txt",b:["CC","=","Ct",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cz"],m:[{a:"txt",b:"Cz = clamp ( Cx , _0_0 , _1_0 ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( Ct . r , Ct . g ) , Ct . b ) * Cw ; Cz = clamp ( Cx * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cz"],m:[{a:"txt",b:"Cz = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( Ct . r , Ct . g ) , Ct . b ) * rk ; Cz = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["E","=","Ct",";"]}]},{a:"node_else",m:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","Cu",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"nZ",h:["vec3"],g:!1},{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_out",c:"ob",h:["vec4"],g:!1},{a:"node_out",c:"oc",h:["vec3"],g:!1}],m:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},
{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],s:[{a:"node_in",c:"od",h:["vec4"],g:!1},{a:"node_out",c:"oe",h:["vec3"],g:!1},{a:"node_out",c:"of",h:["vec2"],g:!1},{a:"node_out",c:"og",h:["vec3"],g:!1},{a:"node_out",c:"oh",h:["float"],g:!1}],m:[{a:"txt",
b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",m:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"om",h:["vec3"],g:!1},{a:"node_in",c:"on",h:["vec2"],g:!1},{a:"node_in",c:"oo",h:["vec3"],g:!1},{a:"node_in",c:"op",h:["float"],g:!1},{a:"node_in",c:"oq",h:["vec2"],g:!1},{a:"node_out",c:"or",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ou",h:["vec3"],g:!1},{a:"node_in",c:"ov",h:["vec2"],g:!1},{a:"node_in",c:"ow",h:["vec3"],
g:!1},{a:"node_in",c:"ox",h:["float"],g:!1},{a:"node_out",c:"oy",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",
c:"oz",h:["vec3"],g:!1},{a:"node_in",c:"oA",h:["vec2"],g:!1},{a:"node_in",c:"oB",h:["vec3"],g:!1},{a:"node_in",c:"oC",h:["float"],g:!1},{a:"node_in",c:"oD",h:["vec2"],g:!1},{a:"node_out",c:"oE",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oO",h:["vec3"],g:!1},{a:"node_in",c:"oP",h:["vec2"],g:!1},{a:"node_in",c:"oQ",h:["vec3"],g:!1},{a:"node_in",c:"oR",h:["float"],g:!1},{a:"node_in",c:"oS",h:["vec2"],g:!1},{a:"node_out",c:"oT",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oU",h:["vec3"],g:!1},{a:"node_in",c:"oV",h:["vec2"],g:!1},{a:"node_in",c:"oW",h:["vec3"],g:!1},
{a:"node_in",c:"oX",h:["float"],g:!1},{a:"node_in",c:"oY",h:["vec2"],g:!1},{a:"node_out",c:"oZ",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pa",h:["vec3"],g:!1},{a:"node_in",c:"pb",h:["vec2"],g:!1},{a:"node_in",c:"pc",h:["vec3"],g:!1},{a:"node_in",c:"pd",h:["float"],g:!1},{a:"node_in",c:"pe",h:["vec2"],g:!1},{a:"node_out",c:"pf",h:["float"],g:!1}],m:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ph",h:["vec3"],g:!1},{a:"node_in",c:"pi",h:["vec2"],g:!1},{a:"node_in",c:"pj",h:["vec3"],g:!1},{a:"node_in",c:"pk",h:["float"],g:!1},{a:"node_in",c:"pl",h:["vec2"],g:!1},{a:"node_out",c:"pm",h:["float"],g:!1}],m:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pn",h:["vec3"],g:!1},{a:"node_in",c:"po",h:["vec2"],g:!1},{a:"node_in",c:"pr",h:["vec3"],g:!1},{a:"node_in",c:"pu",h:["float"],g:!1},{a:"node_in",c:"pv",h:["vec2"],g:!1},{a:"node_out",c:"pw",h:["float"],g:!1}],m:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pz",h:["vec3"],g:!1},{a:"node_in",c:"pA",h:["vec2"],g:!1},{a:"node_in",c:"pB",h:["vec3"],g:!1},{a:"node_in",c:"pC",h:["float"],g:!1},{a:"node_in",c:"pD",h:["vec2"],g:!1},{a:"node_out",c:"pE",h:["float"],
g:!1}],m:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pG",h:["vec3"],g:!1},{a:"node_in",c:"pH",h:["vec2"],g:!1},{a:"node_in",c:"pI",h:["vec3"],g:!1},{a:"node_in",c:"pJ",h:["float"],g:!1},{a:"node_in",c:"pK",h:["vec2"],g:!1},{a:"node_out",c:"pL",h:["float"],g:!1}],m:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < _1_0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( _1_0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pQ",h:["vec4"],g:!1},{a:"node_in",c:"pR",h:["vec3"],g:!1},{a:"node_in",c:"pS",h:["float"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["vec3"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec4"],g:!1},{a:"node_in",c:"pX",h:["vec3"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["float"],g:!1},{a:"node_out",c:"qa",h:["vec4"],g:!1},{a:"node_out",c:"qb",
h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_B4W_TRANSLUCENCY"],m:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float CD = pW . x ; float CE = pW . y ; float CF = pW . z ; float CG = pW . w ; float CH = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float CI = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float CJ = pow ( CI , CE ) ; qa = pQ + p_ * vec4 ( pZ * CH * pow ( pX , vec3 ( CD ) ) , _1_0 ) ; qa += CF * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , CG ) * p_ * vec4 ( pZ * CH * vec3 ( CJ ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",u:[{a:"node_var",c:"RGB_IND",b:["0"]}],s:[{a:"node_out",c:"CK",h:["vec3"],g:!1}],m:[{a:"txt",b:"CK = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",u:[],s:[{a:"node_in",c:"CL",h:["vec3"],g:!1},{a:"node_out",c:"CM",h:["float"],g:!1}],m:[{a:"txt",b:"CM = dot ( CL , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",u:[],s:[{a:"node_in",c:"CN",
h:["vec3"],g:!1},{a:"node_out",c:"CO",h:["float"],g:!0},{a:"node_out",c:"CP",h:["float"],g:!0},{a:"node_out",c:"CQ",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CO"],m:[{a:"txt",b:"CO = CN . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CP"],m:[{a:"txt",b:"CP = CN . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CQ"],m:[{a:"txt",b:"CQ = CN . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",u:[],s:[{a:"node_in",c:"CR",h:["vec3"],g:!1},{a:"node_out",
c:"CS",h:["float"],g:!0},{a:"node_out",c:"CT",h:["float"],g:!0},{a:"node_out",c:"CU",h:["float"],g:!0}],m:[{a:"txt",b:"vec3 CV = jy ( CR ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CS"],m:[{a:"txt",b:"CS = CV . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CT"],m:[{a:"txt",b:"CT = CV . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CU"],m:[{a:"txt",b:"CU = CV . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",u:[],s:[{a:"node_in",c:"CW",h:["float"],g:!1},
{a:"node_in",c:"CX",h:["float"],g:!1},{a:"node_in",c:"CY",h:["float"],g:!1},{a:"node_out",c:"CZ",h:["float"],g:!1}],m:[{a:"txt",b:"CZ = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( CW - CY ) * CX ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",u:[],s:[{a:"node_in",c:"C_",h:["vec3"],g:!1},{a:"node_in",c:"Da",h:["float"],g:!1},{a:"node_out",c:"Db",h:["vec3"],g:!1}],m:[{a:"txt",b:"Db = C_ ; if ( Db . x > _0_0 ) Db . x = pow ( C_ . x , Da ) ; if ( Db . y > _0_0 ) Db . y = pow ( C_ . y , Da ) ; if ( Db . z > _0_0 ) Db . z = pow ( C_ . z , Da ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",u:[],s:[{a:"node_in",c:"Dc",h:["vec3"],g:!1},{a:"node_out",c:"Dd",h:["vec3"],g:!1}],m:[{a:"txt",b:"Dd = max ( vec3 ( _0_0 ) , Dc ) ; Dd = pow ( Dd , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",u:[],s:[{a:"node_in",c:"De",h:["vec3"],g:!1},{a:"node_out",c:"Df",h:["vec3"],g:!1}],m:[{a:"txt",b:"Df = max ( vec3 ( _0_0 ) , De ) ; Df = pow ( Df , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",u:[],s:[{a:"node_out",c:"Dg",h:["vec3"],
g:!1},{a:"node_out",c:"Dh",h:["vec3"],g:!1},{a:"node_out",c:"Di",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dg"],m:[{a:"txt",b:"Dg [ 2 ] = Dg [ 1 ] = Dg [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dh"],m:[{a:"txt",b:"Dh [ 2 ] = Dh [ 1 ] = Dh [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Di"],m:[{a:"txt",b:["Di","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",u:[],s:[{a:"node_in",c:"Dj",h:["vec3"],g:!1},{a:"node_out",
c:"Dk",h:["vec3"],g:!0},{a:"node_out",c:"Dl",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",h:["uniform","samplerCube"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , Dj ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dk"],m:[{a:"txt",b:"Dk = zt . xyz ; bY ( Dk ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dl"],m:[{a:"txt",b:"Dl = zt . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",u:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Dn",h:["vec3"],g:!0},{a:"node_in",c:"Do",h:["vec3"],g:!0},{a:"node_in",c:"Dp",h:["vec3"],g:!0},{a:"node_in",c:"Dq",h:["vec3"],g:!0},{a:"node_out",c:"Dr",h:["vec3"],g:!0},{a:"node_out",c:"Ds",h:["float"],g:!0},{a:"node_out",c:"Dt",h:["vec3"],g:!0},{a:"node_out",c:"Du",h:["float"],g:!0},{a:"node_out",c:"Dv",h:["vec3"],g:!0},{a:"node_out",c:"Dw",h:["float"],
g:!0},{a:"node_out",c:"Dx",h:["vec3"],g:!0},{a:"node_out",c:"Dy",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dn ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dr"],m:[{a:"txt",b:"Dr = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dr",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",
i:["USE_OUT_Ds"],m:[{a:"txt",b:"Ds = zt . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Do ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dt"],m:[{a:"txt",b:"Dt = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dt",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Du"],m:[{a:"txt",b:"Du = zt . w ;".split(" ")}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dp ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dv"],m:[{a:"txt",b:"Dv = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dv",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dw"],m:[{a:"txt",b:"Dw = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",
b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dq ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dx"],m:[{a:"txt",b:"Dx = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dx",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dy"],m:[{a:"txt",b:"Dy = zt . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",u:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Dz",h:["vec3"],g:!0},{a:"node_in",c:"DA",h:["vec3"],g:!0},{a:"node_in",c:"DB",h:["vec3"],g:!0},{a:"node_in",c:"DC",h:["vec3"],g:!0},{a:"node_out",c:"DD",h:["vec3"],g:!0},{a:"node_out",c:"DE",h:["float"],g:!0},{a:"node_out",c:"DF",h:["vec3"],g:!0},{a:"node_out",c:"DG",h:["float"],g:!0},{a:"node_out",c:"DH",h:["vec3"],g:!0},{a:"node_out",c:"DI",h:["float"],g:!0},{a:"node_out",c:"DJ",h:["vec3"],g:!0},{a:"node_out",c:"DK",h:["float"],g:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( Dz ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DD"],m:[{a:"txt",b:"DD = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DE"],m:[{a:"txt",b:"DE = zt . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DA ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DF"],m:[{a:"txt",b:"DF = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DG"],m:[{a:"txt",b:"DG = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DB ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DH"],m:[{a:"txt",b:"DH = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
f:[{a:"node_if",i:["USE_OUT_DI"],m:[{a:"txt",b:"DI = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DC ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DJ"],m:[{a:"txt",b:"DJ = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DK"],m:[{a:"txt",b:"DK = zt . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",u:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],s:[{a:"node_out",c:"DL",h:["float"],g:!1}],m:[{a:"txt",b:"DL = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",u:[],s:[{a:"node_in",c:"DM",h:["vec3"],g:!1},{a:"node_in",c:"DN",h:["vec3"],g:!1},{a:"node_out",c:"DO",h:["vec3"],g:!1},{a:"node_out",c:"DP",h:["float"],g:!0}],m:[{a:"txt",b:"DO = DM + DN ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DP"],m:[{a:"txt",b:"DP = ( abs ( DO [ 0 ] ) + abs ( DO [ 1 ] ) + abs ( DO [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",u:[],s:[{a:"node_in",c:"DQ",h:["vec3"],g:!1},{a:"node_in",c:"DR",h:["vec3"],g:!1},{a:"node_out",c:"DS",h:["vec3"],g:!1},{a:"node_out",c:"DT",h:["float"],g:!0}],m:[{a:"txt",b:"DS = DQ - DR ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DT"],m:[{a:"txt",b:"DT = ( abs ( DS [ 0 ] ) + abs ( DS [ 1 ] ) + abs ( DS [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",u:[],s:[{a:"node_in",c:"DU",h:["vec3"],g:!1},{a:"node_in",c:"DV",h:["vec3"],g:!1},
{a:"node_out",c:"DW",h:["vec3"],g:!1},{a:"node_out",c:"DX",h:["float"],g:!0}],m:[{a:"txt",b:"DW = DU + DV ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DX"],m:[{a:"txt",b:"DX = length ( DW ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DW"],m:[{a:"txt",b:"DW = normalize ( DW ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",u:[],s:[{a:"node_in",c:"DY",h:["vec3"],g:!1},{a:"node_in",c:"DZ",h:["vec3"],g:!1},{a:"node_out",c:"D_",h:["vec3"],g:!1},{a:"node_out",c:"Ea",
h:["float"],g:!0}],m:[{a:"txt",b:"D_ = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ea"],m:[{a:"txt",b:"Ea = dot ( DY , DZ ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",u:[],s:[{a:"node_in",c:"Eb",h:["vec3"],g:!1},{a:"node_in",c:"Ec",h:["vec3"],g:!1},{a:"node_out",c:"Ed",h:["vec3"],g:!1},{a:"node_out",c:"Ee",h:["float"],g:!0}],m:[{a:"txt",b:"Ed = cross ( Eb , Ec ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ee"],m:[{a:"txt",b:"Ee = length ( Ed ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",u:[],s:[{a:"node_in",c:"Ef",h:["vec3"],g:!1},{a:"node_in",c:"Eg",h:["vec3"],g:!1},{a:"node_out",c:"Eh",h:["vec3"],g:!1},{a:"node_out",c:"Ei",h:["float"],g:!0}],m:[{a:"txt",b:"Eh = normalize ( Ef ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ei"],m:[{a:"txt",b:"Ei = length ( Ef ) ;".split(" ")}]}]},{a:"txt",b:["Eg",";"]}]},{a:"node",c:"B4W_REFLECT",u:[],s:[{a:"node_in",c:"Em",h:["vec3"],g:!1},{a:"node_in",c:"En",h:["vec3"],g:!1},{a:"node_out",c:"Eo",
h:["vec3"],g:!1}],m:[{a:"txt",b:"Eo = reflect ( T ( u_view_tsr_inverse , Em ) , En ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",u:[],s:[{a:"node_in",c:"Ep",h:["vec3"],g:!1},{a:"node_out",c:"Eq",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 FD = - nI . xyz ; Eq = reflect ( FD , Ep ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",u:[],s:[{a:"node_in",c:"Er",h:["vec3"],g:!1},{a:"node_in",c:"Es",h:["float"],g:!1},{a:"node_in",c:"Et",h:["const","float"],g:!1},{a:"node_in",c:"Eu",h:["const","float"],g:!1},{a:"node_out",
c:"Ev",h:["vec3"],g:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < Eu ) { vec2 bE = qQ ( Er ) ; float bI = clamp ( _0_5 * ( Eu - bp ) , _0_0 , _1_0 ) ; float hk = Es * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / Et ; vec2 bM = bK . xy * hk / ( Et * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = _1_0 ; bQ <= Et ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; Ev = qP ( bE ) ; } else Ev = Er ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",u:[],s:[{a:"node_in",c:"Ew",h:["vec3"],g:!1},{a:"node_out",c:"Ex",h:["vec3"],g:!1}],m:[{a:"txt",b:"Ex = clamp ( Ew , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",u:[],s:[{a:"node_in",c:"Ey",h:["vec3"],g:!1},{a:"node_in",c:"Ez",h:["float"],g:!1},{a:"node_out",c:"EA",h:["vec3"],g:!1}],m:[{a:"txt",b:["EA","=","Ey",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",u:[],s:[{a:"node_in",c:"EB",h:["float"],g:!1},{a:"node_in",c:"EC",h:["float"],g:!1},{a:"node_in",c:"ED",h:["float"],
g:!1},{a:"node_in",c:"EE",h:["float"],g:!1},{a:"node_in",c:"EF",h:["float"],g:!1},{a:"node_out",c:"EG",h:["float"],g:!0},{a:"node_out",c:"EH",h:["vec4"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EG"],m:[{a:"txt",b:["EG","=","EB",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EH"],m:[{a:"txt",b:"EH = vec4 ( EC , ED , EE , EF ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",u:[],s:[{a:"node_out",c:"EI",h:["float"],g:!1}],m:[{a:"txt",b:["EI","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
u:[],s:[{a:"node_in",c:"EJ",h:["float"],g:!1},{a:"node_in",c:"EK",h:["float"],g:!1},{a:"node_in",c:"EL",h:["float"],g:!1},{a:"node_out",c:"EM",h:["float"],g:!1}],m:[{a:"txt",b:"EM = smoothstep ( EK , EL , EJ ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",u:[],s:[{a:"node_in",c:"EN",h:["vec3"],g:!1},{a:"node_in",c:"EO",h:["float"],g:!1}],m:[{a:"txt",b:"D = EN ; H = EO ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",u:[],s:[{a:"node_in",c:"EP",h:["vec3"],g:!1},{a:"node_out",c:"EQ",h:["float"],g:!1}],
m:[{a:"txt",b:"EQ = ( EP . r + EP . g + EP . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",u:[],s:[{a:"node_in",c:"ER",h:["float"],g:!1},{a:"node_out",c:"ES",h:["vec3"],g:!1}],m:[{a:"txt",b:"ES [ 0 ] = ER ; ES [ 1 ] = ER ; ES [ 2 ] = ER ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",f:[{a:"if",
i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_NO"],j:{a:"grp",f:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",j:{a:"grp",f:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",u:[],s:[],m:[{a:"txt",b:["A","=","FJ",";"]}]},{a:"node",c:"UV_MERGED",u:[],s:[],m:[{a:"txt",b:["A","=","FJ",";"]}]},{a:"node",c:"UVMAP",u:[],s:[],m:[{a:"txt",b:["A","=","FJ",";"]}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[],m:[{a:"txt",b:["A","=","FJ",";"]}]},{a:"node",c:"PARTICLE_INFO",u:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],s:[{a:"node_param",c:"Fp",h:["GLSL_OUT","vec4"],g:!0},{a:"node_param",c:"Fq",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"Fr",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"Fs",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",h:["GLSL_IN","float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_SIZE"],m:[{a:"txt",b:"Fp [ 3 ] = FI ;".split(" ")}]}]},{a:"node_cond",
f:[{a:"node_if",i:["PART_INFO_AGE"],m:[{a:"txt",b:"Fp [ 1 ] = FH ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_LT"],m:[{a:"txt",b:"Fp [ 2 ] = FK ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_LOC"],m:[{a:"txt",b:["Fq","=","FE",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_IND"],m:[{a:"txt",b:"Fp [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_VEL"],m:[{a:"txt",b:["Fr","=","FF",";"]}]}]},{a:"node_cond",
f:[{a:"node_if",i:["PART_INFO_A_VEL"],m:[{a:"txt",b:["Fs","=","FG",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 FE , in vec3 FF , in vec3 FG , in float FH , in float FI , in vec2 FJ , in float FK ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["A","=","FJ",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
j:{a:"grp",f:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PROCEDURAL_GLSLF",j:{a:"grp",f:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 FL ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 FL ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 FL ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 FM ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 FN ( vec4 x ) { return FL ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 FO ) { vec2 FP = FL ( floor ( FO ) ) ; vec2 FQ = fract ( FO ) ; vec4 FR = FQ . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 FS = FQ . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = FN ( FP . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = FN ( p + FP . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 FT = FM ( p ) * K + K2 ; vec4 FU = FM ( floor ( p * K ) ) * K + K2 ; vec4 FV = FR + JITTER * FT ; vec4 FW = FS + JITTER * FU ; vec4 df = FV * FV + FW * FW ;".split(" ")},
{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 FO , float FX ) { vec2 FP = FL ( floor ( FO ) ) ; vec2 FQ = fract ( FO ) ; vec4 FR = FQ . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 FS = FQ . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = FN ( FP . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = FN ( p + FP . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 FT = FM ( p ) * K + K2 ; vec4 FU = FM ( floor ( p * K ) ) * K + K2 ; vec4 FV = FR + JITTER * FT ; vec4 FW = FS + JITTER * FU ; vec4 FY = FV * FV + FW * FW ; FV += FX ; FW += FX ; vec4 FZ = FV * FV + FW * FW ; FV += FX ; FW += FX ; vec4 F_ = FV * FV + FW * FW ; FY . xy = min ( FY . xy , FY . zw ) ; FY . x = min ( FY . x , FY . y ) ; FZ . xy = min ( FZ . xy , FZ . zw ) ; FZ . x = min ( FZ . x , FZ . y ) ; F_ . xy = min ( F_ . xy , F_ . zw ) ; F_ . x = min ( F_ . x , F_ . y ) ; return vec3 ( FY . x , FZ . x , F_ . x ) ; } vec3 Ga ( vec3 x ) { return FL ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Gb = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Gb . yy ) ) ; vec2 Gc = ki - bQ + dot ( bQ , Gb . xx ) ; vec2 Gd ; Gd = ( Gc . x > Gc . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Ge = Gc . xyxy + Gb . xxzz ; Ge . xy -= Gd ; bQ = FL ( bQ ) ; vec3 p = Ga ( Ga ( bQ . y + vec3 ( _0_0 , Gd . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Gd . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Gc , Gc ) , dot ( Ge . xy , Ge . xy ) , dot ( Ge . zw , Ge . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Gb . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 FT = floor ( x + 0.5 ) ; vec3 Gf = x - FT ; ap *= 1.79284291400159 - 0.85373472095314 * ( Gf * Gf + bO * bO ) ; vec3 g ; g . x = Gf . x * Gc . x + bO . x * Gc . y ; g . yz = Gf . yz * Ge . xz + bO . yz * Ge . yw ; return 130.0 * dot ( ap , g ) ; } vec2 Gi ( vec2 fm ) { float FY = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float FZ = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float Gg = fract ( sin ( FY ) * 43758.5453 ) * 2.0 - _1_0 ; float Gh = fract ( sin ( FZ ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( Gg , Gh ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"REFRACTION_GLSLF",j:{a:"grp",f:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 Gj = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( Gj ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 Gk ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + Gk ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
j:{a:"grp",f:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 Gl ) { return ( bE + 0.5 ) * Gl . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SHADOW_GLSLF",j:{a:"grp",f:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"procedural.glslf"}]}}]},{a:"cond",f:[{a:"if",
i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float Gm = 0.1 ; const float Gn = 0.1 ; const float Go = - 0.01 ; const float Gp = 0.05 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 Gq = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 Gr = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 Gs = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 Gt = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 Gu = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 Gv = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 Gw = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 Gx = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",i:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 Gq = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 Gr = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 Gs = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 Gt = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 Gu = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 Gv = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 Gw = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 Gx = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",i:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 Gq = vec2 ( - 0.51808083 , 0.0 ) ; vec2 Gr = vec2 ( 0.5741194 , 0.0 ) ; vec2 Gs = vec2 ( - 0.68048857 , 0.0 ) ; vec2 Gt = vec2 ( 0.82934988 , 0.0 ) ; vec2 Gu = vec2 ( 0.70009436 , 0.0 ) ; vec2 Gv = vec2 ( - 0.78790467 , 0.0 ) ; vec2 Gw = vec2 ( - 0.58619489 , 0.0 ) ; vec2 Gx = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool Gz ( vec2 hZ , float Gy ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + Gy ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - Gy ) ) ) ; } float GG ( float GA , float GB , mat2 GC , vec3 GD , float GE , PRECISION GLSL_SMPLR2D_SHDW GF ) {".split(" ")},
{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 hZ , eY ; eY . x = GA ; eY . y = GB ; eY = GC * eY ; hZ = GD . xy + eY * GE / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 hZ = GD . xy ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"if ( ! Gz ( hZ , Go ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COMPARED_MODE"],j:{a:"grp",
f:[{a:"txt",b:"return GLSL_TEXTURE ( GF , vec3 ( hZ , GD . z ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return step ( GD . z , GLSL_TEXTURE ( GF , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float GL ( vec3 GD , PRECISION GLSL_SMPLR2D_SHDW GF , float GE ) { float GH = 0.0 ; GD . z = clamp ( GD . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float GI = Gi ( GD . xy ) . x * M_PI ; float GJ = cos ( GI ) ; float GK = sin ( GI ) ; mat2 GC = mat2 ( GJ , GK , - GK , GJ ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { GH += GG ( Gq [ bQ ] , Gu [ bQ ] , GC , GD , GE , GF ) ; GH += GG ( Gr [ bQ ] , Gv [ bQ ] , GC , GD , GE , GF ) ; GH += GG ( Gs [ bQ ] , Gw [ bQ ] , GC , GD , GE , GF ) ; GH += GG ( Gt [ bQ ] , Gx [ bQ ] , GC , GD , GE , GF ) ; } return clamp ( GH / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"return GG ( 0.0 , 0.0 , mat2 ( 0.0 ) , GD , GE , GF ) ;".split(" ")}]}}]},{a:"txt",b:"} float GU ( vec3 GM , PRECISION GLSL_SMPLR2D_SHDW GN , vec3 GO , PRECISION GLSL_SMPLR2D_SHDW GP , float GQ , float GR , float aB ) { float GS , GT ; GM . z = clamp ( GM . z , 0.0 , 1.0 ) ; GO . z = clamp ( GO . z , 0.0 , 1.0 ) ; GS = 0.0 ; GT = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float GI = Gi ( GM . xy ) . x * M_PI ; float GJ = cos ( GI ) ; float GK = sin ( GI ) ; mat2 GC = mat2 ( GJ , GK , - GK , GJ ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { GS += GG ( Gq [ bQ ] , Gu [ bQ ] , GC , GM , GQ , GN ) ; GS += GG ( Gr [ bQ ] , Gv [ bQ ] , GC , GM , GQ , GN ) ; GS += GG ( Gs [ bQ ] , Gw [ bQ ] , GC , GM , GQ , GN ) ; GS += GG ( Gt [ bQ ] , Gx [ bQ ] , GC , GM , GQ , GN ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { GT += GG ( Gq [ bQ ] , Gu [ bQ ] , GC , GO , GR , GP ) ; GT += GG ( Gr [ bQ ] , Gv [ bQ ] , GC , GO , GR , GP ) ; GT += GG ( Gs [ bQ ] , Gw [ bQ ] , GC , GO , GR , GP ) ; GT += GG ( Gt [ bQ ] , Gx [ bQ ] , GC , GO , GR , GP ) ; } GS = mix ( GS , GT , aB ) ; GS /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"GS += GG ( 0.0 , 0.0 , mat2 ( 0.0 ) , GM , GQ , GN ) ; GT += GG ( 0.0 , 0.0 , mat2 ( 0.0 ) , GO , GR , GP ) ; GS = mix ( GS , GT , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( GS , 0.0 , 1.0 ) ; } float GV ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float GX ( float tE , float GW ) { if ( GW >= 0.0 && GW <= Gn ) tE = ( tE - 1.0 ) / Gn * GW + 1.0 ; return tE ; } float Hb ( vec3 GY , vec3 GZ , PRECISION GLSL_SMPLR2D_SHDW GN , PRECISION GLSL_SMPLR2D_SHDW GP , float GQ , float GR , float G_ , float fN ) { float tE ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CSM_BLEND_BETWEEN_CASCADES"],j:{a:"grp",f:[{a:"txt",b:"float GW = GV ( GY . xy ) ; if ( - fN > G_ && GW >= 0.0 && GW <= Gm && Gz ( GZ . xy , 0.0 ) ) { float Ha = 1.0 - GW / Gm ; tE = GU ( GY , GN , GZ , GP , GQ , GR , Ha ) ; } else".split(" ")}]}}]},{a:"txt",b:"tE = GL ( GY , GN , GQ ) ; return tE ; } float Hd ( vec3 Hc , PRECISION GLSL_SMPLR2D_SHDW GF , float GE , float G_ , float fN ) { float tE = GL ( Hc , GF , GE ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_FADE_LAST_CASCADE"],
j:{a:"grp",f:[{a:"txt",b:"if ( - fN > G_ ) { float GW = GV ( Hc . xy ) ; tE = GX ( tE , GW ) ; }".split(" ")}]}}]},{a:"txt",b:"return tE ; } vec4 dD ( float fN ) { float tE = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec4","He","=","u_pcf_blur_radii",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 He = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 GM = n . xyz / n . w ; if ( n . w < 0.0 ) GM . z = 0.0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 GO = o . xyz / o . w ; if ( o . w < 0.0 ) GO . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Hf = u . xyz / u . w ; if ( u . w < 0.0 ) Hf . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Hg = v . xyz / v . w ; if ( v . w < 0.0 ) Hg . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",b:"if ( Gz ( GM . xy , 0.0 ) ) { tE = Hb ( GM , GO , u_shadow_map0 , u_shadow_map1 , He [ 0 ] , He [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( Gz ( GM . xy , Gp ) ) { tE = Hd ( GM , u_shadow_map0 , He [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",b:"else { if ( Gz ( GO . xy , 0.0 ) ) {".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",b:"tE = Hb ( GO , Hf , u_shadow_map1 , u_shadow_map2 , He [ 1 ] , He [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"tE = Hd ( GO , u_shadow_map1 , He [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",
b:"else { if ( Gz ( Hf . xy , 0.0 ) ) {".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"tE = Hb ( Hf , Hg , u_shadow_map2 , u_shadow_map3 , He [ 2 ] , He [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"tE = Hd ( Hf , u_shadow_map2 , He [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"else { if ( Gz ( Hg . xy , 0.0 ) ) tE = Hd ( Hg , u_shadow_map3 , He [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float Hh = GL ( GO , u_shadow_map1 , He [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","Hh","=","0.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float Hi = GL ( Hf , u_shadow_map2 , He [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","Hi","=","0.0",";"]}]}}]},{a:"cond",
f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float Hj = GL ( Hg , u_shadow_map3 , He [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","Hj","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tE , Hh , Hi , Hj ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 GH = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"l_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cd *= GH . a ;".split(" ")}]}}]},{a:"txt",b:["return","GH",";"]}]}},{a:"elif",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 GH = dD ( i . z ) ; return GH ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SHADOW_GLSLV",j:{a:"grp",f:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"txt",b:"vec4 Hn ( mat4 Hk , vec4 Hl , mat4 Hm ) { vec2 dF = ( Hk * Hm [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 GD = Hk * Hl ; GD . xy += dF ; GD . xyz = 0.5 * ( GD . xyz + GD . w ) ; return GD ; } void bD ( vec3 eD , vec3 Ho ) {".split(" ")},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"mat4 Hm = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 Hm = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 Hp = Hm * vec4 ( eD + u_normal_offset * Ho , 1.0 ) ; n = Hn ( u_p_light_matrix0 , Hp , Hm ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"Hp = Hm * vec4 ( eD + u_normal_offset * Ho , 1.0 ) ; o = Hn ( u_p_light_matrix1 , Hp , Hm ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Hp = Hm * vec4 ( eD + u_normal_offset * Ho , 1.0 ) ; u = Hn ( u_p_light_matrix2 , Hp , Hm ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Hp = Hm * vec4 ( eD + u_normal_offset * Ho , 1.0 ) ; v = Hn ( u_p_light_matrix3 , Hp , Hm ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",
b:"o = Hn ( u_p_light_matrix1 , Hp , Hm ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",b:"u = Hn ( u_p_light_matrix2 , Hp , Hm ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"v = Hn ( u_p_light_matrix3 , Hp , Hm ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SKIN_GLSLV",j:{a:"grp",f:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 Hx ( in vec4 gI , in vec4 Hq , in float Hr ) { float Hs = gI [ 0 ] * Hq [ 0 ] + gI [ 1 ] * Hq [ 1 ] + gI [ 2 ] * Hq [ 2 ] + gI [ 3 ] * Hq [ 3 ] ; if ( Hs < 0.0 ) { Hq *= - 1.0 ; Hs = - Hs ; } if ( abs ( Hs ) >= 1.0 ) return gI ; float Ht = acos ( Hs ) ; float Hu = sqrt ( 1.0 - Hs * Hs ) ; if ( abs ( Hu ) < 0.001 ) return vec4 ( gI * 0.5 + Hq * 0.5 ) ; float Hv = sin ( ( 1.0 - Hr ) * Ht ) / Hu ; float Hw = sin ( Hr * Ht ) / Hu ; return gI * Hv + Hq * Hw ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"vec3 HL ( in vec3 N , in vec4 Hy , in vec4 Hz , in vec4 HA , in vec4 HB , in float HC ) { vec3 HD = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 gI = Hx ( Hy , Hz , HC ) ; vec4 HE = mix ( HA , HB , HC ) ; vec3 HF = O ( gI , HD ) ; vec3 HG = HF * HE . w + HE . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 HH = O ( Hy , HD ) ; vec3 HI = O ( Hz , HD ) ; vec3 HJ = HH * HA . w + HA . xyz ; vec3 HK = HI * HB . w + HB . xyz ; vec3 HG = mix ( HJ , HK , HC ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , HG ) ; } vec3 HR ( in vec3 HM , in vec4 Hy , in vec4 Hz , in float HC ) { vec3 HN = qn ( u_arm_rel_trans , u_arm_rel_quat , HM ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 gI = Hx ( Hy , Hz , HC ) ; vec3 HO = O ( gI , HN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 HP = O ( Hy , HN ) ; vec3 HQ = O ( Hz , HN ) ; vec3 HO = mix ( HP , HQ , HC ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , HO ) ; }".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 HL ( in vec3 N , in vec4 Hy , in vec4 HA ) { vec3 HD = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 HF = O ( Hy , HD ) ; vec3 HG = HF * HA . w + HA . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , HG ) ; } vec3 HR ( in vec3 HM , in vec4 Hy ) { vec3 HN = qn ( u_arm_rel_trans , u_arm_rel_quat , HM ) ; vec3 HO = O ( Hy , HN ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , HO ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:["float","HS","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 HT = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 HU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 HV = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 HW = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int HX = int ( HW [ bQ ] ) ; float HY = fract ( HW [ bQ ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",
b:"HT += HY * HR ( Q , u_quatsb [ HX ] , u_quatsa [ HX ] , HS ) ; HU += HY * HR ( R , u_quatsb [ HX ] , u_quatsa [ HX ] , HS ) ; HV += HY * HR ( P , u_quatsb [ HX ] , u_quatsa [ HX ] , HS ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iU += HY * HL ( N , u_quatsb [ HX ] , u_transb [ HX ] ) ; HV += HY * HR ( P , u_quatsb [ HX ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"HT += HY * HR ( Q , u_quatsb [ HX ] ) ; HU += HY * HR ( R , u_quatsb [ HX ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"int HX = int ( HW [ 0 ] ) ; float HY = fract ( HW [ 0 ] ) ; iU += HY * HL ( N , u_quatsb [ HX ] , u_quatsa [ HX ] , u_transb [ HX ] , u_transa [ HX ] , HS ) ; HX = int ( HW [ 1 ] ) ; HY = fract ( HW [ 1 ] ) ; iU += HY * HL ( N , u_quatsb [ HX ] , u_quatsa [ HX ] , u_transb [ HX ] , u_transa [ HX ] , HS ) ; HX = int ( HW [ 2 ] ) ; HY = fract ( HW [ 2 ] ) ; iU += HY * HL ( N , u_quatsb [ HX ] , u_quatsa [ HX ] , u_transb [ HX ] , u_transa [ HX ] , HS ) ; HX = int ( HW [ 3 ] ) ; HY = fract ( HW [ 3 ] ) ; iU += HY * HL ( N , u_quatsb [ HX ] , u_quatsa [ HX ] , u_transb [ HX ] , u_transa [ HX ] , HS ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = HV ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Q = HT ; R = HU ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int HZ = int ( a_influence [ 0 ] - 1.0 ) ; if ( HZ > - 1 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"N = HL ( N , u_quatsb [ HZ ] , u_quatsa [ HZ ] , u_transb [ HZ ] , u_transa [ HZ ] , HS ) ; Q = HR ( Q , u_quatsb [ HZ ] , u_quatsa [ HZ ] , HS ) ; R = HR ( R , u_quatsb [ HZ ] , u_quatsa [ HZ ] , HS ) ; P = HR ( P , u_quatsb [ HZ ] , u_quatsa [ HZ ] , HS ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"N = HL ( N , u_quatsb [ HZ ] , u_transb [ HZ ] ) ; P = HR ( P , u_quatsb [ HZ ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Q = HR ( Q , u_quatsb [ HZ ] ) ; R = HR ( R , u_quatsb [ HZ ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",j:{a:"grp",f:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",A:"std.glsl"},{a:"include",A:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 H_ ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",f:[{a:"if",i:["BLENDTYPE",
"MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","ADD",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SUBTRACT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE",
"SCREEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","OVERLAY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIVIDE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE",
"DARKEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LIGHTEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","HUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SATURATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE",
"VALUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","COLOR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Ia ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",f:[{a:"if",i:["BLENDTYPE","MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","ADD",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SUBTRACT",{a:"equal_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SCREEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","OVERLAY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIVIDE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DARKEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LIGHTEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
i:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Ib = 1.0 ; Ib = dM . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT"],j:{a:"grp",f:[{a:"txt",b:"Ib = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["MTEX_NEGATIVE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Ib = 1.0 - Ib ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT"],j:{a:"grp",f:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"Ib = dM . a ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_HORIZ"],j:{a:"grp",f:[{a:"txt",b:"dJ = H_ ( dM . rgb , dJ , Ib , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["float","Ic","=","0.0",";"]},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP"],
j:{a:"grp",f:[{a:"txt",b:"Ic = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["WOMAP_ZENDOWN"],j:{a:"grp",f:[{a:"txt",b:"else Ic = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP"],j:{a:"grp",f:[{a:"txt",b:"Ic = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",i:["WOMAP_ZENDOWN"],j:{a:"grp",f:[{a:"txt",b:"Ic = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Ic != 0.0 ) dK = H_ ( dM . rgb , dK , Ib , Ic ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_BLEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Ib = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Ia ( u_sky_tex_dvar , dI , Ib , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"STD_ENUMS_GLSL",j:{a:"grp",f:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",f:[{a:"if",i:["CONSTANTS_HACK"],j:{a:"grp",f:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"TO_WORLD_GLSLV",j:{a:"grp",f:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",A:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",f:[{a:"if",i:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
l:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 aX ( vec3 Id , mat3 M ) { vec4 Ie = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 If = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 If = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Ie = qe ( If , Ie ) ; Ie = kj ( Ie ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Id ; aY = cK ( Ie , aY ) ; return aY ; }".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 Ih ( vec3 kV , vec3 Id ) { vec3 Ig = kV - Id ; Ig . z = 0.0 ; Ig = normalize ( Ig ) ; vec4 Ie = qj ( Ig , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Id ; aY = cK ( Ie , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"mat3 ai ( in vec3 Ii , float Ij , float Ik , float Il , vec3 aQ , mat3 S ) { float Im = fract ( length ( aQ ) / 0.17 ) ; float In = Il + Im / 10.0 ; float Io = Im ; if ( Il != 0.0 ) Io /= Il ; Ii *= 1.0 + 0.5 * sin ( Ij ) ; float Ip = length ( Ii ) * Ik * sin ( 2.0 * 3.14 * Ij * In + Io ) ; vec4 Iq = cI ( TOWARD_VECTOR , Ip ) ; vec4 Ir = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; Ir = qe ( Ir , Iq ) ; S = cK ( Ir , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",l:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",i:["BILLBOARD_RANDOM"],j:{a:"grp",f:[{a:"txt",b:"float Im = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float Is = 2.0 * M_PI * Im ; vec4 It = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float Iu = asin ( 2.0 * ( It . x * It . y - It . z * It . w ) ) ; float gZ = Iu - Is ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float Iv = Is ; if ( gZ <= MAX_BILLBOARD_ANGLE ) Iv += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) Iv += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) Iv += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) Iv += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else Iv += gZ - 2.0 * M_PI ; vec4 Iw = cI ( UP_VECTOR , Iv ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( Iw , lj ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 lj = Ih ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 Ix , in vec3 Iy , in vec3 Iz , in vec3 IA , in vec3 IB , in mat3 S ) { eD = ad ( S , eD ) ; Ix = ad ( S , Ix ) ; Iy = T ( S , Iy ) ; Iz = T ( S , Iz ) ; IA = T ( S , IA ) ; IB = T ( S , IB ) ; return lk ( aj ( eD , Ix , Iy , Iz , IA , IB , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"WIND_BENDING_GLSLV",j:{a:"grp",f:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"void IO ( inout vec3 bd , in vec3 IC , in float ID , in float IE , in float eK , in vec3 Ii , in float IF , in mat4 by ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",
{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 IG = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 IH = ( by * vec4 ( IC , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 IG = bd ; vec3 IH = IC ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( IH ) ; float II = IE * ( 1.0 + 0.1 * fract ( dg ) ) ; float IJ = ID * IF * ( 1.0 + sin ( 2.0 * 3.14 * eK * II + dg ) ) ; float IK = ( IG . z - IH . z ) * abs ( IJ ) ; IK += 1.0 ; IK *= IK ; IK = IK * IK - IK ; vec3 IL = IG ; IL . xy += Ii . xy * IK * sign ( IJ ) ; vec3 IM = IL - IH ; if ( all ( equal ( IM , vec3 ( 0.0 ) ) ) ) bd = IC ; else {".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"IM = ( by * vec4 ( IM , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float IN = length ( IG - IH ) ; bd = IC + normalize ( IM ) * IN ; } }".split(" ")},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"vec4 IP ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 IQ ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 IR ( vec4 x ) { return IP ( IQ ( x ) ) ; } void Jc ( inout vec3 bd , in float eK , in vec3 P , in vec3 Ii , in vec3 IC , in float IS , in float IT , in float IU , in vec3 IV , in mat4 by ) { float IW ; float IX ; float IY ; vec2 IZ ; vec4 I_ ; vec2 Ja ; vec3 Jb ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 IG = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 IH = ( by * vec4 ( IC , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 IG = bd ; vec3 IH = IC ;".split(" ")}]}}]},{a:"txt",b:"IW = dot ( IH , vec3 ( 1.0 ) ) ; IX = IW + IV . g ; IY = dot ( IG , vec3 ( IV . g ) ) ; IZ = ( eK + vec2 ( IY , IX ) ) ; I_ = ( ( fract ( ( IZ . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( Ii ) * IS ; I_ = IR ( I_ ) ; Ja = I_ . xz + I_ . yw ; Ja . y = 0.5 - Ja . y ; Jb = Ja . xxy * IV . rrb * vec3 ( IT * P . x , IT * P . y , IU ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Jb = ( by * vec4 ( Jb , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Jb",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Jd = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:"vec3 Je = ac ; vec3 Jf = a_emitter_center ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Jf = ( by * vec4 ( Jf , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Je = N ; vec3 Jf = ac ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"Jc ( Je , u_time , P , Jd , Jf , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"IO ( Je , Jf , au_wind_bending_amp , au_wind_bending_freq , u_time , Jd , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"IO ( Je , Jf , au_wind_bending_amp , au_wind_bending_freq , u_time , Jd , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:"N += Je - ac ; ac = Je ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"N = Je ; ac = Jf ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.animation=function(a,r){var d=r("__animation"),c=r("__obj_util"),b=r("__print");a.SLOT_0=d.SLOT_0;a.SLOT_1=d.SLOT_1;a.SLOT_2=d.SLOT_2;a.SLOT_3=d.SLOT_3;a.SLOT_4=d.SLOT_4;a.SLOT_5=d.SLOT_5;a.SLOT_6=d.SLOT_6;a.SLOT_7=d.SLOT_7;a.SLOT_ALL=d.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=d.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=d.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=d.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=d.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=d.OBJ_ANIM_TYPE_SOUND;a.OBJ_ANIM_TYPE_PARTICLES=
d.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=d.OBJ_ANIM_TYPE_MATERIAL;a.OBJ_ANIM_TYPE_STATIC=d.OBJ_ANIM_TYPE_STATIC;a.AB_CYCLIC=d.AB_CYCLIC;a.AB_FINISH_RESET=d.AB_FINISH_RESET;a.AB_FINISH_STOP=d.AB_FINISH_STOP;a.is_animated=function(a){return d.is_animated(a)};a.get_anim_names=function(a){return d.uD(a)?d.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!d.is_animated(a))return null;b=b||d.SLOT_0;return d.RM(a,b)};a.apply=function(a,c,r){if(r>d.SLOT_7)b.error("Can't apply animation to slot "+
r+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{r=r||d.SLOT_0;if(d.is_animated(a)){var e=d.get_slot_num_by_anim(a,c);if(-1!=e&&e!=r){b.error('Animation "'+c+'" is already applied to object "'+a.name+'" (slot "'+e+'").');return}}d.PF(a,c)?d.apply(a,null,c,r):b.error('No fcurves in action "'+c+'"')}};a.apply_ext=function(a,c,r){if(r>d.SLOT_7)b.error("Can't apply animation to slot "+r+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{r=r||
d.SLOT_0;var e=c[0];if(d.is_animated(a)){var g=d.get_slot_num_by_anim(a,e);if(-1!=g&&g!=r){b.error('Animation "'+e+'" is already applied to object "'+a.name+'" (slot "'+g+'").');return}}d.PF(a,e)?d.apply(a,c.slice(1),e,r):b.error('No fcurves in action "'+e+'"')}};a.remove=function(a){d.remove(a)};a.remove_slot_animation=function(a,b){d.is_animated(a)&&(b=b||d.SLOT_0,d.remove_slot_animation(a,b))};a.apply_def=function(a){d.apply_def(a)};a.play=function(a,c,r){d.is_animated(a)?(r=r||d.SLOT_0,d.play(a,
c,r),d.NR(a,0,r,!0)):b.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){d.is_animated(a)&&(b=b||d.SLOT_0,d.stop(a,b))};a.is_play=function(a,b){if(!d.is_animated(a))return!1;b=b||d.SLOT_0;return d.is_play(a,b)};a.set_frame=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_frame(a,b,c))};a.set_first_frame=function(a,b){d.is_animated(a)&&d.set_first_frame(a,b)};a.set_last_frame=function(a,b){if(d.is_animated(a)){b=b||d.SLOT_0;var c=d.get_anim_start_frame(a,b),e=d.get_anim_length(a,
b);d.set_frame(a,c+e-d.CG,b)}};a.get_frame=function(a,b){if(!d.is_animated(a))return 0;b=b||d.SLOT_0;return d.rw(a,b)};a.set_speed=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_speed(a,b||1,c))};a.get_speed=function(a,b){if(!d.is_animated(a))return 0;b=b||d.SLOT_0;return a.fa[b]?d.get_speed(a,b):0};a.get_anim_start_frame=function(a,b){return d.is_animated(a)&&(b=b||d.SLOT_0,a.fa[b])?d.get_anim_start_frame(a,b):-1};a.get_anim_length=function(a,b){return d.is_animated(a)&&(b=b||d.SLOT_0,a.fa[b])?
d.get_anim_length(a,b):-1};a.set_behavior=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_behavior(a,b,c))};a.get_behavior=function(a,b){if(!d.is_animated(a))return null;b=b||d.SLOT_0;return d.get_behavior(a,b)};a.apply_smoothing=function(a,b,c,e){e=e||d.SLOT_0;d.is_animated(a)&&d.apply_smoothing(a,b,c,e)};a.frame_to_sec=function(a){return d.frame_to_sec(a)};a.get_slot_num_by_anim=function(a,b){return d.is_animated(a)&&b?d.get_slot_num_by_anim(a,b):-1};a.get_anim_type=function(a,b){return d.is_animated(a)?
d.get_anim_type(a,b):null};a.apply_to_first_empty_slot=function(a,b){return d.apply_to_first_empty_slot(a,b)};a.get_skel_mix_factor=function(a){return a.o.mg};a.set_skel_mix_factor=function(a,n,r){c.is_armature(a)?(n=Math.min(Math.max(n,0),1),a.o.mg!=n&&d.set_skel_mix_factor(a,n,r||0)):b.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,r){var d=r("__anchors");a.attach_move_cb=d.attach_move_cb;a.detach_move_cb=d.detach_move_cb;a.is_anchor=d.is_anchor;a.get_element_id=d.get_element_id;a.update=function(){d.update(!0)}};b4w.module.armature=function(a,r){var d=r("__armature"),c=r("__obj_util"),b=r("__transform"),g=r("__print");a.get_bone_tsr=function(a,b,e){if(!c.is_armature(a))return null;if(!d.ur(a,b))return g.error('There is no bone: "',b,'" in "',a.name,'".'),null;e||(e=new Float32Array(8));d.get_bone_tsr(a,b,!1,!1,e);return e};a.get_bone_tsr_rel=function(a,b,e){if(!c.is_armature(a))return null;if(!d.ur(a,b))return g.error('There is no bone: "',b,'" in "',a.name,'".'),null;e||(e=new Float32Array(8));d.get_bone_tsr(a,
b,!1,!0,e);return e};a.set_bone_tsr=function(a,r,e){c.is_armature(a)&&(d.ur(a,r)?(d.set_bone_tsr(a,r,e,!1),b.L(a)):g.error('There is no bone: "',r,'" in "',a.name,'".'))};a.set_bone_tsr_rel=function(a,r,e){c.is_armature(a)&&(d.ur(a,r)?(d.set_bone_tsr(a,r,e,!0),b.L(a)):g.error('There is no bone: "',r,'" in "',a.name,'".'))}};b4w.module.assets=function(a,r){var d=r("__assets");a.AT_ARRAYBUFFER=d.AT_ARRAYBUFFER;a.AT_JSON=d.AT_JSON;a.AT_TEXT=d.AT_TEXT;a.AT_AUDIOBUFFER=d.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=d.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=d.AT_AUDIO_ELEMENT;a.enqueue=function(a,b,g,n){if(a.length)if(a.id)d.enqueue(a,b,g,n);else{for(var c=[],e=0;e<a.length;e++){var u=a[e];c.push({id:u[0],type:u[1],url:u[2],request:u.request?u.request:"GET",ul:null,Mj:null,vb:u[3]})}d.enqueue(c,b,g,n)}}};b4w.module.camera=function(a,r){var d=r("__camera"),c=r("__constraints"),b=r("__container"),g=r("__mat4"),n=r("__math"),x=r("__obj_util"),e=r("__physics"),u=r("__print"),w=r("__scenes"),h=r("__transform"),m=r("__tsr"),B=r("__util"),k=r("__vec3"),f=r("__vec4"),F=r("__quat"),t=new Float32Array(2),q=new Float32Array(3),E=new Float32Array(3),J=new Float32Array(4),A=F.create(),I={},C={};a.MS_STATIC=d.MS_STATIC;a.MS_TARGET_CONTROLS=d.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=d.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=
d.MS_HOVER_CONTROLS;a.static_setup=function(a,b){if(x.is_camera(a)){d.Jq(a);a.o.kb=d.MS_STATIC;if(b){var c=b.pos||m.get_trans_view(a.o.v);b.look_at?d.oE(a,c,b.look_at):h.set_translation(a,c)}h.L(a);e.sync_transform(a);d.Am(a)}else u.error("static_setup(): Wrong camera object")};a.static_set_look_at=function(a,b,c){d.is_static_camera(a)?(b=b||m.get_trans_view(a.o.v),c?d.oE(a,b,c):h.set_translation(a,b),h.L(a),e.sync_transform(a)):u.error("static_set_look_at(): Wrong camera object or camera move style")};
a.static_set_rotation=function(a,b){d.is_static_camera(a)?(h.set_rotation(a,b),h.L(a),e.sync_transform(a)):u.error("static_set_rotation(): Wrong camera object or camera move style")};a.static_get_rotation=function(a,b){if(!d.is_static_camera(a))return u.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return h.get_rotation(a,b)};a.eye_setup=function(a,b){if(x.is_camera(a))if(b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=
typeof b.horiz_rot_lim.right))u.error("eye_setup(): Wrong horizontal limits object.");else if(b&&b.vert_rot_lim&&("number"!=typeof b.vert_rot_lim.down||"number"!=typeof b.vert_rot_lim.up))u.error("eye_setup(): Wrong vertical limits object.");else{d.Jq(a);a.o.kb=d.MS_EYE_CONTROLS;if(b){var c=b.pos||m.get_trans_view(a.o.v);d.tE(a,c,b.look_at,b.horiz_rot_lim,b.vert_rot_lim)}h.L(a);e.sync_transform(a);d.Am(a)}else u.error("eye_setup(): Wrong camera object")};a.eye_set_look_at=function(a,b,f){d.is_eye_camera(a)?
(b=b||m.get_trans_view(a.o.v),f?d.rQ(a,b,f):h.set_translation(a,b),c.correct_up(a,a.o.sf,!0),h.L(a),e.sync_transform(a)):u.error("eye_set_look_at(): Wrong camera object or camera move style")};a.eye_rotate=function(a,b,c,f,g){d.is_eye_camera(a)?(d.dy(a,b,c,f||!1,g||!1),h.L(a),e.sync_transform(a)):u.error("eye_rotate(): Wrong camera object or camera move style")};a.eye_set_vertical_limits=function(a,b){d.is_eye_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.rE(a,b),h.L(a),e.sync_transform(a)):
u.error("eye_set_vertical_limits(): Incorrect limits object."):u.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.eye_get_vertical_limits=function(a,b,c){if(!d.is_eye_camera(a))return u.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.o;return a.Da?(b=b||{},c?(b.down=a.Da.km,b.up=a.Da.vn):(b.down=a.Da.down,b.up=a.Da.up),b.camera_space=c||!1,b):null};a.eye_set_horizontal_limits=function(a,b){d.is_eye_camera(a)?!b||"number"==typeof b.left&&
"number"==typeof b.right?(d.mE(a,b),h.L(a),e.sync_transform(a)):u.error("eye_set_horizontal_limits(): Incorrect limits object."):u.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.eye_get_horizontal_limits=function(a,b,c){if(!d.is_eye_camera(a))return u.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.o;return a.Bb?(b=b||{},c?(b.left=a.Bb.Gm,b.right=a.Bb.Zm):(b.left=a.Bb.left,b.right=a.Bb.right),b.camera_space=c||!1,b):null};
a.target_setup=function(a,b){if(x.is_camera(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){u.error("target_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.Mp&&
("number"!=typeof b.Mp.min_y||"number"!=typeof b.Mp.max_y||b.Mp.min_y>b.Mp.max_y))u.error("target_setup(): Wrong pivot limits object");else{d.Jq(a);a.o.kb=d.MS_TARGET_CONTROLS;var c=b.pos||m.get_trans_view(a.o.v);d.vE(a,c,b.pivot,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.Mp,b.use_panning||!1);h.L(a);e.sync_transform(a);d.Am(a)}}else u.error("target_setup(): Wrong vertical limits object");else u.error("target_setup(): Wrong horizontal limits object");else u.error("target_setup(): Wrong camera object")};
a.target_rotate=function(a,b,c,f,g){d.is_target_camera(a)?(d.XD(a,b,c,f||!1,g||!1),h.L(a),e.sync_transform(a)):u.error("target_rotate(): Wrong camera object or camera move style")};a.target_set_trans_pivot=function(a,b,c){d.is_target_camera(a)?(b=b||m.get_trans_view(a.o.v),c=c||a.o.pivot,d.my(a,b,c),h.L(a),e.sync_transform(a)):u.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.target_set_pivot_translation=function(a,b){d.is_target_camera(a)?(d.yQ(a,b),h.L(a),e.sync_transform(a)):
u.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.target_set_distance=function(a,b){if(d.is_target_camera(a)){var c=h.Dp(a,a.o.pivot);h.move_local(a,0,0,Math.max(0,b)-c);h.L(a);e.sync_transform(a)}else u.error("target_set_distance(): Wrong camera object or camera move style")};a.target_get_distance=function(a){return d.is_target_camera(a)?h.Dp(a,a.o.pivot):(u.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.target_zoom_object=function(a,
b){if(d.is_target_camera(a)){var c=h.get_object_center(b,!1,q),f=h.get_object_size(b),g=w.get_active(),g=x.oa(a,g).ea[0],g=d.QM(g)/2,f=f/Math.sin(g),g=h.Dp(a,c);d.my(a,m.get_trans_view(a.o.v),c);h.L(a);h.move_local(a,0,0,f-g);h.L(a);e.sync_transform(a)}else u.error("target_zoom_object(): Wrong camera object or camera move style")};a.target_get_pivot=function(a,b){if(!d.is_target_camera(a))return u.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);
k.copy(a.o.pivot,b);return b};a.target_set_distance_limits=function(a,b){if(d.is_target_camera(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){u.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}d.fQ(a,b);h.L(a);e.sync_transform(a)}else u.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.target_get_distance_limits=function(a,b){if(!d.is_target_camera(a))return u.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var c=a.o;return c.ub?(b=b||{},b.min=c.ub.min,b.max=c.ub.max,b):null};a.target_set_vertical_limits=function(a,b){d.is_target_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.rE(a,b),h.L(a),e.sync_transform(a)):u.error("target_set_vertical_limits(): Wrong limits object"):u.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.target_get_vertical_limits=function(a,b,c){if(!d.is_target_camera(a))return u.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.o;return a.Da?(b=b||{},c?(b.down=a.Da.km,b.up=a.Da.vn):(b.down=a.Da.down,b.up=a.Da.up),b.camera_space=c||!1,b):null};a.target_set_horizontal_limits=function(a,b){d.is_target_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.mE(a,b),h.L(a),e.sync_transform(a)):u.error("target_set_horizontal_limits(): Wrong limits object"):u.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.target_get_horizontal_limits=function(a,b,c){if(!d.is_target_camera(a))return u.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.o;return a.Bb?(b=b||{},c?(b.left=a.Bb.Gm,b.right=a.Bb.Zm):(b.left=a.Bb.left,b.right=a.Bb.right),b.camera_space=c||!1,b):null};a.target_set_pivot_limits=function(a,b){d.is_target_camera(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?u.error("target_set_pivot_limits(): Wrong limits object"):(d.uQ(a,b),h.L(a),e.sync_transform(a)):u.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.target_get_pivot_limits=function(a,b){if(!d.is_target_camera(a))return u.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var c=a.o;return c.Dd?(b=b||{},b.min_z=c.Dd.min_z,b.max_z=c.Dd.max_z,b):null};a.target_pan_pivot=function(a,b,c){if(d.is_target_camera(a)){var f=a.o;f.use_panning&&(q[0]=b,q[1]=-c,q[2]=0,m.transform_dir_vec3(q,f.v,q),k.add(f.pivot,q,f.pivot),b=m.get_trans_view(f.v),k.add(b,q,b),h.L(a),e.sync_transform(a))}else u.error("target_pan_pivot(): wrong object")};a.target_switch_panning=function(a,b){if(!d.is_target_camera(a))return u.error("target_switch_panning(): Wrong camera object or camera move style"),
null;a.o.use_panning=b};a.hover_setup_rel=function(b,c){a.hover_setup(b,{pos:c.pos,pivot:c.pivot});var f="undefined"==typeof c.dist_interval?0:Math.max(c.dist_interval,0),g="undefined"==typeof c.angle_interval?0:Math.max(c.angle_interval,0),k="undefined"==typeof c.t?.5:B.clamp(c.t,0,1),l=a.hover_get_distance_limits(b,I);l.min=Math.max(l.min-k*f,0);l.max+=(1-k)*f;f=a.hover_get_vertical_limits(b,C);f.down=B.clamp(f.down+k*g,-Math.PI/2,0);f.up=B.clamp(f.up-(1-k)*g,-Math.PI/2,0);d.hover_set_distance_limits(b,
l);d.hover_set_vertical_limits(b,f);h.L(b);e.sync_transform(b);d.Am(b)};a.hover_setup=function(a,b){if(x.is_camera(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){u.error("hover_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<
b.hover_angle_lim.up))u.error("hover_setup(): Wrong hover angle limits object");else if(b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max))u.error("hover_setup(): Wrong horizontal translation limits object");else if(b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max))u.error("hover_setup(): Wrong vertical translation limits object");
else{d.Jq(a);a.o.kb=d.MS_HOVER_CONTROLS;var c=b.pos||m.get_trans_view(a.o.v);d.uE(a,c,b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1);h.L(a);e.sync_transform(a);d.Am(a)}}else u.error("hover_setup(): Wrong camera object")};a.hover_rotate=function(a,b,c,f,g){d.is_hover_camera(a)?(d.ey(a,b,c,f||!1,g||!1),h.L(a),e.sync_transform(a)):u.error("hover_rotate(): Wrong camera object or camera move style")};a.hover_set_pivot_translation=function(a,b){d.is_hover_camera(a)?
(d.nE(a,b),h.L(a),e.sync_transform(a)):u.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.hover_get_pivot=function(a,b){if(!d.is_hover_camera(a))return u.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);k.copy(a.o.fc,b);return b};a.hover_get_distance=function(a){return d.is_hover_camera(a)?h.Dp(a,a.o.fc):(u.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.hover_set_vertical_limits=function(a,
b){d.is_hover_camera(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?u.error("hover_set_vertical_limits(): Wrong limits object"):(d.hover_set_vertical_limits(a,b),h.L(a),e.sync_transform(a)):u.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.hover_get_vertical_limits=function(a,b){if(!d.is_hover_camera(a))return u.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var c=a.o;b=b||{};b.down=c.Da.down;b.up=c.Da.up;return b};
a.hover_set_distance_limits=function(a,b){d.is_hover_camera(a)?"number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max?u.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),d.hover_set_distance_limits(a,b),h.L(a),e.sync_transform(a)):u.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.hover_get_distance_limits=function(a,b){if(!d.is_hover_camera(a))return u.error("hover_get_distance_limits(): Wrong camera object or camera move style"),
null;var c=a.o;b=b||{};b.min=c.ub.min;b.max=c.ub.max;return b};a.hover_set_vert_trans_limits=function(a,b){d.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?u.error("hover_set_vert_trans_limits(): Wrong limits object"):(d.CQ(a,b),h.L(a),e.sync_transform(a)):u.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.hover_get_vert_trans_limits=function(a,b){if(!d.is_hover_camera(a))return u.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),
null;var c=a.o;return c.cd?(b=b||{},b.min=c.cd.min,b.max=c.cd.max,b):null};a.hover_set_horiz_trans_limits=function(a,b){d.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?u.error("hover_set_horiz_trans_limits(): Wrong limits object"):(d.lQ(a,b),h.L(a),e.sync_transform(a)):u.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.hover_get_horiz_trans_limits=function(a,b){if(!d.is_hover_camera(a))return u.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),
null;var c=a.o;return c.bd?(b=b||{},b.min=c.bd.min,b.max=c.bd.max,b):null};a.hover_switch_horiz_rotation=function(a,b){if(!d.is_hover_camera(a))return u.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.o.kh=b};a.is_static_camera=d.is_static_camera;a.is_target_camera=d.is_target_camera;a.is_eye_camera=d.is_eye_camera;a.is_hover_camera=d.is_hover_camera;a.get_move_style=function(a){return x.is_camera(a)?d.get_move_style(a):(u.error("get_move_style(): Wrong camera object"),
null)};a.set_translation=function(a,b){if(x.is_camera(a)){var c=a.o;if(d.is_target_camera(a)){var f=m.get_trans_view(c.v),f=k.subtract(b,f,q);k.add(f,c.pivot,c.pivot)}else d.is_hover_camera(a)&&(f=m.get_trans_view(c.v),f=k.subtract(b,f,q),k.add(f,c.fc,c.fc));h.set_translation(a,b);h.L(a);e.sync_transform(a)}else u.error("set_translation(): Wrong camera object")};a.get_translation=function(a,b){if(!x.is_camera(a))return u.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);
return h.get_translation(a,b)};a.rotate_camera=function(a,b,c,f,g){x.is_camera(a)?(f=f||!1,g=g||!1,d.is_target_camera(a)?d.XD(a,b,c,f,g):d.is_eye_camera(a)?d.dy(a,b,c,f,g):d.is_hover_camera(a)?d.ey(a,b,c,f,g):d.is_static_camera(a)?u.warn("rotate_camera(): not supported for STATIC cameras"):u.error("rotate_camera(): Wrong camera move style"),h.L(a),e.sync_transform(a)):u.error("rotate_camera(): Wrong camera object")};a.set_velocities=function(a,b){if(x.is_camera(a)){var c=a.o;"number"==typeof b.trans&&
(c.An=B.clamp(b.trans,0,Infinity));"number"==typeof b.rot&&(c.zn=B.clamp(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.Bn=B.clamp(b.zoom,0,.99))}else u.error("set_velocities(): Wrong camera object")};a.get_velocities=function(a,b){if(!x.is_camera(a))return u.error("get_velocities(): Wrong camera object"),null;var c=a.o;b=b||{};b.trans=c.An;b.rot=c.zn;b.zoom=c.Bn;return b};a.is_look_up=function(a){if(!x.is_camera(a))return u.error("is_look_up(): Wrong camera object"),!1;a=m.get_quat_view(a.o.v);return 0<=
B.quat_to_dir(a,B.AXIS_MZ,q)[1]};a.get_camera_angles=function(a,b){if(!x.is_camera(a))return u.error("get_camera_angles(): Wrong camera object"),null;b=b||new Float32Array(2);d.get_camera_angles(a,b);return b};a.get_camera_angles_char=function(a,b){if(!x.is_camera(a))return u.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);d.get_camera_angles_char(a,b);return b};a.get_camera_angles_dir=function(a,b){b=b||new Float32Array(2);var c=k.normalize(a,q),c=B.hy(B.AXIS_MZ,
c,A);B.correct_cam_quat_up(c,!0);d.qw(c,b);return b};a.set_stereo_distance=function(a,b){if(x.is_camera(a))for(var c=w.get_active(),c=x.oa(a,c).ea,e=0;e<c.length;e++){var f=c[e];f.type!=d.pc&&f.type!=d.wc&&f.type!=d.re&&f.type!=d.Yd||d.xQ(f,b,f.He)}else u.error("set_stereo_distance(): Wrong camera object")};a.get_stereo_distance=function(a){if(!x.is_camera(a))return u.error("get_stereo_distance(): Wrong camera object"),0;var b=w.get_active();a=x.oa(a,b).ea;for(b=0;b<a.length;b++){var c=a[b];if(c.type==
d.pc||c.type==d.wc)return c.Vj}return 0};a.set_eye_distance=function(a,b){if(x.is_camera(a)){var c=w.get_active(),c=x.oa(a,c).ea;d.set_eye_distance(c,b)}else u.error("set_eye_distance(): Wrong camera object")};a.get_eye_distance=function(a){if(!x.is_camera(a))return u.error("get_eye_distance(): Wrong camera object"),0;var b=w.get_active();a=x.oa(a,b).ea;for(b=0;b<a.length;b++){var c=a[b];if(c.type==d.pc||c.type==d.wc||c.type==d.re||c.type==d.Yd)return c.He}return 0};a.set_vertical_axis=function(a,
b){x.is_camera(a)?(k.copy(b,a.o.sf),h.L(a),e.sync_transform(a)):u.error("set_vertical_axis(): Wrong camera object")};a.get_vertical_axis=function(a,b){if(x.is_camera(a))return b||(b=k.create()),k.copy(a.o.sf,b),b;u.error("get_vertical_axis(): Wrong camera object")};a.translate_view=function(a,b,c,e){if(x.is_camera(a)){var f=w.get_active();a=x.oa(a,f).ea;for(f=0;f<a.length;f++){var h=a[f];h.hc||d.Sj(h,!1);var k=q;k[0]=-b;k[1]=-c;k[2]=0;g.translate(h.lb,k,h.lb);g.rotateZ(h.lb,e,h.lb);d.GA(h);d.qv(h)}}else u.error("translate_view(): Wrong camera object")};
a.get_view_vector=function(a,b){if(!x.is_camera(a))return u.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=m.get_quat_view(a.o.v);B.quat_to_dir(c,B.AXIS_MZ,b);return b};a.get_fov=function(a){if(!x.is_camera(a))return u.error("get_fov(): Wrong camera object"),0;var b=w.get_active();a=x.oa(a,b).ea;return d.get_fov(a[0])};a.set_fov=function(a,b){if(x.is_camera(a))for(var c=w.get_active(),c=x.oa(a,c).ea,e=0;e<c.length;e++){var f=c[e];d.set_fov(f,b);f.hc||d.Sj(f,!1);
d.GA(f);d.qv(f)}else u.error("set_fov(): Wrong camera object")};a.set_hmd_fov=function(){u.ja("set_hmd_fov() deprecated")};a.correct_up=function(a,b,d){x.is_camera(a)?(b=b||a.o.sf,c.correct_up(a,b,d||!1),h.L(a),e.sync_transform(a)):u.error("correct_up(): Wrong camera object")};a.set_ortho_scale=function(a,b){if(x.is_camera(a)&&d.is_ortho_camera(a)){var c=a.o;if(d.is_target_camera(a)){var e=m.get_trans_view(c.v),e=k.dist(e,c.pivot);c.tj=b/2*c.sj/e}else d.is_hover_camera(a)?(e=m.get_trans_view(c.v),
e=k.distance(e,c.fc),c.tj=b/2*c.sj/e):(c=w.get_active(),x.oa(a,c).ea[0].top=b/2);d.QR(a)}else u.error("set_ortho_scale(): Wrong camera object")};a.get_ortho_scale=function(a){if(!x.is_camera(a)||!d.is_ortho_camera(a))return u.error("get_ortho_scale(): Wrong camera object"),0;var b=w.get_active();return 2*x.oa(a,b).ea[0].top};a.is_ortho_camera=function(a){return x.is_camera(a)?d.is_ortho_camera(a):(u.error("is_ortho_camera(): Wrong camera object"),!1)};a.calc_ray=function(a,c,e,f){if(!x.is_camera(a))return u.error("calc_ray(): Wrong camera object"),
null;var g=w.get_active(),l=x.oa(a,g).ea[0];f&&3==f.length?u.ja('dest parameter in the function "calc_ray" should be type of parametric line.'):f=f||new Float32Array(6);switch(l.type){case d.Zc:case d.vf:case d.pc:case d.wc:var v=Math.tan(d.vN(l)/2),r=v*l.fb,g=q;c=b.po(c,e,t,l);g[0]=(2*c[0]/l.width-1)*r;g[1]=(1-2*c[1]/l.height)*v;g[2]=-1;m.transform_dir_vec3(g,a.o.v,g);k.normalize(g,g);3==f.length?k.copy(g,f):(a=h.get_translation(a,E),n.set_pline_initial_point(f,a),n.set_pline_directional_vec(f,g));
return f;case d.Jd:return g=q,c=b.po(c,e,t,l),g[0]=(2*c[0]/l.width-1)*l.top*l.fb,g[1]=(1-2*c[1]/l.height)*l.top,g[2]=0,m.transform_vec3(g,a.o.v,g),k.copy(g,f),a=m.get_quat_view(a.o.v,J),k.transformQuat(B.AXIS_MZ,a,g),n.set_pline_directional_vec(f,g),f;default:return u.error("calc_ray(): Non-compatible camera"),f}};a.project_point=function(a,b,c){if(!x.is_camera(a))return u.error("project_point(): Wrong camera object"),null;c=c||new Float32Array(2);return d.project_point(a,b,c)};a.has_distance_limits=
function(a){return(d.is_target_camera(a)||d.is_hover_camera(a))&&null!==a.o.ub};a.has_vertical_rot_limits=function(a){return(d.is_eye_camera(a)||d.is_target_camera(a)||d.is_hover_camera(a))&&null!==a.o.Da};a.has_horizontal_rot_limits=function(a){return(d.is_target_camera(a)||d.is_eye_camera(a))&&null!==a.o.Bb};a.has_vertical_trans_limits=function(a){return d.is_hover_camera(a)&&null!==a.o.cd};a.has_horizontal_trans_limits=function(a){return d.is_hover_camera(a)&&null!==a.o.bd};a.get_frustum_planes=
function(a,b){if(!x.is_camera(a))return u.error("get_frustum_planes(): Wrong camera object"),null;var c=w.get_active(),c=x.oa(a,c).ea[0].mh;f.copy(c.left,b.left);f.copy(c.right,b.right);f.copy(c.top,b.top);f.copy(c.bottom,b.bottom);f.copy(c.near,b.near);f.copy(c.far,b.far);return b}};b4w.module.config=function(a,r){var d=r("__config"),c=r("__compat"),b=r("__debug"),g=r("__data"),n=r("__print");a.P_LOW=d.P_LOW;a.P_HIGH=d.P_HIGH;a.P_ULTRA=d.P_ULTRA;a.P_CUSTOM=d.P_CUSTOM;a.P_AUTO=d.P_AUTO;a.set=d.set;a.get=d.get;a.reset=d.reset;a.reset_limits=d.reset_limits;a.get_std_assets_path=d.get_assets_path;a.get_assets_path=d.get_assets_path;a.apply_quality=function(a){g.is_primary_loaded()?n.error("Cannot change quality profile after a scene is loaded."):(d.set("quality",a),b.hs()&&(d.apply_quality(),
c.lE(b.hs(),!1)))}};b4w.module.controls=function(a,r){var d=r("__controls"),c=r("__physics"),b=r("__print");a.CT_POSITIVE=d.CT_POSITIVE;a.CT_CONTINUOUS=d.CT_CONTINUOUS;a.CT_TRIGGER=d.CT_TRIGGER;a.CT_SHOT=d.CT_SHOT;a.CT_LEVEL=d.CT_LEVEL;a.CT_CHANGE=d.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=
54;a.KEY_7=55;a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_MULT=106;a.KEY_ADD=107;a.KEY_SUB=
109;a.KEY_DEC_POINT=110;a.KEY_DIV=111;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=d.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=d.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=d.PL_MULTITOUCH_MOVE_PAN;a.PL_MULTITOUCH_MOVE_ROTATE=d.PL_MULTITOUCH_MOVE_ROTATE;a.default_AND_logic_fun=d.default_AND_logic_fun;
a.default_OR_logic_fun=d.default_OR_logic_fun;a.create_gamepad_btn_sensor=d.create_gamepad_btn_sensor;a.create_gamepad_axis_sensor=d.create_gamepad_axis_sensor;a.create_custom_sensor=d.create_custom_sensor;a.create_keyboard_sensor=d.create_keyboard_sensor;a.create_collision_sensor=function(a,b,c){return d.create_collision_sensor(a,b||"ANY",c||!1)};a.create_collision_impulse_sensor=d.create_collision_impulse_sensor;a.create_ray_sensor=function(a,n,r,e,u,w,h){if(a&&!c.ka(a))b.ja("No physics for object "+
a.name);else return d.create_ray_sensor(a,n,r,e||"ANY",u||!1,w||!1,h||!1)};a.create_mouse_click_sensor=d.create_mouse_click_sensor;a.create_mouse_wheel_sensor=d.create_mouse_wheel_sensor;a.create_mouse_move_sensor=d.create_mouse_move_sensor;a.create_plock_mouse_sensor=d.create_plock_mouse_sensor;a.create_plock_sensor=d.create_plock_sensor;a.create_touch_move_sensor=d.create_touch_move_sensor;a.create_touch_zoom_sensor=d.create_touch_zoom_sensor;a.create_touch_rotate_sensor=d.create_touch_rotate_sensor;
a.create_touch_click_sensor=d.create_touch_click_sensor;a.create_motion_sensor=d.create_motion_sensor;a.create_vertical_velocity_sensor=d.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=d.create_gyro_angles_sensor;a.create_gyro_quat_sensor=d.create_gyro_quat_sensor;a.create_gyro_delta_sensor=d.create_gyro_delta_sensor;a.create_hmd_quat_sensor=d.create_hmd_quat_sensor;a.create_hmd_position_sensor=d.create_hmd_position_sensor;a.create_timer_sensor=function(a,b){return d.create_timer_sensor(a,
b||!1)};a.reset_timer_sensor=d.reset_timer_sensor;a.create_elapsed_sensor=d.create_elapsed_sensor;a.create_timeline_sensor=d.create_timeline_sensor;a.create_selection_sensor=function(a,b){return d.create_selection_sensor(a,b||!1)};a.create_callback_sensor=function(a,b){return d.create_callback_sensor(a,b||0)};a.set_custom_sensor=function(a,b){d.XP(a,b)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=d.get_sensor_value;a.get_sensor_payload=d.get_sensor_payload;a.create_sensor_manifold=
function(a,b,c,e,u,w,h){u=u||d.default_AND_logic_fun;d.create_sensor_manifold(a,b,c,e,u,w,void 0===h?null:h)};a.create_kb_sensor_manifold=function(a,b,c,e,u,w){e=d.create_keyboard_sensor(e);d.create_sensor_manifold(a,b,c,[e],d.default_AND_logic_fun,u,void 0===w?null:w)};a.check_sensor_manifolds=function(a){return d.check_sensor_manifold(a,null)};a.check_sensor_manifold=d.check_sensor_manifold;a.remove_sensor_manifold=d.remove_sensor_manifold;a.reset=d.reset;a.set_plock_smooth_factor=d.set_plock_smooth_factor};b4w.module.constraints=function(a,r){var d=r("__camera"),c=r("__constraints"),b=r("__physics"),g=r("__print"),n=r("__transform");a.append_stiff=function(a,d,g,w,h){h=h||1;d instanceof Array&&2==d.length?c.RI(a,d[0],d[1],g,w,h):c.eA(a,d,g,w,h);n.L(a);b.sync_transform(a)};a.append_semi_stiff=function(a,d,g,w){c.OI(a,d,g,w);n.L(a);b.sync_transform(a)};a.append_semi_stiff_cam=function(a,e,u,w,h,m,r,k){d.is_eye_camera(a)?(h=h||-Math.PI/2,m=m||Math.PI/2,r=r||Math.PI/2,k=k||-Math.PI/2,c.NI(a,e,u,w,h,m,r,
k),n.L(a),b.sync_transform(a)):g.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_semi_soft_cam=function(a,e,u,w){if(d.is_eye_camera(a)){if(!w||0>w)w=.25;c.MI(a,e,u,w);n.L(a);b.sync_transform(a)}else g.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_stiff_trans=function(a,d,g){c.TI(a,d,g);n.L(a);b.sync_transform(a)};a.append_copy_trans=function(a,d,g){c.FI(a,d,g);n.L(a);b.sync_transform(a)};
a.append_stiff_trans_rot=function(a,d,g,w){c.UI(a,d,g,w);n.L(a);b.sync_transform(a)};a.append_track=function(a,d){3==d.length?c.WI(a,d):c.VI(a,d);n.L(a);b.sync_transform(a)};a.append_follow=function(a,d,g,w){3==d.length?c.JI(a,d,g,w):c.II(a,d,g,w);n.L(a);b.sync_transform(a)};a.append_stiff_viewport=function(a,d,g){c.append_stiff_viewport(a,d,g);n.L(a);b.sync_transform(a)};a.remove=function(a){a.cc&&c.remove(a)}};b4w.module.container=function(a,r){var d=r("__container"),c=r("__print");a.get_canvas=d.get_canvas;a.get_canvas_hud=d.get_canvas_hud;a.get_container=d.get_container;a.insert_to_container=function(a,g){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&g&&d.insert_to_container(a,g)};a.set_canvas_offsets=function(a,g){c.ja("container.set_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");return d.set_canvas_offsets(a,g)};
a.update_canvas_offsets=function(){c.ja("container.update_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");d.update_canvas_offsets()};a.client_to_canvas_coords=function(a,c,n){n||(n=new Float32Array(2));return d.client_to_canvas_coords(a,c,n)};a.client_to_element_coords=function(a,c,n,r){r||(r=new Float32Array(2));return d.client_to_element_coords(a,c,n,r)};a.force_offsets_updating=function(){c.ja("container.force_offsets_updating() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");
d.force_offsets_updating()};a.resize=function(a,g,n){a&&g||c.warn("Wrong canvas container dimensions: "+a+"x"+g+". Zero dimensions aren't allowed. Resized to: "+d.Hu+"x"+d.Gu+".");d.resize(a,g,n)};a.resize_to_container=function(a){d.resize_to_container(a||!1)}};b4w.module.data=function(a,r){var d=r("__data"),c=r("__loader");a.load=d.load;a.unload=function(a){d.unload(a|0)};a.set_debug_resources_root=d.set_debug_resources_root;a.is_primary_loaded=d.is_primary_loaded;a.is_idle=c.al;a.load_and_add_new=d.load;a.cleanup=a.unload;a.activate_media=d.activate_media;a.prefetch=d.prefetch;a.unfetch=d.unfetch};b4w.module.debug=function(a,r){function d(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;q.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.lw.ALL_OPS-a.lw.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.lw,e=c.vS,f=g(c.yL),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";q.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);q.groupCollapsed("directives");for(var h=c.ab.ei.slice().sort(),f=0;f<h.length;f++){var k=h[f];q.dd(k[0],k[1])}q.groupEnd();q.groupCollapsed("node elements");h=c.ab.Rf;for(f=0;f<h.length;f++)q.dd(h[f]);q.groupEnd();q.groupCollapsed("vert source");q.dd(c.tS);q.groupEnd();q.groupCollapsed("vert translated source");q.dd(c.uS);q.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];q.groupCollapsed("vert ops stats");for(var m in e)-1==f.indexOf(m)&&q.dd(m,e[m]);
q.groupEnd();q.groupCollapsed("vert assembly");q.dd(c.sS);q.groupEnd();q.groupCollapsed("frag source");q.dd(c.BM);q.groupEnd();q.groupCollapsed("frag translated source");q.dd(c.CM);q.groupEnd();q.groupCollapsed("frag ops stats");for(m in d)-1==f.indexOf(m)&&q.dd(m,d[m]);q.groupEnd();q.groupCollapsed("frag assembly");q.dd(c.tM);q.groupEnd();q.groupEnd()}}function g(a){for(var b=[],c=J.jp(),d=0;d<c.length;d++)for(var e=c[d],g=f.Ib(e,"MESH",f.DATA_ID_ALL),h=0;h<g.length;h++){var k=F.oa(g[h],e);if(k&&
k.R.length)for(var k=k.R,m=0;m<k.length;m++){var l=k[m];if(l.ib==a)for(var n=0;n<l.Jb.length;n++){var p=l.Jb[n];-1==b.indexOf(p)&&b.push(p)}}}return b}function n(a,b){function c(){y.push(c);Z=b;return a.apply(a,arguments)}return c}function x(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var e=r("__config"),u=r("__compat"),w=r("__controls"),
h=r("__container"),m=r("__debug"),B=r("__extensions"),k=r("__loader"),f=r("__objects"),F=r("__obj_util"),t=r("__physics"),q=r("__print"),E=r("__renderer"),J=r("__scenes"),A=r("__scenegraph"),I=r("__sfx"),C=r("__shaders"),v=r("__subscene"),l=r("__textures"),z=r("__tsr"),H=r("__util"),p=r("__vec3"),Q=e.H,y=[],Z="",S=!0,G=new Float32Array(2);a.DV_NONE=m.DV_NONE;a.DV_OPAQUE_WIREFRAME=m.DV_OPAQUE_WIREFRAME;a.DV_TRANSPARENT_WIREFRAME=m.DV_TRANSPARENT_WIREFRAME;a.DV_FRONT_BACK_VIEW=m.DV_FRONT_BACK_VIEW;
a.DV_BOUNDINGS=m.DV_BOUNDINGS;a.DV_CLUSTERS_VIEW=m.DV_CLUSTERS_VIEW;a.DV_BATCHES_VIEW=m.DV_BATCHES_VIEW;a.DV_RENDER_TIME=m.DV_RENDER_TIME;a.physics_stats=function(){t.FL()};a.physics_id=function(a){q.log("O",t.nM(a));for(var b=t.OM().jc.ra,c=0;c<b.length;c++){var d=b[c];d.J.ba==a&&q.log("B",d)}};a.visible_objects=function(){for(var a=J.get_active(),b=f.Ib(a,"MESH",f.DATA_ID_ALL),a=[J.Aa(a,v.Db),J.Aa(a,v.Vc),J.Aa(a,v.Id)],c=0;c<a.length;c++){var d=a[c],e=d.Qa;if(e.length){q.group(d.type,"DYNAMIC");
for(var g=0;g<b.length;g++){var h=b[g],k=h.o;if("DYNAMIC"==k.type)for(var m=!1,l=0;l<e.length;l++){for(var n=e[l].ra,p=0;p<n.length;p++){var t=n[p];if(t.Ub&&t.Ee==k){q.dd(h.name,h);m=!0;break}}if(m)break}}q.groupEnd();q.groupCollapsed(d.type,"STATIC");for(g=0;g<b.length;g++)if(h=b[g],k=h.o,"DYNAMIC"!=k.type)for(m=!1,l=0;l<e.length;l++){n=e[l].ra;for(p=0;p<n.length;p++)if(t=n[p],t.Ub&&t.Ee==k){q.dd(h.name,h);m=!0;break}if(m)break}q.groupEnd()}}};a.object_info=function(a){for(var b=J.get_active(),c=
f.Ib(b,"MESH",f.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];if(e.name==a){q.log("Object",e);for(var g=J.ow(b),h=0;h<g.length;h++){for(var k=g[h],m=[],l=k.Qa,n=0;n<l.length;n++)for(var p=l[n].ra,t=0;t<p.length;t++)p[t].Ee==e.o&&m.push(p[t]);q.log("Subscene "+k.type,m)}}}};a.objects_stat=function(){var a=J.get_active();console.log("Armatures: "+f.Ib(a,"ARMATURE",f.DATA_ID_ALL).length);console.log("Cameras: "+f.Ib(a,"CAMERA",f.DATA_ID_ALL).length);console.log("Curves: "+f.Ib(a,"CURVE",f.DATA_ID_ALL).length);
console.log("Empties: "+f.Ib(a,"EMPTY",f.DATA_ID_ALL).length);console.log("Lamps: "+f.Ib(a,"LAMP",f.DATA_ID_ALL).length);console.log("Meshes: "+f.Ib(a,"MESH",f.DATA_ID_ALL).length);console.log("Speakers: "+f.Ib(a,"SPEAKER",f.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=J.get_active(),b=[J.Aa(b,v.Db),J.Aa(b,v.Vc),J.Aa(b,v.Id)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=d[e].ra,g=0;g<f.length;g++){var h=f[g].qa;h&&(a+=h.num_vertices)}}return a};
a.num_triangles=function(){for(var a=0,b=J.get_active(),b=[J.Aa(b,v.Db),J.Aa(b,v.Vc),J.Aa(b,v.Id)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=d[e].ra,g=0;g<f.length;g++){var h=f[g].qa;h&&(a+=h.num_triangles)}}return a};a.num_draw_calls=function(){for(var a=J.get_active(),b=J.Ii(a,[v.Db,v.Vc,v.Id,v.qd,v.Qe]),c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.Qa,f=0;f<e.length;f++)c+=e[f].ra.length;a=J.Ii(a,[v.Wc,v.qe]);for(d=0;d<a.length;d++)for(e=a[d],e=e.Qa,f=0;f<e.length;f++)c+=
6*e[f].ra.length;return c};a.num_shaders=function(){return H.hi(C.aC())};a.geometry_stats=function(){for(var a=J.get_active(),b=J.ow(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=v.Xl&&d.type!=v.eg)for(var e=d.Qa,f=0;f<e.length;f++)for(var g=e[f].ra,h=0;h<g.length;h++){var k=g[h].qa,m=g[h].Ee;k&&(d.type!=v.Wd&&d.type!=v.fg||m.nt||m.mt)&&(a[k.id]=k)}}var c=b=0,l;for(l in a)d=a[l].da,d.fm&&(c+=d.fm/1048576),b+=d.hm/1048576;return{vbo_memory:b,ibo_memory:c}};a.num_textures=function(){for(var a=[],
b=0,c=J.get_active(),c=[J.Aa(c,v.Db),J.Aa(c,v.Vc),J.Aa(c,v.Id)],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.Qa,f=0;f<e.length;f++)for(var g=e[f].ra,h=0;h<g.length;h++){var k=g[h].qa;if(k)for(var k=k.Sa,m=0;m<k.length;m++){var l=k[m];if("IMAGE"===l.source||"ENVIRONMENT_MAP"===l.source){var n=l.Cb;-1===a.indexOf(n)&&(a.push(n),l=l.width*l.height*4/1048576/l.Io,l*=1.3333,b+=l)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=J.get_active(),c=J.ow(c),d=0;d<c.length;d++){var e=
c[d];if(e.type!=v.Xl){var f=e.B,g=[f.lc,f.we];g.push.apply(g,e.Hh);for(e=0;e<g.length;e++){var h=g[e];l.Em(h)&&-1==a.indexOf(h)&&(a.push(h),b+=f.width*f.height*l.uN(h))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=J.get_active();(a=J.Aa(a,v.Db))&&J.bD(a.B,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=J.get_active(),b=J.Aa(a,v.Db),a=J.Ii(a,[v.Xc]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;
case 2:e=[0,0,1];break;default:e=[1,0,1]}J.bD(d.B,b,e)}};a.scenegraph_to_dot=function(){for(var a=J.jp(),b=0;b<a.length;b++)q.log("\n"+A.CL(J.ks(a[b])))};a.scenes_to_dot=function(){};a.loading_graph_to_dot=function(){q.log("\n"+k.zN())};a.controls_info=w.debug;a.object_distance=function(a,b){var c=z.get_trans_view(a.o.v),d=z.get_trans_view(b.o.v);return p.dist(c,d)};a.msg=m.msg;a.fbmsg=m.fbmsg;a.print_telemetry=m.print_telemetry;a.plot_telemetry=m.plot_telemetry;a.fbres=function(a,b){function c(){m.fbmsg("FBRES",
a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array([0,0,0,1]),b=new Float32Array([1,0,0]),c=new Float32Array([0,1,0]),d=new Float32Array([0,0,1]),e=new Float32Array([-1,0,0]),f=new Float32Array([0,-1,0]),g=new Float32Array([0,0,-1]);if(!H.aj(new Float32Array(3),H.Sz))throw"Wrong VEC3_IDENT";if(!H.aj(a,H.Wl))throw"Wrong QUAT4_IDENT";if(!H.aj(b,H.AXIS_X))throw"Wrong AXIS_X";if(!H.aj(c,H.AXIS_Y))throw"Wrong AXIS_Y";if(!H.aj(d,H.AXIS_Z))throw"Wrong AXIS_Z";if(!H.aj(e,
H.AXIS_MX))throw"Wrong AXIS_MX";if(!H.aj(f,H.AXIS_MY))throw"Wrong AXIS_MY";if(!H.aj(g,H.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=I.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==I.zw(c)&&I.mute(c,!0)}};a.check_finite=function(a){m.check_finite(a)};a.set_debug_params=function(a){var b=J.get_active(),b=J.Ii(b,[v.eg]);if(b.length)for(var c=0;c<b.length;c++){var d=b[c];if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case m.DV_NONE:case m.DV_OPAQUE_WIREFRAME:case m.DV_TRANSPARENT_WIREFRAME:case m.DV_FRONT_BACK_VIEW:case m.DV_BOUNDINGS:case m.DV_CLUSTERS_VIEW:case m.DV_BATCHES_VIEW:case m.DV_RENDER_TIME:J.cQ(d,
a.debug_view_mode);break;default:q.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&J.bQ(d,a.debug_colors_seed);"number"==typeof a.EP&&J.wQ(d,a.EP);"object"==typeof a.wireframe_edge_color&&J.EQ(d,H.f32(a.wireframe_edge_color))}else q.error("Debugging is not available on the scene.")};a.get_error_quantity=function(){return q.aN()};a.get_warning_quantity=function(){return q.wN()};a.clear_errors_warnings=function(){return q.clear_errors_warnings()};a.analyze_shaders=
function(a){var e=C.aC(),f=0,g;for(g in e)a&&-1===g.indexOf(a)||f++;var f="of "+f+" analyzing...",h={};for(g in e)if(!a||-1!==g.indexOf(a)){var k=e[g],l;var n=k.uu;l=k.bs;var p=B.YM();if(p){var t=p.getTranslatedShaderSource(n),p=p.getTranslatedShaderSource(l);if(u.detect_mobile())var t=t.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),w=c("/analyze_shader/vert_gles",t),r=c("/analyze_shader/frag_gles",p);else t=t.replace("#version","#version 400 //"),p=p.replace("#version",
"#version 400 //"),w=c("/analyze_shader/vert",t),r=c("/analyze_shader/frag",p);var v=d(w),y=d(r);l={tS:m.hs().getShaderSource(n),uS:t,sS:w,vS:v,BM:m.hs().getShaderSource(l),CM:p,tM:r,lw:y}}else q.error("WEBGL_debug_shaders extension not found"),l=void 0;t=k.ab;n=t.bg+" + "+t.Ae;l.yL=k;l.ab=t;k=h[n]=h[n]||[];k.push(l);q.dd(f)}for(n in h)q.group("%c"+n,"color: #800"),k=h[n],b(k),q.groupEnd()};a.fake_load=m.fake_load;a.test_performance=function(b){if(C.SA())if(B.tw()){var c=Q.gl_debug;Q.gl_debug=!0;
var d=A.QK();J.SB(null,d);for(var e=A.dc(d,v.On),f=e.B,d=0;5>d;d++)E.lm(e);Q.gl_debug=c;window.setTimeout(function(){m.qP(e);var a=e.Xe;b(a,f.width*f.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.test_performance(b)},100)};a.calc_vbo_garbage_byte_size=m.calc_vbo_garbage_byte_size;a.show_vbo_garbage_info=m.show_vbo_garbage_info;a.print_batches_stat=m.print_batches_stat;a.start_debug=function(a){y=[];S=!0;a=r(a);for(var b in a)"function"===typeof a[b]&&(a[b]=
n(a[b],b))};a.check_debug_result=function(){return S};a.test=function(a,b){try{return b(),!0}catch(V){return S=!1,console.error(a+" test was failed. ",V),!1}};a.pix=function(a){var b=h.oC(),c=h.nC(),d=b/2,e=c/2;h.resize(b,c,!1);b=J.get_active().F.Ja;(c=A.oM(b))||H.D("Couldn't find onscreen subscene");b=c.B;d=h.po(d,e,G,c.B);d[1]=b.height-d[1];d=E.Dt(b.ee,d[0],d[1]);x(a,d,1)};a.eqs=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+Z;};a.eqv=x;a.eqf=function(a,b,
c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.eq=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=r(a);for(var b in a)-1==y.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.ok=function(a){if(!a)throw"Wrong result. Function: "+Z;}};b4w.module.geometry=function(a,r){var d=r("__batch"),c=r("__geometry"),b=r("__print"),g=r("__renderer"),n=r("__util");a.extract_vertex_array=function(a,e,g){if(!c.pj(a))return b.error("Wrong object:",a.name),null;if(a=d.Oa(a,e,"MAIN")){if((e=a.da)&&e.Fb&&e.Fb[g])return c.dM(e,g);b.error("Attribute not found:"+g);return null}b.error("Wrong material:",e);return null};a.extract_index_array=function(a,e){if(!c.pj(a))return b.error("Wrong object:",a.name),null;var g=d.Oa(a,e,"MAIN");if(g){if((g=g.da)&&
g.Fb)return g.zd;b.error("Buffer data not found");return null}b.error("Wrong material:",e);return null};a.update_vertex_array=function(a,e,g,n){if(c.pj(a)){var h=c.nj(g),h=c.bC(h);if(h!=n.constructor)b.error("Wrong input array type '"+n.constructor.name+"' for the given attribute. Should be '"+h.name+"'.");else for(var h=["MAIN","SHADOW","COLOR_ID"],m=0;m<h.length;m++){var u=d.Oa(a,e,h[m]);u&&(u=u.da)&&u.Fb&&u.Fb[g]&&c.vF(u,g,0,n)}}else b.error("Wrong object:",a.name)};a.override_geometry=function(a,
e,u,w,h){if(c.pj(a))if(u instanceof Uint16Array||u instanceof Uint32Array)if(w instanceof Float32Array)for(var m=["MAIN","SHADOW","COLOR_ID"],r=0;r<m.length;r++){var k=d.Oa(a,e,m[r]);if(k){var f=k.da;if(f){c.wF(f,k.tg,u);var x={},t;for(t in f.Fb){var q=f.Fb[t],q=w.length/3*q.Vb,E=c.nj(t);x[E]||(x[E]=0);x[E]+=q}E=c.IN(x);f.Kb=E;x={};for(t in f.Fb)switch(q=f.Fb[t],E=c.nj(t),x[E]||(x[E]=0),t){case "a_position":c.Fq(f.Kb,"a_position",w,x[E]);q.offset=x[E];q.length=w.length;x[E]+=q.length;break;case "a_tbn_quat":var J;
h&&(J=c.EA(u,w,w));var A=c.DA(u,w,J);q.length=w.length/3*q.Vb;for(var I=new Float32Array(q.length),C=0;C<I.length;C+=4)I[C]=1,I[C+3]=1;A=n.gen_tbn_quats(A,I);c.Fq(f.Kb,"a_tbn_quat",A,x[E]);q.offset=x[E];x[E]+=q.length;break;default:q.offset=x[E],q.length=w.length/3*q.Vb,A=new (c.bC(E))(q.length),c.Fq(f.Kb,t,A,x[E]),x[E]+=q.length}c.bz(f);g.bv(k);(k=d.af(a,k))&&k.da&&(k.da=f)}}}else b.error("Wrong positions_array type");else b.error("Wrong ibo_array type");else b.error("Wrong object:",a.name)};a.set_shape_key_value=
function(a,d,g){c.check_shape_keys(a)?c.Kw(a,d)?c.av(a,d,parseFloat(g)):b.error("Wrong key name:",d):b.error("Wrong object:",a.name)};a.check_shape_keys=function(a){return c.check_shape_keys(a)};a.get_shape_keys_names=function(a){return c.check_shape_keys(a)?c.get_shape_keys_names(a):(b.error("Wrong object:",a.name),[])};a.get_shape_key_value=function(a,d){return c.check_shape_keys(a)?c.Kw(a,d)?c.get_shape_key_value(a,d):(b.error("Wrong key name:",d),0):(b.error("Wrong object:",a.name),0)};a.draw_line=
function(a,e,n){n=n||!1;if(e instanceof Float32Array){if(a=d.vw(a))c.draw_line(a,e,n),g.bv(a)}else b.error("Wrong positions type")}};b4w.module.hud=function(a,r){var d=r("__hud"),c=r("__print");a.draw_mixer_strip=function(a,g,n,r,e,u,w){c.Ze("draw_mixer_strip","screen.draw_mixer_strip");d.draw_mixer_strip(a,g,n,r,e,u,w)};a.plot_array=function(a,g,n,r,e,u,w){c.Ze("plot_array","screen.plot_array");d.plot_array(a,g,n,r,e,u,w)}};b4w.module.input=function(a,r){function d(a){e.Ze("enable_split_screen","screen.request_split_screen");var d=c.get_device_by_type_element(c.DEVICE_HMD);if(!d)return!1;if(B)return!0;var f=c.get_vector_param(d,c.xz,h),g=c.get_vector_param(d,c.yz,m);b.set_hmd_fov(a,f,g);if(f=c.get_value_param(d,F))g=u.get_active(),a=x.oa(a,g).ea,b.set_eye_distance(a,f);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};c.get_value_param(d,c.HMD_WEBVR_TYPE)&(c.HMD_NON_WEBVR|c.HMD_WEBVR_MOBILE|c.HMD_WEBVR_DESKTOP)&&
(a.distortion_coefs=[d.distortion_coefs[0],d.distortion_coefs[1]],a.chromatic_aberration_coefs=[d.chromatic_aberration_coefs[0],d.chromatic_aberration_coefs[1],d.chromatic_aberration_coefs[2],d.chromatic_aberration_coefs[3]],d.Pl||(d.Yg&&d.rh&&d.Zg?a.base_line_factor=(d.Yg-d.Zg)/d.rh:d.Zg||(a.base_line_factor=d.Yg/d.rh)),d.Kf&&d.hk&&!d.Pl&&(a.inter_lens_factor=d.Kf/d.hk),k.enabled||(f=1+d.distortion_coefs[0]+d.distortion_coefs[1],u.et(f,f)));u.set_hmd_params(a);n.resize_to_container(!0);c.reset_device(d);
return B=!0}var c=r("__input"),b=r("__camera"),g=r("__config"),n=r("__container"),x=r("__obj_util"),e=r("__print"),u=r("__scenes"),w=r("__vec4"),h=w.create(),m=w.create(),B=!1,k=g.Jk,f=g.H;a.GMPD_BUTTON_12=c.GMPD_BUTTON_12;a.GMPD_BUTTON_13=c.GMPD_BUTTON_13;a.GMPD_BUTTON_15=c.GMPD_BUTTON_15;a.GMPD_BUTTON_14=c.GMPD_BUTTON_14;a.GMPD_BUTTON_3=c.GMPD_BUTTON_3;a.GMPD_BUTTON_0=c.GMPD_BUTTON_0;a.GMPD_BUTTON_1=c.GMPD_BUTTON_1;a.GMPD_BUTTON_2=c.GMPD_BUTTON_2;a.GMPD_BUTTON_5=c.GMPD_BUTTON_5;a.GMPD_BUTTON_7=
c.GMPD_BUTTON_7;a.GMPD_BUTTON_4=c.GMPD_BUTTON_4;a.GMPD_BUTTON_6=c.GMPD_BUTTON_6;a.GMPD_BUTTON_8=c.GMPD_BUTTON_8;a.GMPD_BUTTON_9=c.GMPD_BUTTON_9;a.GMPD_BUTTON_10=c.GMPD_BUTTON_10;a.GMPD_BUTTON_11=c.GMPD_BUTTON_11;a.GMPD_BUTTON_16=c.GMPD_BUTTON_16;a.GMPD_BUTTON_17=c.GMPD_BUTTON_17;a.GMPD_BUTTON_18=c.GMPD_BUTTON_18;a.GMPD_BUTTON_19=c.GMPD_BUTTON_19;a.GMPD_BUTTON_20=c.GMPD_BUTTON_20;a.GMPD_BUTTON_21=c.GMPD_BUTTON_21;a.GMPD_BUTTON_22=c.GMPD_BUTTON_22;a.GMPD_BUTTON_23=c.GMPD_BUTTON_23;a.GMPD_BUTTON_24=
c.GMPD_BUTTON_24;a.GMPD_BUTTON_25=c.GMPD_BUTTON_25;a.GMPD_AXIS_0=c.GMPD_AXIS_0;a.GMPD_AXIS_1=c.GMPD_AXIS_1;a.GMPD_AXIS_2=c.GMPD_AXIS_2;a.GMPD_AXIS_3=c.GMPD_AXIS_3;a.GMPD_AXIS_4=c.GMPD_AXIS_4;a.GMPD_AXIS_5=c.GMPD_AXIS_5;a.GMPD_AXIS_6=c.GMPD_AXIS_6;a.GMPD_AXIS_7=c.GMPD_AXIS_7;a.GMPD_AXIS_8=c.GMPD_AXIS_8;a.GMPD_AXIS_9=c.GMPD_AXIS_9;a.GMPD_AXIS_10=c.GMPD_AXIS_10;a.GMPD_AXIS_11=c.GMPD_AXIS_11;a.HMD_ORIENTATION_QUAT=c.HMD_ORIENTATION_QUAT;a.HMD_POSITION=c.HMD_POSITION;a.HMD_WEBVR_TYPE=c.HMD_WEBVR_TYPE;
a.HMD_WEBVR_DESKTOP=c.HMD_WEBVR_DESKTOP;a.HMD_WEBVR_MOBILE=c.HMD_WEBVR_MOBILE;a.HMD_NON_WEBVR=c.HMD_NON_WEBVR;a.HMD_WEBVR1=c.HMD_WEBVR1;a.HMD_WEBVR1_1=c.HMD_WEBVR1_1;var F=c.HMD_EYE_DISTANCE;a.HMD_EYE_DISTANCE=F;a.HMD_DISTORTION=c.HMD_DISTORTION;a.HMD_BASELINE_DIST=c.HMD_BASELINE_DIST;a.HMD_SCREEN_LENSE_DIST=c.HMD_SCREEN_LENSE_DIST;a.HMD_SCREEN_WIDTH=c.HMD_SCREEN_WIDTH;a.HMD_SCREEN_HEIGHT=c.HMD_SCREEN_HEIGHT;a.HMD_BEVEL_SIZE=c.HMD_BEVEL_SIZE;a.MOUSE_LOCATION=c.MOUSE_LOCATION;a.MOUSE_DOWN_WHICH=c.MOUSE_DOWN_WHICH;
a.MOUSE_UP_WHICH=c.MOUSE_UP_WHICH;a.MOUSE_WHEEL=c.MOUSE_WHEEL;a.KEYBOARD_UP=c.KEYBOARD_UP;a.KEYBOARD_DOWN=c.KEYBOARD_DOWN;a.TOUCH_START=c.TOUCH_START;a.TOUCH_MOVE=c.TOUCH_MOVE;a.TOUCH_END=c.TOUCH_END;a.GYRO_ORIENTATION_QUAT=c.GYRO_ORIENTATION_QUAT;a.GYRO_ORIENTATION_ANGLES=c.GYRO_ORIENTATION_ANGLES;var t={};t[c.DEVICE_HMD]=[c.HMD_ORIENTATION_QUAT,c.HMD_POSITION];t[c.DEVICE_MOUSE]=[c.MOUSE_LOCATION];var q={};q[c.DEVICE_HMD]=[c.HMD_WEBVR_TYPE];var E={};E[c.DEVICE_MOUSE]=[c.MOUSE_LOCATION,c.MOUSE_DOWN_WHICH,
c.MOUSE_UP_WHICH,c.MOUSE_WHEEL];E[c.DEVICE_KEYBOARD]=[c.KEYBOARD_UP,c.KEYBOARD_DOWN];E[c.DEVICE_TOUCH]=[c.TOUCH_START,c.TOUCH_MOVE,c.TOUCH_END];E[c.DEVICE_GYRO]=[c.GYRO_ORIENTATION_QUAT,c.GYRO_ORIENTATION_ANGLES];var J={};J[c.DEVICE_HMD]=[c.HMD_DISTORTION,c.HMD_EYE_DISTANCE,c.HMD_BASELINE_DIST,c.HMD_SCREEN_LENSE_DIST,c.HMD_SCREEN_WIDTH,c.HMD_SCREEN_HEIGHT,c.HMD_BEVEL_SIZE];a.DEVICE_GYRO=c.DEVICE_GYRO;a.DEVICE_HMD=c.DEVICE_HMD;a.DEVICE_MOUSE=c.DEVICE_MOUSE;a.DEVICE_KEYBOARD=c.DEVICE_KEYBOARD;a.DEVICE_TOUCH=
c.DEVICE_TOUCH;a.can_use_device=c.can_use_device;a.get_device_by_type_element=c.get_device_by_type_element;a.switch_prevent_default=function(a,b){a&&c.switch_prevent_default(a,b)};a.register_device=function(){e.ja("input.register_device() deprecated")};a.reset_device=function(a){a&&a.type==c.DEVICE_HMD?c.reset_device(a):e.error("reset_device is undefined for device.")};a.get_vector_param=function(a,b,d){if(a&&a.type in t&&0<=t[a.type].indexOf(b))return c.get_vector_param(a,b,d);e.error("device hasn't param: ",
b);return null};a.get_value_param=function(a,b){if(a&&a.type in q&&0<=q[a.type].indexOf(b))return c.get_value_param(a,b);e.error("device hasn't param: ",b);return null};a.attach_param_cb=function(a,b,d){d=d||null;if(a&&a.type in E&&0<=E[a.type].indexOf(b))return c.attach_param_cb(a,b,d);e.error("device hasn't param: ",b)};a.detach_param_cb=function(a,b,d){d=d||null;if(a&&a.type in E&&0<=E[a.type].indexOf(b))return c.detach_param_cb(a,b,d);e.error("device hasn't param: ",b)};a.set_config=function(a,
b,d){if(a&&a.type in J&&0<=J[a.type].indexOf(b))return c.set_config(a,b,d);e.error("device hasn't config: ",b)};a.request_fullscreen_hmd=function(){e.Ze("request_fullscreen_hmd","screen.request_fullscreen_hmd");if(u.xa()){var a=u.mj(u.get_active());if(a&&(d(a),a=c.get_device_by_type_element(c.DEVICE_HMD))){var b=a.Uc;b&&!b.isPresenting&&(b.capabilities.canPresent?(a=n.get_canvas(),b.requestPresent([{source:a}]).then(function(){if(!f.is_mobile_device){var a=b.getEyeParameters("left"),c=b.getEyeParameters("right");
n.resize(2*Math.max(a.renderWidth,c.renderWidth),Math.max(a.renderHeight,c.renderHeight),!1)}},function(){e.error("HMD fullscreen request failed.")})):e.error("HMD fullscreen request failed."))}}};a.enable_split_screen=d;a.disable_split_screen=function(){e.Ze("disable_split_screen","screen.exit_split_screen");var a=c.get_device_by_type_element(c.DEVICE_HMD);if(!B||!a||!a.lf)return!1;u.set_hmd_params({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);u.et(a,a);n.resize_to_container(!0);
return!0};a.set_gamepad_key=function(a,b,d){switch(a){case 0:a=c.Mq;break;case 1:a=c.Iu;break;case 2:a=c.Ju;break;case 3:a=c.Ku;break;default:a=c.Mq}a=c.get_device_by_type_element(a);c.set_config(a,b,d)};a.get_pressed_gmpd_btn=c.get_pressed_gmpd_btn;a.get_moved_gmpd_axis=c.get_moved_gmpd_axis;a.check_enable_gamepad_indices=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b};
a.add_click_listener=function(a,b){a&&b&&c.add_click_listener(a,b)};a.remove_click_listener=function(a,b){a&&b&&c.remove_click_listener(a,b)}};b4w.module.lights=function(a,r){function d(a){for(var c=e.get_active(),d=g.Ib(c,"LAMP",g.DATA_ID_ALL),f=0;f<d.length;f++){var k=d[f];if("SUN"==k.nb.type){var n=k;break}}if(!n)x.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){d=h.deg_to_rad(180-a.hor_position);a=h.deg_to_rad(90-a.vert_position);f=n.o;u.set_rotation_euler(n,[a,0,d]);d=new Float32Array(3);k=w.get_quat_view(f.v);h.quat_to_dir(k,h.AXIS_Z,d);f=w.get_trans_view(f.v);f=m.length(f);
m.copy(d,B);m.scale(B,f,B);u.set_translation(n,B);u.L(n);d=n.nb;if(d.CB){f=c.world.horizon_color;k=c.world.zenith_color;a=Math.cos(Math.abs(a));var q=Math.max(a,.1)*c.world.light_settings.environment_energy;b.set_light_energy(d,Math.max(Math.min(3*a,1),0)*d.uB);e.set_environment_colors(c,q,f,k)}e.vq(n,c)}}function c(a){if(n.is_lamp(a))return a.nb.type;x.error("get_light_type(): Wrong object");return""}var b=r("__lights"),g=r("__objects"),n=r("__obj_util"),x=r("__print"),e=r("__scenes"),u=r("__transform"),
w=r("__tsr"),h=r("__util"),m=r("__vec3"),B=new Float32Array(3),k,f,F,t=60;a.get_lamps=function(a){var b=e.get_active(),b=g.Ib(b,"LAMP",g.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var f=b[d];f.nb.type===a&&c.push(f)}return c};a.get_sun_params=function(){for(var a=e.get_active(),a=g.Ib(a,"LAMP",g.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.nb.type){b=d;break}}return b?(b=b.nb.direction,a=h.rad_to_deg(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=h.rad_to_deg(Math.atan2(b[2],
Math.sqrt(b[0]*b[0]+b[1]*b[1]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=d;a.set_day_time=function(a){for(var b=e.get_active(),b=g.Ib(b,"LAMP",g.DATA_ID_ALL),c=0;c<b.length;c++){var f=b[c];if("SUN"==f.nb.type){var h=f;break}}h?(h=-Math.cos(a/12*Math.PI)*t,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=h,d(b)):x.error("There is no sun on the scene")};a.set_date=function(a){k=a.getFullYear();f=a.getMonth();F=a.getDate();k?1582==k&&9==f&&4<F&&15>F&&x.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):
x.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){t=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(n.is_lamp(a))var b=a.nb;else return x.error("get_light_params(): Wrong object"),null;if(a=c(a))switch(a){case "SPOT":var d={light_type:a,light_color:new Float32Array(3),light_energy:b.Ye,light_spot_blend:b.lq,light_spot_size:b.Dl,light_distance:b.distance};d.light_color.set(b.color);break;case "POINT":d={light_type:a,light_color:new Float32Array(3),light_energy:b.Ye,
light_distance:b.distance};d.light_color.set(b.color);break;default:d={light_type:a,light_color:new Float32Array(3),light_energy:b.Ye},d.light_color.set(b.color)}return d?d:null};a.get_light_type=c;a.set_light_params=function(a,c){if(n.is_lamp(a)){var d=a.nb,f=e.get_active(),g=!1;"number"==typeof c.light_energy&&b.set_light_energy(d,c.light_energy);"object"==typeof c.light_color&&b.set_light_color(d,c.light_color);"number"==typeof c.light_spot_blend&&(b.oQ(d,c.light_spot_blend),g=!0);"number"==typeof c.light_spot_size&&
(b.pQ(d,c.light_spot_size),g=!0);"number"==typeof c.light_distance&&(b.nQ(d,c.light_distance),g=!0);e.vq(a,f);g&&e.wR(f)}else x.error("set_light_params(): Wrong object")};a.get_light_energy=function(a){return n.is_lamp(a)?a.nb.Ye:(x.error("get_light_energy(): Wrong object"),0)};a.set_light_energy=function(a,c){if(n.is_lamp(a)){var d=e.get_active();b.set_light_energy(a.nb,c);e.vq(a,d)}else x.error("set_light_energy(): Wrong object")};a.get_light_color=function(a,b){if(!n.is_lamp(a))return x.error("get_light_color(): Wrong object"),
null;b=b||new Float32Array(3);b.set(a.nb.color);return b};a.set_light_color=function(a,c){if(n.is_lamp(a)){var d=e.get_active();b.set_light_color(a.nb,c);e.vq(a,d)}else x.error("set_light_color(): Wrong object")}};b4w.module.logic_nodes=function(a,r){var d=r("__logic_nodes");a.append_custom_callback=function(a,b){d.HI(a,b)};a.remove_custom_callback=function(a){d.wP(a)};a.run_entrypoint=function(a,b){d.RP(a,b)}};b4w.module.material=function(a,r){function d(a,b){for(var c=a.K[0].R,d=0;d<c.length;d++){var e=c[d];if(-1<e.Jb.indexOf(b)&&"MAIN"==e.type)return!0}return!1}function c(a,b){var c=g.Oa(a,b,"MAIN");return!(!c||!c.Rd[0])}function b(a,b){var c=g.Oa(a,b,"MAIN");return!(!c||!c.Rd[1])}var g=r("__batch"),n=r("__config"),x=r("__geometry"),e=r("__objects"),u=r("__obj_util"),w=r("__print"),h=r("__shaders"),m=r("__util"),B=r("__scenes"),k=n.H;a.inherit_material=function(a,b,c,d){if(x.pj(c)&&x.pj(a)){var f=a.rc.Fj.indexOf(b);
if(-1==f)w.error('inherit_material(): material "'+b+'" not found on the object "'+a.Cd+'".');else{var g=c.rc.Fj.indexOf(d);-1==g?w.error('inherit_material(): material "'+d+'" not found on the object "'+c.Cd+'".'):(0==c.ig.data.submeshes[g].shade_tangs.length&&a.rc.Yi[f].use_tangent_shading&&w.warn('The target material "'+d+'" was exported without tangent shading data. However, the "'+b+'" material requires it. It\'s needed to enable the "Tangent Shading" option on the target material for correct rendering.'),
e.inherit_material(a,b,c,d))}}else w.error('inherit_material(): both objects "'+a.Cd+'" and "'+c.Cd+'" must have the "Dynamic Geometry & Materials" flag enabled.')};a.get_materials_names=function(a){var b=[];a=a.K;for(var c=0;c<a.length;c++)for(var d=a[c].R,e=0;e<d.length;e++)for(var f=0;f<d[e].Jb.length;f++)-1==b.indexOf(d[e].Jb[f])&&b.push(d[e].Jb[f]);return b};a.set_diffuse_color=function(a,b,c){var d=g.Oa(a,b,"MAIN");d?(d.xd.set(c),(a=g.af(a,b,"MAIN"))&&a.xd.set(c)):w.error('Couldn\'t set property "diffuse_color"!')};
a.get_diffuse_color=function(a,b){var c=g.Oa(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.xd);return d}w.error('Couldn\'t get property "diffuse_color"!')};a.set_diffuse_intensity=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.jh=c,a=g.af(a,b,"MAIN"))a.jh=c}else w.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.jh;w.error('Couldn\'t get property "diffuse_intensity"!');return 0};a.set_specular_color=function(a,b,
c){var d=g.Oa(a,b,"MAIN");d?(d.Yf.set(c),(a=g.af(a,b,"MAIN"))&&a.Yf.set(c)):w.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=g.Oa(a,b,"MAIN");if(c){var d=Array(3);d[0]=c.Yf[0];d[1]=c.Yf[1];d[2]=c.Yf[2];return d}w.error('Couldn\'t get property "specular_color"!')};a.set_specular_color_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.Ei=c,a=g.af(a,b,"MAIN"))a.Ei=c}else w.error('Couldn\'t set property "specular_color_factor"!')};a.get_specular_color_factor=
function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.Ei;w.error('Couldn\'t get property "specular_color_factor"!');return 0};a.set_specular_intensity=function(a,b,d){c(a,b)||w.error('Property "specular_intensity" is missing!');g.Oa(a,b,"MAIN").Rd[0]=d;(a=g.af(a,b,"MAIN"))&&(a.Rd[0]=d)};a.get_specular_intensity=function(a,b){c(a,b)||w.error('Property "specular_intensity" is missing!');return g.Oa(a,b,"MAIN").Rd[0]};a.check_specular_intensity=c;a.set_specular_hardness=function(a,c,d){b(a,c)||w.error('Property "specular_hardness" is missing!');
g.Oa(a,c,"MAIN").Rd[1]=d;(a=g.af(a,c,"MAIN"))&&(a.Rd[1]=d)};a.get_specular_hardness=function(a,c){b(a,c)||w.error('Property "specular_hardness" is missing!');return g.Oa(a,c,"MAIN").Rd[1]};a.check_specular_hardness=b;a.set_emit_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.ug=c,a=g.af(a,b,"MAIN"))a.ug=c}else w.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.ug;w.error('Couldn\'t get property "emit_factor"!');return 0};
a.set_ambient_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.lg=c,a=g.af(a,b,"MAIN"))a.lg=c}else w.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.lg;w.error('Couldn\'t get property "ambient_factor"!');return 0};a.set_diffuse_color_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.ih=c,a=g.af(a,b,"MAIN"))a.ih=c}else w.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,
b){var c=g.Oa(a,b,"MAIN");if(c)return c.ih;w.error('Couldn\'t get property "diffuse_color_factor"!');return 0};a.set_alpha_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.xf=c,a=g.af(a,b,"MAIN"))a.xf=c}else w.error('Couldn\'t set property "alpha_factor"!')};a.get_alpha_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.xf;w.error('Couldn\'t get property "alpha_factor"!');return 0};a.get_material_extended_params=function(a,b){if(!a||!b)return w.error("missing arguments in get_material_params"),
null;if(!d(a,b))return null;var c=g.Oa(a,b,"MAIN");if(!c)return null;var e={};"MAIN"==c.type&&(e.reflect_factor=c.reflect_factor,e.fresnel=c.bf[2],e.fresnel_factor=5*(1-c.bf[3]),e.parallax_scale=c.parallax_scale,e.parallax_steps=g.Kd(c,"PARALLAX_STEPS")[1]);return e};a.get_water_material_params=function(a,b){if(!a||!b)return w.error("missing arguments in get_water_material_params"),null;if(!d(a,b))return null;var c=g.Oa(a,b,"MAIN");if(!c||!c.Lh)return null;if(!c)return w.error("material not found"),
null;var e={};if("MAIN"==c.type){if(k.an){var f=e.shallow_water_col=Array(3);f[0]=c.shallow_water_col[0];f[1]=c.shallow_water_col[1];f[2]=c.shallow_water_col[2];f=e.shore_water_col=Array(3);f[0]=c.shore_water_col[0];f[1]=c.shore_water_col[1];f[2]=c.shore_water_col[2];e.shallow_water_col_fac=c.shallow_water_col_fac;e.shore_water_col_fac=c.shore_water_col_fac}e.foam_factor=c.foam_factor;e.norm_uv_velocity=c.gk;e.absorb_factor=g.Kd(c,"ABSORB")[1];e.sss_strength=g.Kd(c,"SSS_STRENGTH")[1];e.sss_width=
g.Kd(c,"SSS_WIDTH")[1];e.dst_noise_scale0=g.Kd(c,"DST_NOISE_SCALE_0")[1];e.dst_noise_scale1=g.Kd(c,"DST_NOISE_SCALE_1")[1];e.dst_noise_freq0=g.Kd(c,"DST_NOISE_FREQ_0")[1];e.dst_noise_freq1=g.Kd(c,"DST_NOISE_FREQ_1")[1];e.dir_min_shore_fac=g.Kd(c,"DIR_MIN_SHR_FAC")[1];e.dir_freq=g.Kd(c,"DIR_FREQ")[1];e.dir_noise_scale=g.Kd(c,"DIR_NOISE_SCALE")[1];e.dir_noise_freq=g.Kd(c,"DIR_NOISE_FREQ")[1];e.dir_min_noise_fac=g.Kd(c,"DIR_MIN_NOISE_FAC")[1];e.dst_min_fac=g.Kd(c,"DST_MIN_FAC")[1];e.waves_hor_fac=g.Kd(c,
"WAVES_HOR_FAC")[1]}return e};a.set_material_extended_params=function(a,b,c){if(a&&b&&c)if(d(a,b)){var e=g.Oa(a,b,"MAIN");if(e){var f=[e];(e=g.af(a,b,"MAIN"))&&f.push(e);for(a=0;a<f.length;a++)e=f[a],"number"==typeof c.material_reflectivity&&(e.reflect_factor=c.material_reflectivity),"number"==typeof c.material_fresnel&&(e.bf[2]=c.material_fresnel),"number"==typeof c.material_fresnel_factor&&(e.bf[3]=1-c.material_fresnel_factor/5),"number"==typeof c.material_parallax_scale&&(e.parallax_scale=c.material_parallax_scale),
"number"==typeof c.material_parallax_steps&&(b=h.N(parseFloat(c.material_parallax_steps)),g.mb(e,"PARALLAX_STEPS",b),g.vc(e),B.PD(e))}else w.error("material not found")}else w.error("setting material params is not possible");else w.error("missing arguments in set_material_params")};a.set_water_material_params=function(a,b,c){if(a&&b&&c)if(d(a,b)){var e=g.Oa(a,b,"MAIN");if(e){var f=[e];(e=g.af(a,b,"MAIN"))&&f.push(e);for(a=0;a<f.length;a++)e=f[a],k.an&&("object"==typeof c.shallow_water_col&&e.shallow_water_col.set(c.shallow_water_col),
"number"==typeof c.shallow_water_col_fac&&(e.shallow_water_col_fac=c.shallow_water_col_fac),"object"==typeof c.shore_water_col&&e.shore_water_col.set(c.shore_water_col),"number"==typeof c.shore_water_col_fac&&(e.shore_water_col_fac=c.shore_water_col_fac)),k.shore_smoothing&&e.Fn&&("boolean"==typeof c.shore_smoothing&&(c.shore_smoothing?g.mb(e,"SHORE_SMOOTHING",1):g.mb(e,"SHORE_SMOOTHING",0)),"number"==typeof c.absorb_factor&&(b=h.N(parseFloat(c.absorb_factor)),g.mb(e,"ABSORB",b))),"number"==typeof c.foam_factor&&
k.sm&&(e.foam_factor=c.foam_factor),"number"==typeof c.norm_uv_velocity&&(e.gk=c.norm_uv_velocity),k.water_dynamic&&e.water_dynamic&&("boolean"==typeof c.water_dynamic&&(c.water_dynamic?g.mb(e,"DYNAMIC",1):g.mb(e,"DYNAMIC",0)),"number"==typeof c.waves_height&&(b=h.N(parseFloat(c.waves_height)),g.mb(e,"WAVES_HEIGHT",b)),"number"==typeof c.waves_length&&(b=h.N(parseFloat(c.waves_length)),g.mb(e,"WAVES_LENGTH",b)),"number"==typeof c.sss_strength&&(b=h.N(parseFloat(c.sss_strength)),g.mb(e,"SSS_STRENGTH",
b)),"number"==typeof c.sss_width&&(b=h.N(parseFloat(c.sss_width)),g.mb(e,"SSS_WIDTH",b)),"number"==typeof c.dst_noise_scale0&&(b=h.N(parseFloat(c.dst_noise_scale0)),g.mb(e,"DST_NOISE_SCALE_0",b)),"number"==typeof c.dst_noise_scale1&&(b=h.N(parseFloat(c.dst_noise_scale1)),g.mb(e,"DST_NOISE_SCALE_1",b)),"number"==typeof c.dst_noise_freq0&&(b=h.N(parseFloat(c.dst_noise_freq0)),g.mb(e,"DST_NOISE_FREQ_0",b)),"number"==typeof c.dst_noise_freq1&&(b=h.N(parseFloat(c.dst_noise_freq1)),g.mb(e,"DST_NOISE_FREQ_1",
b)),"number"==typeof c.dir_min_shore_fac&&(b=h.N(parseFloat(c.dir_min_shore_fac)),g.mb(e,"DIR_MIN_SHR_FAC",b)),"number"==typeof c.dir_freq&&(b=h.N(parseFloat(c.dir_freq)),g.mb(e,"DIR_FREQ",b)),"number"==typeof c.dir_noise_scale&&(b=h.N(parseFloat(c.dir_noise_scale)),g.mb(e,"DIR_NOISE_SCALE",b)),"number"==typeof c.dir_noise_freq&&(b=h.N(parseFloat(c.dir_noise_freq)),g.mb(e,"DIR_NOISE_FREQ",b)),"number"==typeof c.dir_min_noise_fac&&(b=h.N(parseFloat(c.dir_min_noise_fac)),g.mb(e,"DIR_MIN_NOISE_FAC",
b)),"number"==typeof c.dst_min_fac&&(b=h.N(parseFloat(c.dst_min_fac)),g.mb(e,"DST_MIN_FAC",b)),"number"==typeof c.waves_hor_fac&&(b=h.N(parseFloat(c.waves_hor_fac)),g.mb(e,"WAVES_HOR_FAC",b))),g.vc(e),B.PD(e)}else w.error("material not found")}else w.error("setting water material params is not possible");else w.error("missing arguments in set_water_material_params")};a.set_line_params=function(a,b){var c=g.vw(a);c?(m.Lf(b.color)&&c.xd.set(b.color),m.Lf(b.width)&&(c.Hm=b.width)):w.error("Couldn't set line params!")};
a.get_line_params=function(a){if(a=g.vw(a))return{color:new Float32Array(a.xd),width:a.Hm};w.error("Couldn't get line params");return null};a.set_nodemat_value=function(a,b,c){if(u.Ag(a)){var d=b[0],e=g.Oa(a,d,"MAIN");if(null===e)return w.error('Material "'+d+'" was not found in the object "'+a.name+'".'),null;e=g.ph(e.jf,b);if(null===e)return w.error('Value node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),null;g.set_nodemat_value(a,d,e,c)}else w.error('The type of the object "'+
a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_value=function(a,b){if(!u.Ag(a))return w.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),0;var c=b[0],d=g.Oa(a,c,"MAIN");if(null===d)return w.error('Material "'+c+'" was not found in the object "'+a.name+'".'),0;c=g.ph(d.jf,b);return null===c?(w.error('Value node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),0):g.get_nodemat_value(d,c)};a.set_nodemat_rgb=function(a,b,c,d,e){if(u.Ag(a)){var f=
b[0],h=g.Oa(a,f,"MAIN");null===h?w.error('Material "'+f+'" was not found in the object "'+a.name+'".'):(h=g.ph(h.hf,b),null===h?w.error('RGB node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'):g.set_nodemat_rgb(a,f,h,c,d,e))}else w.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_rgb=function(a,b,c){if(!u.Ag(a))return w.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var d=b[0],e=g.Oa(a,d,"MAIN");
if(null===e)return w.error('Material "'+d+'" was not found in the object "'+a.name+'".'),null;d=g.ph(e.hf,b);if(null===d)return w.error('RGB node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),null;c||(c=new Float32Array(3));return g.get_nodemat_rgb(e,d,c)}};b4w.module.math=function(a,r){var d=r("__vec3"),c=r("__util"),b=r("__math"),g=new Float32Array(3);a.create_pline_from_points=function(a,c){var e=new Float32Array(6);b.set_pline_initial_point(e,a);d.subtract(c,a,g);b.set_pline_directional_vec(e,g);return e};a.create_pline_from_point_vec=function(a,c){var d=new Float32Array(6);b.set_pline_initial_point(d,a);b.set_pline_directional_vec(d,c);return d};a.create_pline=function(){return new Float32Array(6)};a.get_pline_directional_vec=b.get_pline_directional_vec;
a.get_pline_initial_point=b.get_pline_initial_point;a.set_pline_initial_point=b.set_pline_initial_point;a.set_pline_directional_vec=b.set_pline_directional_vec;a.line_plane_intersect=c.line_plane_intersect;a.calc_pline_point=b.calc_pline_point;a.point_plane_dist=b.point_plane_dist};b4w.module.particles=function(a,r){var d=r("__particles"),c=r("__print");a.set_size=function(a,g,n){d.Ex(a,g)?d.set_size(a,g,n):c.error('set_size(): Object "'+a.name+'" has not a particle system named "'+g+'"')};a.set_normal_factor=function(a,g,n){d.Ex(a,g)?d.set_normal_factor(a,g,n):c.error('set_normal_factor(): Object "'+a.name+'" has not a particle system named "'+g+'"')};a.set_factor=function(a,g,n){d.Ex(a,g)?(n=Math.min(n,1),n=Math.max(n,0),d.set_factor(a,g,n)):c.error('set_factor(): Object "'+
a.name+'" has not a particle system named "'+g+'"')}};b4w.module.physics=function(a,r){function d(a,b,c,d){return n.ML(a,d[c[0]],d[c[1]],d[c[2]])}function c(a,b,c,d,g){b=Math.abs(a[2]-b[2]);return b<g&&x.UN(a,c,d)?b:Number.MAX_VALUE}var b=r("__physics"),g=r("__print"),n=r("__util"),x=r("__navmesh");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){b.ka(a)?b.enable_simulation(a):g.ja("No physics for object "+a.name)};a.disable_simulation=function(a){b.ka(a)?b.disable_simulation(a):g.ja("No physics for object "+a.name)};a.has_physics=
function(a){return b.ka(a)};a.has_simulated_physics=function(a){return b.has_simulated_physics(a)};a.has_dynamic_physics=function(a){return b.has_dynamic_physics(a)};a.set_gravity=function(a,c){b.ka(a)?b.set_gravity(a,c):g.ja("No physics for object "+a.name)};a.set_transform=function(a,c,d){b.ka(a)?b.set_transform(a,c,d):g.ja("No physics for object "+a.name)};a.sync_transform=function(a){b.ka(a)?b.sync_transform(a):g.ja("No physics for object "+a.name)};a.apply_velocity=function(a,c,d,h){b.ka(a)?
b.apply_velocity(a,c,d,h):g.ja("No physics for object "+a.name)};a.apply_velocity_world=function(a,c,d,h){b.ka(a)?b.apply_velocity_world(a,c,d,h):g.ja("No physics for object "+a.name)};a.apply_force=function(a,c,d,h){b.ka(a)?b.apply_force(a,c,d,h,!1):g.ja("No physics for object "+a.name)};a.apply_force_world=function(a,c,d,h){b.ka(a)?b.apply_force(a,c,d,h,!0):g.ja("No physics for object "+a.name)};a.apply_torque=function(a,c,d,h){b.ka(a)?b.apply_torque(a,c,d,h):g.ja("No physics for object "+a.name)};
a.vehicle_throttle=function(a,c){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_throttle(a,n.clamp(c,-1,1))):g.ja("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,c,d){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");c=n.clamp(c,0,1);var e=a.I.nm;-1==d||1==d?e=Math.max(-1,Math.min(e+d*c,1)):!d&&0<=e?e=Math.max(0,e-c):!d&&0>e?e=Math.min(0,e+c):g.error("Wrong steering direction");b.vehicle_throttle(a,n.clamp(e,
-1,1))}else g.ja("No physics for object "+a.name)};a.vehicle_steer=function(a,c){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_steer(a,n.clamp(c,-1,1))):g.ja("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,c,d){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");c=n.clamp(c,0,1);var e=a.I.hn;-1==d||1==d?e=Math.max(-1,Math.min(e+d*c,1)):!d&&0<=e?e=Math.max(0,e-c):!d&&0>e?e=Math.min(0,e+c):g.error("Wrong steering direction");
b.vehicle_steer(a,n.clamp(e,-1,1))}else g.ja("No physics for object "+a.name)};a.vehicle_brake=function(a,c){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_brake(a,n.clamp(c,0,1))):g.ja("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,c){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");c=n.clamp(c,-1,1);var d=a.I.mo;b.vehicle_brake(a,n.clamp(d+d*c,0,1))}else g.ja("No physics for object "+a.name)};a.is_vehicle_chassis=
function(a){return b.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return b.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.Le.name;g.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.I.nm;g.error("Wrong object");return null};a.get_vehicle_steering=
function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.I.hn;g.error("Wrong object");return 0};a.get_vehicle_brake=function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.I.mo;g.error("Wrong object");return 0};a.get_vehicle_speed=function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return b.get_vehicle_speed(a);
g.error("Wrong object");return 0};a.is_character=function(a){return b.tC(a)};a.set_character_move_dir=function(a,c,d){b.ka(a)?b.set_character_move_dir(a,c,d):g.ja("No physics for object "+a.name)};a.set_character_move_type=function(a,c){b.ka(a)?b.set_character_move_type(a,c):g.ja("No physics for object "+a.name)};a.set_character_walk_velocity=function(a,c){b.ka(a)?b.set_character_walk_velocity(a,c):g.ja("No physics for object "+a.name)};a.set_character_run_velocity=function(a,c){b.ka(a)?b.set_character_run_velocity(a,
c):g.ja("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,c){b.ka(a)?b.set_character_fly_velocity(a,c):g.ja("No physics for object "+a.name)};a.character_jump=function(a){b.ka(a)?b.character_jump(a):g.ja("No physics for object "+a.name)};a.character_rotation_inc=function(a,c,d){b.ka(a)?b.character_rotation_inc(a,c,d):g.ja("No physics for object "+a.name)};a.set_character_rotation=function(a,c,d){b.ka(a)?b.set_character_rotation(a,c,d):g.ja("No physics for object "+a.name)};
a.set_character_rotation_v=function(a,c){b.ka(a)?b.set_character_rotation_v(a,c):g.ja("No physics for object "+a.name)};a.set_character_rotation_h=function(a,c){b.ka(a)?b.set_character_rotation_h(a,c):g.ja("No physics for object "+a.name)};a.append_collision_test=function(a,c,d,h){b.ka(a)?b.append_collision_test(a,c||"ANY",d,h||!1):g.ja("No physics for object "+a.name)};a.remove_collision_test=function(a,c,d){b.ka(a)?b.remove_collision_test(a,c||"ANY",d):g.ja("No physics for object "+a.name)};a.apply_collision_impulse_test=
function(a,c){b.ka(a)?b.apply_collision_impulse_test(a,c):g.ja("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){b.ka(a)?b.clear_collision_impulse_test(a):g.ja("No physics for object "+a.name)};a.append_ray_test=function(a,c,d,h,m,n){a=a||null;return null==a||b.ka(a)?b.append_ray_test(a,c,d,h||"ANY",m,n||!1,!1,!1,!1):(g.ja("No physics for object "+a.name),0)};a.append_ray_test_ext=function(a,c,d,h,m,n,k,f,r){a=a||null;return null==a||b.ka(a)?b.append_ray_test(a,c,d,h||"ANY",
m,n||!1,k||!1,f||!1,r||!1):(g.ja("No physics for object "+a.name),0)};a.remove_ray_test=function(a){b.KC(a)?b.remove_ray_test(a):g.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,c,d){b.KC(a)?b.change_ray_test_from_to(a,c,d):g.error("Wrong ray test ID")};a.apply_constraint=function(a,c,d,h,m,n,k,f,r,t){b.ka(c)&&b.ka(m)?b.apply_constraint(a,c,d,h,m,n,k,f,r,t):g.error("Wrong objects")};a.clear_constraint=function(a){b.ka(a)&&b.CN(a)?b.clear_constraint(a):g.error("Wrong object")};a.pull_to_constraint_pivot=
function(a,c,d,h,m,n){b.ka(a)&&b.ka(h)?b.pull_to_constraint_pivot(a,c,d,h,m,n):g.error("Wrong objects")};a.navmesh_get_island=function(a,c,n){n||(n=d);if(b.ka(a)){var e=a.J.Cp;return e?x.navmesh_get_island(e,c,n):(g.error(a.name+" is not a navigation mesh object"),null)}g.ja("No physics for object "+a.name)};a.navmesh_find_path=function(a,n,r,h){if(b.ka(a)){var e=a.J.Cp;if(!e)return g.error(a.name+" is not a navigation mesh object"),null;h=h||{};a={};a.do_not_pull_string=!!h.do_not_pull_string;a.distance_to_closest=
h.distance_to_closest||d;a.distance_to_farthest=h.distance_to_farthest||c;a.island=h.island||0;a.allowed_distance=h.allowed_distance||Number.MAX_VALUE;a.return_normals=h.return_normals||!1;return x.navmesh_find_path(e,n,r,a)}g.ja("No physics for object "+a.name)}};b4w.module.rgb=function(a,r){var d=r("__util"),c=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,c,d){var b=new Float32Array(3);b[0]=a;b[1]=c;b[2]=d;return b};a.set=function(a,c,d,r){r[0]=a;r[1]=c;r[2]=d;return r};a.css_to_rgb=function(a,c,n,r){r=r||new Float32Array(3);r[0]=a/255;r[1]=c/255;r[2]=n/255;d.OE(r,r);return r};a.rgb_to_css=function(a){a=d.dx(a,c);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=function(a){function b(a){a=
Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=d.dx(a,c);return"#"+b(a[0])+b(a[1])+b(a[2])}};
b4w.module.rgba=function(a,r){var d=r("__util"),c=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,c,d,r){var b=new Float32Array(4);b[0]=a;b[1]=c;b[2]=d;b[3]=r;return b};a.set=function(a,c,d,r,e){e[0]=a;e[1]=c;e[2]=d;e[3]=r;return e};a.css_to_rgba=function(a,c,n,r,e){e=e||new Float32Array(4);e[0]=a/255;e[1]=c/255;e[2]=n/255;e[3]=r;d.OE(e,e);return e};a.rgba_to_css=function(a){var b=d.dx(a,c);return[Math.round(255*b[0]),Math.round(255*b[1]),
Math.round(255*b[2]),a[3]]}};b4w.module.scenes=function(a,r){function d(){var a=g.get_canvas();return e.pick_object(a.clientWidth/2,a.clientHeight/2)}var c=r("__batch"),b=r("__camera"),g=r("__container"),n=r("__data"),x=r("__graph"),e=r("__objects"),u=r("__obj_util"),w=r("__print"),h=r("__scenes"),m=r("__scenegraph"),B=r("__subscene"),k=r("__util");a.DATA_ID_ALL=e.DATA_ID_ALL;a.set_active=function(a){var b=h.jp();h.set_active(k.keysearch("name",a,b))};a.get_active=function(){return h.xa()?h.get_active().name:""};a.get_scenes=
function(){for(var a=h.jp(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(h.xa())return h.mj(h.get_active());w.error("No active scene");return!1};a.get_object_by_name=function(a,b){var c=e.oc(e.Mu,a,b|0,!0);if(c)return c;w.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=e.oc(e.Lu,a,b,c|0))return a;w.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=e.oc(e.Cc,a,b|0);if(c)return c;w.error("get object "+
a+": not found")};a.get_world_by_name=function(a,b){var c=e.get_world_by_name(a,b|0);if(c)return c;w.error("get object "+a+": not found")};a.get_object_data_id=function(a){return u.get_object_data_id(a)};a.pick_object=function(a,b){var c=h.oh();return c?(c=h.Aa(c,B.uf))&&c.enable_hmd_stereo?(w.ja("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),d()):e.pick_object(a,b):(w.error("No active scene"),null)};a.pick_center=d;a.outlining_is_enabled=function(a){return a&&
a.o&&a.o.Ic};a.set_outline_intensity=function(a,b){a&&a.o&&a.o.Ic?e.set_outline_intensity(a,b):w.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.o&&a.o.Ic)return a.o.Jg;w.error("get_outline_intensity(): wrong object");return 0};a.apply_outline_anim=function(a,b,c,d){a&&a.o&&a.o.Ic?e.apply_outline_anim(a,b,c,d):w.error("apply_outline_anim(): wrong object")};a.apply_outline_anim_def=function(a){if(a&&a.o&&a.o.Ic){var b=a.o.Ah;e.apply_outline_anim(a,b.Gj,b.Hj,
b.Ij)}else w.error("apply_outline_anim_def(): wrong object")};a.clear_outline_anim=function(a){a&&a.o&&a.o.Ic?e.clear_outline_anim(a):w.error("clear_outline_anim(): wrong object")};a.set_outline_color=h.set_outline_color;a.get_outline_color=function(a){var b=h.get_active();if(b=h.Aa(b,B.Vl))return a=a||new Float32Array(3),a.set(b.wi),a};a.set_hmd_params=function(a){h.xa()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof
Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),h.set_hmd_params(a)):w.error("No active scene")};a.get_shadow_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active(),b=h.Aa(a,B.Xc);if(!b)return null;var c=a.F.Jc,d=h.Aa(a,B.Db),e=h.Aa(a,B.Re),g={};g.csm_resolution=c.csm_resolution;
g.self_shadow_polygon_offset=b.self_shadow_polygon_offset;e&&(g.self_shadow_normal_offset=e.self_shadow_normal_offset);g.enable_csm=c.enable_csm;g.csm_num=c.csm_num;g.csm_first_cascade_border=c.csm_first_cascade_border;g.first_cascade_blur_radius=c.first_cascade_blur_radius;g.csm_last_cascade_border=c.csm_last_cascade_border;g.last_cascade_blur_radius=c.last_cascade_blur_radius;g.fade_last_cascade=c.fade_last_cascade;g.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(g.csm_borders=h.XM(a,
d.B),g.blur_radii=new Float32Array(c.csm_num),g.blur_radii.set(d.B.Sm.subarray(0,c.csm_num))):(g.csm_borders=null,g.blur_radii=null);return g};a.set_shadow_params=function(a){if(h.xa()){var d=h.get_active();"number"==typeof a.self_shadow_polygon_offset&&x.ha(d.F.Ja,function(b,c){c.type==B.Xc&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});for(var e=h.Ii(d,[B.Re]),f=0;f<e.length;f++){var g=e[f];"number"==typeof a.self_shadow_normal_offset&&(g.self_shadow_normal_offset=a.self_shadow_normal_offset);
"number"==typeof a.pcf_blur_radius&&(g.pcf_blur_radius=a.pcf_blur_radius)}e=h.Ii(d,[B.Vc]);for(f=0;f<e.length;f++){var k=e[f];"number"==typeof a.self_shadow_normal_offset&&(k.self_shadow_normal_offset=a.self_shadow_normal_offset);"number"==typeof a.pcf_blur_radius&&(k.pcf_blur_radius=a.pcf_blur_radius);k.Ba=!0}e=d.F.Jc;"number"==typeof a.csm_first_cascade_border&&(e.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(e.first_cascade_blur_radius=a.first_cascade_blur_radius);
"number"==typeof a.csm_last_cascade_border&&(e.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(e.last_cascade_blur_radius=a.last_cascade_blur_radius);if(g){k=g.Qa;for(f=0;f<k.length;f++)for(var m=k[f].ra,n=0;n<m.length;n++){var r=m[n];if(r.Ee.Gd){var v=r.qa;c.iA(v,e);c.vc(v);B.Ec(g,r)}}g.Ba=!0}g=u.oa(d.Vi,d).ea;for(f=0;f<g.length;f++)b.$y(g[f],e);h.jy(d)}else w.error("No active scene")};a.get_environment_colors=function(){if(!h.xa())return w.error("No active scene"),
[];var a=h.get_active();return h.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(h.xa()){var d=h.get_active(),e=h.Aa(d,B.Db);h.set_environment_colors(d,a||0==a?parseFloat(a):e.wg,b||0==b?b:e.Md,c||0==c?c:e.Vd)}else w.error("No active scene")};a.get_fog_color_density=function(a){if(!h.xa())return w.error("No active scene"),!1;var b=h.get_active();return h.get_fog_color_density(b,a)};a.set_fog_color_density=function(a){if(h.xa()){var b=h.get_active();h.set_fog_color_density(b,
a)}else w.error("No active scene")};a.get_fog_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active(),b={};b.bp=h.eN(a);b.fog_depth=h.cN(a);b.fog_start=h.fN(a);b.fog_height=h.dN(a);return b};a.set_fog_params=function(a){if(h.xa()){var b=h.get_active();"number"==typeof a.bp&&h.hE(b,a.bp);"number"==typeof a.fog_depth&&h.fE(b,a.fog_depth);"number"==typeof a.fog_start&&h.iE(b,a.fog_start);"number"==typeof a.fog_height&&h.gE(b,a.fog_height)}else w.error("No active scene")};
a.get_ssao_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.get_ssao_params(a)};a.set_ssao_params=function(a){if(h.xa()){var b=h.get_active(),d=h.Ii(b,[B.Tq]),b=h.Ii(b,[B.Ru]);if(!d.length)return w.error("SSAO is not enabled on the scene"),0;for(var e=0;e<d;e++){var f=d[e],g=b[e],k=a,n=h.get_active(),r=f.Qa[0].ra[0],u=r.qa,l=g.Qa[0].ra[0],x=l.qa;if("quality"in k){var H=k.quality;8===H||16===H||24===H||32===H?(f.mq=H,c.mb(u,"SSAO_QUALITY","SSAO_QUALITY_"+
H),c.vc(u),B.Ec(f,r)):w.error('set_ssao_params(): Wrong "quality" value.')}"use_hemisphere"in k&&(f.Xt=k.use_hemisphere,c.mb(u,"SSAO_HEMISPHERE",k.use_hemisphere|0),c.vc(u),B.Ec(f,r));"use_blur_depth"in k&&(g.Ut=k.use_blur_depth,c.mb(x,"SSAO_BLUR_DEPTH",k.use_blur_depth|0),c.vc(x),B.Ec(g,l),m.Ck(n.F.Ja,g,x));"ssao_white"in k&&(f.ssao_white=k.ssao_white,c.mb(u,"SSAO_WHITE",k.ssao_white|0),c.vc(u),B.Ec(f,r));"blur_discard_value"in k&&(g.Vt=k.blur_discard_value);"radius_increase"in k&&(f.Zt=k.radius_increase);
"influence"in k&&(f.Yt=k.influence);"dist_factor"in k&&(f.Wt=k.dist_factor);if("boolean"==typeof k.ssao_only){n=h.Aa(n,B.Db);n.ssao_only=k.ssao_only;r=n.Qa;u=[];for(l=0;l<r.length;l++)for(x=r[l].ra,H=0;H<x.length;H++){var p=x[H].qa;c.mb(p,"SSAO_ONLY",k.ssao_only|0);c.vc(p);u.push(x[H])}for(l=0;l<u.length;l++)B.Ec(n,u[l])}f.Ba=!0;g.Ba=!0}}else w.error("No active scene")};a.get_color_correction_params=function(){if(!h.xa())return w.error("No active scene"),null;var a=h.get_active(),a=h.Aa(a,B.Eu);if(!a)return null;
var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(h.xa()){var b=h.get_active();if(b=h.Aa(b,B.Eu))"brightness"in a&&(b.brightness=a.brightness),"contrast"in a&&(b.contrast=a.contrast),"exposure"in a&&(b.exposure=a.exposure),"saturation"in a&&(b.saturation=a.saturation),b.Ba=!0}else w.error("No active scene")};a.get_sky_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=
h.get_active();return h.get_sky_params(a)};a.set_sky_params=function(a){if(h.xa()){var b=h.get_active(),c=h.Aa(b,B.gg);c&&("color"in a&&c.en.set(a.color),"rayleigh_brightness"in a&&(c.rayleigh_brightness=a.rayleigh_brightness),"mie_brightness"in a&&(c.mie_brightness=a.mie_brightness),"spot_brightness"in a&&(c.spot_brightness=a.spot_brightness),"scatter_strength"in a&&(c.scatter_strength=a.scatter_strength),"rayleigh_strength"in a&&(c.rayleigh_strength=a.rayleigh_strength),"mie_strength"in a&&(c.mie_strength=
a.mie_strength),"rayleigh_collection_power"in a&&(c.rayleigh_collection_power=a.rayleigh_collection_power),"mie_collection_power"in a&&(c.mie_collection_power=a.mie_collection_power),"mie_distribution"in a&&(c.mie_distribution=a.mie_distribution),c.Ba=!0,c.ft=!0,h.XR(b,c))}else w.error("No active scene")};a.get_dof_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.Aa(a,B.Kn)?h.get_dof_params(a):null};a.set_dof_params=function(a){if(h.xa()){var b=h.get_active();
h.set_dof_params(b,a)}else w.error("No active scene")};a.get_god_rays_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.Aa(a,B.Ul)?h.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(h.xa()){var b=h.get_active();h.set_god_rays_params(b,a)}else w.error("No active scene")};a.get_bloom_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.Aa(a,B.Hn)?h.get_bloom_params(a):null};a.set_bloom_params=function(a){if(h.xa()){var b=
h.get_active();h.set_bloom_params(b,a)}else w.error("No active scene")};a.get_glow_material_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.Aa(a,B.Ln)?h.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(h.xa()){var b=h.get_active();h.set_glow_material_params(b,a)}else w.error("No active scene")};a.get_wind_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.get_wind_params(a)};a.set_wind_params=
function(a){if(h.xa()){var b=h.get_active();e.set_wind_params(b,a)}else w.error("No active scene")};a.get_water_surface_level=function(a,b){if(!h.xa())return w.error("No active scene"),0;var c=h.get_active();return c.F.Bc?h.get_water_surface_level(c,a,b):(w.error("No water parameters on the active scene"),0)};a.set_water_params=function(a){if(h.xa()){var b=h.get_active();h.set_water_params(b,a)}else w.error("No active scene")};a.get_water_mat_params=function(a){if(h.xa()){var b=h.get_active();h.get_water_mat_params(b,
a)}else w.error("No active scene")};a.update_scene_materials_params=function(){if(h.xa()){var a=h.get_active();h.BF(a)}else w.error("No active scene")};a.hide_object=function(a,b){b=b||!1;!u.is_mesh(a)&&!u.is_empty(a)||u.is_dynamic(a)?b?h.uo(a,!0):h.sr(a,!0):w.error("show/hide is only supported for dynamic objects.")};a.show_object=function(a,b){b=b||!1;!u.is_mesh(a)&&!u.is_empty(a)||u.is_dynamic(a)?b?h.uo(a,!1):h.sr(a,!1):w.error("show/hide is only supported for dynamic objects.")};a.is_hidden=function(a){if(u.Ag(a)||
u.is_empty(a)||u.is_lamp(a))return h.is_hidden(a);w.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.is_visible=function(a){return a.o.is_visible};a.check_object_by_name=function(a,b){return e.oc(e.Mu,a,b|0,!0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return e.oc(e.Lu,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return e.oc(e.Cc,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=h.get_active();a||(a="ALL");b||0===b||(b=e.DATA_ID_ALL);
return e.kC(c,a,b)};a.get_object_name=function(a){return a?a.Cd:(w.error("Wrong object name"),"")};a.get_object_name_hierarchy=function(a){if(!a)return w.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Cd),a=u.get_dg_parent(a);return b.reverse()};a.get_object_type=function(a){return a&&a.type?a.type:(w.error("Wrong object"),"UNDEFINED")};a.get_object_children=function(a){return a.ve.slice(0)};a.get_first_character=function(){return e.get_first_character(h.get_active())};a.get_shore_dist=
function(a,b){b||0===b||(b=1);if(!h.xa())return w.error("No active scene"),0;var c=h.get_active();return h.get_shore_dist(c,a,b)};a.get_cam_water_depth=function(){return h.get_cam_water_depth()};a.get_type_mesh_object=function(a){return u.is_mesh(a)?a.o.type:""};a.get_meta_tags=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.get_meta_tags(a)};a.get_custom_prop=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.get_custom_prop(a)};
a.append_object=function(a,b){if(a.o.Gs){if(b)var c=h.jp(),c=k.keysearch("name",b,c);else c=h.get_active();h.append_object(c,a,!0)}else w.error('object "'+a.name+'" has been created not by coping.')};a.remove_object=function(a){(u.is_mesh(a)||u.is_empty(a))&&u.is_dynamic(a)?(e.kt(a,a.o.Hs,!1,!1),n.oP(a),e.kt(a,!0,!0,!0),e.remove_object(a)):w.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.marker_frame=function(a){var b=h.get_active();if(b.timeline_markers&&
a in b.timeline_markers)return h.marker_frame(b,a);w.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=h.get_active();return(a=h.Aa(a,B.Ug))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=h.get_active(),b=h.Ii(b,[B.Ug]);if(b.length)for(var c=0;c<b.length;c++){var d=b[c];"number"==typeof a.mb_decay_threshold&&(d.mb_decay_threshold=a.mb_decay_threshold);"number"==typeof a.mb_factor&&(d.mb_factor=a.mb_factor)}else w.error("The motion blur subscene doesn't exist.")};
a.can_select_objects=function(){var a=h.get_active();return!!h.Aa(a,B.Wd)}};b4w.module.screen=function(a,r){function d(){}function c(){}function b(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullscreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}a=a||e.get_container();
b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.Zx=a.Zx||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.Zx?a.Zx():f.error("B4W App: request fullscreen method is not supported")}function g(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||
document.msExitFullscreen;"function"!=typeof a&&f.error("B4W App: exit fullscreen method is not supported");a.apply(document)}function n(a){var b=h.get_device_by_type_element(h.DEVICE_HMD);if(b&&!J){var c=h.get_value_param(b,h.HMD_WEBVR_TYPE);if(c&h.HMD_WEBVR1_1){var d=b.Uc,f=d.getEyeParameters("left"),d=d.getEyeParameters("right");e.resize(2*Math.max(f.renderWidth,d.renderWidth),Math.max(f.renderHeight,d.renderHeight),!1)}else f=e.get_canvas(),f=Math.max(2*f.height,f.width),e.resize(f,f/2,!1);f=
h.get_vector_param(b,h.xz,q);d=h.get_vector_param(b,h.yz,E);x.set_hmd_fov(a,f,d,!(c&h.HMD_WEBVR1_1));f={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};c&(h.HMD_NON_WEBVR|h.HMD_WEBVR_MOBILE|h.HMD_WEBVR_DESKTOP)&&(f.distortion_coefs=[b.distortion_coefs[0],b.distortion_coefs[1]],f.chromatic_aberration_coefs=[b.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]],b.Pl||(b.Yg&&b.rh&&b.Zg?f.base_line_factor=(b.Yg-
b.Zg)/b.rh:b.Zg||(f.base_line_factor=b.Yg/b.rh)),b.Kf&&b.hk&&!b.Pl&&(f.inter_lens_factor=b.Kf/b.hk));A.enabled||F.et(.5,1);F.set_hmd_params(f);if(c=h.get_value_param(b,h.HMD_EYE_DISTANCE))f=F.get_active(),a=k.oa(a,f).ea,x.set_eye_distance(a,c);F.yP();h.reset_device(b);J=!0}}var x=r("__camera"),e=r("__container"),u=r("__config"),w=r("__hud"),h=r("__input"),m=r("__main"),B=r("__mat4"),k=r("__obj_util"),f=r("__print"),F=r("__scenes"),t=r("__vec4"),q=t.create(),E=t.create();B.create();B.create();var J=
!1,A=u.Jk;a.draw_mixer_strip=w.draw_mixer_strip;a.plot_array=w.plot_array;a.request_fullscreen=b;a.exit_fullscreen=g;a.check_fullscreen=h.check_fullscreen;a.request_fullscreen_hmd=function(a,c,g){if("HMD"!=!u.get("stereo")||"NONE"==u.get("stereo")&&u.get("is_mobile_device")){var k=h.get_device_by_type_element(h.DEVICE_HMD);if(k&&h.get_value_param(k,h.HMD_WEBVR_TYPE)&h.HMD_WEBVR1){var m=k.Uc;m&&!m.isPresenting&&(c=c||function(){},g=g||function(){},d=function(){m.isPresenting?c():(window.removeEventListener("vrdisplaypresentchange",
d),g())},window.addEventListener("vrdisplaypresentchange",d,!1),m.capabilities.canPresent?(a=e.get_canvas(),m.requestPresent([{source:a}]).then(function(){},function(){f.error("HMD fullscreen request failed.")})):f.error("HMD fullscreen request failed."))}else b(a,c,g)}};a.exit_fullscreen_hmd=function(){if("HMD"!=!u.get("stereo")||"NONE"==u.get("stereo")&&u.get("is_mobile_device")){var a=h.get_device_by_type_element(h.DEVICE_HMD);a&&h.get_value_param(a,h.HMD_WEBVR_TYPE)&h.HMD_WEBVR1?(a=a.Uc)&&a.isPresenting&&
(a.exitPresent(),e.resize_to_container(!0)):g()}};a.check_fullscreen_hmd=function(){var a=h.get_device_by_type_element(h.DEVICE_HMD),b=h.get_value_param(a,h.HMD_WEBVR_TYPE)&h.HMD_WEBVR1;return a&&(b&&a.Uc||!b&&h.check_fullscreen())?!0:!1};a.request_split_screen=function(a,b){var d=h.get_device_by_type_element(h.DEVICE_HMD);if(!d)return!1;if(J)return!0;c=b;if(F.xa()){var e=F.mj(F.get_active());e&&(d.lf?(n(e),a&&a()):(h.JP(d),d.Xp=function(){n(e);a&&a()}))}};a.exit_split_screen=function(){var a=h.get_device_by_type_element(h.DEVICE_HMD);
if(!J||!a||!a.lf)return!1;F.set_hmd_params({enable_hmd_stereo:!1});J=!1;c&&c();F.zP();A.enabled||F.et(2,1);e.resize_to_container(!0);return!0};a.shot=function(a,b){a=a||"image/png";m.canvas_data_url(function(b){var c=window.document.createElement("a");document.body.appendChild(c);c.style.display="none";c.href=b;c.download="screenshot."+a.split("/")[1];c.click();document.body.removeChild(c)},a,b||1,!0)}};b4w.module.sfx=function(a,r){var d=r("__obj_util"),c=r("__scenes"),b=r("__sfx"),g=r("__print");a.play=function(a,c,d){b.play(a,c||0,d||0)};a.play_def=function(a){b.play_def(a)};a.is_playing=function(a){return b.is_playing(a)};a.stop=function(a){b.stop(a)};a.pause=function(a){b.SQ(a)};a.resume=function(a){b.UQ(a)};a.loop_stop=function(a,c,d){b.loop_stop(a,c||0,d||!1)};a.playrate=function(a,c){b.playrate(a,c)};a.get_playrate=function(a){return b.get_playrate(a)};a.cyclic=function(a,c){b.cyclic(a,c)};
a.is_cyclic=function(a){return b.is_cyclic(a)};a.listener_reset_speed=function(){b.listener_stride()};a.listener_stride=function(){b.listener_stride()};a.speaker_reset_speed=function(a){b.speaker_stride(a)};a.speaker_stride=function(a){b.speaker_stride(a)};a.get_volume=function(a){return a&&"object"===typeof a?b.get_volume(a):b.oN()};a.set_volume=function(a,c){a&&"object"===typeof a?b.set_volume(a,c):b.sQ(c)};a.mute=function(a,c){a&&"object"===typeof a?b.mute(a,c):b.OO(c)};a.is_muted=function(a){return a&&
"object"===typeof a?b.is_muted(a):b.SN()};a.get_speaker_objects=function(){return b.get_speaker_objects().slice(0)};a.check_active_speakers=b.check_active_speakers;a.set_compressor_params=function(a){b.set_compressor_params(c.get_active(),a)};a.get_compressor_params=function(){return b.get_compressor_params(c.get_active())};a.duck=function(a,c,d){a&&"object"===typeof a?b.duck(a,c,d):b.QL(c,d)};a.unduck=function(a){a&&"object"===typeof a?b.unduck(a):b.vR()};a.apply_playlist=b.apply_playlist;a.clear_playlist=
b.clear_playlist;a.detect_audio_container=b.detect_audio_container;a.detect_video_container=b.detect_video_container;a.set_positional_params=b.set_positional_params;a.get_positional_params=b.get_positional_params;a.set_filter_params=b.set_filter_params;a.get_filter_params=b.get_filter_params;a.get_filter_freq_response=b.get_filter_freq_response;a.get_duration=function(a){return a&&d.is_speaker(a)?b.get_duration(a):(g.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker'),0)}};b4w.module.textures=function(a,r){var d=r("__print"),c=r("__scenes"),b=r("__textures"),g=r("__obj_util"),n=r("__util"),x=r("__assets");a.play_video=function(a,g){g||(g=0);var e=b.Ew(a,g);e?c.get_active().b4w_use_nla&&b.iz(e)?d.error("NLA texture can't be controlled directly through API."):b.play_video(e):d.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,g){g||(g=0);var e=b.Ew(a,g);e?c.get_active().b4w_use_nla&&b.iz(e)?d.error("NLA texture can't be controlled directly through API."):
b.pause_video(e):d.error('Texture with name "'+a+'" not found!')};a.reset_video=function(a,g){g||(g=0);var e=b.Ew(a,g);e?c.get_active().b4w_use_nla&&b.iz(e)?d.error("NLA texture can't be controlled directly through API."):b.reset_video(e):d.error('Texture with name "'+a+'" not found!')};a.get_canvas_ctx=function(a,c){if(g.is_mesh(a)){var e=b.UM(a,c);if(e)return e;d.error("Couldn't find canvas texture with this name: "+c)}else d.error("Object must be type of mesh.");return null};a.update_canvas_ctx=
function(a,c){if(!g.is_mesh(a))return d.error("Object must be type of mesh."),!1;var e=b.Bw(a,c);if(!e||"CANVAS"!=e.source)return d.error("Couldn't find canvas texture \""+c+'" in object "'+a.name+'".'),!1;b.aS(e);return!0};a.change_image=function(a,c,g,h){h=h||function(){};var e=b.Bw(a,c);if(e)if(e.mi)d.error("Changing video textures is forbidden."),h(!1);else{var r=n.zh(g);e.rj==r?h(!0):x.enqueue([{id:g,type:x.AT_IMAGE_ELEMENT,url:g,request:"GET"}],function(d){d?(b.change_image(a,e,c,d,g),h(!0)):
h(!1)},null,null)}else d.error("Couldn't find texture \""+c+'" in object "'+a.name+'".'),h(!1)};a.get_texture_names=function(a){if(g.is_mesh(a))return b.get_texture_names(a);d.error("Object must be type of mesh.");return[]}};b4w.module.time=function(a,r){var d=r("__time");a.set_timeout=d.set_timeout;a.clear_timeout=d.clear_timeout;a.get_timeline=d.get_timeline;a.animate=d.animate;a.clear_animation=d.clear_animation};b4w.module.transform=function(a,r){var d=r("__obj_util"),c=r("__physics"),b=r("__print"),g=r("__quat"),n=r("__transform"),x=r("__tsr"),e=r("__util"),u=x.create(),w=new Float32Array(3),h=new Float32Array(4);a.set_translation=function(a,e,g,f){d.is_dynamic(a)?(w[0]=e,w[1]=g,w[2]=f,n.set_translation(a,w),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel=function(a,e,g,f){d.is_dynamic(a)?(w[0]=e,w[1]=g,w[2]=f,n.set_translation_rel(a,w),n.L(a),c.sync_transform(a)):
b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,e){d.is_dynamic(a)?(n.set_translation(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel_v=function(a,e){d.is_dynamic(a)?(n.set_translation_rel(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_obj_rel=function(a,g,h,f,r){d.is_dynamic(a)?(w[0]=g,w[1]=h,w[2]=f,g=x.get_trans_view(r.o.v),r=x.get_quat_view(r.o.v),
e.transform_vec3(w,1,r,g,w),n.set_translation(a,w),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));n.get_translation(a,b);return b};a.get_translation_rel=function(a,b){b||(b=new Float32Array(3));n.get_translation_rel(a,b);return b};a.set_rotation=function(a,e,g,f,r){d.is_dynamic(a)?(h[0]=e,h[1]=g,h[2]=f,h[3]=r,n.set_rotation(a,h),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.set_rotation_rel=function(a,e,g,f,r){d.is_dynamic(a)?(h[0]=e,h[1]=g,h[2]=f,h[3]=r,n.set_rotation_rel(a,h),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_v=function(a,e){d.is_dynamic(a)?(n.set_rotation(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel_v=function(a,e){d.is_dynamic(a)?(n.set_rotation_rel(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.get_rotation=function(a,b){b||(b=new Float32Array(4));n.get_rotation(a,b);return b};a.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));n.get_rotation_rel(a,b);return b};a.set_rotation_euler=function(a,e,g,f){d.is_dynamic(a)?(w[0]=e,w[1]=g,w[2]=f,n.set_rotation_euler(a,w),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_rotation_euler=function(a,b){b||(b=new Float32Array(3));n.get_rotation_euler(a,b);return b};a.get_rotation_euler_rel=function(a,b){b||
(b=new Float32Array(3));n.get_rotation_euler_rel(a,b);return b};a.set_rotation_euler_rel=function(a,e,g,f){d.is_dynamic(a)?(w[0]=e,w[1]=g,w[2]=f,n.set_rotation_euler_rel(a,w),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,e){d.is_dynamic(a)?(n.set_rotation_euler(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel_v=function(a,e){d.is_dynamic(a)?(n.set_rotation_euler_rel(a,
e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,c){d.is_dynamic(a)?(n.set_scale(a,c),n.L(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale_rel=function(a,c){d.is_dynamic(a)?(n.set_scale_rel(a,c),n.L(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_scale=function(a){return n.get_scale(a)};a.get_scale_rel=function(a){return n.get_scale_rel(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+
a.name);else{for(var e=0;e<a.ve.length;e++)if(!d.is_dynamic(a.ve[e])){b.error('Wrong object: "'+a.ve[e].name+'" is not dynamic.');return}n.set_translation(a,[0,0,0]);n.set_rotation(a,[0,0,0,1]);n.set_scale(a,1);n.L(a);c.sync_transform(a)}};a.get_object_size=function(a){return d.is_mesh(a)?n.get_object_size(a):(b.error("Wrong object: "+a.name),0)};a.get_object_center=function(a,c,e){if(!d.is_mesh(a))return b.error("Wrong object: "+a.name),null;e||(e=new Float32Array(3));return n.get_object_center(a,
c,e)};a.move_local=function(a,e,g,f){d.is_dynamic(a)?(n.move_local(a,e,g,f),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_x_local=function(a,r){if(d.is_dynamic(a)){var k=g.setAxisAngle(e.AXIS_X,r,h);n.fy(a,k);n.L(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_y_local=function(a,r){if(d.is_dynamic(a)){var k=g.setAxisAngle(e.AXIS_MY,r,h);n.fy(a,k);n.L(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.rotate_z_local=function(a,r){if(d.is_dynamic(a)){var k=g.setAxisAngle(e.AXIS_Z,r,h);n.fy(a,k);n.L(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return n.get_object_bounding_box(a)};a.set_tsr=function(a,e){d.is_dynamic(a)?(n.set_tsr(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr_rel=function(a,e){d.is_dynamic(a)?(n.set_tsr_rel(a,e),n.L(a),c.sync_transform(a)):
b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_tsr=function(a,b){b||(b=new Float32Array(8));n.get_tsr(a,b);return b};a.get_tsr_rel=function(a,b){b||(b=new Float32Array(8));n.get_tsr_rel(a,b);return b};a.distance=function(a,b){return n.distance(a,b)};a.set_matrix=function(a,e){d.is_dynamic(a)?(x.from_mat4(e,u),n.set_tsr(a,u),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_matrix_rel=function(a,e){d.is_dynamic(a)?(x.from_mat4(e,u),n.set_tsr_rel(a,
u),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_matrix=function(a,b){b||(b=new Float32Array(16));n.get_tsr(a,u);x.to_mat4(u,b);return b};a.get_matrix_rel=function(a,b){b||(b=new Float32Array(16));n.get_tsr_rel(a,u);x.to_mat4(u,b);return b}};b4w.module.tsr=function(a,r){var d=r("__mat4"),c=r("__tsr");a.create=c.create;a.from_values=c.from_values;a.copy=c.copy;a.identity=c.identity;a.set_sep=c.set_sep;a.set_trans=c.set_trans;a.set_scale=c.set_scale;a.set_transcale=c.set_transcale;a.set_quat=c.set_quat;a.get_trans_view=c.get_trans_view;a.get_scale=c.get_scale;a.get_quat_view=c.get_quat_view;a.invert=c.invert;a.to_mat4=function(a,g){g||(g=d.create());c.to_mat4(a,g);return g};a.from_mat4=c.from_mat4;a.multiply=c.multiply;a.transform_vec3=
c.transform_vec3;a.transform_vec3_inv=c.transform_vec3_inv;a.transform_vectors=c.transform_vectors;a.transform_dir_vectors=c.transform_dir_vectors;a.transform_dir_vec3=c.transform_dir_vec3;a.transform_tangents=c.transform_tangents;a.translate=c.translate;a.interpolate=function(a,d,n,r){r||(r=c.create());c.interpolate(a,d,n,r);return r}};b4w.module.util=function(a,r){var d=r("__compat"),c=r("__print"),b=r("__quat"),g=r("__util"),n=r("__vec3");a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.XYX=g.XYX;a.YZY=g.YZY;a.ZXZ=g.ZXZ;a.XZX=g.XZX;a.YXY=g.YXY;a.ZYZ=g.ZYZ;a.XYZ=g.XYZ;a.YZX=g.YZX;a.ZXY=g.ZXY;a.XZY=g.XZY;a.YXZ=g.YXZ;a.ZYX=g.ZYX;a.f32=function(a){return g.f32(a||
0)};a.assert=g.assert;a.keyfind=g.keyfind;a.keysearch=g.keysearch;a.matrix_to_quat=function(a){return g.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));return g.euler_to_quat(a,b)};a.ordered_angles_to_quat=function(a,c,d){d||(d=b.create());return g.ordered_angles_to_quat(a,c,d)};a.quat_to_ordered_angles=function(a,b,c){c||(c=n.create());return g.quat_to_ordered_angles(a,b,c)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));return g.quat_to_euler(a,b)};a.sign=g.sign;
a.clamp=g.clamp;a.quat_to_dir=g.quat_to_dir;a.ground_project_cam_quat=function(a,b){return g.quat_project(a,g.AXIS_MZ,g.AXIS_Z,g.AXIS_Y,b)};a.cam_quat_to_mesh_quat=function(a,b){return g.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,b,d,r,h){return 0!=n.dot(d,r)?(c.error("Wrong in-plane direction"),null):g.quat_project(a,b,d,r,h)};a.hash_code=g.hash_code;a.smooth=g.smooth;a.smooth_v=g.smooth_v;a.is_vector=g.is_vector;a.correct_cam_quat_up=g.correct_cam_quat_up;a.quat_to_angle_axis=g.quat_to_angle_axis;
a.random_from_array=g.random_from_array;a.horizontal_direction=g.horizontal_direction;a.angle_wrap_0_2pi=g.angle_wrap_0_2pi;a.angle_wrap_periodic=g.angle_wrap_periodic;a.smooth_step=g.smooth_step;a.lerp=g.lerp;a.deg_to_rad=g.deg_to_rad;a.rad_to_deg=g.rad_to_deg;a.dir_to_quat=g.dir_to_quat;a.is_ie11=d.is_ie11;a.gen_tbn_quats=g.gen_tbn_quats};b4w.module.version=function(a,r){var d=r("__version");a.version=d.version;a.version_str=d.version_str;a.type=d.type;a.date=d.date;a.date_str=d.date_str};b4w.module.objects=function(a,r){var d=r("__geometry"),c=r("__objects"),b=r("__batch"),g=r("__obj_util"),n=r("__print"),x=r("__scenes");a.get_meta_tags=function(a){if(a)return c.get_meta_tags(a)};a.get_custom_prop=function(a){if(a)return c.get_custom_prop(a)};a.copy=function(a,b,r){return g.is_mesh(a)?g.is_dynamic(a)?d.pj(a)||d.check_shape_keys(a)||!r?-1==c.Ib(x.get_active(),"MESH",c.DATA_ID_ALL).indexOf(a)?(n.error('object "'+a.name+'" does not belong to the active scene.'),!1):c.copy(a,b||"",r):
(n.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),!1):(n.error('object "'+a.name+'" is not dynamic.'),!1):(n.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,c,d){n.Ze("set_nodemat_value","material.set_nodemat_value");if(g.Ag(a)){var e=c[0],m=b.Oa(a,e,"MAIN");if(null===m)return n.error('Material "'+e+'" was not found in the object "'+a.name+'".'),null;m=b.ph(m.jf,c);if(null===m)return n.error('Value node "'+c[c.length-1]+'" was not found in the object "'+
a.name+'".'),null;b.set_nodemat_value(a,e,m,d)}else n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_value=function(a,c){n.Ze("get_nodemat_value","material.get_nodemat_value");if(!g.Ag(a))return n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),0;var d=c[0],e=b.Oa(a,d,"MAIN");if(null===e)return n.error('Material "'+d+'" was not found in the object "'+a.name+'".'),0;d=b.ph(e.jf,c);return null===d?(n.error('Value node "'+
c[c.length-1]+'" was not found in the object "'+a.name+'".'),0):b.get_nodemat_value(e,d)};a.set_nodemat_rgb=function(a,c,d,h,m){n.Ze("set_nodemat_rgb","material.set_nodemat_rgb");if(g.Ag(a)){var e=c[0],k=b.Oa(a,e,"MAIN");null===k?n.error('Material "'+e+'" was not found in the object "'+a.name+'".'):(k=b.ph(k.hf,c),null===k?n.error('RGB node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'):b.set_nodemat_rgb(a,e,k,d,h,m))}else n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};
a.get_nodemat_rgb=function(a,c,d){n.Ze("get_nodemat_rgb","material.get_nodemat_rgb");if(!g.Ag(a))return n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var e=c[0],m=b.Oa(a,e,"MAIN");if(null===m)return n.error('Material "'+e+'" was not found in the object "'+a.name+'".'),null;e=b.ph(m.hf,c);if(null===e)return n.error('RGB node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'),null;d||(d=new Float32Array(3));return b.get_nodemat_rgb(m,e,d)};a.update_boundings=
function(a){g.is_mesh(a)?d.pj(a)||d.check_shape_keys(a)?c.update_boundings(a):n.error('object "'+a.name+'" has not dynamic geometry.'):n.error('The type of the object "'+a.name+'" is not "MESH".')};a.get_parent=g.get_parent;a.get_dg_parent=g.get_dg_parent;a.is_mesh=g.is_mesh;a.is_armature=g.is_armature;a.is_speaker=g.is_speaker;a.is_camera=g.is_camera;a.is_lamp=g.is_lamp;a.is_empty=g.is_empty;a.is_line=g.is_line;a.is_world=g.is_world;a.get_selectable_objects=function(){return c.get_selectable_objects()};
a.get_outlining_objects=function(){return c.get_outlining_objects()};a.is_dynamic=g.is_dynamic;a.set_wind_bending_params=function(a,d){if(g.Ag(a)){var e=a.o;if(e.Ud){if("number"==typeof d.angle){var h=b.aG(d.angle,e.Uh,e.v[3]);e.Ne=h}"number"==typeof d.main_frequency&&(e.Oe=d.main_frequency);"number"==typeof d.detail_frequency&&(e.ye=d.detail_frequency);"number"==typeof d.detail_amplitude&&(e.xe=d.detail_amplitude);"number"==typeof d.branch_amplitude&&(e.te=d.branch_amplitude);c.kQ(a)}else n.error('The "'+
a.name+"\" object doesn't have wind bending parameters.")}else n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_wind_bending_params=function(a){var c=a.o;if(!g.Ag(a)||!c.Ud)return null;a={};var d=b.zS(c.Ne,c.Uh,c.v[3]);a.angle=d;a.main_frequency=c.Oe;a.detail_frequency=c.ye;a.detail_amplitude=c.xe;a.branch_amplitude=c.te;return a}};b4w.module.main=function(a,r){function d(){}function c(){}function b(){}function g(){window.performance||(Z.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(Z.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});L.qE(0)}function n(a,b){for(var c=null,d=b?ma:P,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,U)}catch(ra){}if(c)break}c&&t.IL(c);return c}function x(a,b,d){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();Z.error("WebGL context lost");u()},!1);I.mf(d);var e=I.get_renderer_info();e&&Z.log("%cRENDERER INFO:","color: #00a",d.getParameter(e.UNMASKED_VENDOR_WEBGL)+", "+d.getParameter(e.UNMASKED_RENDERER_WEBGL));S.mf(d);C.mf(d);V.mf(d);X.mf(d);A.mf(d);q.mf(d);J.FQ(a);q.init(a,b);G.sE(a.width,a.height,1);D.init();v.init();c=m();h()}function e(){d=function(){}}function u(){w()||(M=performance.now()/1E3,D.pause(),y.pause(),V.pause(),B.pause())}function w(){return la<M}function h(){var a=
"HMD"===ga.stereo&&v.xN();a?a.requestAnimationFrame(h):ka(h);var b=performance.now()/1E3;ca||(ca=b);var e=b-ca;if(!(e<1/ga.max_fps)){for(var g=L.get_timeline(),m=0;m<aa.length;m++)aa[m](g,e);w()||(la>ca&&(e-=la-Math.max(M,ca)),g+=e,L.qE(g),A.update(),f.update(),J.update(),m=e,J.is_primary_loaded()&&(l.reset(),ba.update(m),p.update(g,m),z.update(g,m),D.update(g,m),m&&k.update(m),J.is_primary_loaded()&&(y.update(g,m),J.is_primary_loaded()&&(v.update(g),E.update(g,m),J.is_primary_loaded()&&(B.update(!1),
Q.update(g,m),ha.update(),d(m,g),J.is_primary_loaded()&&(G.update(g,m),B.EF(),H.frame()))))),c(e));ca=b;a&&a.isPresenting&&a.submitFrame()}}function m(){var a=60,c=0,d=ga.LB,e=ga.uM;return function(f){f<1/ga.max_fps||(a=pa.smooth(1/f,a,f,d),f=y.gN(),(c=(c+1)%e)||b(Math.round(a),f))}}var B=r("__anchors"),k=r("__animation"),f=r("__assets"),F=r("__config"),t=r("__compat"),q=r("__container"),E=r("__controls"),J=r("__data"),A=r("__debug"),I=r("__extensions"),C=r("__geometry"),v=r("__input"),l=r("__hud"),
z=r("__nla"),H=r("__main"),p=r("__logic_nodes"),Q=r("__objects"),y=r("__physics"),Z=r("__print"),S=r("__renderer"),G=r("__scenes"),D=r("__sfx"),X=r("__shaders"),V=r("__textures"),L=r("__time"),ba=r("__transform"),pa=r("__util"),Y=r("__version"),ha=r("__particles"),U=F.context,ga=F.H,ca=0,M=0,la=0,aa=[],P=["webgl","experimental-webgl"],ma=["webgl2","experimental-webgl2"],W=null,ka=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ga.max_fps)}}();a.init=function(a,b){F.tQ();Z.BQ(ga.console_verbose);var c=Y.version_str()+" "+Y.type()+" ("+Y.date_str()+")";Z.log("%cINIT ENGINE","color: #00a",c);Z.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;g();b?l.init(b):(F.H.show_hud_debug_info=!1,F.Y.$s=!1);t.ZI();t.wv("Chrome")||t.wv("Firefox")||(ga.Yb=!1);c=n(a,ga.Yb);!c&&ga.Yb&&(ga.Yb=!1,c=n(a,!1));if(!c)return null;
Z.log("%cINIT WEBGL "+(ga.Yb?"2":"1"),"color: #00a");W=c;x(a,b,c);F.apply_quality();t.lE(c,!0);X.rO();ga.Uk&&(a.style["touch-action"]="none");Z.log("%cSET PRECISION:","color: #00a",ga.precision);return c};a.set_fps_callback=function(a){b=a};a.clear_fps_callback=function(){b=function(){}};a.set_render_callback=function(a){d=a};a.clear_render_callback=function(){e()};a.pause=u;a.resume=function(){w()&&(la=performance.now()/1E3,D.resume(),y.resume(),V.play(!0),B.resume())};a.is_paused=w;a.reset=function(){J.unload(0);
J.reset();I.reset();S.reset();C.reset();V.KP();X.reset();A.reset();q.reset();J.reset();q.reset();L.reset();D.reset();la=M=ca=0;b=function(){};c=function(){};d=function(){};aa.length=0;W=null};a.canvas_data_url=function(a,b,c,d){H.canvas_data_url(a,b,c,d)};a.detect_mobile=function(){return t.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<aa.length;b++)if(aa[b]==a)return;aa.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<aa.length;b++)if(aa[b]==a){aa.splice(b,1);break}};a.get_renderer_info=
function(){var a=I.get_renderer_info();return a?{vendor:W.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:W.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.nla=function(a,r){var d=r("__nla"),c=r("__time"),b=r("__print"),g=r("__util");a.set_frame=function(a){a=g.clamp(a,d.get_frame_start(),d.get_frame_end());d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.set_frame(a,c.get_timeline())};a.get_frame=function(){return d.get_frame(c.get_timeline())};a.stop=function(){d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.Ay()};a.play=function(a){d.check_logic_nodes()?b.error("The active scene is using NLA script."):
d.FD(a)};a.is_play=function(){return d.is_play()};a.get_frame_start=function(){return d.get_frame_start()};a.get_frame_end=function(){return d.get_frame_end()};a.check_nla=function(){return d.check_nla()};a.check_logic_nodes=function(){return d.check_logic_nodes()};a.set_range=function(a,c){d.check_logic_nodes()?b.error("The active scene is using NLA script."):(c=parseFloat(c)||d.get_frame_end(),a=parseFloat(a)||d.get_frame_end(),c=g.clamp(c,d.get_frame_start(),d.get_frame_end()),a=g.clamp(a,d.get_frame_start(),
c),d.set_range(a,c))};a.reset_range=function(){d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.reset_range()};a.set_cyclic=function(a){d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.set_cyclic(a)};a.clear_callback=function(){d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.clear_callback()}};b4w.module.app=function(a,r){function d(){var a=H.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=H.is_paused(),H.pause()):a||H.resume()},!1)}function c(){var a=0,b=I.get_container(),c=H.is_paused(),d=!0;H.append_loop_cb(function(){if(!(a%10)){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=H.is_paused()),H.pause(),d=!1):c||d||(H.resume(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);
f||(Q.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",e.style.left=0,e.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(e);if(!H.init(e,a))return c&&t("Browser could not initialize WebGL",
"For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html#problems-upon-startup",d),!1;a&&I.insert_to_container(a,"LAST");return!0}function g(a,b){a?(b&&(document.getElementById(b).style.display="block"),V=document.getElementById(a)):(V=document.createElement("div"),V.innerHTML=0,V.style.cssText="position:absolute;font-family: Arial, sans-serif;top: 20px;right: 20px;text-shadow: 0px 0px 6px #000;font-size: 40px;line-height: 50px;font-weight: bold;color: #fff;",I.insert_to_container(V,
"JUST_AFTER_CANVAS"))}function n(a,b){var c=String(a);b&&(c+="/"+String(b));V.innerHTML=c}function x(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function e(a,b,c){var d=Math.max(E.hover_get_distance(a),1),e=S.get_rotation(a,ca);b=G.quat_to_dir(e,b,U);b[2]=0;D.normalize(b,b);D.scale(b,d*c,b);c=S.get_translation(a,ga);D.add(c,b,c);E.set_translation(a,c)}function u(a,b){var c=E.hover_get_vertical_limits(a,la);if(c.up!=c.down){var d=E.get_camera_angles(a,
ha)[1],c=(c.down-d)/(c.down-c.up),d=E.hover_get_distance_limits(a,la),c=Math.max(c,2/d.max);E.hover_rotate(a,0,c*b)}}function w(a,b,c,d){S.move_local(a,5*b,5*c,5*d)}function h(a,b,c){var d=E.target_get_distance(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));S.move_local(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function m(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function B(a,b,c,d,e){e?(e=E.target_get_pivot(a,U),a=E.get_translation(a),a=D.dist(e,a)+d,d=0<b?m(b,-c,a,d):m(-b,c/(1-c),a,
d)):d-=2*b*c;return d}function k(a,b,c,d,g){function k(a,b,c,d){if(1==c){E.get_velocities(a,J);var e=V?.003*J.trans:.003*J.rot;c=C.get_sensor_value(a,b,0);C.get_sensor_payload(a,b,0).es===C.PL_SINGLE_TOUCH_MOVE?($a+="X"==d?-c*e:0,db+="Y"==d?-c*e:0):C.get_sensor_payload(a,b,0).es===C.PL_MULTITOUCH_MOVE_PAN&&(a=V?.003*J.rot:7.5E-4*J.trans,wb+="X"==d?-c*a:0,xb+="Y"==d?-c*a:0)}}function l(a){E.get_velocities(a,J);za-=.05*J.zoom}function m(a){E.get_velocities(a,J);Ma-=.002*J.trans}function n(a){E.get_velocities(a,
J);za+=.05*J.zoom}function q(a){E.get_velocities(a,J);Ma+=.002*J.trans}function t(a,b,c,d){if(1==c){c=C.get_sensor_value(a,b,1);E.get_velocities(a,J);if(V)e=.003*J.trans,f=7.5E-4*J.rot;else var e=.003*J.rot,f=7.5E-4*J.trans;if(1===C.get_sensor_payload(a,b,0).which)ya+="X"==d?-c*e:0,Xa+="Y"==d?-c*e:0;else if(2===C.get_sensor_payload(a,b,0).which||3===C.get_sensor_payload(a,b,0).which)Qa+="X"==d?-c*f:0,Bb+="Y"==d?-c*f:0}}function r(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function v(a){return a[0]&&(a[1]||
a[2]||.1<a[3])}function y(a){return a[0]&&(a[1]||-.1>a[2])}function x(a){return a[0]&&(a[1]||.1<a[2])}function F(a){return a[0]&&(a[1]||a[2]||a[3])}function H(a,b,c){if(1==c)switch(c=C.get_sensor_value(a,b,0),E.get_velocities(a,J),b){case "FORWARD":P?la[0]=1:V?(b=E.get_camera_angles(a,ha)[1],b=Math.abs(b)>=Math.PI/4?G.AXIS_Y:G.AXIS_MZ,e(a,b,.5*J.trans*c)):Q?h(a,-J.zoom,c):w(a,0,0,-J.trans*c);break;case "BACKWARD":P?la[0]=-1:V?(b=E.get_camera_angles(a,ha)[1],b=Math.abs(b)>=Math.PI/4?G.AXIS_MY:G.AXIS_Z,
e(a,b,.5*J.trans*c)):Q?h(a,J.zoom,c):w(a,0,0,J.trans*c);break;case "UP":V?u(a,30*-J.zoom*c):P||w(a,0,J.trans*c,0);break;case "DOWN":V?u(a,30*J.zoom*c):P||w(a,0,-J.trans*c,0);break;case "LEFT":P?la[1]=1:V?e(a,G.AXIS_MX,.5*J.trans*c):w(a,-J.trans*c,0,0);break;case "RIGHT":P?la[1]=-1:V?e(a,G.AXIS_X,.5*J.trans*c):w(a,J.trans*c,0,0);break;case "ROT_LEFT":Q?E.target_rotate(a,.75*-J.rot*c,0):E.eye_rotate(a,.75*J.rot*c,0);break;case "ROT_RIGHT":Q?E.target_rotate(a,.75*J.rot*c,0):E.eye_rotate(a,.75*-J.rot*
c,0);break;case "ROT_UP":Q?E.target_rotate(a,0,.75*-J.rot*c):E.eye_rotate(a,0,.75*J.rot*c);break;case "ROT_DOWN":Q?E.target_rotate(a,0,.75*J.rot*c):E.eye_rotate(a,0,.75*-J.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":P&&(la[0]=0);break;case "LEFT":case "RIGHT":P&&(la[1]=0)}P&&(p.set_character_move_dir(P,la[0],la[1]),a=E.get_camera_angles_char(a,Y),p.set_character_rotation(P,a[0],a[1]))}L=a;ba=b;pa=c;var I=Z.get_active_camera();f(I);var Q=!1,P=null,V=!1;switch(E.get_move_style(I)){case E.MS_TARGET_CONTROLS:Q=
!a;break;case E.MS_EYE_CONTROLS:P=Z.get_first_character();break;case E.MS_STATIC:return;case E.MS_HOVER_CONTROLS:V=!0}var J=E.get_velocities(I,M);a=C.create_elapsed_sensor();if(p.has_simulated_physics(I)){var aa=C.create_collision_sensor(I,null,!0);C.create_sensor_manifold(I,"CAMERA_COLLISION",C.CT_POSITIVE,[aa],null,function(a,b){var c=C.get_sensor_payload(a,b,0).bm;if(0>c){var d=C.get_sensor_payload(a,b,0).dh,e=U;D.scale(d,-.25*c,e);c=S.get_translation(a,ga);D.add(c,e,c);S.set_translation_v(a,c)}})}if(P){var aa=
S.get_translation(I),W=S.get_rotation(I),W=G.cam_quat_to_mesh_quat(W);aa[2]-=.5;p.set_transform(P,aa,W);A.append_stiff_trans(I,P,[0,0,.5]);var la=new Float32Array(2),N=!0;p.set_character_move_type(P,p.CM_FLY);C.create_kb_sensor_manifold(I,"TOGGLE_CHAR_MOVE_TYPE",C.CT_SHOT,C.KEY_C,function(){N=!N;p.set_character_move_type(P,N?p.CM_FLY:p.CM_WALK)})}var ma=z.check_enable_gamepad_indices(),aa=ma.length?ma[ma.length-1]:0,ca,ka,Ba,Ka,kb,Fa,Ra,La,fa,Ha;b?ca=ka=Ba=Ka=kb=Fa=b=aa=Ra=La=fa=Ha=C.create_custom_sensor(0):
(ca=C.create_keyboard_sensor(C.KEY_W),ka=C.create_keyboard_sensor(C.KEY_S),Ba=C.create_keyboard_sensor(C.KEY_A),Ka=C.create_keyboard_sensor(C.KEY_D),kb=C.create_keyboard_sensor(C.KEY_R),Fa=C.create_keyboard_sensor(C.KEY_F),b=C.create_gamepad_btn_sensor(z.GMPD_BUTTON_6,aa),aa=C.create_gamepad_btn_sensor(z.GMPD_BUTTON_7,aa),Ra=C.create_keyboard_sensor(C.KEY_UP),La=C.create_keyboard_sensor(C.KEY_DOWN),fa=C.create_keyboard_sensor(C.KEY_LEFT),Ha=C.create_keyboard_sensor(C.KEY_RIGHT));var W=C.create_gamepad_axis_sensor(z.GMPD_AXIS_0,
ma),ja=C.create_gamepad_axis_sensor(z.GMPD_AXIS_1,ma),R=C.create_gamepad_axis_sensor(z.GMPD_AXIS_2,ma),ma=C.create_gamepad_axis_sensor(z.GMPD_AXIS_3,ma);V||(C.create_sensor_manifold(I,"FORWARD",C.CT_CONTINUOUS,[a,ca,ja],y,H),C.create_sensor_manifold(I,"BACKWARD",C.CT_CONTINUOUS,[a,ka,ja],x,H));Q?(C.create_sensor_manifold(I,"ROT_UP",C.CT_CONTINUOUS,[a,Ra,kb,ma],r,H),C.create_sensor_manifold(I,"ROT_DOWN",C.CT_CONTINUOUS,[a,La,Fa,ma],v,H),C.create_sensor_manifold(I,"ROT_LEFT",C.CT_CONTINUOUS,[a,fa,Ba,
R],r,H),C.create_sensor_manifold(I,"ROT_RIGHT",C.CT_CONTINUOUS,[a,Ha,Ka,R],v,H)):V?(C.create_sensor_manifold(I,"LEFT",C.CT_CONTINUOUS,[a,fa,Ba,W],r,H),C.create_sensor_manifold(I,"RIGHT",C.CT_CONTINUOUS,[a,Ha,Ka,W],v,H),C.create_sensor_manifold(I,"FORWARD",C.CT_CONTINUOUS,[a,Ra,ca,ja],r,H),C.create_sensor_manifold(I,"BACKWARD",C.CT_CONTINUOUS,[a,La,ka,ja],v,H),C.create_sensor_manifold(I,"UP",C.CT_CONTINUOUS,[a,Fa,ma],x,H),C.create_sensor_manifold(I,"DOWN",C.CT_CONTINUOUS,[a,kb,ma],y,H)):(C.create_sensor_manifold(I,
"UP",C.CT_CONTINUOUS,[a,kb,b],F,H),C.create_sensor_manifold(I,"DOWN",C.CT_CONTINUOUS,[a,Fa,aa],F,H),C.create_sensor_manifold(I,"LEFT",C.CT_CONTINUOUS,[a,Ba,W],y,H),C.create_sensor_manifold(I,"RIGHT",C.CT_CONTINUOUS,[a,Ka,W],x,H),C.create_sensor_manifold(I,"ROT_UP",C.CT_CONTINUOUS,[a,Ra,ma],y,H),C.create_sensor_manifold(I,"ROT_DOWN",C.CT_CONTINUOUS,[a,La,ma],x,H),C.create_sensor_manifold(I,"ROT_LEFT",C.CT_CONTINUOUS,[a,fa,R],y,H),C.create_sensor_manifold(I,"ROT_RIGHT",C.CT_CONTINUOUS,[a,Ha,R],x,H));
if(!c){var Da=0;c=C.create_mouse_wheel_sensor(d);var ab=0,ma=C.create_touch_zoom_sensor(d);C.create_sensor_manifold(I,"MOUSE_WHEEL",C.CT_LEVEL,[c],null,function(a,b,c){1==c&&(b=C.get_sensor_value(a,b,0),E.get_velocities(a,J),Q||V?Da=B(a,b,J.zoom,Da,Q):(J.trans*=1+b*J.zoom,E.set_velocities(a,J)))});C.create_sensor_manifold(I,"TOUCH_ZOOM",C.CT_LEVEL,[ma],null,function(a,b,c){1==c&&(c=C.get_sensor_value(a,b,0),E.get_velocities(a,J),C.get_sensor_payload(a,b,0)===C.PL_MULTITOUCH_MOVE_ZOOM&&(ab=B(a,c,.03*
J.zoom,ab,Q)))});C.create_sensor_manifold(I,"ZOOM_INTERPOL",C.CT_POSITIVE,[a],null,function(a,b){if(Q||V)if(1E-5<Math.abs(Da)||1E-5<Math.abs(ab)){var c=C.get_sensor_value(a,b,0),d=G.smooth(Da,0,c,.1*X);Da-=d;c=G.smooth(ab,0,c,.15*X);ab-=c;V?u(a,-(d+c)):(d=E.target_get_distance(a)+d+c,d=Math.max(d,.001),E.target_set_distance(a,d))}else ab=Da=0})}var ya=0,Xa=0,Qa=0,Bb=0,Ma=0,za=0;Q?(C.create_sensor_manifold(I,"GMPD_PAN_Y_POS",C.CT_CONTINUOUS,[b],null,n),C.create_sensor_manifold(I,"GMPD_PAN_Y_NEG",C.CT_CONTINUOUS,
[aa],null,l),C.create_sensor_manifold(I,"GMPD_PAN_X_POS",C.CT_CONTINUOUS,[W],function(a){return-.1>a[0]},m),C.create_sensor_manifold(I,"GMPD_PAN_X_NEG",C.CT_CONTINUOUS,[W],function(a){return.1<a[0]},q)):V&&(C.create_sensor_manifold(I,"GMPD_PAN_X_POS",C.CT_CONTINUOUS,[R],function(a){return-.1>a[0]},m),C.create_sensor_manifold(I,"GMPD_PAN_X_NEG",C.CT_CONTINUOUS,[R],function(a){return.1<a[0]},q));if(g){g=C.create_mouse_move_sensor("X",window);c=C.create_mouse_move_sensor("Y",window);b=C.create_mouse_click_sensor(d);
var aa=C.create_mouse_click_sensor(window),Oa=!1,W=function(a){a[2]?Oa=!0:a[0]||(Oa=!1);return Oa&&a[0]};C.create_sensor_manifold(I,"MOUSE_X",C.CT_POSITIVE,[aa,g,b],W,t,"X");C.create_sensor_manifold(I,"MOUSE_Y",C.CT_POSITIVE,[aa,c,b],W,t,"Y");g=z.get_device_by_type_element(z.DEVICE_MOUSE,window);z.switch_prevent_default(g,!1)}else g=C.create_mouse_move_sensor("X",d),c=C.create_mouse_move_sensor("Y",d),b=C.create_mouse_click_sensor(d),C.create_sensor_manifold(I,"MOUSE_X",C.CT_POSITIVE,[b,g],null,t,
"X"),C.create_sensor_manifold(I,"MOUSE_Y",C.CT_POSITIVE,[b,c],null,t,"Y");var $a=0,db=0,wb=0,xb=0;g=C.create_touch_move_sensor("X",d);d=C.create_touch_move_sensor("Y",d);C.create_sensor_manifold(I,"TOUCH_X",C.CT_POSITIVE,[g],null,k,"X");C.create_sensor_manifold(I,"TOUCH_Y",C.CT_POSITIVE,[d],null,k,"Y");C.create_sensor_manifold(I,"ROT_TRANS_INTERPOL",C.CT_POSITIVE,[a],null,function(a,b){if(1E-5<Math.abs(ya)||1E-5<Math.abs(Xa)||1E-5<Math.abs($a)||1E-5<Math.abs(db)||1E-5<Math.abs(Qa)||1E-5<Math.abs(Bb)||
1E-5<Math.abs(wb)||1E-5<Math.abs(xb)||1E-5<Math.abs(Ma)||1E-5<Math.abs(za)){var c=C.get_sensor_value(a,b,0),d=G.smooth(ya,0,c,.08*X),f=G.smooth(Xa,0,c,.08*X);ya-=d;Xa-=f;var g=G.smooth($a,0,c,.12*X),h=G.smooth(db,0,c,.12*X);$a-=g;db-=h;var k=G.smooth(Qa,0,c,.08*X),l=G.smooth(Bb,0,c,.08*X);Qa-=k;Bb-=l;var m=G.smooth(wb,0,c,.12*X),n=G.smooth(xb,0,c,.12*X);wb-=m;xb-=n;var q=G.smooth(Ma,0,c,.08*X),c=G.smooth(za,0,c,.08*X);Ma-=q;za-=c;Q?(E.target_rotate(a,d+g,f+h),f=E.target_get_distance(a),E.target_pan_pivot(a,
f*(k+m+q),f*(l+n+c))):V?(d+g&&e(a,G.AXIS_X,.2*(d+g)),f+h&&(l=E.get_camera_angles(a,ha)[1],e(a,Math.abs(l)>Math.PI/4?G.AXIS_MY:G.AXIS_Z,.2*(f+h))),E.hover_rotate(a,k+m+q,0)):(E.eye_rotate(a,.5*(d+g),.5*(f+h)),P&&(k=E.get_camera_angles_char(a,Y),p.set_character_rotation(P,k[0],k[1])))}});C.create_kb_sensor_manifold(I,"DEC_STEREO_DIST",C.CT_SHOT,C.KEY_LEFT_SQ_BRACKET,function(a){var b=E.get_stereo_distance(a);E.set_stereo_distance(a,.9*b)});C.create_kb_sensor_manifold(I,"INC_STEREO_DIST",C.CT_SHOT,C.KEY_RIGHT_SQ_BRACKET,
function(a){var b=E.get_stereo_distance(a);E.set_stereo_distance(a,1.1*b)})}function f(a){var b=E.get_move_style(a),c=C.create_callback_sensor(function(){var c=E.get_move_style(a),d=c!=b;b=c;return d});C.create_sensor_manifold(a,"CHANGE_MOVE_STYLE",C.CT_POSITIVE,[c],null,function(){F();k(L,ba,pa)})}function F(){var a=Z.get_active_camera();C.check_sensor_manifold(a,"TOGGLE_CHAR_MOVE_TYPE")&&Z.get_first_character()&&A.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
c=0;c<b.length;c++)C.remove_sensor_manifold(a,b[c])}function t(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=
b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function q(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&H.remove_loop_cb(f)}var g=performance.now();H.append_loop_cb(f)}var E=r("camera"),J=r("config"),A=r("constraints"),I=r("container"),C=r("controls"),v=r("data"),l=r("debug"),z=r("input"),H=r("main"),p=r("physics"),Q=r("print"),y=r("screen"),
Z=r("scenes"),S=r("transform"),G=r("util"),D=r("vec3"),X=1,V=null,L=!1,ba=!1,pa=!1,Y=new Float32Array(2),ha=new Float32Array(2),U=new Float32Array(3),ga=new Float32Array(3),ca=new Float32Array(4),M={},la={};a.init=function(a){function e(){var a=b(m,F,D,p),e=I.get_canvas();if(a){var f=I.get_container();I.resize_to_container();z&&(g(q,r),H.set_fps_callback(n));y&&(d(),c());t&&H.append_loop_cb(function(){f.style.height=f.clientWidth/t+"px"});k&&H.append_loop_cb(function(){I.resize_to_container()});B&&
H.append_loop_cb(function(){I.force_offsets_updating()});w&&J.reset_limits();E==J.P_AUTO?l.test_performance(function(a,b){0==a?(Q.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),J.apply_quality(J.P_HIGH)):1.5>b?(Q.log("QUALITY TEST RESULT: LOW ("+b.toFixed(1)+" GB/s)"),J.apply_quality(J.P_LOW)):(Q.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),J.apply_quality(J.P_HIGH));h(e,!0)}):h(e,!0)}else h(e,!1)}function f(a){a.keyCode==C.KEY_P&&(H.is_paused()?H.resume():H.pause())}function h(){}
a=a||{};var k=!1,m=null,p=null,q=null,t=0,r=null,u=!0,w=!1,y=!0,D=!0,x=!1,z=!1,A=!1,B=!1,E=J.get("quality"),G;for(G in a)switch(G){case "canvas_container_id":m=a.canvas_container_id;break;case "callback":h=a.callback;break;case "autoresize":k=a.autoresize;break;case "show_hud_debug_info":A=a.show_hud_debug_info;break;case "sfx_mix_mode":x=a.sfx_mix_mode;break;case "show_fps":z=a.show_fps;break;case "track_container_position":B=a.track_container_position;Q.ja("track_container_position deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");
break;case "fps_wrapper_id":r=a.fps_wrapper_id;break;case "fps_elem_id":q=a.fps_elem_id;break;case "error_purge_elements":p=a.error_purge_elements;break;case "report_init_failure":D=a.report_init_failure;break;case "pause_invisible":y=a.pause_invisible;break;case "key_pause_enabled":u=a.key_pause_enabled;break;case "force_container_ratio":t=a.force_container_ratio;break;case "min_capabilities":w=a.min_capabilities;break;case "quality":E=a.quality;break;default:J.set(G,a[G])}E!=J.P_AUTO&&J.set("quality",
E);u&&document.addEventListener("keydown",f,!1);J.set("show_hud_debug_info",A);J.set("sfx_mix_mode",x);var F=A||x||null;"complete"==document.readyState?window.setTimeout(e,0):window.addEventListener("load",e,!1);window.addEventListener("unload",function(){v.cleanup()},!1)};a.set_onclick=function(a,b){var c=x(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=function(a,b){var c=x(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=
function(a,b){var c=x(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=k;a.disable_camera_controls=F;a.enable_object_controls=function(a){function b(a){return a[0]&&(a[1]||a[2])}function c(a,b,c){if(1==c)switch(c=C.get_sensor_value(a,b,0),b){case "FORWARD":d?p.vehicle_throttle(a,1):S.move_local(a,0,-1*c,0);break;case "BACKWARD":d?p.vehicle_throttle(a,-1):S.move_local(a,0,1*c,0);break;case "LEFT":d?p.vehicle_steer(a,-1):S.move_local(a,1*c,0,0);break;
case "RIGHT":d?p.vehicle_steer(a,1):S.move_local(a,-1*c,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&p.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&p.vehicle_steer(a,0)}}var d=p.is_vehicle_chassis(a)||p.is_vehicle_hull(a),e=C.create_elapsed_sensor(),f=C.create_keyboard_sensor(C.KEY_W),g=C.create_keyboard_sensor(C.KEY_S),h=C.create_keyboard_sensor(C.KEY_A),k=C.create_keyboard_sensor(C.KEY_D),l=C.create_keyboard_sensor(C.KEY_UP),m=C.create_keyboard_sensor(C.KEY_DOWN),n=C.create_keyboard_sensor(C.KEY_LEFT),
q=C.create_keyboard_sensor(C.KEY_RIGHT);C.create_sensor_manifold(a,"FORWARD",C.CT_CONTINUOUS,[e,f,l],b,c);C.create_sensor_manifold(a,"BACKWARD",C.CT_CONTINUOUS,[e,g,m],b,c);C.create_sensor_manifold(a,"LEFT",C.CT_CONTINUOUS,[e,h,n],b,c);C.create_sensor_manifold(a,"RIGHT",C.CT_CONTINUOUS,[e,k,q],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)C.remove_sensor_manifold(a,b[c])};a.enable_debug_controls=function(){C.create_kb_sensor_manifold(null,
"CAMERA_SHOT",C.CT_SHOT,C.KEY_K,function(){l.make_camera_frustum_shot()});C.create_kb_sensor_manifold(null,"LIGHT_SHOT",C.CT_SHOT,C.KEY_L,function(){l.make_light_frustum_shot()});C.create_kb_sensor_manifold(null,"TELEMETRY",C.CT_SHOT,C.KEY_T,function(){l.plot_telemetry()})};a.request_fullscreen=function(a,b,c){Q.Ze("request_fullscreen","screen.request_fullscreen");y.request_fullscreen(a,b,c)};a.exit_fullscreen=function(){Q.Ze("exit_fullscreen","screen.exit_fullscreen");y.exit_fullscreen()};a.check_fullscreen=
function(){Q.Ze("check_fullscreen","screen.check_fullscreen");return y.check_fullscreen()};a.report_app_error=t;a.get_url_params=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,b,c,d,e,f,g,h){if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=
f||"";g=g||"";h=h||function(){};var k=a.style,l=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==k[b])if(void 0!=k["webkit"+l])b="webkit"+l;else if(void 0!=k["ms"+l])b="ms"+l;else if(void 0!=k["moz"+l])b="moz"+l;else return;q(a,c,d,e,function(e){a&&(k[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(k[b]=f+d+g,h())})}};a.attr_animate=function(a,b,c,d,e,f){a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},q(a,c,d,e,function(e){a&&(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),
f())}))};a.queue_animate=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.queue_animate(b)};"css"==c.type?a.css_animate(d,e,f,g,h,k,l,m):"attr"==c.type&&a.attr_animate(d,e,f,g,h,m)}};a.set_camera_smooth_factor=function(a){X=a};a.get_camera_smooth_factor=function(){return X}};b4w.module.camera_anim=function(a,r){function d(a,b,d,e,f){d=w.angle_wrap_0_2pi(b-d);d=Math.min(d,2*Math.PI-d);b=w.angle_wrap_0_2pi(e-b);b=Math.min(b,2*Math.PI-b);if(1E-6>Math.abs(d)||1E-6>2*Math.PI-Math.abs(d))d=0;if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;c.is_eye_camera(a)?(f[0]=b,f[1]=d):(f[0]=d,f[1]=b);return f}var c=r("camera"),b=r("controls"),g=r("print"),n=r("scenes"),x=r("time"),e=r("transform"),u=r("tsr"),w=r("util"),h=r("vec3"),m=new Float32Array(2),B=new Float32Array(2),k=new Float32Array(3),
f=new Float32Array(3),F=new Float32Array(3),t=u.create(),q=u.create(),E=u.create(),J={},A=!1,I=!1,C=!1,v=!1;a.track_to_target=function(a,d,n,p,q,t,r,v){if(c.is_eye_camera(a)){if(w.is_vector(d))var l=d;else l=k,e.get_object_center(d,!1,l);n=n||1;p=p||2;q=q||1;t=t||1;var u=e.get_translation(a,f);d=h.subtract(l,u,F);var l=c.get_camera_angles(a,m),y=c.get_camera_angles_dir(d,B),z=y[0]-l[0],A=y[1]-l[1],C=Math.abs(Math.acos(Math.cos(z)*Math.cos(A))/n),E=h.length(d)*(1-1/p),H=function(a){return 6*a*(1-a)},
I=x.get_timeline(),Q=0,J=function(){b.remove_sensor_manifold(a,"TRACK_TO_TARGET");r&&r()};n=b.create_timeline_sensor();p=b.create_elapsed_sensor();b.create_sensor_manifold(a,"TRACK_TO_TARGET",b.CT_CONTINUOUS,[n,p],null,function(d,f,g){c.is_eye_camera(d)?1==g&&(g=b.get_sensor_value(d,f,0)-I,f=b.get_sensor_value(d,f,1),g<C?(g=H(g/C),c.eye_rotate(a,g*z*f/C,g*A*f/C)):g<C+q?(Q||(c.eye_rotate(a,y[0],y[1],!0,!0),Q++),g=H(g-C/q),f=g*E*f/q,e.move_local(d,0,0,-f)):g<C+q+t?1>=Q&&(c.eye_rotate(a,y[0],y[1],!0,
!0),c.eye_set_look_at(a,u),e.move_local(d,0,0,-E),v&&v(),Q++):g<C+q+t+q?(2>=Q&&(c.eye_rotate(a,y[0],y[1],!0,!0),c.eye_set_look_at(a,u),e.move_local(d,0,0,-E),Q++),g=H(g-C-q-t/q),f=g*E*f/q,e.move_local(d,0,0,f)):(c.eye_rotate(a,y[0],y[1],!0,!0),c.eye_set_look_at(a,u),J())):J()})}else g.error("track_to_target(): Wrong camera object or camera move style")};a.auto_rotate=function(a,e,f){function h(e,f,g){if(1==g)if(g=c.get_move_style(e),g==c.MS_STATIC)k();else if(g!=c.MS_TARGET_CONTROLS&&g!=c.MS_EYE_CONTROLS||
!c.has_horizontal_rot_limits(e))q=null,f=b.get_sensor_value(e,f,0),c.rotate_camera(e,f*a,0);else{g=g==c.MS_EYE_CONTROLS?c.eye_get_horizontal_limits(e,J):c.target_get_horizontal_limits(e,J);if(null===q||g.left!=q.left||g.right!=q.right){q=q||{};q.left=g.left;q.right=g.right;t=Math.min(.2,w.angle_wrap_0_2pi(q.right-q.left)/2);g=l;var h=q,n=c.get_camera_angles(g,m)[0];g=d(g,n,h.left,h.right,B);r=a*Math.min(1,g[0]/.2,g[1]/.2)}f=b.get_sensor_value(e,f,0);g=c.get_camera_angles(e,m)[0];g=d(e,g,q.left,q.right,
B);g[1]>t&&g[0]>t?r=w.sign(r)*a:g[1]<t?r-=Math.pow(a,2)/.4*f:g[0]<t&&(r+=Math.pow(a,2)/.4*f);c.rotate_camera(e,f*r,0)}}function k(){b.remove_sensor_manifold(l,"AUTO_ROTATE");b.remove_sensor_manifold(l,"DISABLE_AUTO_ROTATE");e()}e=e||function(){};var l=n.get_active_camera();if(c.is_static_camera(l))g.error("auto_rotate(): Wrong camera move style");else{var q={},t=0,r=0;if(b.check_sensor_manifold(l,"AUTO_ROTATE"))k();else{var v=b.create_mouse_move_sensor("X"),u=b.create_mouse_move_sensor("Y"),x=b.create_mouse_click_sensor(),
z=b.create_touch_move_sensor(),A=b.create_touch_zoom_sensor(),C=b.create_elapsed_sensor();f=f?b.create_mouse_wheel_sensor():b.create_custom_sensor(0);b.create_sensor_manifold(l,"DISABLE_AUTO_ROTATE",b.CT_LEVEL,[v,u,x,z,A,f],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},k);b.create_sensor_manifold(l,"AUTO_ROTATE",b.CT_CONTINUOUS,[C],function(a){return a[0]},h)}}};a.is_auto_rotate=function(){var a=n.get_active_camera();return b.check_sensor_manifold(a,"AUTO_ROTATE")};a.check_auto_rotate=
function(){var a=n.get_active_camera();return c.get_move_style(a)==c.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,b,d,m,n){if(c.get_move_style(a)!=c.MS_STATIC)g.error("move_camera_to_point(): wrong camera type");else if(!A)if(a)if(b){d=d||1;m=m||.01;var l=w.is_vector(a)?a:e.get_tsr(a,t),p=w.is_vector(b)?b:e.get_tsr(b,q);b=h.distance(u.get_trans_view(l),u.get_trans_view(p))/d;d=w.quat_to_dir(u.get_quat_view(l),w.AXIS_MZ,k);var r=w.quat_to_dir(u.get_quat_view(p),w.AXIS_MZ,f);d=Math.min(Math.abs(h.dot(d,
r)),1);m=1E3*Math.max(b,Math.acos(d)/m);A=!0;var v=x.animate(0,1,m,function(b){var c=u.interpolate(l,p,w.smooth_step(b),E);C?(x.clear_animation(v),A=C=!1):(e.set_tsr(a,c),1==b&&(A=!1,n&&n()))})}else g.error("move_camera_to_point(): you must specify the point object");else g.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,b,d,e,f){if(c.get_move_style(a)==c.MS_STATIC)g.error("rotate_camera(): not supported for STATIC cameras");else if(!I)if(a)if(b||d){I=
!0;var h=0,k=0,l=b?b:d,m=x.animate(0,l,e||1E3,function(e){v?(x.clear_animation(m),I=v=!1):(h-=e,k-=e,d&&b?c.rotate_camera(a,h,k):d?c.rotate_camera(a,0,k):b&&c.rotate_camera(a,h,0),k=h=e,e==l&&(I=!1,f&&f()))})}else g.error("rotate_camera(): you must specify the rotation angle");else g.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){C=!0};a.stop_cam_rotating=function(){v=!0};a.is_moving=function(){return A};a.is_rotating=function(){return I}};b4w.module.gp_conf=function(a,r){function d(){p.length=0;for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)a[b]&&p.push(a[b]);return p}function c(a){var b=f.get(a+"_gmpd_stngs","b4w");if(b){var b=JSON.parse(b),c;for(c in b)k.set_gamepad_key(a,c,b[c])}else c=JSON.stringify(t),f.set(a+"_gmpd_stngs",c,"b4w")}function b(a){S=!0;var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),
e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),n=document.createElement("div"),p=document.createElement("div"),t=document.createElement("div"),r=document.createElement("div"),v=document.createElement("div"),w=document.createElement("div"),D=document.createElement("div"),x=document.createElement("div"),z=document.createElement("div"),A=document.createElement("div"),
B=document.createElement("div"),E=document.createElement("div"),G=document.createElement("div");C=b;b.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+
"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;";c.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+
"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;";d.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;";e.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;";f.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;";g.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;";h.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;";l.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;";m.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;";n.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;";p.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;top: 51px;position: absolute;";t.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;";r.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;";v.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;";w.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;";D.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>')+
"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;";x.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;";z.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;";A.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;";B.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>')+
"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;";E.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;";G.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;";b.appendChild(E);b.appendChild(G);c.appendChild(d);c.appendChild(e);c.appendChild(f);c.appendChild(g);b.appendChild(c);h.appendChild(l);h.appendChild(m);h.appendChild(n);h.appendChild(p);b.appendChild(h);b.appendChild(t);b.appendChild(r);b.appendChild(v);b.appendChild(w);b.appendChild(D);b.appendChild(x);b.appendChild(z);a.appendChild(b);b.appendChild(A);b.appendChild(B);Q.length=0;q.length=0;y.length=0;Z.length=0;Q.push(n,
m,p,l,D,x,A,z,v,w,t,r,d,f,g,e,B);q.push('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',
'<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>');
y.push(t,t,r,r);Z.push(E,G);for(a=0;a<Q.length;a++)Q[a].setAttribute("id","pad_btn_"+a),Q[a].setAttribute("data-colorstate","B"),Q[a].setAttribute("data-key",a),Q[a].setAttribute("data-svgid",a);E.setAttribute("id","pad_left_axis");E.setAttribute("data-colorstate","GR");E.setAttribute("data-key",k.GMPD_AXIS_0);E.setAttribute("data-svgid",q.length);G.setAttribute("id","pad_right_axis");G.setAttribute("data-colorstate","GR");G.setAttribute("data-key",k.GMPD_AXIS_2);G.setAttribute("data-svgid",q.length+
1);q.push('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',
'<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>');
u(Q,F);u(Z,"#e6e6e6")}function g(a){return[B.create_gamepad_btn_sensor(k.GMPD_BUTTON_0,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_1,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_2,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_3,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_4,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_5,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_6,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_7,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_8,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_9,
a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_10,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_11,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_12,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_13,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_14,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_15,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_16,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_17,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_18,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_19,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_20,
a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_21,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_22,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_23,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_24,a),B.create_gamepad_btn_sensor(k.GMPD_BUTTON_25,a)]}function n(a){return[B.create_gamepad_axis_sensor(k.GMPD_AXIS_0,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_1,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_2,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_3,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_4,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_5,
a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_6,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_7,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_8,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_9,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_10,a),B.create_gamepad_axis_sensor(k.GMPD_AXIS_11,a)]}function x(a,b){var c=document.createElement("input");c.style.cssText="display: inline-block;position = relative;";c.setAttribute("type","radio");c.setAttribute("name","choice");var d=document.createElement("label");d.textContent=
b;d.style.cssText="position = relative;display: inline-block;color: white;";a.appendChild(c);a.appendChild(d);return c}function e(a){I.removeChild(C);C=null;switch(a){case "PAD":z.checked=!0;b(I);break;case "WHEEL":l.checked=!0;var c=I;S=!1;var d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),m=document.createElement("div"),n=document.createElement("div"),p=document.createElement("div"),
t=document.createElement("div"),r=document.createElement("div"),v=document.createElement("div"),w=document.createElement("div"),x=document.createElement("div"),D=document.createElement("div"),A=document.createElement("div"),B=document.createElement("div"),E=document.createElement("div"),G=document.createElement("div"),H=document.createElement("div"),J=document.createElement("div"),ta=document.createElement("div"),ea=document.createElement("div"),ra=document.createElement("div"),O=document.createElement("div");
a=document.createElement("div");var Ia=document.createElement("div"),xa=document.createElement("div"),oa=document.createElement("div"),K=document.createElement("div"),ia=document.createElement("div");C=d;var na="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>')+
"');width: 19px;height: 19px;background-size: 100% 100%;";d.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+
"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;";e.style.cssText=na+"top: 132px;left: 331px;";f.style.cssText=na+"top: 122px;left: 315px;";g.style.cssText=na+"top: 122px;left: 347px;";h.style.cssText=na+"top: 113px;left: 331px;";m.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+
btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;";n.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;";p.style.cssText=na+"top: 107px;left: 141px;";t.style.cssText=na+"top: 107px;left: 90px;";r.style.cssText=na+"top: 185px;left: 321px;";v.style.cssText=na+"top: 185px;left: 340px;";w.style.cssText=na+"top: 179px;left: 358px;";x.style.cssText=na+"top: 178px;left: 303px;";D.style.cssText=na+"top: 210px;left: 299px;";A.style.cssText=na+"top: 279px;left: 299px;";B.style.cssText=na+"top: 210px;left: 321px;";E.style.cssText=na+
"top: 279px;left: 321px;";G.style.cssText=na+"top: 210px;left: 344px;";H.style.cssText=na+"top: 278px;left: 344px;";J.style.cssText=na+"top: 124px;left: 147px;";ta.style.cssText=na+"top: 138px;left: 133px;";ea.style.cssText=na+"top: 124px;left: 82px;";ra.style.cssText=na+"top: 138px;left: 96px;";O.style.cssText=na+"top: 278px;left: 367px;";na="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>')+
"');width: 19px;height: 46px;background-size: 100% 100%;";a.style.cssText=na+"top: 291px;left: 50px;";Ia.style.cssText=na+"top: 291px;left: 111px;";xa.style.cssText=na+"top: 291px;left: 171px;";oa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>')+
"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;";K.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>')+
"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;";ia.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>')+
"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;";c.appendChild(d);d.appendChild(a);d.appendChild(Ia);d.appendChild(xa);d.appendChild(oa);d.appendChild(K);d.appendChild(ia);d.appendChild(e);d.appendChild(f);d.appendChild(g);d.appendChild(h);d.appendChild(m);d.appendChild(n);d.appendChild(p);d.appendChild(t);d.appendChild(r);d.appendChild(v);d.appendChild(w);d.appendChild(x);d.appendChild(D);d.appendChild(A);d.appendChild(B);d.appendChild(E);d.appendChild(G);d.appendChild(H);
d.appendChild(J);d.appendChild(ta);d.appendChild(ea);d.appendChild(ra);d.appendChild(O);Q.length=0;q.length=0;y.length=0;Z.length=0;Q.push(e,f,g,h,m,n,p,t,r,v,w,x,D,A,B,E,G,H,J,ta,ea,ra,O);q.push('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>');
Z.push(oa,a,xa,Ia,K,ia);for(c=0;c<Q.length;c++)Q[c].setAttribute("id","wheel_btn_"+c),Q[c].setAttribute("data-colorstate","B"),Q[c].setAttribute("data-key",c),Q[c].setAttribute("data-svgid",c);for(c=0;c<Z.length;c++)Q[c].setAttribute("id","wheel_axis_"+c),Q[c].setAttribute("data-colorstate","GR");oa.setAttribute("data-key",k.GMPD_AXIS_0);oa.setAttribute("data-svgid",q.length);a.setAttribute("data-key",k.GMPD_AXIS_1);a.setAttribute("data-svgid",q.length+1);xa.setAttribute("data-key",k.GMPD_AXIS_2);
xa.setAttribute("data-svgid",q.length+2);Ia.setAttribute("data-key",k.GMPD_AXIS_3);Ia.setAttribute("data-svgid",q.length+3);K.setAttribute("data-key",k.GMPD_AXIS_4);K.setAttribute("data-svgid",q.length+4);ia.setAttribute("data-key",k.GMPD_AXIS_5);ia.setAttribute("data-svgid",q.length+5);q.push('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>');
u(Q,F);u(Z,"#e6e6e6")}}function u(a,b){function c(a){a=a.target;if(!(0>E||"G"==a.getAttribute("data-colorstate")))if(A){if("R"==a.getAttribute("data-colorstate")&&(J=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",A=0),"B"==a.getAttribute("data-colorstate")||"GR"==a.getAttribute("data-colorstate")){var c=parseFloat(J.getAttribute("data-svgid"));J.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(q[c])+"')";J.setAttribute("data-colorstate",
a.getAttribute("data-colorstate"));J=a;c=parseFloat(a.getAttribute("data-svgid"));a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(q[c].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R")}}else{var c=parseFloat(a.getAttribute("data-svgid")),d="B"==a.getAttribute("data-colorstate")?1:2;A=d;a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(q[c].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R");document.getElementById("action_label").textContent=
1==d?"Now press the button on the device":"Now move the axis on the device";J=a}}for(var d=0;d<a.length;d++)k.add_click_listener(a[d],c)}function w(a){var b=document.createElement("label");b.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;";b.textContent=a;return b}function h(){var a=window.innerWidth,b=window.innerHeight;I.style.zoom=750>=
b&&400<b||750>=a&&400<a?"0.5":400>=a||400>=b?"0.3":"1"}var m=r("container"),B=r("controls"),k=r("input"),f=r("storage"),F=RegExp("#5276cf","g"),t={};t[k.GMPD_BUTTON_12]=k.GMPD_BUTTON_12;t[k.GMPD_BUTTON_13]=k.GMPD_BUTTON_13;t[k.GMPD_BUTTON_15]=k.GMPD_BUTTON_15;t[k.GMPD_BUTTON_14]=k.GMPD_BUTTON_14;t[k.GMPD_BUTTON_3]=k.GMPD_BUTTON_3;t[k.GMPD_BUTTON_0]=k.GMPD_BUTTON_0;t[k.GMPD_BUTTON_1]=k.GMPD_BUTTON_1;t[k.GMPD_BUTTON_2]=k.GMPD_BUTTON_2;t[k.GMPD_BUTTON_5]=k.GMPD_BUTTON_5;t[k.GMPD_BUTTON_7]=k.GMPD_BUTTON_7;
t[k.GMPD_BUTTON_4]=k.GMPD_BUTTON_4;t[k.GMPD_BUTTON_6]=k.GMPD_BUTTON_6;t[k.GMPD_BUTTON_8]=k.GMPD_BUTTON_8;t[k.GMPD_BUTTON_9]=k.GMPD_BUTTON_9;t[k.GMPD_BUTTON_10]=k.GMPD_BUTTON_10;t[k.GMPD_BUTTON_11]=k.GMPD_BUTTON_11;t[k.GMPD_BUTTON_16]=k.GMPD_BUTTON_16;var q=[],E=-1,J=null,A=0,I=null,C=null,v=null,l=null,z=null,H=null,p=[],Q=[],y=[],Z=[],S=!0,G={};G[k.GMPD_AXIS_0]=-2;G[k.GMPD_AXIS_1]=-2;G[k.GMPD_AXIS_2]=-2;G[k.GMPD_AXIS_3]=-2;G[k.GMPD_AXIS_4]=-2;G[k.GMPD_AXIS_5]=-2;G[k.GMPD_AXIS_6]=-2;G[k.GMPD_AXIS_7]=
-2;G[k.GMPD_AXIS_8]=-2;G[k.GMPD_AXIS_9]=-2;G[k.GMPD_AXIS_10]=-2;G[k.GMPD_AXIS_11]=-2;a.show=function(){var a=document.createElement("div");I=a;a.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);";
m.insert_to_container(a,"LAST");b(a);var p=document.createElement("div");p.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var t=document.createElement("div");t.innerHTML="Select a device";t.style.cssText="color: #fff;display: inline-block;";p.appendChild(t);for(t=0;4>t;t++){var r=g(t),u=function(){return!0},
C=function(a,b){if(b==E)for(var c=0;c<Q.length;c++){var d=Q[c],e=B.get_sensor_value(a,b,c),g=c;if(A)e=k.get_pressed_gmpd_btn(E),0<=e&&J&&1==A&&(d=J.getAttribute("data-key"),k.set_gamepad_key(E,d,e),g=f.get(E+"_gmpd_stngs","b4w")||"{}",g=JSON.parse(g),g[d]=e,f.set(E+"_gmpd_stngs",JSON.stringify(g),"b4w"),J=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",A=0);else{if(e&&"B"==d.getAttribute("data-colorstate")){var h=q[g];d.style.backgroundImage=
"url('data:image/svg+xml;base64,"+btoa(h.replace(F,"#00ff00"))+"')";d.setAttribute("data-colorstate","G")}e||"B"==d.getAttribute("data-colorstate")||(h=q[g],d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(h)+"')",d.setAttribute("data-colorstate","B"))}}};B.create_sensor_manifold(null,t,B.CT_CONTINUOUS,r,u,C)}0<d().length&&(E=0);var Y=[],t=document.createElement("div");t.style.cssText="margin-top: 20px;";for(r=0;4>r;r++)C=w(r),r==E&&(C.style.backgroundColor="green",v=C),c(r),t.appendChild(C),
C.setAttribute("data-device_type","PAD"),Y.push(C),k.add_click_listener(C,function(a){var b=d();a=a.target;for(var f=0;f<b.length;f++)Y[f]==a&&(E=f,v=a,c(E),e(a.getAttribute("data-device_type")))});p.appendChild(t);H=document.createElement("label");H.style.cssText="position: relative;display: block;color: white;";p.appendChild(H);t=document.createElement("div");t.style.cssText="margin-top: 20px;";r=x(t,"Pad");C=x(t,"Wheel");r.setAttribute("checked","true");r.onchange=function(){e("PAD");v&&v.setAttribute("data-device_type",
"PAD")};C.onchange=function(){e("WHEEL");v&&v.setAttribute("data-device_type","WHEEL")};r.setAttribute("id","test");z=r;l=C;r=document.createElement("label");r.style.cssText+="color: #fff;display: block;";t.appendChild(r);r.textContent="Click on the buttons & arrows to setup your controller";r.setAttribute("id","action_label");p.appendChild(t);a.appendChild(p);a=B.create_elapsed_sensor();B.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",B.CT_CONTINUOUS,[a],u,function(){var a=d(),b=a.length;-1==
E&&a.length&&(E=a[0].index,v=Y[E]);for(var c=0;c<Y.length;c++)c<b?(Y[c].textContent=a[c].index,Y[c]==v?(Y[c].style.backgroundColor="green",H.textContent="Selected device: "+a[c].index+". Data: "+a[c].id):Y[c].style.backgroundColor="blue"):Y[c].style.backgroundColor="black";b||(E=-1,H.textContent="")});for(t=0;4>t;t++)r=n(t),C=function(a,b){if(b=="AXES"+E){for(var c=0;c<y.length;c+=2){var d=y[c],e=a,f=b,g=c,h=20*B.get_sensor_value(e,f,g),e=20*B.get_sensor_value(e,f,g+1);d.style.transform="translate3d("+
h+"px, "+e+"px, 0px) rotate(0rad)"}if(S)for(c=0;12>c;c+=2){if(e=a,f=b,d=c,!(d+1>2*Z.length)){h=B.get_sensor_value(e,f,d);e=B.get_sensor_value(e,f,d+1);if(-2<G[d]){var l=h-G[d],m=e-G[d+1],f=Z[Math.floor(d/2)],g=f.getAttribute("data-svgid");A?2==A&&(l=k.get_moved_gmpd_axis(E),0<=l&&(l%2&&l--,A=0,f.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(q[g])+"')",f=parseFloat(J.getAttribute("data-key")),k.set_gamepad_key(E,f,l),k.set_gamepad_key(E,f+1,l+1),J=null,document.getElementById("action_label").textContent=
"Click on the buttons & arrows to setup your controller")):f.style.backgroundImage=l||m?"url('data:image/svg+xml;base64,"+btoa(q[g].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(q[g])+"')"}G[d]=h;G[d+1]=e}}else for(c=0;12>c;c++)(d=c,d>=Z.length)||(h=B.get_sensor_value(a,b,d),-2<G[d]&&((g=h-G[d],e=Z[d],f=e.getAttribute("data-svgid"),A)?2==A&&(g=k.get_moved_gmpd_axis(E),0<=g&&(A=0,e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(q[f])+"')",e=parseFloat(J.getAttribute("data-key")),
k.set_gamepad_key(E,e,g),J=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller")):e.style.backgroundImage=g?"url('data:image/svg+xml;base64,"+btoa(q[f].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(q[f])+"')"),G[d]=h)}},B.create_sensor_manifold(null,"AXES"+t,B.CT_CONTINUOUS,r,function(){return!0},C);h();window.addEventListener("resize",h)};a.hide=function(){A=0;E=-1;z=l=J=v=null;y.length=0;Q.length=0;Z.length=
0;m.get_container().removeChild(I);I=null;B.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var a=0;4>a;a++)B.remove_sensor_manifold(null,a),B.remove_sensor_manifold(null,"AXES"+a);window.removeEventListener("resize",h)};a.update=function(){for(var a=0;4>a;a++)c(a)}};b4w.module.gyroscope=function(a,r){function d(a){var d=b.create_gyro_angles_sensor(),g=b.create_gyro_quat_sensor(),r=!0;b.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",b.CT_CONTINUOUS,[d,g],null,function(a,d,g){if(0<g)if(c.is_eye_camera(a))d=b.get_sensor_payload(a,d,1),g=e.transformQuat(x.AXIS_MY,d,h),c.set_vertical_axis(a,g),n.set_rotation_v(a,d);else{w=b.get_sensor_payload(a,d,0);r&&(u[0]=w[0],u[1]=w[1],u[2]=w[2],r=!1);g=d=0;window.orientation||(d=w[1]-u[1],g=w[0]-u[0],w[1]>B&&w[1]<m&&(g=0));if(180==
window.orientation){d=w[1]-u[1];0>w[1]&&(d=-d);g=u[0]-w[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;w[1]>-m&&w[1]<-B&&(g=0)}if(-90==window.orientation){d=w[0]-u[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;g=u[1]-w[1];if(w[0]>k||w[0]<f)g=0}if(90==window.orientation){d=u[0]-w[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;g=w[1]-u[1];if(w[0]>k||w[0]<f)g=0}c.rotate_camera(a,g,d);u[0]=w[0];u[1]=w[1];u[2]=w[2]}})}var c=r("camera"),b=r("controls"),g=r("scenes"),n=r("transform"),x=r("util"),e=r("vec3"),u=new Float32Array(3),w=new Float32Array(3),
h=e.create(),m=x.deg_to_rad(110),B=x.deg_to_rad(70),k=x.deg_to_rad(70),f=-x.deg_to_rad(70);a.enable_camera_rotation=function(){var a=g.get_active_camera();d(a)};a.disable_camera_rotation=function(){var a=g.get_active_camera();b.remove_sensor_manifold(a,"CAMERA_ROTATE_GYRO")}};b4w.module.hmd_conf=function(a,r){function d(){if(!B.can_use_device(B.DEVICE_HMD))return!1;var a=B.get_device_by_type_element(B.DEVICE_HMD),a=B.get_value_param(a,B.HMD_WEBVR_TYPE);return a&(B.HMD_NON_WEBVR|B.HMD_WEBVR_MOBILE|B.HMD_WEBVR_DESKTOP)&&!(a&B.HMD_WEBVR1)}function c(a){a=a.target.value;var b=v[a],c;for(c in I)if(c in b){var d=document.getElementById(c+"_slider");d&&(d.disabled="custom"!==a,d.value=b[c]);if(d=document.getElementById(c+"_number"))d.disabled="custom"!==a,d.value=b[c];I[c]=b[c]}}
function b(){m.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING");n();e();t&&(t=!1,h.get_container().removeChild(q),document.head.removeChild(E),E=J=q=null)}function g(){n(!0);e();for(var a in I){var b=document.getElementById(a+"_slider");b&&(b.value=I[a]);if(b=document.getElementById(a+"_number"))b.value=I[a]}}function n(a){var b=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,c=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,d=0,e=0,g=0,h;a:{h=
z;var l=navigator.userAgent||navigator.vendor||window.opera;if(1==h.format&&h.devices&&h.devices.length)for(var m=0;m<h.devices.length;m++){var n=h.devices[m];if(n.rules&&("ios"==n.type&&C||"android"==n.type)){for(var q=!1,t=0;t<n.rules.length;t++){var r=n.rules[t];if(r.ua&&0<=l.indexOf(r.ua)||!r.ua&&r.res&&r.res[0]&&r.res[1]&&Math.min(b,c)==Math.min(r.res[0],r.res[1])&&Math.max(b,c)==Math.max(r.res[0],r.res[1])){q=!0;break}}if(q){h=m;break a}}}else k.error("DPDB isn't correct.");h=-1}-1!=h&&(g=z.devices[h],
e=g.dpi[1]||g.dpi,d=Math.round(25.4*b/(g.dpi[0]||g.dpi)),e=Math.round(25.4*c/e),g=Math.round(g.bw));b=f.get("hmd_conf","b4w");b=JSON.parse(b?b:"{}");a?(I.first_distortion=.34,I.second_distortion=.55,I.bevel_size=g||4,I.screen_width=d||110,I.screen_height=e||65,I.screen_lense=50,I.ipd=64,I.baseline=32):(I.first_distortion="first_distortion"in b?parseFloat(b.first_distortion):.34,I.second_distortion="second_distortion"in b?parseFloat(b.second_distortion):.55,I.bevel_size="bevel_size"in b?parseFloat(b.bevel_size):
g||4,I.screen_width="screen_width"in b?parseFloat(b.screen_width):d||110,I.screen_height="screen_height"in b?parseFloat(b.screen_height):e||65,I.screen_lense="screen_lense"in b?parseFloat(b.screen_lense):50,I.ipd="ipd"in b?parseFloat(b.ipd):64,I.baseline="baseline"in b?parseFloat(b.baseline):32);A=!0}function x(){f.set("hmd_conf",JSON.stringify(I),"b4w");b()}function e(){if(A){var a=B.get_device_by_type_element(B.DEVICE_HMD);a&&(B.set_config(a,B.HMD_DISTORTION,[I.first_distortion,I.second_distortion]),
B.get_value_param(a,B.HMD_WEBVR_TYPE)&(B.HMD_NON_WEBVR|B.HMD_WEBVR_MOBILE)&&(B.set_config(a,B.HMD_BEVEL_SIZE,.001*I.bevel_size),B.set_config(a,B.HMD_SCREEN_WIDTH,.001*I.screen_width),B.set_config(a,B.HMD_SCREEN_HEIGHT,.001*I.screen_height),B.set_config(a,B.HMD_SCREEN_LENSE_DIST,.001*I.screen_lense),B.set_config(a,B.HMD_EYE_DISTANCE,.001*I.ipd),B.set_config(a,B.HMD_BASELINE_DIST,.001*I.baseline)));A=!1}}function u(a){var b=a.target.id.split("_"),b=b.splice(0,b.length-1).join("_");b in I&&I[b]!=a.target.value&&
(A=!0,I[b]=a.target.value,document.getElementById(b+"_slider").value=a.target.value,document.getElementById(b+"_number").value=a.target.value)}function w(a,b,c){var d=document.createElement("button");d.onclick=a;d.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 160px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;padding-left: 8px;line-height: 28px;margin-right:"+
c+";box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";d.innerHTML=b;return d}var h=r("container"),m=r("controls"),B=r("input"),k=r("print"),f=r("storage"),F=r("util"),t=!1,q=null,E=null,J=null,A=!0,I={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},C=/iPad|iPhone|iPod/.test(navigator.platform),v={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",
type:1,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},l=[{label:"Tray to lens-center distance.",Cm:!0,inputs:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",Cm:!0,inputs:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",
Cm:!0,inputs:[{id:"screen_lense",max:"100",step:"1"}]},{label:"Screen height.",Cm:!0,inputs:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",Cm:!0,inputs:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",Cm:!0,inputs:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",inputs:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];a.check=d;a.show=function(a){if(d()){var k=h.get_container();E=document.createElement("style");
E.innerHTML="."+a+" input[type=range]::-webkit-slider-runnable-track {width: 100%; height: 8px;cursor: pointer;background-color: #fff;border: 2px solid rgba(98, 98, 98, .2);box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);}."+a+" input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);height: 30px;width: 16px;border-radius: 2px;background-color: #323232;cursor: pointer;margin-top: -13px;-webkit-appearance: none;}";document.head.appendChild(E);if(!t){t=!0;n();var r=
B.get_device_by_type_element(B.DEVICE_MOUSE,k);B.switch_prevent_default(r,!1);r=B.get_device_by_type_element(B.DEVICE_TOUCH,k);B.switch_prevent_default(r,!1);q=document.createElement("div");q.className=a;k.appendChild(q);J=document.createElement("div");q.appendChild(J);J.style.cssText="background-color: #484848;border: 2px solid rgba(150, 150, 150, 0.7);box-shadow: 0px 0px 10px 0px rgba(150, 150, 150, 0.7);position: relative;width: 524px;padding: 16px;overflow: hidden;";a=f.get("hmd_conf","b4w");
a=JSON.parse(a?a:"{}").profile||"custom";k=document.createElement("div");r=document.createElement("label");r.innerHTML="Profile: ";r.className="text_label";r.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 120px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";
k.appendChild(r);r=document.createElement("select");k.appendChild(r);r.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";var y=B.get_device_by_type_element(B.DEVICE_HMD);if(y)for(var z in v)if(0==v[z].type||B.get_value_param(y,
B.HMD_WEBVR_TYPE)&(B.HMD_NON_WEBVR|B.HMD_WEBVR_MOBILE)&&1==v[z].type){var C=document.createElement("option");C.value=z;C.text=v[z].name;r.appendChild(C)}r.value=a;F.is_ie11()?r.onchange=c:r.oninput=c;J.appendChild(k);z=B.get_device_by_type_element(B.DEVICE_HMD);for(a=0;a<l.length;a++)if(B.get_value_param(z,B.HMD_WEBVR_TYPE)&(B.HMD_NON_WEBVR|B.HMD_WEBVR_MOBILE)||!l[a].Cm){k=l[a];y=a;r=document.createElement("div");C=document.createElement("label");C.className="text_label";var A="8px";y%2&&(A="0");
C.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 100%;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";C.textContent=k.label;r.appendChild(C);r.style.cssText="margin-top: 16px;float: left;width: 240px;margin-right: "+A+";border-top: 2px solid rgba(98, 98, 98, .4);box-sizing: border-box;-webkit-box-sizing: border-box;padding-top: 8px;";
for(y=0;y<k.inputs.length;y++){C=k.inputs[y];A=document.createElement("div");A.className="row";var D=document.createElement("input");D.className="input_slider";D.style.cssText="-webkit-appearance: none;width: 192px;display: block;float: left;height: 8px;margin-bottom: 16px;margin-top: 16px;box-sizing: border-box;margin-right: 8px;margin-left: 0;";D.setAttribute("id",C.id+"_slider");D.setAttribute("type","range");D.setAttribute("min","0.00");D.setAttribute("step",C.step);D.setAttribute("value",I[C.id]);
D.setAttribute("max",C.max);A.appendChild(D);var H=document.createElement("input");H.className="input_text";H.setAttribute("id",C.id+"_number");H.setAttribute("type","number");H.setAttribute("min","0.00");H.setAttribute("step",C.step);H.setAttribute("value",I[C.id]);H.setAttribute("max",C.max);A.appendChild(H);H.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 40px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;box-sizing: border-box;line-height: 28px;margin-top: 4px;margin-right: 0;margin-left: 0;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";
F.is_ie11()?(D.onchange=u,H.onchange=u):(D.oninput=u,H.oninput=u);r.appendChild(A)}J.appendChild(r)}z=document.createElement("div");a=w(x,"SAVE","4px");k=w(b,"CANCEL","4px");r=w(g,"RESET","0px");z.className="row";z.style.cssText="padding-top: 32px;clear: both;box-sizing: border-box;-webkit-box-sizing: border-box;";z.appendChild(a);z.appendChild(k);z.appendChild(r);J.appendChild(z);z=m.create_timeline_sensor();m.create_sensor_manifold(null,"UPDATE_HMD_RENDERING",m.CT_CONTINUOUS,[z],null,e)}}};a.hide=
b;a.reset=g;a.update=function(){n();e()};var z={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},
{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,
518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},
{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},
{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],
dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",
rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},
{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},
{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],
dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,
bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},
{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",
rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3}]}};b4w.module.hmd=function(a,r){function d(a,d){function g(d,e,f){if(0<f&&(f=x.get_active_camera())&&c.is_eye_camera(f)&&(d=b.get_sensor_payload(d,e,1)))if(1==a){d=n.multiply(v,d,C);var g=h.transformQuat(w.AXIS_MY,d,t);c.set_vertical_axis(f,g);u.set_rotation_v(f,d)}else if(2==a||3==a){e=u.get_rotation(f,A);e=n.invert(e,A);var k=n.multiply(m,e,A);e=c.get_vertical_axis(f,t);Math.abs(e[2])<Math.PI/4?g=h.cross(e,w.AXIS_MY,q):Math.abs(e[1])<Math.PI/4&&(g=h.cross(e,w.AXIS_Z,q));h.normalize(g,g);var k=h.transformQuat(g,
k,E),l=h.dot(e,k),k=h.scaleAndAdd(k,e,-l,E);h.normalize(k,k);e=h.cross(e,g,t);g=Math.acos(w.clamp(h.dot(g,k),0,1));e=w.sign(h.dot(k,e));B+=g*e;g=n.setAxisAngle(w.AXIS_Z,-B,A);3==a?d=n.multiply(g,d,J):(e=w.quat_project(d,w.AXIS_MZ,w.AXIS_Z,w.AXIS_Y,I),e=n.invert(e,I),d=n.multiply(e,d,I),d=n.multiply(g,d,J));g=h.transformQuat(w.AXIS_MY,d,t);c.set_vertical_axis(f,g);u.set_rotation_v(f,d);n.copy(d,m)}}if(d){var l=x.get_active_camera();l&&e.request_split_screen(function(){c.is_eye_camera(l)||(k=c.is_target_camera(l),
f=c.is_hover_camera(l),F=c.is_static_camera(l),c.eye_setup(l));var a=b.create_elapsed_sensor();m=u.get_rotation(l,m);b.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",b.CT_CONTINUOUS,[a,d],null,g)})}}var c=r("camera"),b=r("controls"),g=r("input"),n=r("quat"),x=r("scenes"),e=r("screen"),u=r("transform"),w=r("util"),h=r("vec3"),m=n.create(),B=0,k=!1,f=!1,F=!1,t=h.create(),q=h.create(),E=h.create(),J=n.create(),A=n.create(),I=n.create(),C=n.create(),v=n.create(),l={pivot:h.create()};a.HMD_NONE_MOUSE_ALL_AXES=
0;a.HMD_ALL_AXES_MOUSE_NONE=1;a.HMD_ROLL_PITCH_MOUSE_YAW=2;a.HMD_ALL_AXES_MOUSE_YAW=3;a.enable_hmd=function(a){var c;if(c=g.get_device_by_type_element(g.DEVICE_HMD))c=g.get_value_param(c,g.HMD_WEBVR_TYPE)&(g.HMD_WEBVR_MOBILE|g.HMD_WEBVR_DESKTOP|g.HMD_WEBVR1)?b.create_hmd_quat_sensor():b.create_gyro_quat_sensor(),d(a,c)};a.check_browser_support=function(){return!!g.can_use_device(g.DEVICE_HMD)};a.disable_hmd=function(){if(b.check_sensor_manifold(null,"HMD_ROTATE_CAMERA")){b.remove_sensor_manifold(null,
"HMD_ROTATE_CAMERA");e.exit_split_screen();var a=x.get_active_camera();k?c.target_setup(a,l):f?c.hover_setup(a,l):F&&c.static_setup(a,l);c.set_vertical_axis(a,w.AXIS_Z);var d=u.get_rotation(a,J);u.set_rotation_v(a,d)}};a.set_rotate_quat=function(a){n.copy(a,v)};a.get_rotate_quat=function(a){n.copy(v,a);return a}};b4w.module.fps=function(a,r){function d(){}function c(a,b,c){var d=A.get_active_camera();q.eye_rotate(d,b,c);b=q.get_camera_angles_char(d,ga);J.set_character_rotation(a,b[0],b[1])}function b(a,b,c,d){if(.01<Math.abs(D[0])||.01<Math.abs(D[1]))c=E.get_sensor_value(a,b,0),b=I.smooth(D[0],0,c,.2*X),c=I.smooth(D[1],0,c,.2*X),D[0]-=b,D[1]-=c,d(a,-b*V,-c*V)}function g(a){var b=document.createElement("div");b.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
b.setAttribute("id","B4W_DEFAULT_BTN_1");var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
c.setAttribute("id","B4W_DEFAULT_BTN_2");a.appendChild(b);a.appendChild(c)}function n(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function x(a,c){if(n(a)&&!C.detect_mobile()){var e=E.create_plock_mouse_sensor(a),f=pa?pa:E.create_plock_sensor(a);pa=f;E.create_sensor_manifold(c,"FPS_PLOCK",E.CT_CONTINUOUS,[e,f],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=E.get_sensor_payload(a,b,0),d(a,-b.coords[0]*V,-b.coords[1]*V))});E.create_sensor_manifold(null,
"FPS_ACTIVATE_PLOCK",E.CT_TRIGGER,[f],function(a){return a[0]},function(b,c,d){0<d?Y.dw&&Y.dw(a):Y.Zv&&Y.Zv(a)})}else{if(C.detect_mobile())var e=E.create_touch_move_sensor("XY",a),f=E.create_touch_click_sensor(a),g=4;else{var e=E.create_mouse_move_sensor("XY",a),f=E.create_mouse_click_sensor(a),g=2,h=A.get_active_camera(),k=E.create_elapsed_sensor(),m=E.create_gamepad_axis_sensor(l.GMPD_AXIS_2),p=E.create_gamepad_axis_sensor(l.GMPD_AXIS_3);E.create_sensor_manifold(c,"FPS_CAM_ROT",E.CT_CONTINUOUS,
[k,m,p],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var d=E.get_sensor_value(a,b,0);c=E.get_sensor_value(a,b,1);var e=E.get_sensor_value(a,b,2);b=2.5*d;e=.05>Math.abs(e)?0:e;d=q.get_camera_angles(h,ga);e=d[1]-e*b;c=-(.05>Math.abs(c)?0:c)*b;e=I.clamp(e,S,G);q.eye_rotate(h,c,e,!1,!0);J.set_character_rotation(a,d[0]+c+Math.PI,0)}})}var t=0,r=0;E.create_sensor_manifold(null,"FPS_DRAG_PRESS",E.CT_SHOT,[f],function(a){return a[0]},function(a,b,c){1==c&&(a=E.get_sensor_payload(a,
b,0).coords,t=a[0],r=a[1])});E.create_sensor_manifold(null,"FPS_DRAG_MOVE",E.CT_CONTINUOUS,[e,f],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=E.get_sensor_payload(a,b,0).coords,D[0]+=(a[0]-t)*g,D[1]+=(a[1]-r)*g,t=a[0],r=a[1])});e=E.create_elapsed_sensor();E.create_sensor_manifold(c,"FPS_SMOOTH_DRAG",E.CT_CONTINUOUS,[e],null,b,d)}}function e(a){var b=E.create_elapsed_sensor(),c=A.get_active_camera();E.create_sensor_manifold(a,"FPS_CHARECTER_VR_ROT",E.CT_CONTINUOUS,[b],null,function(a){var b=
q.get_camera_angles_char(c,ga)[0];J.set_character_rotation(a,b,0)})}function u(){var a=y.check_browser_support()&&!C.detect_mobile(),b=l.get_device_by_type_element(l.DEVICE_HMD);b&&(a=a&&l.get_value_param(b,l.HMD_WEBVR_TYPE)&l.HMD_WEBVR1);return a}function w(a,b,c,d){function e(a){a=0<a?1:a;var d=n+p;p=-(0>a?-1:a);a=q+r;var e=n+p;J.set_character_move_dir(b,a,e);c&&c(a,e);k(a,e);u&&d!=e&&u(a,e)}function h(a){a=0<a?1:a;var d=q+r;r=-(0>a?-1:a);a=q+r;var e=n+p;J.set_character_move_dir(b,a,e);c&&c(a,e);
k(a,e);u&&d!=a&&u(a,e)}function k(a,b){var c=m.em.id;a||b?0==c&&(0<v?f(m,2):f(m,1)):f(m,0)}C.detect_mobile()&&g(a.parentElement?a.parentElement:a);var m=F(b),n=0,p=0,q=0,r=0,v=-1,u=d.move_dir_cd;a=d.jJ;var w=d.NP,y=d.cO,x=d.YN,D=d.SP,z=d.rM;t(1,d.sM,function(a){var d=q+r;q=a;a=q+r;var e=n+p;J.set_character_move_dir(b,a,e);c&&c(a,e);k(a,e);u&&d!=a&&u(a,e)});t(1,a,h);t(1,w,e);t(1,y,function(a){var d=n+p;n=a;a=q+r;var e=n+p;J.set_character_move_dir(b,a,e);c&&c(a,e);k(a,e);u&&d!=e&&u(a,e)});t(1,x,function(a){0<
a&&J.character_jump(b)});t(3,[l.GMPD_AXIS_0],e);t(3,[l.GMPD_AXIS_1],h);t(1,D,function(a){v=a;q+r+n+p?(0<a?f(m,2):f(m,1),u&&u(q+r,n+p)):f(m,0)});t(1,z,function(a){0<a&&(a=ba.em.id,1==a||0==a?f(m,3):f(m,1))})}function h(){ba||(ba={V:[],em:null,lock:!1,VC:null});return ba}function m(a,b,c,d){a.V.push({id:b,Zu:c,IA:d,HA:null,sv:null})}function B(a){for(var b=[],c=0;c<a.V;c++){var d=a.V[c].id;if(0<=b.indexOf(d))return!1;b.push(d)}for(c=0;c<a.V;c++)for(var d=a.V[c],e=0;e<d.Zu.length;e++)if(0>b.indexOf(d.Zu[e]))return!1;
return!0}function k(a,b){for(var c=null,d=0;d<a.V.length;d++)if(a.V[d].id==b){c=a.V[d];break}return c}function f(a,b){a.VC=b;if(!a.lock){var c=a.em,d=c.id;if(0<=c.Zu.indexOf(b)){var e=!0;c.HA&&(e=c.HA(d,b));e&&(a.em=k(a,b),c.IA&&c.IA(d,b),c.sv&&c.sv(d,b))}}}function F(a){function b(b,c){switch(c){case 0:case 1:J.set_character_move_type(a,J.CM_WALK);break;case 2:J.set_character_move_type(a,J.CM_RUN);break;case 3:J.set_character_move_type(a,J.CM_FLY);break;case 4:J.set_character_move_type(a,J.CM_CLIMB)}}
var c=h();m(c,0,[1,3,2,4],b);m(c,1,[2,3,4,0],b);m(c,2,[1,3,4,0],b);m(c,3,[1],b);m(c,4,[1,2,0],b);B(c);c.em=k(c,0);return ba}function t(a,b,c){if(b.length){for(var d=[],e=0;e<b.length;e++)if("number"==typeof b[e])300>b[e]?d.push(E.create_keyboard_sensor(b[e])):326>b[e]?d.push(E.create_gamepad_btn_sensor(b[e],ha)):d.push(E.create_gamepad_axis_sensor(b[e]));else if("string"==typeof b[e]){var f=document.getElementById(b[e]);f?d.push(E.create_touch_click_sensor(f)):Z.error("Couldn't find element with "+
b[e]+" ID.")}b=function(){return!1};e=E.CT_SHOT;f=function(){};switch(a){case 1:e=E.CT_TRIGGER;b=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0<d?c(1):c(0)};break;case 2:e=E.CT_TRIGGER;b=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0>d?c(1):c(0)};break;case 3:e=E.CT_CONTINUOUS,b=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},f=function(a,b,d,e){if(0<d)for(d=0;d<e;d++){var f=E.get_sensor_value(a,
b,d);if(.05<Math.abs(f)){c(f);break}}else c(0)}}E.create_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+L.toString(),e,d,b,f,d.length);L++}}var q=r("camera"),E=r("controls"),J=r("physics"),A=r("scenes"),I=r("util"),C=r("main"),v=r("container"),l=r("input"),z=r("screen"),H=r("transform"),p=r("constraints"),Q=r("vec3"),y=r("hmd"),Z=r("__print"),S=(-Math.PI+.1)/2,G=(Math.PI-.1)/2,D=new Float32Array(2),X=1,V=4E-4,L=0,ba=null,pa=null,Y={dw:null,Zv:null},ha=0,U=4,ga=new Float32Array(2),ca=new Float32Array(3),
M=new Float32Array(3);a.CS_STAY=0;a.CS_WALK=1;a.CS_RUN=2;a.CS_FLY=3;a.CS_CLIMB=4;a.AT_PRESSED=1;a.AT_RELEASED=2;a.AT_CONTINUOUS=3;a.bind_action=t;a.enable_fps_controls=function(a){a=a||{lock_camera:!0};var b=a.character||A.get_first_character();if(b){var f=a.element||v.get_canvas(),g=a.motion_cb||null;ha=a.gamepad_id||0;var h=a.forward_sens||[E.KEY_W,l.GMPD_BUTTON_12],k=a.backward_sens||[E.KEY_S,l.GMPD_BUTTON_13],m=a.right_sens||[E.KEY_D,l.GMPD_BUTTON_15],n=a.left_sens||[E.KEY_A,l.GMPD_BUTTON_14],
t=a.jump_sens||[E.KEY_SPACE,l.GMPD_BUTTON_1],r=a.OU||[E.KEY_SHIFT,l.GMPD_BUTTON_7],D=a.fly_sens||[];C.detect_mobile()&&(h.push("B4W_DEFAULT_BTN_1"),k.push("B4W_DEFAULT_BTN_2"));h={sM:h,jJ:k,NP:m,cO:n,YN:t,SP:r,rM:D,move_dir_cd:a.move_dir_cd||null};d=a.rotation_cb||c;k=a.lock_camera||!1;a=A.get_active_camera();k&&(k=H.get_translation(a,ca),m=H.get_translation(b,M),Q.subtract(k,m,k),p.append_stiff_trans(a,b,k));a=q.get_camera_angles_char(a,ga);J.set_character_rotation(b,a[0],a[1]);u()?(y.enable_hmd(y.HMD_ALL_AXES_MOUSE_NONE),
l.add_click_listener(f,z.request_fullscreen_hmd),e(b)):x(f,b);w(f,b,g,h)}};a.disable_fps_controls=function(a,b){a=a||A.get_first_character();b=b||v.get_container();if(a){for(var c=0;c<L;c++)E.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+c.toString());c=a;n(b)&&!C.detect_mobile()&&(E.remove_sensor_manifold(c,"FPS_PLOCK"),E.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!n(b)||C.detect_mobile())E.remove_sensor_manifold(c,"FPS_CAM_ROT"),E.remove_sensor_manifold(c,"FPS_DRAG_PRESS"),
E.remove_sensor_manifold(c,"FPS_DRAG_MOVE"),E.remove_sensor_manifold(c,"FPS_SMOOTH_DRAG");c=a;u()&&E.remove_sensor_manifold(c,"FPS_CHARECTER_VR_ROT");c=b;if(C.detect_mobile()){var d=document.getElementById("B4W_DEFAULT_BTN_1"),e=document.getElementById("B4W_DEFAULT_BTN_2");d&&c.removeChild(d);e&&c.removeChild(e)}}};a.set_character_state_changing_cb=function(a,b){k(ba,a).sv=b};a.set_cam_smooth_factor=function(a){E.set_plock_smooth_factor(a);X=a};a.set_cam_sensitivity=function(a){V=a/2E5};a.set_plock_enable_cb=
function(a){Y.dw=a};a.set_plock_disable_cb=function(a){Y.Zv=a};a.get_character_state=function(){return ba.em.id};a.add_new_state=function(){return U++};a.add_state_to_state_machine=function(a,b,c){var d=h();m(d,a,b,c);B(d)||Z.error("Incorrect state machine.")};a.state_machine_switch_state=function(a){var b=h();f(b,a)};a.lock_character_state_machine=function(){h().lock=!0};a.unlock_character_state_machine=function(){h().lock=!1};a.is_state_machine_locked=function(){return h().lock};a.get_last_state=
function(){return h().VC};a.set_rotation_cb=function(a){a?d=a:d=c};a.CD_NONE=0;a.CD_FORWARD=1;a.CD_BACKWARD=2;a.CD_RIGHT=3;a.CD_LEFT=4};b4w.module.mixer=function(a,r){function d(){q=t.length=0;E=c();J=new Float32Array(E.length);A=new Float32Array(E.length);var a=k.get_speaker_objects();if(a.length){t.push(b());for(var d=0;d<a.length;d++)t.push(n(a[d]));t.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function c(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function b(){var a=g("MASTER"),b=k.get_compressor_params();b&&(a.X.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.X.push(["KNEE",b.knee,0,40,40,!1]),a.X.push(["RATIO",b.ratio,1,20,20,!1]),a.X.push(["ATTACK",b.attack,0,1,1E3,!1]),a.X.push(["RELEASE",b.release,0,1,1E3,!1]));a.X.push(["VOLUME",k.get_volume(null),0,1,50,!1]);a.mute=k.is_muted(null)?1:0;a.Xf=-1;return a}function g(a){return{id:a,X:[],kk:0,mute:-1,Xf:-1,Xb:null}}function n(a){var b=g(m.get_object_name(a));b.mute=k.is_muted(a)?
1:0;b.Xf=0;b.Xb=a;return b}function x(a){if(a.Xb){a.X.length=0;var b=k.get_positional_params(a.Xb);b&&(a.X.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.X.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.X.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=k.get_filter_params(a.Xb))a.X.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.X.push(["EQ_Q",b.Q,0,10,100,!1]),a.X.push(["EQ_GAIN",b.gain,-70,30,100,!1]);a.X.push(["VOLUME",k.get_volume(a.Xb),0,1,50,!1]);f.clamp(a.kk,0,a.X.length-1)}}function e(a){for(var b=
0;b<t.length;b++){var c=t[b];if(c!=a&&1==c.Xf)return!0}return!1}function u(a){for(var b=0;b<t.length;b++){var c=t[b];c!=a&&0==c.mute&&0==c.Xf&&k.mute(c.Xb,!1)}}function w(){if(!t.length)return[0,-1];var a=8*Math.floor(q/8),b=a+7,a=f.clamp(a,0,t.length-1),b=f.clamp(b,0,t.length-1);return[a,b]}var h=r("controls"),m=r("scenes"),B=r("screen"),k=r("sfx"),f=r("__util"),F="SWITCH_STRIP SWITCH_STRIP_HOLD SWITCH_PARAM INC_DEC INC_DEC_HOLD MUTE_SOLO".split(" "),t=[],q=0,E=null,J=null,A=null;a.enable_mixer_controls=
function(){function a(a,b,c){if(1==c){var d=h.get_sensor_value(a,b,0)?-1:1,e=t[q];if(e)switch(c=e.X[e.kk],c[1]=c[5]?c[1]*Math.pow(c[3]/c[2],d/c[4]):c[1]+(c[3]-c[2])/c[4]*d,c[1]=f.clamp(c[1],c[2],c[3]),c[0]){case "VOLUME":"MASTER"!=e.id?k.set_volume(e.Xb,c[1]):k.set_volume(null,c[1]);break;case "DIST_REF":d=k.get_positional_params(e.Xb);d.dist_ref=c[1];k.set_positional_params(e.Xb,d);break;case "ATTENUATION":d=k.get_positional_params(e.Xb);d.attenuation=c[1];k.set_positional_params(e.Xb,d);break;case "DIST_MAX":d=
k.get_positional_params(e.Xb);d.dist_max=c[1];k.set_positional_params(e.Xb,d);break;case "EQ_FREQ":d=k.get_filter_params(e.Xb);d.freq=c[1];k.set_filter_params(e.Xb,d);break;case "EQ_Q":d=k.get_filter_params(e.Xb);d.Q=c[1];k.set_filter_params(e.Xb,d);break;case "EQ_GAIN":d=k.get_filter_params(e.Xb);d.gain=c[1];k.set_filter_params(e.Xb,d);break;case "THRESHOLD":e=k.get_compressor_params();e.threshold=c[1];k.set_compressor_params(e);break;case "KNEE":e=k.get_compressor_params();e.knee=c[1];k.set_compressor_params(e);
break;case "RATIO":e=k.get_compressor_params();e.ratio=c[1];k.set_compressor_params(e);break;case "ATTACK":e=k.get_compressor_params();e.attack=c[1];k.set_compressor_params(e);break;case "RELEASE":e=k.get_compressor_params();e.release=c[1];k.set_compressor_params(e);break;default:f.D("Unknown strip param")}"INC_DEC"==b?h.reset_timer_sensor(a,b,2,.35):h.reset_timer_sensor(a,b,2,.05)}else h.reset_timer_sensor(a,b,2,10)}function b(a,b,c){if(1==c){c=h.get_sensor_value(a,b,0)?-1:1;if(t.length){1==c&&q<
t.length-1?q++:-1==c&&0<q&&q--;c=w();for(var d=c[0];d<=c[1];d++)x(t[d])}"SWITCH_STRIP"==b?h.reset_timer_sensor(a,b,2,.15+.3):h.reset_timer_sensor(a,b,2,.15)}else h.reset_timer_sensor(a,b,2,10)}d();var c=h.create_keyboard_sensor(h.KEY_NUM4),g=h.create_keyboard_sensor(h.KEY_NUM6),m=h.create_keyboard_sensor(h.KEY_NUM8),n=h.create_keyboard_sensor(h.KEY_NUM2),p=h.create_keyboard_sensor(h.KEY_ADD),r=h.create_keyboard_sensor(h.KEY_SUB),y=h.create_keyboard_sensor(h.KEY_NUM7),F=h.create_keyboard_sensor(h.KEY_NUM9),
S=h.create_timer_sensor(.15,!0),G=h.create_timer_sensor(.05,!0),c=[c,g,S];h.create_sensor_manifold(null,"SWITCH_STRIP",h.CT_TRIGGER,c,function(a){return a[0]||a[1]},b);h.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",h.CT_SHOT,c,function(a){return(a[0]||a[1])&&a[2]},b);h.create_sensor_manifold(null,"SWITCH_PARAM",h.CT_SHOT,[m,n],function(a){return a[0]||a[1]},function(a,b){var c=h.get_sensor_value(a,b,0)?-1:1,d=t[q];d&&(1==c&&d.kk<d.X.length-1?d.kk++:-1==c&&0<d.kk&&d.kk--)});m=[r,p,G];h.create_sensor_manifold(null,
"INC_DEC",h.CT_TRIGGER,m,function(a){return a[0]||a[1]},a);h.create_sensor_manifold(null,"INC_DEC_HOLD",h.CT_SHOT,m,function(a){return(a[0]||a[1])&&a[2]},a);h.create_sensor_manifold(null,"MUTE_SOLO",h.CT_SHOT,[y,F],function(a){return a[0]||a[1]},function(a,b){if(h.get_sensor_value(a,b,0)){var c=t[q];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,k.mute(c.Xb,!0),1==c.Xf&&(c.Xf=0,e(c)||u(c))):(c.mute=0,e(c)||k.mute(c.Xb,!1)):0==c.mute?(c.mute=1,k.mute(null,!0)):(c.mute=0,k.mute(null,!1)))}else if((c=
t[q])&&0<=c.Xf)if(0==c.Xf){c.Xf=1;k.mute(c.Xb,!1);1==c.mute&&(c.mute=0);for(var d=0;d<t.length;d++){var f=t[d];f!=c&&0==f.mute&&0==f.Xf&&k.mute(f.Xb,!0)}}else c.Xf=0,e(c)?k.mute(c.Xb,!0):u(c)});y=h.create_elapsed_sensor();h.create_sensor_manifold(null,"MIXER_DRAW",h.CT_CONTINUOUS,[y],null,function(){if(t[q])for(var a=w(),b=a[0];b<=a[1];b++){var c=t[b];B.draw_mixer_strip(c.id,b==q,b%8,c.X,c.kk,c.mute,c.Xf);if(c.Xb&&k.get_filter_params(c.Xb)){k.get_filter_freq_response(c.Xb,E,J,A);for(c=0;c<J.length;c++)J[c]=
20*Math.log(J[c])/Math.LN10;B.plot_array("EQ",b%8,J,20,2E4,-10,10)}}});y=h.create_timer_sensor(1,!0);h.create_sensor_manifold(null,"MIXER_UPDATE",h.CT_TRIGGER,[y],null,function(){for(var a=w(),b=a[0];b<=a[1];b++)x(t[b])})};a.disable_mixer_controls=function(){for(var a=0;F.length;a++)h.remove_sensor_manifold(null,F[a])}};b4w.module.npc_ai=function(a,r){function d(a,b){var c=b.destination,d=b.dv,f=J;B.get_translation(b.collider,f);var g=0,h=f[2];c[2]=h;switch(b.type){case z:if(b.random&&b.Oj){c[0]=(12*Math.random()-6)*b.speed+d[0];c[1]=-(12*Math.random()-6)*b.speed+d[1];var m=v,d=A,n=b.speed,q=b.rot_speed;B.get_rotation(b.collider,m);k.transformQuat(t.AXIS_MY,m,d);d[2]=0;k.normalize(d,d);m=.5*n/Math.sin(q/2);f=k.dist(c,f);f<2*m&&k.scaleAndAdd(c,d,2*m-f,c);b.Oj=!1}b.Gw&&(g=b.Gw-h,f=b.speed*a,g>f?g=f:g<-f&&(g=-f));b.Si=
g;break;case H:case p:b.Cn?g=b.Cn:b.Si&&(g=b.Si,b.type==p&&(g*=a)),b.random&&b.Oj&&(b.type==p?(b.speed=Math.random()+.1,f=b.fD-b.hD):f=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=10*Math.random()-5+d[1],c[2]=h-(Math.random()*f-.5*f),b.Oj=!1)}g&&(c[2]=h+g);var c=E,f=J,m=A,g=l,q=b.rig,d=b.collider,h=b.destination,r=b.speed,u=b.actions,y=e.get_current_anim_name(q);if(!e.is_play(q)||!u.idle||-1==u.idle.indexOf(y)){B.get_translation(d,c);var n=h[0]-c[0],F=h[1]-c[1],n=Math.sqrt(n*n+F*F);
if(n>2*r*a)b.state=20,t.horizontal_direction(h,c,m),u=b.rig,e.is_animated(u)&&(q=b.speed,r=e.get_frame(u),u=e.get_anim_length(u),q=u/24*(1-r/u)*q,.9>n/q&&k.scaleAndAdd(h,m,q-n,h)),n=v,q=I,B.get_rotation(b.collider,n),k.transformQuat(t.AXIS_MY,n,f),q[0]=f[0],q[1]=f[1],q[2]=0,k.normalize(q,q),r=k.dot(q,m),u=a/(Math.abs(Math.acos(r))/Math.PI)*b.rot_speed*b.gy,w.rotationTo(q,m,g),w.rotationTo(t.AXIS_MY,q,n),1<=Math.abs(r)?w.copy(n,g):(w.multiply(g,n,g),w.slerp(n,g,Math.min(u,1),g)),m=a,b.type!=H&&(m=
Math.max(m,1/60),n=C,q=v,w.setAxisAngle(t.AXIS_X,-Math.asin(-f[2]),q),w.setAxisAngle(t.AXIS_X,-Math.atan(b.Si/(b.speed*m)),n),w.slerp(q,n,m,n),w.multiply(g,n,g)),B.set_rotation_v(d,g),f=A,d=I,t.quat_to_dir(g,t.AXIS_MY,f),k.scale(f,b.speed*a,d),k.add(d,c,d),d[2]=b.type!=z?(h[2]-c[2])*a*.1+c[2]:h[2],B.set_translation_v(b.collider,d);else if(b.type==z)u.move?y&&-1!=u.move.indexOf(y)&&e.is_play(q)?b.state=20:(b.state=10,b.Oj=!0):(b.state=10,b.Oj=!0);else if(b.type==p||b.type==H)b.Oj=!0;if(x(b)&&(c=b.rig,
!e.is_play(c))){g=null;switch(b.state){case 10:g=b.actions;g=g.idle?t.random_from_array(g.idle):null;break;case 20:g=e.get_current_anim_name(b.rig),f=h=b.actions,f.move_blends&&-1==f.move_blends.indexOf(g)&&f.move&&-1!=f.move.indexOf(g)&&.33<Math.random()?(h=b.actions,g=h.move_blends[h.move.indexOf(g)]):(f=b.actions,f.move&&(-1!=f.move.indexOf(g)||!f.move_blends&&!f.move_start||!f.move_start&&!g||f.move_blends&&-1!=f.move_blends.indexOf(g)||f.move_start&&-1!=f.move_start.indexOf(g))?(h=b.actions,
h.move_blends?(f=h.move_blends.indexOf(g),-1!=f?(g=f+1,g=g<h.move.length?g:0,g=h.move[g]):g=-1!=h.move.indexOf(g)?g:t.random_from_array(h.move)):g=t.random_from_array(h.move)):(f=b.actions,g=f.move_start&&-1==f.move_start.indexOf(g)&&f.move&&-1==f.move.indexOf(g)?t.random_from_array(h.move_start):null))}g&&(e.apply(c,g),e.set_behavior(c,e.AB_FINISH_RESET),e.set_frame(c,0),e.play(c))}}}function c(a,b,c,d){if(d)if(1==c)switch(d.type){case H:a:{for(c=0;3>c;c++){var e=u.get_sensor_payload(a,b,c).If;if(e){b=
e;break a}}b=void 0}b=100*b;d.Si=b<d.min_height?10:b>d.max_height?-10:0;break;case z:a=u.get_sensor_payload(a,b,0);d.Gw=a.sh[2];break;case p:a=u.get_sensor_payload(a,b,0),"CLOSE_GROUND"==b?(d.Si=100*a.If-1,d.Si=.1>d.Si?.05:0):"CLOSE_WATER"==b&&(d.Cn=100*a.If,d.Cn=d.Cn<d.hD?-.02:d.Cn>d.fD?.02:0)}else d.Si=0}function b(){for(var a=0;a<q.length;a++){var b=q[a];g(b);n(b);e.get_current_anim_name(b.rig)&&e.play(b.rig)}}function g(a){var b=k.create(),d=a.collider;switch(a.type){case H:var e=u.create_ray_sensor(d,
b,[0,0,-100],"TERRAIN",!0,!0),f=u.create_ray_sensor(d,b,[0,0,-100],"STONE",!0,!0),b=u.create_ray_sensor(d,b,[0,0,-100],"WATER",!0,!0),e=[e,f,b];u.create_sensor_manifold(d,"CLOSE_GROUND",u.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},c,a);break;case z:e=u.create_ray_sensor(d,[0,0,1],[0,0,-99],"TERRAIN",!0,!0);e=[e];u.create_sensor_manifold(d,"CLOSE_GROUND",u.CT_CONTINUOUS,e,null,c,a);break;case p:e=u.create_ray_sensor(d,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),b=u.create_ray_sensor(d,b,[0,0,100],
"WATER",!0,!0),e=[e],u.create_sensor_manifold(d,"CLOSE_WATER",u.CT_CONTINUOUS,[b],null,c,a),u.create_sensor_manifold(d,"CLOSE_GROUND",u.CT_CONTINUOUS,e,null,c,a)}}function n(a){var b=a.collider;if(a.type==z){var c=u.create_collision_sensor(b,"CONSTRUCTION",!1);u.create_sensor_manifold(b,"CONSTRUCTION_COLL",u.CT_CONTINUOUS,[c],null,function(b,c,d){1==d?(k.copy(a.dv,a.destination),a.gy=4):a.gy=1})}}function x(a){var b=a.rig;if(!e.is_play(b))return!0;b=e.get_current_anim_name(b);if(!b)return!0;var c=
a.actions;switch(a.state){case 10:if(!c.idle)return!1;break;case 20:if(!c.move||-1!=c.move.indexOf(b)||c.move_start&&-1!=c.move_start.indexOf(b)||c.move_blends&&-1!=c.move_blends.indexOf(b))return!1;break;default:return!1}return!0}var e=r("animation"),u=r("controls"),w=r("quat"),h=r("scenes"),m=r("time"),B=r("transform"),k=r("vec3"),f=r("physics"),F=r("print"),t=r("util"),q=[],E=new Float32Array(3),J=new Float32Array(3),A=new Float32Array(3),I=new Float32Array(3),C=new Float32Array(4),v=new Float32Array(4),
l=new Float32Array(4),z=a.NT_WALKING=10,H=a.NT_FLYING=20,p=a.NT_SWIMMING=30;a.new_event_track=function(a){var b={obj:null,rig:null,collider:null,empty:null,type:z,state:10,actions:{},dv:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],Wr:[],delay:[],random:!0,Oj:!0,Gw:0,Si:0,Cn:0,gy:1,speed:1,rot_speed:.1,max_height:0,min_height:0,fD:0,hD:0};if("object"!=typeof a.obj)F.error("Can't create event track. Wrong object.");else if("object"!=typeof a.rig)F.error("Can't create event track. Wrong rig object.");
else if("object"==typeof a.collider&&f.has_physics(a.collider)){b.obj=a.obj;b.collider=a.collider;b.rig=a.rig;B.get_translation(a.collider,b.dv);"object"==typeof a.actions&&(b.actions=a.actions);"boolean"==typeof a.random&&(b.random=a.random);"number"==typeof a.type&&(b.type=a.type);"number"==typeof a.speed&&(b.speed=a.speed);"number"==typeof a.rot_speed&&(b.rot_speed=a.rot_speed);"number"==typeof a.max_height&&(b.max_height=a.max_height);"number"==typeof a.min_height&&(b.min_height=a.min_height);
if(!b.random){for(var c=0;c<a.path.length;c++)b.start[c]=-1,b.ended[c]=!1,b.Wr[c]=!1;b.path=a.path;b.delay=a.delay}a=a.actions;var c=e.get_current_anim_name(b.rig),d;for(d in a)for(var g=a[d],h=0;h<g.length;h++)e.apply(b.rig,g[h]);c&&e.apply(b.rig,c);q.push(b)}else F.error("Can't create event track. Wrong collider object.")};a.enable_animation=function(){if(q.length){b();var a=u.create_elapsed_sensor();u.create_sensor_manifold(q[0].collider,"ELAPSED",u.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,
b,c){if(1==c)for(a=u.get_sensor_value(a,b,0),b=0;b<q.length;b++){c=q[b];var e=a;if(h.is_visible(c.obj))if(c.random)d(e,c);else{for(var f=m.get_timeline(),g=0;g<c.path.length;g++)if(!c.ended[g]){c.Wr[g]||(c.Wr[g]=!0,c.destination[0]=c.path[g][0],c.destination[1]=c.path[g][1],c.destination[2]=c.path[g][2],c.start[g]=f+c.delay[g]);if(f<c.start[g])break;d(e,c);c.ended[g]=c.Oj;break}a:{for(e=0;e<c.path.length;e++)if(0==c.ended[e]){e=!1;break a}e=!0}if(e)for(e=0;e<c.path.length;e++)c.Wr[e]=!1,c.ended[e]=
!1}}})}};a.disable_animation=function(){if(!(0>=q.length))for(var a=0;a<q.length;a++){var b=q[a];u.check_sensor_manifolds(b.collider)&&u.remove_sensor_manifold(b.collider);e.is_play(b.rig)&&e.stop(b.rig)}}};b4w.module.mouse=function(a,r){function d(){1==l&&(l=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);m.remove_sensor_manifold(f.get_active_camera(),"SMOOTH_PL")}function c(a){2==l&&(l=0);a.removeEventListener("mousedown",g,!1);a.removeEventListener("mouseup",n,!1);a.removeEventListener("mousemove",b,!1);m.remove_sensor_manifold(f.get_active_camera(),"SMOOTH_DRAG")}function b(a){if(C()){if(H)var b=h.client_to_element_coords(a.clientX,
a.clientY,a.target,I);else b=I,b[0]=a.clientX,b[1]=a.clientY;A[0]+=2*(b[0]-E);A[1]+=2*(b[1]-J);E=b[0];J=b[1]}a.preventDefault()}function g(a){if(H)var c=h.client_to_element_coords(a.clientX,a.clientY,a.target,I);else c=I,c[0]=a.clientX,c[1]=a.clientY;E=c[0];J=c[1];a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function n(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function x(a,b,c,d){if(.01<Math.abs(A[0])||.01<Math.abs(A[1]))b=m.get_sensor_value(a,
b,0),a=F.smooth(A[0],0,b,.1*q),b=F.smooth(A[1],0,b,.1*q),A[0]-=a,A[1]-=b,d(4E-4*-a,4E-4*-b)}function e(a,b){var c=f.get_first_character(),d=f.get_active_camera();w.eye_rotate(d,a,b);c&&(d=w.get_camera_angles_char(d,I),B.set_character_rotation(c,d[0],d[1]))}function u(a){z?(a=h.client_to_canvas_coords(a.clientX,a.clientY,I),a=f.pick_object(a[0],a[1])):a=f.pick_object(a.clientX,a.clientY);a?(f.outlining_is_enabled(a)&&f.set_outline_intensity(a,1),f.outlining_is_enabled(v)&&a!=v&&f.set_outline_intensity(v,
0)):f.outlining_is_enabled(v)&&f.set_outline_intensity(v,0);v=a}var w=r("camera"),h=r("container"),m=r("controls"),B=r("physics"),k=r("print"),f=r("scenes"),F=r("util"),t=r("main"),q=1,E=0,J=0,A=new Float32Array(2),I=new Float32Array(2),C=null,v=null,l=0,z=!1,H=!1;a.request_pointerlock=function(a,b,d,g,h,n){function p(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){c(a);a.addEventListener("mousemove",g,!1);var e=f.get_active_camera();
if(!m.check_sensor_manifold(e,"SMOOTH_PL")){var h=m.create_elapsed_sensor();m.create_sensor_manifold(e,"SMOOTH_PL",m.CT_CONTINUOUS,[h],null,x,n)}b()}else a.removeEventListener("mousemove",g,!1),l=0,document.removeEventListener("pointerlockchange",p,!1),document.removeEventListener("webkitpointerlockchange",p,!1),document.removeEventListener("mozpointerlockchange",p,!1),d()}if(1!=l){l=1;b=b||function(){};d=d||function(){};n=n||e;h=h||function(){return!0};g=g||function(a){if(h()){if("number"==typeof a.movementX){var b=
a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;A[0]+=b;A[1]+=a}};document.addEventListener("pointerlockchange",p,!1);document.addEventListener("webkitpointerlockchange",p,!1);document.addEventListener("mozpointerlockchange",p,!1);var q=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof q?q.apply(a):k.error("Pointer lock is not available")}};
a.exit_pointerlock=d;a.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b,c,h){2!=l&&(l=2,d(),C=b||function(){return!0},c=c||e,H=!!h,a.addEventListener("mousedown",g,!1),a.addEventListener("mouseup",n,!1),a=f.get_active_camera(),m.check_sensor_manifold(a,"SMOOTH_DRAG")||(b=m.create_elapsed_sensor(),m.create_sensor_manifold(a,"SMOOTH_DRAG",m.CT_CONTINUOUS,[b],null,x,c)))};a.exit_mouse_drag=
c;a.enable_mouse_hover_outline=function(a){z=!!a;t.detect_mobile()||h.get_canvas().addEventListener("mousemove",u)};a.disable_mouse_hover_outline=function(){t.detect_mobile()||(h.get_canvas().removeEventListener("mousemove",u),v&&f.set_outline_intensity(v,0))};a.get_coords_x=function(a,b,c){b=b?a.targetTouches:a.touches;return c?"clientX"in a&&"clientY"in a?h.client_to_canvas_coords(a.clientX,a.clientY,I)[0]:b&&b[0]&&"clientX"in b[0]&&"clientY"in b[0]?h.client_to_canvas_coords(b[0].clientX,b[0].clientY,
I)[0]:-1:"clientX"in a?a.clientX:b&&b[0]&&"clientX"in b[0]?b[0].clientX:-1};a.get_coords_y=function(a,b,c){b=b?a.targetTouches:a.touches;return c?"clientX"in a&&"clientY"in a?h.client_to_canvas_coords(a.clientX,a.clientY,I)[1]:b&&b[0]&&"clientX"in b[0]&&"clientY"in b[0]?h.client_to_canvas_coords(b[0].clientX,b[0].clientY,I)[1]:-1:"clientY"in a?a.clientY:b&&b[0]&&"clientY"in b[0]?b[0].clientY:-1};a.set_plock_smooth_factor=function(a){q=a};a.get_plock_smooth_factor=function(){return q}};b4w.module.preloader=function(a,r){var d=r("container"),c,b,g,n,x,e,u,w,h=null;a.create_preloader=function(a){var e="#484848",h="#5276cf",f="rgba(150, 150, 150, 0.7)",m="#fff",t;for(t in a)switch(t){case "container_color":e=a.container_color;break;case "bar_color":h=a.bar_color;break;case "frame_color":f=a.frame_color;break;case "font_color":m=a.font_color}a=document.createElement("div");t=a.cloneNode(!1);var q=a.cloneNode(!1),r=a.cloneNode(!1),u=d.get_container();q.appendChild(t);q.appendChild(r);
a.appendChild(q);u.appendChild(a);a.style.cssText="background-color: "+e+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";q.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;box-shadow: 0px 0px 10px 0px "+f+";border: 2px solid "+f+";";t.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+h+";height: 100%;";r.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;font-weight: bold;text-shadow: 0px 0px 6px "+
f+";color: "+m+";";c=t;b=r;g=a;n="DEFAULT"};a.create_simple_preloader=function(a){var d=null,e=null,f="#bf9221",m="#000",t;for(t in a)switch(t){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "bg_color":m=a.bg_color;break;case "bar_color":f=a.bar_color}a=document.createElement("div");t=document.createElement("div");a.id="simple_preloader_container";var q=document.createElement("div"),r=document.createElement("div"),e=document.getElementById(e);
h=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+m+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";t.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";q.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+f+";border-radius: 0px;";r.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
t.appendChild(q);t.appendChild(r);a.appendChild(t);document.body.appendChild(a);n="SIMPLE";g=a;c=q;b=r;x=e};a.create_rotation_preloader=function(a){var c=null,d=null,f="rgba(0,0,0,0)",m="",t="",q="rgba(0,0,0,0)",r;for(r in a)switch(r){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":d=a.background_container_id;break;case "frame_bg_color":f=a.frame_bg_color;break;case "bg_color":q=a.bg_color;break;case "frame_class":m=a.frame_class;break;case "anim_elem_class":t=
a.anim_elem_class}a=document.createElement("div");r=document.createElement("div");var u=document.createElement("div"),w=document.createElement("div"),d=document.getElementById(d);h=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+q+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";r.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+f+";";u.style.cssText=
"position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";w.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";u.className=t;r.appendChild(u);r.className=m;r.appendChild(w);a.appendChild(r);h.appendChild(a);n="ROTATION";g=a;e=u;b=w;x=d};a.create_advanced_preloader=function(a){var d=a.preloader_width,d=d/(d-a.img_width),e=
document.getElementById(a.preloader_bar_id),f=document.getElementById(a.fill_band_id),m=document.getElementById(a.preloader_caption_id),r=document.getElementById(a.preloader_container_id),q=document.getElementById(a.background_container_id);h=document.getElementById(a.canvas_container_id);n="ADVANCED";c=e;u=f;w=d;b=m;g=r;x=q};a.update_preloader=function(a){b.innerHTML=a+"%";"SIMPLE"==n?c.style.width=a+"%":"ADVANCED"==n?(c.style.width=a/w+"%",u.style.width=100-a+"%"):"ROTATION"==n?e.style.transform=
"rotate("+a+"deg)":"DEFAULT"==n&&(c.style.width=a+"%");100==a&&(g.parentNode.removeChild(g),x&&x.parentNode.removeChild(x))}};b4w.module.storage=function(a,r){function d(a){return g[a?a:b]?JSON.parse(g[a?a:b]):{}}var c=r("__print"),b="b4w",g=null;a.init=function(a){a?"b4w"!==a?b=a:c.error("b4w prefix denied"):c.warn("Prefix should be a string. Last declared storage prefix will be used.")};a.set=function(a,c,e){var n=d(e);n[a]=String(c);g[e?e:b]=JSON.stringify(n)};a.cleanup=function(a){delete g[a?a:b]};a.get=function(a,b){var c=d(b);return c[a]?c[a]:""};a.debug=function(a){c.log(d(a?a:b))};try{g=window.localStorage;try{g.tmp=
null,delete g.tmp}catch(n){c.warn("localStorage quota is limited. Disabling localStorage"),g=null}}catch(n){c.warn("Applying chrome localStorage bug workaround"),g=null}g||(c.warn("localStorage is not available, initializing temporary storage"),g={})};b4w.module.screenshooter=function(a,r){var d=r("screen"),c=r("print");a.shot=function(a,g){c.Ze("shot","screen.shot");d.shot(a,g)}};
//# sourceMappingURL=/deploy/apps/common/b4w.min.js.map